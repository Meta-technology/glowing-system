function WmsResource(){this.MessageObject}function push(a){if(a.msg&&a.msg.msglist){var b=a.msg.msglist,c=Object.assign({},a);for(var d=0;d<b.length;d++)delete c.msg.meta,delete c.msg.mod,c.msg=Object.assign(c.msg,b[d]),c.mtype=b[d].mtype,c.msg.meta&&$WC.Util.getObjectLength(c.msg.meta)==0&&delete c.msg.meta,WebMessanger.push(c)}else WebMessanger.push(a);setTimeout(function(){WebMessanger.updateClientDebugStore(a)},1),WebMessanger.lastmessage=a,WebMessanger.lastmessagetime=new Date}function getPrd(){return WebMessanger.getPrd()}function getWmsConfig(){return _WMSCONFIG}function getUserName(){return WebMessanger.getUserName()}function getNickName(){return WebMessanger.getNickName()}function getZuid(){return WebMessanger.getZuid()}function getUserId(){return WebMessanger.getUserId()}function getSid(){return WebMessanger.getSid()}function _getAuthType(){return WebMessanger.authtype}function getAuthToken(){return _WMSAUTHTOKEN}function getAuthScope(){return _WMSAUTHSCOPE}function getZAID(){return _WMSZAID}function getRawSid(){return WebMessanger.getRawSid()}function getWmsContacts(){return WmsContacts.getcontacts()}function updateWmsContacts(a){WmsContacts.init(a)}function isReconnecting(){return WebMessanger.isReconnecting()}function disablewms(){WebMessanger.disable()}function isdisablewms(){return WebMessanger.isdisablewms()}function getWMSOAuthCredentials(){return{token:_WMSOAUTHTOKEN,orgscope:_WMSOAUTHORGSCOPE,userscope:_WMSOAUTHUSERSCOPE,oprscope:_WMSOAUTHOPRSCOPE}}function WebMessanger(){}function EventsUtil(){}function isLongPollingForced(){return _WMS_LP}function WMSUI(){}function ZMSGUI(){}function ChatWindow(){this.atmentions="",this.selectedoptions="",this.win=null,this.partinfo={},this.partcount=0,this.top=20,this.width=WindowHandler.cwsize,this.height=200,this.scrollTop=0,this.msgdisp,this.ftools,this.composer,this.headernode,this.scode,this.smsg,this.stype,this.recipant,this.objId,this.maximized,this.winIndex=-1,this.prevIndex=-1,this.imgurl="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/contactphoto.gif",this.addinfo={},this.prechattime=null,this.offlinemessage=!1,this.ctype=-1,this.attached=!1,this.channelphotoid,this.channeldesc="",this.channeltype,this.channelid,this.channelsoid,this.channelservicecode,this.mutedinterval=null,this.ispinned=!1,this.iscallongoing=!1,this.msgdelaytimer=null,this.msghidetimer=null,this.scrolltimer=null,this.addinfotemplate,this.deleteinfotemplate,this.titleinfotemplate,this.clickedfailurenode,this.lastEnterKeyTime=-1,this.reactions={},this.pinmsgdetails={action_enabled:!0,msg_pinned:!1,info:{}},this.unfurlmsg=!0}function Factory(){}function WindowHandler(){}function Message(){}function Chat(){}function Self(){Self.prevIdleStatus}function WMSZohoApi(){}function WMSKeyHandler(){}function WMSSessionConfig(){}function WmsSound(){}function WmsSettings(){}function WmsDragDrop(){}function PubSubObject(a,b,c,d,e,f){this.pskey=a,this.config=c,this.psuri=b,this.maxulist=-1,d!=undefined&&(this.maxulist=d),this.authtype=e,this.authid=f,this.userinfo={},this.wmsids=new Array,this.getUsers=function(){return this.userinfo},this.reInitUsers=function(){this.userinfo={},this.wmsids=new Array},this.addUsers=function(a){for(var b in a)this.addUser(b,a[b])},this.removeUsers=function(a){for(var b in a)this.removeUser(b,a[b])},this.addUser=function(a,b){var c=this.wmsids.indexOf(a);c!=-1&&this.wmsids.splice(c,1),this.wmsids.push(a),this.userinfo[a]=b;if(this.maxulist!=-1&&this.wmsids.length>this.maxulist){var d=this.wmsids.splice(0,1);delete this.userinfo[d]}},this.removeUser=function(a){var b=this.wmsids.indexOf(a);if(b!=-1){var c=this.wmsids.splice(b,1);delete this.userinfo[c]}},this.userCount=function(){return this.wmsids.length}}function PubSubApi(){}function PubSubBridge(){}function WmsNotification(){}function ListCommon(a,b){this.container=b,this.input=a,this.selectedelem="";var c=this;a.addEventListener("keydown",function(a){var b=a.keyCode;WebMessanger&&(WebMessanger.userslist||WebMessanger.forkedlist)?(b===$WC.WmsConstants.KEYCODES.ENTER||b===$WC.WmsConstants.KEYCODES.UP||b===$WC.WmsConstants.KEYCODES.DOWN)&&a.preventDefault():c.container.style.display!=="none"&&(b===$WC.WmsConstants.KEYCODES.ENTER||b===$WC.WmsConstants.KEYCODES.UP||b===$WC.WmsConstants.KEYCODES.DOWN||b===$WC.WmsConstants.KEYCODES.LEFT||b===$WC.WmsConstants.KEYCODES.RIGHT)&&a.preventDefault()}),a.addEventListener("keyup",function(a){c.container.style.display!=="none"&&c.handleKeyMovement(a,c)}),b.addEventListener("click",function(a){var b=$WC.Util.getEventTarget(a);c.handleClick(b,c),typeof WmsUIImpl!="undefined"&&WmsImplHandler.invoke(WmsUIImpl.onChatWindowDropUpClick,a,c),a.stopPropagation()})}function WmsUsersList(a,b,c,d){this.listcommon=new ListCommon(a,b),this.input=a,this.container=b,this.target=c,this.userlimit=d,this.exclude_users}var $WC=function(a){function k(a,b){for(var c in b)a[c]=b[c];return a}function l(a){var b=a.parentNode;b&&b.removeChild(a)}function m(a,b,c){var d,e=arguments,f={};for(d in b)"key"!==d&&"ref"!==d&&(f[d]=b[d]);if(arguments.length>3)for(c=[c],d=3;d<arguments.length;d++)c.push(e[d]);if(null!=c&&(f.children=c),"function"==typeof a&&null!=a.defaultProps)for(d in a.defaultProps)void 0===f[d]&&(f[d]=a.defaultProps[d]);return n(a,f,b&&b.key,b&&b.ref)}function n(a,c,d,e){var f={type:a,props:c,key:d,ref:e,__k:null,__:null,__b:0,__e:null,__d:null,__c:null,constructor:void 0};return b.vnode&&b.vnode(f),f}function o(a){return a.children}function p(a,b){this.props=a,this.context=b}function q(a,b){if(null==b)return a.__?q(a.__,a.__.__k.indexOf(a)+1):null;for(var c;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e)return c.__e;return"function"==typeof a.type?q(a):null}function r(a){var b,c;if(null!=(a=a.__)&&null!=a.__c){for(a.__e=a.__c.base=null,b=0;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e){a.__e=a.__c.base=c.__e;break}return r(a)}}function s(a){(!a.__d&&(a.__d=!0)&&1===c.push(a)||e!==b.debounceRendering)&&(e=b.debounceRendering)||d(t)}function t(){var a,b,d,e,f,g,h;for(c.sort(function(a,b){return b.__v.__b-a.__v.__b});a=c.pop();)a.__d&&(d=void 0,e=void 0,g=(f=(b=a).__v).__e,(h=b.__P)&&(d=[],e=A(h,f,k({},f),b.__n,void 0!==h.ownerSVGElement,null,d,null==g?q(f):g),B(d,f),e!=g&&r(f)))}function u(a,b,c,d,e,f,g,j,k){var m,n,o,p,r,s,t,u=c&&c.__k||i,w=u.length;if(j==h&&(j=null!=f?f[0]:w?q(c,0):null),m=0,b.__k=v(b.__k,function(c){if(null!=c){if(c.__=b,c.__b=b.__b+1,null===(o=u[m])||o&&c.key==o.key&&c.type===o.type)u[m]=void 0;else for(n=0;n<w;n++){if((o=u[n])&&c.key==o.key&&c.type===o.type){u[n]=void 0;break}o=null}if(p=A(a,c,o=o||h,d,e,f,g,j,k),(n=c.ref)&&o.ref!=n&&(t||(t=[]),o.ref&&t.push(o.ref,null,c),t.push(n,c.__c||p,c)),null!=p){if(null==s&&(s=p),null!=c.__d)p=c.__d,c.__d=null;else if(f==o||p!=j||null==p.parentNode){a:if(null==j||j.parentNode!==a)a.appendChild(p);else{for(r=j,n=0;(r=r.nextSibling)&&n<w;n+=2)if(r==p)break a;a.insertBefore(p,j)}"option"==b.type&&(a.value="")}j=p.nextSibling,"function"==typeof b.type&&(b.__d=p)}}return m++,c}),b.__e=s,null!=f&&"function"!=typeof b.type)for(m=f.length;m--;)null!=f[m]&&l(f[m]);for(m=w;m--;)null!=u[m]&&E(u[m],u[m]);if(t)for(m=0;m<t.length;m++)D(t[m],t[++m],t[++m])}function v(a,b,c){if(null==c&&(c=[]),null==a||"boolean"==typeof a)b&&c.push(b(null));else if(Array.isArray(a))for(var d=0;d<a.length;d++)v(a[d],b,c);else c.push(b?b("string"==typeof a||"number"==typeof a?n(null,a,null,null):null!=a.__e||null!=a.__c?n(a.type,a.props,a.key,null):a):a);return c}function w(a,b,c,d,e){var f;for(f in c)f in b||y(a,f,null,c[f],d);for(f in b)e&&"function"!=typeof b[f]||"value"===f||"checked"===f||c[f]===b[f]||y(a,f,b[f],c[f],d)}function x(a,b,c){"-"===b[0]?a.setProperty(b,c):a[b]="number"==typeof c&&!1===j.test(b)?c+"px":null==c?"":c}function y(a,b,c,d,e){var f,g,h,i,j;if(e?"className"===b&&(b="class"):"class"===b&&(b="className"),"key"!==b&&"children"!==b)if("style"===b)if(f=a.style,"string"==typeof c)f.cssText=c;else{if("string"==typeof d&&(f.cssText="",d=null),d)for(g in d)c&&g in c||x(f,g,"");if(c)for(h in c)d&&c[h]===d[h]||x(f,h,c[h])}else"o"===b[0]&&"n"===b[1]?(i=b!==(b=b.replace(/Capture$/,"")),j=b.toLowerCase(),b=(j in a?j:b).slice(2),c?(d||a.addEventListener(b,z,i),(a.l||(a.l={}))[b]=c):a.removeEventListener(b,z,i)):"list"!==b&&"tagName"!==b&&"form"!==b&&"type"!==b&&!e&&b in a?a[b]=null==c?"":c:"function"!=typeof c&&"dangerouslySetInnerHTML"!==b&&(b!==(b=b.replace(/^xlink:?/,""))?null==c||!1===c?a.removeAttributeNS("http://www.w3.org/1999/xlink",b.toLowerCase()):a.setAttributeNS("http://www.w3.org/1999/xlink",b.toLowerCase(),c):null==c||!1===c?a.removeAttribute(b):a.setAttribute(b,c))}function z(a){this.l[a.type](b.event?b.event(a):a)}function A(a,c,d,e,f,g,h,i,j){var l,m,n,q,r,s,t,w,x,y,z=c.type;if(void 0!==c.constructor)return null;(l=b.__b)&&l(c);try{a:if("function"==typeof z){if(w=c.props,x=(l=z.contextType)&&e[l.__c],y=l?x?x.props.value:l.__:e,d.__c?t=(m=c.__c=d.__c).__=m.__E:("prototype"in z&&z.prototype.render?c.__c=m=new z(w,y):(c.__c=m=new p(w,y),m.constructor=z,m.render=F),x&&x.sub(m),m.props=w,m.state||(m.state={}),m.context=y,m.__n=e,n=m.__d=!0,m.__h=[]),null==m.__s&&(m.__s=m.state),null!=z.getDerivedStateFromProps&&(m.__s==m.state&&(m.__s=k({},m.__s)),k(m.__s,z.getDerivedStateFromProps(w,m.__s))),q=m.props,r=m.state,n)null==z.getDerivedStateFromProps&&null!=m.componentWillMount&&m.componentWillMount(),null!=m.componentDidMount&&m.__h.push(m.componentDidMount);else{if(null==z.getDerivedStateFromProps&&w!==q&&null!=m.componentWillReceiveProps&&m.componentWillReceiveProps(w,y),!m.__e&&null!=m.shouldComponentUpdate&&!1===m.shouldComponentUpdate(w,m.__s,y)){for(m.props=w,m.state=m.__s,m.__d=!1,m.__v=c,c.__e=d.__e,c.__k=d.__k,m.__h.length&&h.push(m),l=0;l<c.__k.length;l++)c.__k[l]&&(c.__k[l].__=c);break a}null!=m.componentWillUpdate&&m.componentWillUpdate(w,m.__s,y),null!=m.componentDidUpdate&&m.__h.push(function(){m.componentDidUpdate(q,r,s)})}m.context=y,m.props=w,m.state=m.__s,(l=b.__r)&&l(c),m.__d=!1,m.__v=c,m.__P=a,l=m.render(m.props,m.state,m.context),c.__k=v(null!=l&&l.type==o&&null==l.key?l.props.children:l),null!=m.getChildContext&&(e=k(k({},e),m.getChildContext())),n||null==m.getSnapshotBeforeUpdate||(s=m.getSnapshotBeforeUpdate(q,r)),u(a,c,d,e,f,g,h,i,j),m.base=c.__e,m.__h.length&&h.push(m),t&&(m.__E=m.__=null),m.__e=null}else c.__e=C(d.__e,c,d,e,f,g,h,j);(l=b.diffed)&&l(c)}catch(a){b.__e(a,c,d)}return c.__e}function B(a,c){b.__c&&b.__c(c,a),a.some(function(a){try{c=a.__h,a.__h=[],c.some(function(b){b.call(a)})}catch(c){b.__e(c,a.__v)}})}function C(a,b,c,d,e,f,g,j){var k,l,m,n,o,p=c.props,q=b.props;if(e="svg"===b.type||e,null==a&&null!=f)for(k=0;k<f.length;k++)if(null!=(l=f[k])&&(null===b.type?3===l.nodeType:l.localName===b.type)){a=l,f[k]=null;break}if(null==a){if(null===b.type)return document.createTextNode(q);a=e?document.createElementNS("http://www.w3.org/2000/svg",b.type):document.createElement(b.type),f=null}if(null===b.type)null!=f&&(f[f.indexOf(a)]=null),p!==q&&a.data!=q&&(a.data=q);else if(b!==c){if(null!=f&&(f=i.slice.call(a.childNodes)),m=(p=c.props||h).dangerouslySetInnerHTML,n=q.dangerouslySetInnerHTML,!j){if(p===h)for(p={},o=0;o<a.attributes.length;o++)p[a.attributes[o].name]=a.attributes[o].value;(n||m)&&(n&&m&&n.__html==m.__html||(a.innerHTML=n&&n.__html||""))}w(a,q,p,e,j),b.__k=b.props.children,n||u(a,b,c,d,"foreignObject"!==b.type&&e,f,g,h,j),j||("value"in q&&void 0!==q.value&&q.value!==a.value&&(a.value=null==q.value?"":q.value),"checked"in q&&void 0!==q.checked&&q.checked!==a.checked&&(a.checked=q.checked))}return a}function D(a,c,d){try{"function"==typeof a?a(c):a.current=c}catch(a){b.__e(a,d)}}function E(a,c,d){var e,f,g;if(b.unmount&&b.unmount(a),(e=a.ref)&&(e.current&&e.current!==a.__e||D(e,null,c)),d||"function"==typeof a.type||(d=null!=(f=a.__e)),a.__e=a.__d=null,null!=(e=a.__c)){if(e.componentWillUnmount)try{e.componentWillUnmount()}catch(a){b.__e(a,c)}e.base=e.__P=null}if(e=a.__k)for(g=0;g<e.length;g++)e[g]&&E(e[g],c,d);null!=f&&l(f)}function F(a,b,c){return this.constructor(a,c)}function G(a,c,d){var e,g,j;b.__&&b.__(a,c),g=(e=d===f)?null:d&&d.__k||c.__k,a=m(o,null,[a]),j=[],A(c,(e?c:d||c).__k=a,g||h,h,void 0!==c.ownerSVGElement,d&&!e?[d]:g?null:i.slice.call(c.childNodes),j,d||h,e),B(j,a)}function K(a,b){var c;typeof a=="string"||typeof a=="boolean"||typeof a=="number"?c=a:a&&(c=a.id,b=a.params);if(J.get("Resource"))return J.get("Resource").getRealValue(c,b);WmsResource.getRealValue(c,b)}function L(){var a=["common.days.su","common.days.mo","common.days.tu","common.days.we","common.days.th","common.days.fr","common.days.sa"];return m("div",null,m("div",{"class":H.weekheader},a.map(function(a,b){return m("div",{key:b,"class":H.weekheadercnt},m(K,{id:a}))})))}function M(a){var b=["common.month.january","common.month.february","common.month.march","common.month.april","common.month.may","common.month.june","common.month.july","common.month.august","common.month.september","common.month.october","common.month.november","common.month.december"],c=b[a.month_number];return m(K,{id:c})}function S(a){var b=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");return K(b[a])}function T(a){var b=new Date(Number(a)),c=b.getHours(),d=b.getMinutes(),e="",f=c>12?c-12:c==0?"12":c;return e+=f<10?"0"+f:f,e+=(d<10?":0":":")+d,e+=c>=12?" "+K("PM"):" "+K("AM"),e}function U(a){var b=new Date(Number(a)),c=b.getHours(),d=b.getMinutes(),e="";e+=X(a)+" ";var f=c>12?c-12:c==0?"12":c;return e+=f<10?"0"+f:f,e+=(d<10?":0":":")+d,e+=c>=12?" "+K("PM"):" "+K("AM"),e}function V(a){var b=new Date(Number(a)),c="",d=J.get("dateformat");if(d==undefined){var e=b.getDate(),f=S(b.getMonth());return c+=e,c+=" "+f,(new Date).getFullYear()!==b.getFullYear()&&(c+=" "+b.getFullYear()),c}var g=b.getDate(),h=b.getMonth()+1,i=b.getFullYear();d=d.replace(/dd/,g<10?"0"+g:g),d=d.replace(/MM/,h<10?"0"+h:h),d=d.replace(/yyyy/,i);var j=(""+i).substr(2,4);return d=d.replace(/yy/,j<10?"0"+j:j),c=d+" ",c}function W(a,b){return V(a)===V(b)}function X(a){var b=new Date(Number(a)),c=new Date;return W(b,c)?K("chat.today"):(c.setDate(c.getDate()-1),W(b,c)?K("chat.yesterday"):V(a))}function Y(a,b){var c=new Date,d=c.getTime()+c.getTimezoneOffset()*6e4,e=T(d+parseInt(b));return e+" ( "+a+" )"}function Z(a){var b=[],c=parseInt(a)-Date.now();c/=1e3;var d;return c<=60?K("chat.mute.seconds"):(c>86400&&(d=parseInt(c/86400),b.push(d),b.push(d===1?K("chat.mute.day"):K("chat.mute.days")),c%=86400),c>3600&&(d=parseInt(c/3600),b.push(d),b.push(d===1?K("chat.mute.hour"):K("chat.mute.hours")),c%=3600),c>60&&(d=parseInt(c/60),b.push(d),b.push(d===1?K("chat.mute.minute"):K("chat.mute.minutes")),c%=60),b.join(" "))}function $(a){var b=new Date(a),c=b.getHours(),d=b.getMinutes();return(c<10?"0"+c:c)+":"+(d<10?"0"+d:d)+":"+"00"}function ba(a,b,c,d){var e="";d=d||"",c&&(e=new Date,e.setTime(e.getTime()+c),e=e.toUTCString()),document.cookie=a+"="+encodeURIComponent(b)+";expires="+e+";domain="+d+";path=/"}function bb(a){var b=document.cookie.split("; ");for(var c=0;c<b.length;c++){var d=b[c],e=d.split("="),f=e[0];if(f===a)return decodeURIComponent(e[1])}return""}function bc(a,b){b=b||"",document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+b+";path=/"}function bj(a){var b=a.type?a.type:"GET",c=typeof a.async=="boolean"?a.async:!0,d=a.callback,e=a.url,f;window.XMLHttpRequest?f=new XMLHttpRequest:window.ActiveXObject&&(f=new ActiveXObject("Microsoft.XMLHTTP")),f.opts=a.opts,f.onreadystatechange=d,f.open(b,e,c),f.setRequestHeader("Accept","*/*"),a.usedefaultcontenttype||(a.reqheaders&&a.reqheaders["Content-Type"]?f.setRequestHeader("Content-Type","application/json"):f.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"));if(a.uploadlisteners)for(var g in a.uploadlisteners)f.upload.addEventListener(g,a.uploadlisteners[g]);if(a.reqheaders)for(var h in a.reqheaders)f.setRequestHeader(h,a.reqheaders[h]);f.send(a.params)}function bk(a,b,c,d,e,f,g,h,i,j){a&&(b="/"+a+"/"+b),c?b+="?"+c+eD(!0):b+="?nocache="+(new Date).getTime();var k={onsuccess:d,onfailure:e,callbackargs:f},i={callback:bx,opts:k,url:b,async:g,reqheaders:h,usedefaultcontenttype:i&&i.usedefaultcontenttype||"",uploadlisteners:j};bj(i)}function bl(a,b,c,d,e,f,g,h,i,j){a&&(b="/"+a+"/"+b),h=h?h:{},h["X-ZCSRF-TOKEN"]=ex(),h&&h["Content-Type"]==="application/json"?c=JSON.stringify(c):!c instanceof FormData&&(c=c?c+eD(!0):"");var k={onsuccess:d,onfailure:e,callbackargs:f},i={type:"POST",callback:bx,url:b,params:c,opts:k,async:g,reqheaders:h,usedefaultcontenttype:i&&i.usedefaultcontenttype||"",uploadlisteners:j};bj(i)}function bm(a,b,c,d,e,f,g,h,i,j){a&&(b="/"+a+"/"+b);if(h&&h["Content-Type"]==="application/json")c=JSON.stringify(c);else{var k=ex();c=c?c+"&"+k:k,c+=eD(!0)}var l={onsuccess:d,onfailure:e,callbackargs:f},i={type:"PUT",callback:bx,url:b,params:c,opts:l,async:g,reqheaders:h,usedefaultcontenttype:i&&i.usedefaultcontenttype||"",uploadlisteners:j};bj(i)}function bn(a,b,c,d,e,f,g,h,i,j){a&&(b="/"+a+"/"+b);if(h&&h["Content-Type"]==="application/json")c=JSON.stringify(c);else{var k=ex();c=c?c+"&"+k:k,c+=eD(!0)}var l={onsuccess:d,onfailure:e,callbackargs:f},i={type:"DELETE",callback:bx,url:b,params:c,opts:l,async:g,reqheaders:h,usedefaultcontenttype:i&&i.usedefaultcontenttype||"",uploadlisteners:j};bj(i)}function bo(a,b,c,d,e,f,g){bk(J.get("WMSCONT"),a,b,c,d,e,f,g)}function bp(a,b,c,d,e,f,g){bl(J.get("WMSCONT"),a,b,c,d,e,f,g)}function bq(a,b,c,d,e,f,g){bm(J.get("WMSCONT"),a,b,c,d,e,f,g)}function br(a,b,c,d,e,f,g){bn(J.get("WMSCONT"),a,b,c,d,e,f,g)}function bs(a,b,c,d,e,f,g){bk(J.get("CHATCONT"),a,b,c,d,e,f,g)}function bt(a,b,c,d,e,f,g,h,i){bl(J.get("CHATCONT"),a,b,c,d,e,f,g,h,i)}function bu(a,b,c,d,e,f,g){bm(J.get("CHATCONT"),a,b,c,d,e,f,g)}function bv(a,b,c,d,e,f,g){bn(J.get("CHATCONT"),a,b,c,d,e,f,g)}function bw(a,b,c,d,e,f,g){var h=J.get("LOCATION_INFO").PERMISSIONSTATE;if(h==="granted"){var i=function(){var h=eJ(J.get("LOCATION_INFO").CACHED.coords);h.status="granted",g=g||{},g["X-Geo-Location"]=JSON.stringify(h),bt(a,b,c,d,e,f,g)};if(J.get("LOCATION_INFO").CACHED!==undefined)i();else{J.get("LOCATION_INFO").WATCH_ID!==undefined&&navigator.geolocation.clearWatch(J.get("LOCATION_INFO").WATCH_ID);var j=function(a){var b=J.get("LOCATION_INFO").CACHED===undefined;J.get("LOCATION_INFO").CACHED=a,J.get("LOCATION_INFO").PERMISSIONSTATE="granted",b&&i()},k=function(h){var i;h.code===1?(i="denied",J.get("LOCATION_INFO").PERMISSIONSTATE=i):i="failure";var j=J.get("LOCATION_INFO").CACHED===undefined;j&&(g=g||{},g["X-Geo-Location"]=JSON.stringify({status:i}),bt(a,b,c,d,e,f,g)),delete J.get("LOCATION_INFO").CACHED};J.get("LOCATION_INFO").WATCH_ID=navigator.geolocation.watchPosition(j,k)}}else g=g||{},g["X-Geo-Location"]=JSON.stringify({status:h}),bt(a,b,c,d,e,f,g)}function bx(){if(this.readyState===4)if(this.status===200||this.status===204){var a=this.responseText;if(a!==""){var b;try{b=JSON.parse(a)}catch(c){try{a=a.slice(0,-1),a="[["+a+"]]",b=JSON.parse(a)}catch(d){typeof this.opts.onsuccess=="function"&&this.opts.onsuccess.call(this)}}if(b===null||b===undefined)return;var e=b.length,f=0;if(e)for(f=0;f<e;f++){var g=b[f],h=g.objString;g.objType&&g.objType==="do"&&(h=by(g.objType,g.objString));if(typeof this.opts.onsuccess=="function")this.opts.onsuccess.call(this,h);else if(J.get("AjaxDispatcher")){var i=J.get("AjaxDispatcher");i(g.module,g.objType,h)}}else typeof this.opts.onsuccess=="function"&&this.opts.onsuccess.call(this,a)}else typeof this.opts.onsuccess=="function"&&this.opts.onsuccess.call(this)}else{var j="";if(typeof this.response=="string"&&!$WC.Util.isEmpty(this.response))try{j=JSON.parse(this.response)}catch(c){}j&&$WC.SecurityManager.isSecurityError(j)&&$WC.SecurityManager.handleError(j),typeof this.opts.onfailure=="function"&&this.opts.onfailure.call(this)}}function by(a,b){if(a==="do"){var c=new bi;for(var d=0;d<b.length;d++){var e=b[d],f=e.tname,g=e.cols,h=e.rows;for(var i=0;i<h.length;i++){var j=h[i],k=[];for(var l=0;l<j.length;l++)k[l]=[g[l],j[l]];c.addRowsForTable(f,k)}}return c}return b}function bE(){return bD}function bF(a){return a?bB[a]:bB}function bG(a,b){a?bB[a]=b:bB=b}function bH(a){for(var b in a)bG(b,{USERID:b,DNAME:a[b][0],EMAILID:a[b][1],UC:a[b][3]});if(this.opts.callbackargs&&this.opts.callbackargs.params){var c=this.opts.callbackargs.params.split("=")[2];this.opts.callbackargs.searchtext=c,c&&(a=$WC.HybridSearch.filter("display_name",c,a,null,null,"email_id")),a.length?bC.result.push(this.opts.callbackargs.params):bC.noresult.push(this.opts.callbackargs.params)}var d=this.opts.callbackargs&&this.opts.callbackargs.reqid,e=this.opts.callbackargs&&this.opts.callbackargs.topicname;e==="suggestionui"&&(bD=!0),e?(bP(),eI.publish("/orgcontacts/"+e,{callbackargs:this.opts.callbackargs,stat:a.length?"":bA.REQSTATUS.NORESULTS})):eI.publish("/orgcontacts/updateui",{callbackargs:this.opts.callbackargs,reqid:d})}function bI(){var a="updateui",b=this.opts.callbackargs&&this.opts.callbackargs.reqid,c=this.opts.callbackargs&&this.opts.callbackargs.chid;this.opts.callbackargs&&this.opts.callbackargs.topicname&&(a=this.opts.callbackargs.topicname);var d=this.opts&&this.opts.callbackargs;eI.publish("/orgcontacts/"+a,{stat:bA.REQSTATUS.FAILED,chid:c,reqid:b,callbackargs:d})}function bJ(a){var b="limit=50";return b+="&search="+encodeURIComponent(a),b}function bK(a,b){bL({searchtext:a,topicname:"getapi"});var c=eI.subscribe("/orgcontacts/getapi",function(){b(),eI.unsubscribe(c)})}function bL(a,b){if($WC.Config.get("isOrgUser")()===!1)return;var c=a.chid,d=a.searchtext,e=bJ(d),f=a.silentload,g=a.inpresultset,h=a.topicname;a.reqid=b,bM(d)===!1?bs("getorgusers.do",e,bH,bI,{reqid:b,params:e,topicname:h,chid:c,silentload:f}):h?eI.publish("/orgcontacts/"+h,{reqid:b,callbackargs:a}):eI.publish("/orgcontacts/updateui",{reqid:b,callbackargs:a})}function bM(a){var b=a&&a.searchtext||a,c=bJ(b);for(var d=0;d<bC.result.length;d++){var e=bC.result[d];if(e.indexOf(c)!==-1)return!0}return bR(b)}function bN(){var a=(new Date).getTime(),b=864e5,c=bh.getItem($WC.Config.get("zuid")+"_wms_orgcontacts");if(c!=null&&a-c.reqtime>b){bC.result=[],bC.noresult=[],bQ(),bL({searchtext:"",topicname:"suggestionui"},"");return}eH(bB)==0&&(c!=null?eH(c.contacts)>0&&bO():bL({searchtext:"",topicname:"suggestionui"},""))}function bO(){var a=bh.getItem($WC.Config.get("zuid")+"_wms_orgcontacts");bB=a.contacts}function bP(){var a={};a.contacts=bB,a.reqtime=(new Date).getTime(),bh.setItem($WC.Config.get("zuid")+"_wms_orgcontacts",a)}function bQ(){bh.removeItem($WC.Config.get("zuid")+"_wms_orgcontacts")}function bR(a){var b=bJ(a);for(var c=0;c<bC.noresult.length;c++){var d=bC.noresult[c];if(b.startsWith(d))return!0}return!1}function bS(a,b){bF(a)!==undefined&&(bF(a).DNAME=b)}function bZ(a){G(m(bY,{nodeToBeFocusedOnClose:a.nodeToBeFocusedOnClose,headerhtml:a.headerhtml,heading:a.heading,actions:a.actions,footerinfoprefix:a.footerinfoprefix,footerinfosuffix:a.footerinfosuffix,customDialogStyles:a.customDialogStyles,callbackOnClose:a.callbackOnClose,ignoreFocusOnMount:a.ignoreFocusOnMount},a.content),document.body)}function b_(a){a=""+a;var b=[];return a=cj(a,b),a=ca(a),a=cb(a),a=ct(a),a=ck(a,b),a=be.replace("markdown_codeblock",a,ci),a}function ca(a){return a=be.replace("markdown_image",a,cc),a=be.replace("markdown_link",a,ce),a=be.replace("markdown_quote",a,cf),a=be.replace("markdown_heading",a,cg),a=be.replace("markdown_code",a,cn),a}function cb(a){return a=be.replace("markdown_bold",a,co),a=be.replace("markdown_italic",a,cp),a=be.replace("markdown_strike",a,cq),a=be.replace("markdown_underscore",a,cr),a=be.replace("markdown_line",a,ch),a}function cc(a,b,c,d,e){var f=e==="www."?"http://"+d:d;return b+'<img src="'+f+'" alt="'+cs(c)+'" />'}function cd(a){var b=Object.keys(a["btnindexvsdetails.msg"]);return function(a,c,d,e){var f=b.indexOf(e)>-1?'<a zc-quickbutton="'+(typeof c!="undefined"?c:"")+'" btnindex="'+e+'">'+d+"</a>":a;return f}}function ce(a,b,c,d,e){var f=e==="www."?"http://"+d:d;return b+'<a markdown="linkhtml" href="'+f+'" target="_blank">'+cs(c)+"</a>"}function cf(a,b){return b=b.trim(),b.length===0?a:"<blockquote>"+cb(b)+"</blockquote>"}function cg(a,b,c){var d=b.length;return"<h"+d+">"+cs(c)+"</h"+d+">"}function ch(a,b,c,d){return"<hr>"+cb(d)}function ci(a,b,c){return c=c.trim(),c.length===0?a:b+"<pre>"+cs(c)+"</pre>"}function cj(a,b){var c=new RegExp(/(^|\s)(`{3}((?:(?:.*?$)\n)?(?:[\s\S]*?))`{3})(?=$|\s)/,"g");return a=a.replace(c,function(a,c,d){return d=d.trim(),d.length===0?a:(b.push(d),c+"<CODEBLOCK>")}),a}function ck(a,b){for(var c=0;c<b.length;c++)a=a.replace(/<CODEBLOCK>/,b[c]);return a}function cl(a,b){return b&&b["btnindexvsdetails.msg"]&&(a=be.replace("markdown_instantbutton",a,cd(b))),a}function cm(a){return be.replace("markdown_instantbutton",a,function(a,b,c){return c})}function cn(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="`"||c[c.length-1]==="`"||c[0]===" "&&c[c.length-1]===" "?a:b+"<code>"+cs(c)+"</code>"}function co(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="*"||c[c.length-1]==="*"||c[0]===" "&&c[c.length-1]===" "?a:b+"<strong>"+cb(c)+"</strong>"}function cp(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="_"||c[c.length-1]==="_"||c[0]===" "&&c[c.length-1]===" "?a:b+"<i>"+cb(c)+"</i>"}function cq(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="~"||c[c.length-1]==="~"||c[0]===" "&&c[c.length-1]===" "?a:b+"<strike>"+cb(c)+"</strike>"}function cr(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="__"||c[c.length-1]==="__"||c[0]===" "&&c[c.length-1]===" "?a:b+"<u>"+cb(c)+"</u>"}function cs(a){return a.replace(/\*/g,"&ast;").replace(/\_/g,"&#95;").replace(/\~/g,"&#126;")}function ct(a){return a.replace(/&ast;/g,"*").replace(/&#95;/g,"_").replace(/&#126;/g,"~")}function cx(a){return eC(b_(ey(a)))}function cD(a,b){var c=!0;if(cA[a]){var d=cA[a];c=d.status?d.status==="enabled":c,c=!eM(b)&&d.actions&&d.actions[b]?c&&d.actions[b]=="enabled":c}return c}function cE(a){return typeof cB[a]=="function"}function cF(a,b){cB[a]=b}function cG(a){for(var b in a){var c={};c.status=a[b].status,a[b].actions&&(c.actions=a[b].actions),cA[b]=c}return!0}function cH(a){for(var b in a)cA[b]=a[b];this.handleModulesStatusChange(a)}function cI(a){for(var b in a)this.isRegistered(b)&&cB[b]()}function cJ(a){return!eM(a)&&!eM(a.code)&&typeof a.code=="string"&&(a.code.startsWith(this.errorcodes.CS_DISABLED_BY_ADMIN)||a.code.startsWith(this.errorcodes.CS_ACTION_DISABLED_BY_ADMIN))}function cK(a,b){$WC.$Win.isExist("actionforbidden")&&$WC.$Win.destroy("actionforbidden");if(document.getElementById("zcwindows")===null){var c=document.createElement("div");c.id="zcwindows",c.className="zcoverlay",typeof WebMessanger!="undefined"&&(c.style.zIndex=WebMessanger.setzindex),document.body.appendChild(c)}$WC.$Dlg.create({id:"actionforbidden",version:2,"class":"zcdalogbx zcbg_mask alert_dialog",headerhtml:$WC.$Dlg.frameHeaderHTML({imagehtml:'<div class="zcrestrict_icon"></div>',header:K("module.access.restricted")}),bodyhtml:$WC.$Dlg.frameBodyInfoHTML({info:[!eM(a)&&!eM(a.message)?a.message:K("module.disabled.common")]}),buttons:[{text:b?K("common.reload"):K("Ok"),colour:$WC.$Dlg.RED_BUTTON,action:b?function(){location.reload()}:""}]})}function cL(a){for(var b in a)this.register(b,a[b])}function cS(a,b){a=a.indexOf("b-")!=-1?a.split("-")[1]:a,cN[a]&&(cN[a].actionhandles=b)}function cT(){cP=!0}function cU(){cR=!0}function cV(){(cP||cR)&&cX(cR)}function cW(a){var b={ISBOT:!0,EMAILID:K("chatbot.smsg"),STATUSMSG:K("chatbot.smsg"),TYPE:"",PROTOCOL:"zoho",SCODE:1,UC:a.usage_count||a.info&&a.info.uc||0,ZUID:""};b.DNAME=a.name,b.UNIQUENAME=a.unique_name||a.info&&a.info.uniquename||a.uniquename,b.PHOTO=a.photo||a.photo_id||a.photoid,b.CHID=a.chat_id||a.chid||"",b.USERID=a.id,b.PERMISSION=a.permission||a.info&&a.info.permission,b.DESC=a.description||a.info&&a.info.desc||a.desc,b.ISSUBSCRIBED=a.active?!0:!1,b.PHOTO?b.PHOTO="/_chat/botimg/"+b.PHOTO+"/photo.do":b.CHID.endsWith("B1")?b.PHOTO="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bot-custom.png":b.PHOTO="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bot-default.png";var c=a.status||a.statusmsg;if(c){var d=Math.round(Math.random()*(c.length-1));b.STATUSMSG=c[d],b.EMAILID=c[d]}return b.original_info=a,b}function cX(a){if(J.get("isCliqUser")()&&cD("bots"))if(cQ==null||a){var b=dd();if(b){cN=b.botslist;for(var c in cN)cN[c].ISSUBSCRIBED&&(cO[c]=cN[c])}var d=b&&b.sync_token;cY(d)}}function cY(a){var b=function(a){var b=a&&JSON.parse(a);cZ(b.data),da(b.deleted),dc(b.sync_token),eI.publish("/bots/updateui")};cQ=(new Date).getTime(),cP=!1,cR=!1;var c=function(){cQ=null,cR=!0},d="limit=1000";a&&(d+="&sync_token="+a),bs("v2/bots",d,b,c)}function cZ(a){if(typeof a=="object"&&!fr(a)){var b=[];for(var c in a)b.push(a[c]);a=b}a.forEach(function(a){var b=cW(a);a.active&&(cO[a.id]=b),cN[a.id]=b})}function c$(a){return a?cO:cN}function c_(a){return a=(""+a).indexOf("b-")!=-1?a.split("-")[1]:""+a,cN[a]}function da(a){a&&a.length!=0&&a.forEach(function(a){delete cN[a]})}function db(a){a&&(delete cO[a],cN[a].ISSUBSCRIBED=!1,cN[a].original_info.active=!1)}function dc(a){var b={botslist:cN,sync_token:a};bh.setItem(J.get("zuid")+"_wms_bots",b)}function dd(){return bh.getItem(J.get("zuid")+"_wms_bots")}function de(a,b,c){return c&&(a=dg(c)),a=(""+a).indexOf("b-")!=-1?a.split("-")[1]:""+a,cN[a]&&cN[a].original_info&&(b=b||cN[a].original_info.photo_id||cN[a].original_info.photo||cN[a].original_info.photoid||""),b?"/"+J.get("CHATCONT")+"/botimg/"+b+"/photo.do":cN[a]&&cN[a].CHID.endsWith("B1")?"https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bot-custom.png":"https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bot-default.png"}function df(a){var b="v1/bots/b-"+a+"/subscribe",c="consent_validation=true",d={"x-consents-version":"1","X-XHR-exception":!0,"X-ZCSRF-TOKEN":ex()},e=function(){var a=JSON.parse(this.response);if(a.data.status==="Consent"){var b=new cz;b.mountComponent("",a.data)}};bt(b,c,e,null,null,null,d)}function dg(a){for(var b in cN)if(cN[b].CHID==a)return b}function dh(a){if(a){var b=c_(a);return b&&b.DNAME}}function di(a){return a=""+a,a.indexOf("b-")!=-1||cN[a]?!0:!1}function ds(a){return a?dm[a]:dm}function dt(a){return a?dn[a]:dn}function du(a){return a?dp[a]:dp}function dv(a,b){a&&(dp[a]=b)}function dw(a){delete dp[a]}function dx(a){a===null?dm=[]:dm.push(a)}function dy(a){a===null?dn=[]:dn.push(a)}function dz(a){dq=a}function dA(){return dq}function dB(a){dr=a}function dC(){return dr}function dD(a){var b=a.zuid;du(b)==undefined&&dv(b,{OWNERID:J.get("zuid"),USERID:b,DNAME:a.dname,EMAILID:a.email}),du(b).STATUS=a.scode,du(b).STYPE=a.st,du(b).STATUSMSG=a.smsg}function dE(a,b){var c=!1;du(a)!==undefined&&(c=du(a).DNAME!==b?!0:!1,du(a).DNAME=b),c&&WmsHybridSearch.populateContactListInMainUI(!0)}function dF(a){var b=[];try{for(var c in a){var d=a[c].STATUS;d==-3&&b.push(c)}}catch(e){}b.length>0&&(WmsImplHandler.invoke(WmsContactImpl.handleInvitations,b),WMSUI.updateInvitations(b))}function dG(a){try{for(var b in a){var c=ev(a[b].s,6,!0),d={};d.zuid=b,d.scode=c[0],d.email=c[1],d.st=c[2],d.uc=c[3],d.dname=c[5][1]||d.email,d.smsg=c[5][0]||WmsContacts.defaultstatusmsg[d.scode],d.scode==bA.CONTACTSTATUS.REQACC&&ds().indexOf(b)===-1&&dt().indexOf(b)===-1?(dx(b),dy(b)):d.scode==bA.CONTACTSTATUS.NOCHAT&&dt().indexOf(b)===-1&&dy(b),dJ(d)}dz((new Date).getTime())}catch(e){}ds().length&&typeof WmsContactImpl!="undefined"&&WmsImplHandler.invoke(WmsContactImpl.handleInvitations,ds())}function dH(a){var b=[];try{for(var c in a){var d=a[c];d.STATUS==-3&&b.push(c),dI(d)}dz((new Date).getTime())}catch(e){}b.length>0&&(WmsImplHandler.invoke(WmsContactImpl.handleInvitations,b),WMSUI.updateInvitations(b))}function dI(a){dv(a.USERID,{STATUS:a.STATUS,STYPE:a.st,STATUSMSG:a.STATUSMSG,OWNERID:J.get("zuid"),USERID:a.USERID,DNAME:a.DNAME,EMAILID:a.EMAILID});var b="";a.PHOTO!=""&&a.PHOTO!=undefined&&(b=a.PHOTO),du(a.USERID).PHOTO=b}function dJ(a){dv(a.zuid,{STATUS:a.scode,STYPE:a.st,STATUSMSG:a.smsg,OWNERID:J.get("zuid"),USERID:a.zuid,DNAME:a.dname,EMAILID:a.email,PHOTO:"",UC:a.uc}),dz((new Date).getTime())}function dK(a){dw(a)}function dL(){return dC()}function dM(a){dp={},dz(0),dB(!1),a!=undefined&&(dH(a),dB(!0))}function dN(){return du()}function dO(a){return du(a)?du(a).status!=="0":!1}function dP(){return du()}function dQ(a){var b=dS(a);return b==bA.CONTACTSTATUS.UNAPRD?K("Invited"):b==bA.CONTACTSTATUS.REMOVE||b==bA.CONTACTSTATUS.DELETE?"+"+K("chat.contact.add"):b==bA.CONTACTSTATUS.REQACC||b==bA.CONTACTSTATUS.NOCHAT?K("contact.profileinfo.accept"):du(a)?du(a).STATUSMSG:"+ "+K("chat.contact.add")}function dR(a){if(du(a))return du(a).STYPE}function dS(a){return du(a)?du(a).STATUS:c_(a)?c_(a).STATUS:!1}function dT(a,b,c){var d={0:"offline",1:"available",3:"busy",4:"idle",7:"away"};b=b||dS(a),c=c||dR(a);var e="";return b?(e=d[b]||"",c==dk.MOB_LOGIN&&(e+="_mobile")):a&&di(a)&&(e+="bot"),e}function dU(a,b,c){var d,e;if(b.trim()==0)return;a=="zoho"?(d="addcontact.do",e="ulist="+encodeURIComponent(b)):(d="mpcontact.do",e="zohoid="+WebMessanger.getUserName()+"&mploginid="+c+"&contactid="+b+"&opr=addcon"),bt(d,e)}function dV(a,b,c){if(b.trim()==0)return;var d="emailid="+b;bp("reinvitebyemailid.sas",d),dv(c,{STATUS:"0",STATUSMSG:null,OWNERID:null,USERID:c}),dz((new Date).getTime())}function dW(a,b,c){var d,e;a=="zoho"?(d="deletecontact.do",e="emailid="+encodeURIComponent(ec(b))+"&userid="+b):(d="mpcontact.do",e="zohoid="+WebMessanger.getUserName()+"&mploginid="+c+"&contactid="+b+"&opr=removecon"),bt(d,e),dv(b,null),dz((new Date).getTime())}function dX(a,b){if(du()&&du(a))return du(a);if(b&&bF()&&bF(a))return bF(a)}function dY(a){try{return du(a)?du(a).DNAME:bF(a)?bF(a).DNAME:c_(a)?c_(a).DNAME:null}catch(b){return null}}function dZ(a,b,c,d){if(du(a)&&du(a).STATUS>=0&&du(a).STATUS<=4){if(du(a).STATUS!==b||du(a).STYPE!==c||du(a).STATUSMSG!==d)du(a).STATUS=b,du(a).STYPE=c,du(a).STATUSMSG=d,WmsHybridSearch.updatePresence(a),WmsMainUI.updateChatHTML(a)}else bF(a)&&(bF(a).STATUS!==b||bF(a).STYPE!==c||bF(a).STATUSMSG!==d)&&(bF(a).STATUS=b,bF(a).STYPE=c,bF(a).STATUSMSG=d,WmsMainUI.updateChatHTML(a))}function d$(a){var b=a.getAttribute("data-operation"),c=a.getAttribute("data-id"),d=a.getAttribute("data-dname");c===null&&d===null&&(c=a.parentNode.getAttribute("data-id"),d=a.parentNode.getAttribute("data-dname")),b==="accept"?(d_("zoho",c,J.get("zuid")),eE(dt(),c)):b==="reject"?eb(c):b==="addcontact"&&(c?WMSUI.inviteMember(c,d):(WMSUI.inviteMember(d,d),WmsMainUI.resetToDefaultUI())),document.getElementById("wms-hysearch")&&WmsHybridSearch.populateFrequentContactsInSmartChat();if(typeof WmsMainUI!="undefined"&&!J.get("customContacts")){var e={};e.suggestions="show_suggestions",WmsHybridSearch.populateContactListInMainUI(!0,e)}}function d_(a,b,c){var d,e;if(b.trim()==0)return;a=="zoho"?(d="approvecontact.do",e="status=accept&userid="+b):(d="mpcontact.do",e="zohoid="+WebMessanger.getUserName()+"&mploginid="+c+"&contactid="+b+"&opr=acceptcon"),bt(d,e)}function ea(a,b,c){var d,e;if(b.trim()==0)return;a=="zoho"?(d="approvecontact.do",e="status=reject&userid="+b):(d="mpcontact.do",e="zohoid="+WebMessanger.getUserName()+"&mploginid="+c+"&contactid="+b+"&opr=rejectcon"),bt(d,e)}function eb(a){var b="approvecontact.do",c="status=remindmelater&userid="+a;bt(b,c)}function ec(a){return du(a)?du(a).EMAILID:bF(a)?bF(a).EMAILID:null}function ed(a){var b="",c=du();for(var d in c)c[d].EMAILID===a&&(b=d);if(!b){var e=bF();for(var d in e)e[d].EMAILDID===a&&(b=d)}return b}function ee(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.uname,e=c.scode,f=c.zuid;if(f.trim().length==0)continue;try{var g=dS(d);g!==!1&&e!=g&&g>=0&&WebMessanger.verifyUserStatus(c.zuid,du(d).STATUS)}catch(h){}}}function ef(a,b){var c="";ew(a)||a=="null"||ek(a)?c="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/contactphoto.gif":c_(a)?c=de(a):J.get("customContacts")&&(c=WmsImplHandler.invokeSynchronously(WmsUIImpl.getUserPhoto,a,b));if(!c){var d=b||"50";c=J.get("photoserver")+"/file?ID="+a+"&t=user&height="+d+"&width="+d+"&exp=360000"}return c}function eg(a,b,c,d){var e=[];c=c||du();for(var f in c)c[f][a]&&e.push(c[f]);return a==="UC"?e.sort(eF(a,b,function(a){return parseInt(a,10)})):e.sort(eF(a,b,function(a){return a.toLowerCase()})),e.slice(0,d)}function eh(a){var b=dX(a);return b&&b.STATUS==bA.CONTACTSTATUS.REQACC?!0:!1}function ei(a){var b=dX(a);return b&&b.STATUS==bA.CONTACTSTATUS.NOCHAT?!0:!1}function ej(){dx(null),dy(null)}function ek(a){return a&&a.charAt(0)==="$"}function el(){var a={};for(var b in du())du(b).ISBOT||(a[b]=du(b));return a}function eo(a){if(en[a])return en[a]}function ep(a,b){this.getInfo(a)===undefined&&(en[a]=b,dE(a,b.dname),bS(a,b.dname))}function er(a){var b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=Math.floor(a%60);c=c<10?"0"+c:c,d=d<10?"0"+d:d;var e=c+":"+d;return b>0&&(e=b+":"+c+":"+d),e}function es(a,b,c,d){var e,f,g,h,i=0;d=d||{};var j=function(){i=d.leading===!1?0:(new Date).getTime(),e=null,h=a.apply(f,g),e||(f=g=null)},k=function(){var k=(new Date).getTime();!i&&d.leading===!1&&(i=k);var l=c-(k-i);return f=b||this,g=arguments,l<=0||l>c?(e&&(clearTimeout(e),e=null),i=k,h=a.apply(f,g),e||(f=g=null)):!e&&d.trailing!==!1&&(e=setTimeout(j,l)),h};return k.cancel=function(){clearTimeout(e),i=0,e=f=g=null},k}function et(a,b,c){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,c);else if(a.createTextRange){var d=a.createTextRange();d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",b),d.select()}}function eu(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return JSON.stringify(a)===JSON.stringify({})}function ev(a,b,c){var d=0,e=0;b-=1;for(var f=0;f<a.length;f++)if(a.charAt(f)==":"){d++;if(d==b){e=f;break}}var g=a.substring(0,e),h=g.split(":"),i=a.substring(e+1);return c?h.push(JSON.parse(i)):h.push(i),h}function ew(a){return a&&a.trim().length>0?!1:!0}function ex(){return J.get("CHATCFPARAMNAME")+"="+bb(J.get("CHATCFCOOKIENAME"))}function ey(a){var b={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"};return(""+a).replace(/[&><"']/g,function(a){return b[a]})}function ez(a){if(a)return a.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&#x2F;/g,"/").replace(/&#x27;/g,"'")}function eA(a){return!isNaN(a)}function eB(a,b,c){var d=b;if(a==null||a==undefined)d=b;return eA(a)||(d=b),!b&&J.get("zuid")==a&&(d=K("chat.you")),du(a)!=undefined?d=du(a).DNAME||du(a).EMAILID:bF(a)?d=bF(a).DNAME:c_(a)&&(d=c_(a).DNAME),c?ey(d):d}function eC(a,b){var c="1",d="4",e="",f=a.meta&&a.meta.mentions?!0:!1;if(f){var g=a.meta;a=a.msg;var h=function(f){var h=g.mentions[f],i="";if(h.type===3)i=new RegExp("{#"+h.id+"}"),a=a.replace(i,h.name);else if(h.type===2)i=new RegExp("{@G"+h.id+"}"),a=a.replace(i,h.name);else if(h.type===1||h.type===4){var j=h.action?"{\\"+h.action+"@"+h.id+"}":"{@"+h.id+"}",k=J.get("zuid")==h.id?ey(ez(J.get("dname"))):eB(h.id,h.name,!0);i=new RegExp(j,"g"),a=a.replace(i,function(){return b?"@"+k:(e=h.type==c||h.type==d?'data-zcprofileid="'+h.id+'"':"",'<span class="wms-atmtnlink" '+e+">"+"@"+k+"</span>")})}else if(h.type===$WC.CMsgUtil.SpecialMention.participants||h.type===$WC.CMsgUtil.SpecialMention.available||h.type===$WC.CMsgUtil.OldMention)i=new RegExp("{@"+h.id+"}"),a=a.replace(i,function(){return b?"@"+h.name:"<span data-mentiontype="+h.type+' class="wms-atmtnlink">@'+h.name+"</span>"})};for(var i in g.mentions)h(i)}var j=function(f,g){f==="silentmention"?a=J.get("getSilentUserMention")(a):a=be.replace(f,a,function(a,f,h){var i=h.split(":")[1],j=h.split(":")[3],k=h.split(":")[2],l=J.get("zuid")==i?ey(ez(J.get("dname"))):eB(i,j,!0);return b?g+l:(e=k==c||k==d?'data-zcprofileid="'+i+'"':"",'<span class="wms-atmtnlink" '+e+">"+g+l+"</span>")})};return j("atmention_for_transcript","@"),j("addmember_for_transcript","+"),j("silentmention"),a}function eD(a){if(a)return"&nocache="+(new Date).getTime();var b="";return J.get("WMSCFPARAMNAME")!=undefined&&(b="&"+J.get("WMSCFPARAMNAME")+"="+bb(J.get("_WMSCFCOOKIENAME"))),b+="&nocache="+(new Date).getTime(),b}function eE(a,b){var c=a.indexOf(b);c!==-1&&a.splice(c,1)}function eF(a,b,c){var d=c?function(b){return c(b[a])}:function(b){return b[a]};return b=b?-1:1,function(a,c){return a=d(a),c=d(c),b*((a>c)-(c>a))}}function eG(){var a=Array.prototype.slice.call(arguments);return function(b,c){for(var d=0;d<a.length;d++){var e=a[d](b,c);if(e!=0)return e}return 0}}function eH(a){if(typeof a=="object"){if(Object&&Object.keys)return Object.keys(a).length;var b=0;for(var c in a)b++;return b}}function eJ(a,b){return b?eK(!0,{},a):eK({},a)}function eK(){function l(a){return typeof a=="function"&&a.constructor===Function}function m(a){return a instanceof Array}function n(a){return typeof a=="object"&&a.constructor==Object}var a=arguments,b,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;typeof h=="boolean"&&(k=h,h=arguments[i]||{},i++),typeof h!="object"&&!l(h)&&(h={}),i===j&&(h=this,i--);for(;i<j;i++)if((f=a[i])!=null)for(e in f){b=h[e],d=f[e];if(h===d)continue;k&&d&&(n(d)||(c=m(d)))?(c?(c=!1,g=b&&m(b)?b:[]):g=b&&n(b)?b:{},h[e]=eK(k,g,d)):d!==undefined&&d!==null&&(h[e]=d)}return h}function eL(a,b,c){var d=b.getBoundingClientRect().top,e=b.getBoundingClientRect().bottom,f=a.getBoundingClientRect().top,g=a.getBoundingClientRect().bottom;return d===0&&e===0||f===0&&g===0?!1:c?g>=d&&f<=e:f>=d&&g<=e}function eM(a){return a===undefined||a===null||a===""?!0:!1}function eN(a){return a==J.get("zuid")?!0:!1}function eO(a){return a?a.target:window.event.srcElement}function eQ(a,b,c,d,e){var f;b==="height"&&(c<d?f=function(){c+=20,c<=d?(a.style[b]=c+"px",window.requestAnimationFrame(f)):(a.style[b]=d+"px",typeof e=="function"&&e())}:f=function(){c-=20,c>=d?(a.style[b]=c+"px",window.requestAnimationFrame(f)):(a.style[b]=d+"px",typeof e=="function"&&e())}),f()}function eR(a){a.style.display=="block"?a.style.display="none":a.style.display="block"}function eS(a){return(_WMSCONFIG&WMSSessionConfig[a])===WMSSessionConfig[a]?!0:!1}function eT(a){return typeof a=="string"?a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;").replace(/&amp;quot;/g,"&quot;").replace(/&amp;gt;/g,"&gt;").replace(/&amp;lt;/g,"&lt;").replace(/&amp;#x27;/g,"&#x27;").replace(/&amp;#x2F;/g,"&#x2F;").replace(/&amp;amp;/g,"&amp;"):a}function eU(){var a="Webkit Moz O ms".split(" "),b={noprefix:"animationend",Moz:"animationend",Webkit:"webkitAnimationEnd",O:"oAnimationEnd",ms:"MSAnimationEnd"};if(document.body.style.animationName!==undefined)return b.noprefix;for(var c=0;c<a.length;c++)if(document.body.style[a[c]+"AnimationName"]!==undefined)return b[a[c]]}function eV(a,b,c,d,e){var f=function(a){c.call(this,a,e)};for(var g=0;g<b.length;g++)fa(a,b[g],f,d)}function eW(a,b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(a,b);for(var c=0;c<a.length;c++)if(b===a[c])return c;return-1}function eX(a,b,c){var d,e,f,g,h=45,i=21,j=a.getBoundingClientRect();f=window.innerWidth-(j.left+a.offsetWidth),g=window.innerHeight-b.offsetHeight-i,e=f>b.offsetWidth?j.left+a.offsetWidth:j.left-b.offsetWidth,e=c?e+parseInt(c):e,d=j.top+a.offsetHeight/2-b.offsetHeight/2,d=Math.min(g,d),d=Math.max(h,d),b.style.top=d+"px",b.style.left=e+"px"}function eY(a,b,c,d,e){var f=document.createElement(a);c&&(f.className=c),b&&(f.id=b),e&&(f.innerHTML=e);if(d)for(var g in d)f.setAttribute(g,d[g]);return f}function eZ(a){WebMessanger.orgid==="456089"&&typeof console!="undefined"&&console.warn&&console.warn(a)}function e$(a){var b=this.decodeHTMLEntities(a).split(/\s+/g),c=[];for(var d=0;d<b.length;d++){var e=b[d].trim();if(be.checkWithFlag("linkRegExp",e,"gi")){var f=$WC.Matcher.match("linkRegExp",e,"gi")[0];if(f!=e)continue;c.push(e)}}return c}function e_(a){return a.replace(/&#x2F;/g,"/").replace(/&#39;|&#x27;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}function fa(a,b,c,d,e){d=typeof d=="boolean"?d:!0;var f=function(a){c.call(this,a,e)};return a.addEventListener?a.addEventListener(b,f,d):a.attachEvent?a.attachEvent("on"+b,f):a["on"+b]=f,f}function fb(a,b){var c=b&&b.block!="end"?!0:!1;try{setTimeout(function(){a.scrollIntoView(b)},30)}catch(d){setTimeout(function(){a.scrollIntoView(c)},30)}}function fc(a){var b=a.split("_",3);if(b.length==3){var c=b[2],d=c.split("-",2);if(d.length==2)return d[1]=="C4"?bA.CHATTYPES.CHANNEL:d[1];if(d.length==1)return bA.CHATTYPES.CHANNEL}}function fd(a){return a&&fc(a)===bA.CHATTYPES.CHANNEL}function fe(a){var b=fc(a);return b===bA.CHATTYPES.DEFAULT_BOT||b===bA.CHATTYPES.CUSTOM_BOT}function ff(a){var b=fc(a);return b===bA.CHATTYPES.CUSTOM_BOT}function fg(a,b,c,d){var e,f=0;return function(){var g=arguments,h=b||this;d===!0?(Date.now()-f>c&&a.apply(h,g),f=Date.now()):(clearTimeout(e),e=setTimeout(function(){a.apply(h,g)},c))}}function fh(a){return Array.prototype.slice.call(a,0)}function fi(a){if(a)return a.parentNode.removeChild(a)}function fj(a,b){if(a.classList)a.classList.add(b);else{var c=a.className.split(" ");c.indexOf(b)===-1&&(a.className+=" "+b)}}function fk(a,b){if(a.classList)a.classList.remove(b);else{var c=new RegExp("(?:^|\\s)"+b+"(?!\\S)");a.className=a.className.replace(c,"")}}function fl(a,b,c){if(!a||typeof a.getAttribute!="function")return;return a.setAttribute(b,c)}function fm(a,b,c){function e(){if(this.existingnode&&this.existingnode.parentNode)if(!b||this.existingnode.getAttribute("data-imgid")===this.getAttribute("data-zcprofileid")){b?this.existingnode.parentNode.insertBefore(this,this.existingnode.parentNode.firstChild):this.existingnode.parentNode.appendChild(this);var a=this;setTimeout(function(){a.style.opacity="1",a.existingnode.removeAttribute("data-originalsrc"),b&&fi(a.existingnode)},20)}fo(this.existingnode.getAttribute("data-imgid")||this.existingnode.getAttribute("data-channelimgid"))}var d=a.querySelectorAll("div[data-originalsrc]");for(var f in d)if(d.hasOwnProperty(f))if(c||eL(d[f],a,!0)){var g=d[f],h=new Image;g.getAttribute("data-imgid")&&h.setAttribute("data-zcprofileid",g.getAttribute("data-imgid")),h.className="wms_userphoto_trans",h.existingnode=g,h.onload=e,h.src=g.getAttribute("data-originalsrc")}}function fo(a){fn[a]=!0}function fp(a){return fn[a]}function fq(a){return fg(function(){fm(a)},null,100)}function fr(a){return Object.prototype.toString.call(a)==="[object Array]"}function fs(a){if(!a)return;var b=document.getElementsByTagName("body")[0];return b.textContent?a.textContent:a.innerText}function ft(a,b){var c=a.closest(b);return c?c:!1}function fu(a,b){var c=[];if(b){var d=a.split(new RegExp("("+b+"+)","i"));for(var e=0;e<d.length;e++)c.push(d[e].toLowerCase().indexOf(b.toLowerCase())>-1?m("b",null,d[e]):d[e])}return c.length>0?c:a}function fv(a,b,c){c=c||a.parentNode;if(b){var d=c.scrollLeft,e=c.scrollLeft+c.offsetWidth,f=a.offsetLeft+a.offsetWidth;if(a.offsetLeft>=d&&f<e)return!0}else{var g=c.scrollTop,h=c.scrollTop+c.offsetHeight,i=a.offsetTop+a.offsetHeight;if(a.offsetTop>=g&&i<h)return!0}return!1}function fw(a,b,c,d){function e(a,b){var c=a.getBoundingClientRect(),d=b.getBoundingClientRect();if(c.y-d.y+c.height>d.height)return bA.KEYCODES.DOWN;if(c.y<d.y)return bA.KEYCODES.UP}d=d||a.parentNode,b=b||e(a,d);if(c)fv(a,!0,d)===!1&&(b===$WC.WmsConstants.KEYCODES.LEFT?d.scrollLeft=a.offsetLeft:b===$WC.WmsConstants.KEYCODES.RIGHT&&(d.scrollLeft=a.offsetLeft+a.offsetWidth-d.offsetWidth));else if(fv(a,null,d)===!1)if(b===bA.KEYCODES.UP)d.scrollTop=a.offsetTop;else if(b===bA.KEYCODES.DOWN||b===bA.KEYCODES.LEFT||b===bA.KEYCODES.RIGHT)d.scrollTop=a.offsetTop+a.offsetHeight-d.offsetHeight}function fx(a){return a=Math.round(a/1024),a<1024?a+" KB":Math.round(a/1024)+" MB"}function fy(a,b){if(a){var c=0;for(var d=0;d<a.length;d++)c+=a[d].size;return c>b?(alert(K("upload.maxsize.exceed")),!0):!1}}function fz(a){return a instanceof File}function fM(a){fL=a}function fN(a){return a.replace(/&#39;|&#x27;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}function fO(a){a=fN(""+a);var b={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"};return a.replace(/[&><"']/g,function(a){return b[a]})}function fP(a){return Object.prototype.toString.call(a)==="[object Array]"}function fQ(a){var b=a;if(fP(b)){var c=b[1];return c=fP(c)?c:[c],c=c.map(function(a){return fO(a)}),b[1]=c,fL.getRealValue.apply(fL,b)}return fL.getRealValue(b)}function fR(a,b,c){var d={};for(var e in b){var f=/^\$/.test(e);if(f){var g=fQ(b[e]);e=e.substring(1),d[e]=g}else d[e]=c==="InSecureHTML"?b[e]:fO(b[e])}var h=Object.keys(d).join("|"),i=new RegExp("{{("+h+")}}","g");return a.replace(i,function(a){return a=a.substring(2).slice(0,-2),d[a]})}function fW(a){var b=fT.videomodefwdicon+" "+fT.iconsmall,c=fT.duration_content,d=fT.controls_container,e=null,f=fT.iconsmall,g=fT.downloadicon+" "+fT.iconsmall,h=m(bW,{classname:fT.iconsmall,type:"icon",content:"ea15",title:K("videoplayer.theatremode"),onclick:a.toggleTheatreMode});if(a.theatremode||a.fullscreen)b=fT.iconmed,c=fT.duration_theatremode,g=fT.downloadicon+" "+fT.iconmed,d=fT.controls_container_theatremode,e=m(bW,{classname:fT.iconmed,type:"icon",title:K("mediacall.fullscreen"),content:"ea0e",onclick:a.toggleFullScreen}),h=null;a.theatremode&&(f=fT.iconmed);var i=m(bW,{classname:f,content:"ea10",type:"icon",title:K("videoplayer.miniplayer"),onclick:a.toggleMiniPlayer}),j=m(bW,{classname:b,type:"icon",title:K("chat.forward"),content:"ea0d",onclick:a.forwardAttachment});if(a.popout||a.fullscreen)i=null;if(a.fullscreen||a.config&&a.config.hideforwardicon==1)j=null;return a.popout&&(b=fT.iconsmall),m("div",{"class":fT.controller_bgclass},m(fU,{duration:a.duration,current_time:a.current_time,updateCurrentTime:a.updateCurrentTime,bufferpercentage:a.bufferpercentage,theatremode:a.theatremode,popout:a.popout,fullscreen:a.fullscreen}),m("div",{"class":d},m("div",{"class":fT.leftpane},m(fV,{setVolume:a.setVolume,volume:a.volume,videoplayernode:a.videoplayernode,theatremode:a.theatremode,fullscreen:a.fullscreen}),m("div",{"class":c},er(Math.floor(a.current_time)),"/",er(a.duration))),m("div",{"class":fT.rightpane},m("a",{download:!0,target:"_blank",href:a.videosrc},m("span",{"class":g,title:K("chat.download")})),j,i,h,e)))}function gh(a){for(var b in ge)if(ge[b][a]){delete ge[b][a];break}}function gj(a){var b=this;for(var c in ge[b]){var d=ge[b][c];$WC.$CUtil.isScrolledIntoView(d.node,a.target,!0)||d.invokeToggleMiniPlayer(a)}}function gk(a,b){for(var c in ge)for(var d in ge[c])a!=ge[c][d]&&ge[c][d].pauseVideoPlayer(b);gf&&gf.state.videostate=="playing"&&gf.toggleVideoPlay(b)}function gl(a){gf=a}function gm(a){gg=a}function gn(a,b,c){function k(a){clearTimeout(d),d=setTimeout(k,4e3);if(c||a||m()||n()){var b=bb(h);if(b&&b.indexOf("_f")!==-1&&c!==!0)return;var e=i;c&&(e+="_f"),ba(h,e,1e4,j)}}function l(){var a=bb(h);return a===""?g:a===i||a===i+"_f"?e:f}function m(){return l()===e?!0:!1}function n(){return l()===g?!0:!1}function o(){clearTimeout(d),bc(h,j)}var d,e=1,f=2,g=3,h="com_"+a+"_owner",i=""+(new Date).getTime(),j=b&&document.location.hostname.split(".").splice(1).join(".");return c=c||!1,k(),window.addEventListener("focus",k),{isOwner:m,clearOwnerSync:o}}function gq(a){return a?go[a]:go}function gr(a){var b=JSON.parse(a).data,c=b&&b.chats;if(c&&c.length){var d=0;while(d<c.length){var e={};e.ADDINFO=c[d].addinfo,e.CHATID=c[d].chatid,e.LASTMSGINFO=c[d].lastmsginfo&&JSON.parse(c[d].lastmsginfo),e.PARTICIPANTS=c[d].recipants&&JSON.parse(c[d].recipants)||[],e.PARTICIPANTSCOUNT=c[d].pcount,e.LMTIME=c[d].lmtime,e.TITLE=c[d].title,go[c[d].chatid]=e,d++}}this.opts.callbackargs&&this.opts.callbackargs.params&&gp.push(this.opts.callbackargs.params);var f=this.opts.callbackargs&&this.opts.callbackargs.reqid,g=this.opts.callbackargs&&this.opts.callbackargs.topicname;g?eI.publish("/chatlist/"+g,{callbackargs:this.opts.callbackargs}):eI.publish("/chatlist/updateui",{reqid:f,callbackargs:this.opts.callbackargs})}function gs(){var a=this.opts.callbackargs&&this.opts.callbackargs.reqid;eI.publish("/chatlist/updateui",{reqid:a,stat:bA.REQSTATUS.FAILED})}function gt(a){return a?hK("TITLE",a,go):go}function gu(a){return gp.indexOf(gv(a))!==-1}function gv(a){var b="limit=10";return b+=a?"&title="+a:"",b}function gw(a,b){var c=a.searchtext,d=gv(c),e=a.topicname,f=a.silentload,g=a.chid;if(gp.indexOf(d)===-1){var h={"X-XHR-exception":"true","X-ZCSRF-TOKEN":ex()};bs("v1/chats",d,gr,gs,{reqid:b,params:d,topicname:e,chid:g,silentload:f,searchtext:c},null,h)}else e?eI.publish("/chatlist/"+e,{reqid:b,callbackargs:a}):eI.publish("/chatlist/updateui",{reqid:b})}function gA(a,b){gy[b]||(gy[b]=a)}function gB(a,b){gy[a]&&gy[a].onSearch(b)}function gE(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)===-1&&(c[d]=a[d]);return c}function gJ(){var a="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/search_empty.svg";return m("div",{"class":gC.error_info+" "+gC.hv_align},m("img",{"class":gC.error_img,src:a}),m("div",{"class":gC.infotxt},m("div",{"class":gC.infotext_1},K("search.noresult")),m("div",{"class":gC.infotext_2},K("search.again"))))}function gW(){return gV}function gX(a){gV=a}function gY(){gV++}function gZ(){var a=[],b={};return b.FEEDSID="wms_menu_feedsnotify",b.PARTICIPANTS=[],b.LMTIME="",b.TITLE=gV===1?K("chat.feed.you"):K("chat.feeds.you",[gV]),b.desc=K("view.click.here"),a.push(b),a}function g$(){return gU}function g_(a){gU=a}function ha(){var a=iN();return gT.filter(function(b){if(fd(b.CHATID)){if(!iH(b.CHATID)||iH(b.CHATID)&&cD(a[iH(b.CHATID).sc]))return b}else if(!fd(b.CHATID))if(fe(b.CHATID)&&dg(b.CHATID)||b.PARTICIPANTSCOUNT>2||b.PARTICIPANTSCOUNT=="2"&&cD("direct_message"))return b})}function hb(){gS===null&&ht()}function hc(a){return a?gR.filter(function(b){if(b.CHATID===a)return!0})[0]:gR}function hd(a,b){var c=hc(a);c&&(c.LASTSEEN=b||0)}function he(a){var b=hc(a);return b&&b.LASTSEEN?b.LASTSEEN:0}function hf(a,b){var c=hc(a);if(!c)return;c.TITLE=b,eI.publish("/recentchats/updateui",bA.REQSTATUS.SUCCESS)}function hg(a){gU=(new Date).getTime();var b=a.data.chats;for(var c=0;c<b.length;c++){var d=b[c],e=hh(d.chatid);if(!e){var f={};f.ADDINFO=d.addinfo,f.CHATID=d.chatid,f.LASTMSGINFO=d.lastmsginfo&&JSON.parse(d.lastmsginfo),f.PARTICIPANTS=d.recipants&&JSON.parse(d.recipants),f.PARTICIPANTSCOUNT=d.pcount,f.TITLE=d.title,f.LMSGTIME=d.lastmsginfo&&JSON.parse(d.lastmsginfo).time,f.CUSTOMGROUP=d.customgroup,gT.push(f);if(typeof WindowHandler!="undefined"){var g=WindowHandler.getWinObjById(d.chatid);g&&g.updatePinnedInfo(!0)}}}iq()}function hh(a){return gT.find(function(b){if(b.CHATID===a)return!0})}function hi(a){function d(b){b.LASTMSGINFO||(b.LASTMSGINFO={}),b.LASTMSGINFO.addinfo=a.addinfo||{},b.LASTMSGINFO.sender=a.sender,b.LASTMSGINFO.dname=eB(a.sender,a.dname);if(fr(a.msg.msg)){var c=a.msg.msg;typeof c[c.length-1].msg=="object"&&(b.LASTMSGINFO.msg=c[c.length-1].msg.msg,b.LASTMSGINFO.mtype=c[c.length-1].msg.mtype,b.LASTMSGINFO.meta=c[c.length-1].msg.meta)}else a.msg.msg?(b.LASTMSGINFO.msg=a.msg.msg,b.LASTMSGINFO.meta=a.msg.meta):(b.LASTMSGINFO.msg=a.msg,b.LASTMSGINFO.meta=a.meta);b.LMTIME&&(b.LMTIME=a.lmtime),a.mtype==="63"&&(b.LASTMSGINFO.mtype=a.mtype,b.LASTMSGINFO.info_visiblity=a.info_visiblity),a.module?b.LASTMSGINFO.__module=a.module:delete b.LASTMSGINFO.__module}var b=hh(a.chid);b&&(b.LMSGTIME=a.lmtime,d(b));var c=hc(a.chid);c&&d(c),typeof WmsMainUI!="undefined"&&eI.publish("/recentchats/updateui",bA.REQSTATUS.SUCCESS)}function hj(a){var b=hc(a);if(!b)return;gR.splice(gR.indexOf(b),1),eI.publish("/recentchats/updateui",bA.REQSTATUS.SUCCESS)}function hk(a){var b=iN();gR.sort(eF("LMTIME",!0));var c=gR.filter(function(a){if(fd(a.CHATID)){if(!iH(a.CHATID)||iH(a.CHATID)&&cD(b[iH(a.CHATID).sc]))return a}else if(!fd(a.CHATID))if(fe(a.CHATID)&&dg(a.CHATID)||a.PARTICIPANTSCOUNT>2||a.PARTICIPANTSCOUNT=="2"&&cD("direct_message"))return a});return a?c.slice(0,a):c.slice(0)}function hl(a){var b=a.map(function(a){return a.CHATID});return b}function hm(a,b){a=a||4;var c="limit="+a;b&&(c="totime="+b+"&limit="+a);var d={"X-XHR-exception":"true","X-ZCSRF-TOKEN":ex()};bs("v1/chats",c,function(b){gS=(new Date).getTime();var c=JSON.parse(b).data,d=c&&c.chats,e=bA.REQSTATUS.NORESULTS;d&&d.length?(d.forEach(function(a){var b={};b.ADDINFO=a.addinfo,b.CHATID=a.chatid,b.LASTMSGINFO=a.lastmsginfo&&JSON.parse(a.lastmsginfo),b.PARTICIPANTS=a.recipants&&JSON.parse(a.recipants)||[],b.PARTICIPANTSCOUNT=a.pcount,b.LMTIME=a.lmtime,b.TITLE=a.title,b.CUSTOMGROUP=a.customgroup,fe(b.CHATID)&&(b.PHOTO=de(null,null,b.CHATID));var c=hc(b.CHATID);c?gR[gR.indexOf(c)]=b:gR.push(b)}.bind(this)),e=bA.REQSTATUS.SUCCESS):e=bA.REQSTATUS.INITIALSTATE,eI.publish("/recentchats/updateui",e)}.bind(this),function(){eI.publish("/recentchats/updateui",bA.REQSTATUS.FAILED)},null,null,d)}function hn(a){for(var b in a){var c={};c={},c.CHATID=b,c.LASTMSGINFO=JSON.parse(a[b].lmhash),c.PARTICIPANTS=[];var d=JSON.parse(a[b].recipantssummary);for(var e in d)c.PARTICIPANTS.push({zuid:e,dname:d[e]});c.PARTICIPANTSCOUNT=a[b].pcount,c.TITLE=a[b].title,c.ADDINFO=a[b].addinfo,c.LMTIME=+a[b].lmtime,c.CUSTOMGROUP=a[b].customgroup,fe(c.CHATID)&&(c.PHOTO=de(null,null,c.CHATID));var f=hc(b),g=hh(b);g&&(gT[gT.indexOf(g)]=c),f?(c.LASTSEEN=f.LASTSEEN,gR[gR.indexOf(f)]=c):gR.push(c)}typeof WmsMainUI!="undefined"&&eI.publish("/recentchats/updateui",bA.REQSTATUS.SUCCESS)}function ho(a,b){if(b){var c=hc(a),d=hh(a);if(d)return;if(c)c=JSON.stringify(c),c=JSON.parse(c),c.LMTIME="",c.LMSGTIME=c.LASTMSGINFO.time,gT.push(c);else if(a.indexOf("CT")!=-1&&!fe(a)){var e=iH(a);if(e){var f={};f.ADDINFO=e.addinfo,f.CHATID=a,f.LASTMSGINFO=e.lminfo&&JSON.parse(e.lminfo),f.PARTICIPANTS=[],f.TITLE=e.cn,f.LMSGTIME=e.lminfo&&JSON.parse(e.lminfo).time,gT.push(f),iq()}}else typeof WebMessanger!="undefined"&&WebMessanger.getPinnedChats()}else{var g=hh(a);g&&gT.splice(gT.indexOf(g),1)}}function hp(a){for(var b in a){var c=hq(a[b],b),d=hr(c.CHATID,gR);d?gR[gR.indexOf(d)]=c:gR.push(c),typeof WmsMainUI!="undefined"&&(a[b].mute?WmsMainUI.setMuteStatus(b,!0):WmsMainUI.setMuteStatus(b,!1),WmsMainUI.setUnreadCount(b,c.UNREADMSGS)),hd(c.CHATID,a[b].unreadtime),typeof WindowHandler!="undefined"&&WindowHandler.checkAndHighlightChat(c.CHATID)}typeof WmsMainUI!="undefined"&&WmsMainUI.updateUnreadChatsCount()}function hq(a,b){var c={};c.ADDINFO=a.addinfo,c.CHATID=b||a.chid,c.LASTMSGINFO=a.lastmsginfo&&JSON.parse(a.lastmsginfo)||a.lminfo&&JSON.parse(a.lminfo)||a.lmhash&&JSON.parse(a.lmhash);var d=a.recipantssummary&&JSON.parse(a.recipantssummary),e=[];for(var f in d)e.push({dname:d[f],zuid:f});return c.PARTICIPANTS=e||hr(c.CHATID,gR).PARTICIPANTS,c.PARTICIPANTSCOUNT=a.pcount||a.pc,c.LMTIME=a.lmtime||a.unreadtime,c.LASTSEEN=a.unreadtime,c.TITLE=a.title||a.cn,c.UNREADMSGS=a.unreadmsgs?a.unreadmsgs:"1",fe(c.CHATID)&&(c.PHOTO=de(null,null,c.CHATID)),c}function hr(a,b){for(var c in b)if(b[c].CHATID===a)return b[c];return!1}function hs(a){return hK("TITLE",a,hk())}function ht(){var a=(new Date).getTime();gR.length&&(a=gR[gR.length-1].LMTIME),hm(15,a)}function hu(){var a=gR[0]&&gR[0].LMTIME;if(a)return+a}function hv(a){return hk().filter(function(b){if(typeof WmsMainUI!="undefined"&&WmsMainUI.getUnreadCount(b.CHATID))return a==="muted"?WmsMainUI.getMuteStatus(b.CHATID)?!0:!1:a==="unmuted"?WmsMainUI.getMuteStatus(b.CHATID)===!1?!0:!1:!0})}function hx(a,b,c,d,e,f,g,h){var i=this.getRefinedParticipantsList(a,c,h),j=eG(eF("statuscode"),eF("title",!1,function(a){return a.toLowerCase()}));$WC.ListFactory.create(a,i,b,K("users.name.search"),d,j,e,f,g,null,!1,null,!0,!0)}function hy(a,b,c){var d={};for(var e=0;e<b.length;e++){var f=b[e],g={};g.title=eB(f.zuid,f.dname),g.desc=f.email,g.id=f.zuid,g.statuscode=this.getTempParticipantStatus(dS(f.zuid)),g.imgsrc=WmsUIImpl&&WmsUIImpl.getUserPhoto(f.zuid)||J.get("photoserver")+"/file?ID="+f.zuid+"&t=user&height=30&width=30",g.classname="wms_badge_imgwrapper",f.zuid!==J.get("zuid")&&(g.options=c(a)),!f.email&&f.zoid!==J.get("orgid")&&(g.desc=$WC.I18N("chat.participant.nonorg"));var h=du(f.zuid);h!=undefined&&(g.dname=du(f.zuid).DNAME,g.classname="wms_badge_imgwrapper wms_badge_statusicon_"+dT(f.zuid)),d[f.zuid]=g}return d}function hz(a){return a===!1?bA.TEMPUSERSTATUS.ORGCONTACT:+a===dk.ONLINE||+a===dk.BUSY||+a===dk.IDLE?a:+a===dk.OFFLINE?bA.TEMPUSERSTATUS.OFFLINE:bA.TEMPUSERSTATUS.ORGCONTACT}function hA(a,b,c){$WC.ListFactory.updateList(a,this.getRefinedParticipantsList(a,b,c),!0,!0)}function hB(a,b){var c=a&&a.sc,d;return c==="1"?d="orgchannel":c==="2"?d="orggroup":c==="3"?d="privatechannel":c==="4"&&(d="shared-channel"),a?a.photoid?(b.imgsrc="/_chat/channel/"+a.photoid+"/photo.do",b.classname="wms_badge_imgwrapper wms_channelimg_badge wms-"+d+"-small"):(b.empty_img=!0,b.classname="wms_badge_imgwrapper wms_channelimg wms-"+d+"-small",b.fonticon_class="wms_badge_imgwrapper wms_channelimg wms-"+d+"-small"):(b.badge_img=!0,b.badge_letter="#"),b}function hC(a){var b=fd(a.CHATID),c={};if(a._filtertype===bA.HYBRIDSEARCH.CHANNEL)c.title=a.dn,c.desc=a.cd,c.id=a.chid,hB(a,c),c.filtertype=a._filtertype;else if(a._filtertype===bA.HYBRIDSEARCH.CHAT){var d=iH(a.CHATID);if(b&&d)hB(d,c),c.title=d.dn,c.htmldesc=hO(a),c.id=d.chid;else{c.title=a.TITLE,c.htmldesc=hO(a),c.id=a.CHATID;if(a.CHATID&&fe(a.CHATID)){var e=dg(a.CHATID);c.imgsrc=de(e)}else hM(a,!0)?c.imgsrc=hM(a,!0):(c.badge_img=!0,c.badge_letter=hL(a.TITLE));c.classname="wms_badge_imgwrapper wms_badge_statusicon_"+dT(hM(a))}c.filtertype=a._filtertype}else if(a._filtertype===bA.HYBRIDSEARCH.CONTACT||a._filtertype===bA.HYBRIDSEARCH.BOT||a._filtertype===bA.HYBRIDSEARCH.ORGCONTACT){c.title=eB(a.USERID,a.DNAME),c.desc=a.EMAILID,c.id=a.USERID,a._filtertype===bA.HYBRIDSEARCH.CONTACT||a._filtertype===bA.HYBRIDSEARCH.ORGCONTACT?c.imgsrc=WmsUIImpl.getUserPhoto(a.USERID)||_WMSPHOTOSERVER+"/file?ID="+a.USERID+"&t=user&height=30&width=30":c.imgsrc=de(a.USERID),c.classname="wms_badge_imgwrapper";var f=du(a.USERID);f!=undefined&&(c.classname="wms_badge_imgwrapper wms_badge_statusicon_"+dT(a.USERID)),c.filtertype=a._filtertype}else{c.title=a.TITLE,c.htmldesc=hO(a),c.id=a.CHATID;if(b){var g=iH(a.CHATID);hB(g,c),c.title=g?g.dn:a.TITLE,c.filtertype=a._filtertype}else{if(a.CHATID&&fe(a.CHATID)){var h=dg(a.CHATID);c.imgsrc=de(h)}else hM(a,!0)?c.imgsrc=hM(a,!0):(c.badge_img=!0,c.badge_letter=hL(a.TITLE));c.classname="wms_badge_imgwrapper wms_badge_statusicon_"+dT(hM(a))}}return c}function hD(a){var b="",c="",d="",e=fd(a);if(e){var f=iH(a);return hB(f,{badge_letter:d})}if(fe(a)){var g=dg(a);b=de(g)}else if(du(a)||bF(a))b=ef(a);else if(hc(a)||gq(a)){var h=hc(a)||gq(a);h.PARTICIPANTS&&h.PARTICIPANTS.length===2?b=hM(h,!0):d=hL(h.TITLE)}return{imgsrc:b,classname:c,badge_letter:d}}function hE(a,b,c,d,e,f,g){function h(h){var i={},j=0,k=hc();k.length<10&&(k=k.concat(hK("DNAME","",el(),10,"","EMAILID"))),k.forEach(function(a){var b=hC(a);b.counter=j++,i[a.CHATID||a.USERID]=b});var l=new gQ,m=d[0].onclick;d[0]={text:d[0].text||K("message.forward.send"),buttonstyle:"alignend",onclick:function(a){m(a),l.unmountComponent()}},l.mountComponent(a,i,b,c,null,null,null,!0,!1,d,!0,hD,!1,!0,null,null,null,null,l.unmountComponent,!0,e,h,f,g)}h(),hc().length||eI.subscribe("/recentchats/updatechatslistui",function(){document.getElementById("wms_listviewdialog")&&h(!0)})}function hG(a,b){var c=hI(a,b),d="";return c&&(d='<div class="wms-img-badge '+c+'"></div>'),d}function hH(a,b){var c='<div class="wms-img-cont">';return b?c+='<img class="wms-hysearch-result-img" src="'+b+'">':c+='<img class="wms-hysearch-result-img" src="'+ef(a)+'">',c+=hG(a,!1)+"</div>",c}function hI(a,b){var c=dS(a),d="";return c!==!1&&(c=+c,c===dk.ONLINE?d=b?"wms-status-online":"wms-pos-online":c===dk.BUSY?d=b?"wms-status-busy":"wms-pos-busy":c===dk.IDLE?d=b?"wms-status-idle":"wms-pos-idle":c===dk.AWAY?d=b?"wms-status-away":"wms-pos-away":c===dk.OFFLINE&&(d=b?"wms-status-offline":"wms-pos-offline"),d&&parseInt(dR(a),10)===dk.MOB_LOGIN?d+="-mobile":c_(a)&&(d="wms-pos-bot")),d}function hK(a,b,c,d,e,f,g){function m(a){var b=l.filter(a);return g=g||"UC",g==="UC"||g==="lmtime"?b.sort(eF(g,!0,Number)):b.sort(eF(g,!1,function(a){return a.toLowerCase()})),b.forEach(function(a){l.splice(l.indexOf(a),1)}),b}function v(a,b){return a.map(function(a){a._filterweight=b})}b=b.toLowerCase();var h=[];if(fr(c))h=c;else for(var i in c)h.push(c[i]);if(e){var j=function(a){var b=e[a];h=h.filter(function(c){var d;return c[a]?d=c[a]:d=hN(c),b.indexOf(d)==-1?!0:!1})};for(var k in e)j(k)}var l=h.slice(0),n=m(function(c){var d=c[a];d&&d.startsWith("#")&&(d=d.substring(1));if(d&&d.toLowerCase().startsWith(b))return!0}),o=m(function(a){if(a[f]&&a[f].toLowerCase()===b)return!0}),p=m(function(a){if(a[f]&&a[f].toLowerCase().startsWith(b))return!0}),q=m(function(c){if(c[a]&&c[a].toLowerCase().indexOf(" "+b)!==-1)return!0}),r=m(function(a){if(a[f]&&a[f].toLowerCase().indexOf(" "+b)!==-1)return!0}),s=m(function(c){if(c[a]&&c[a].toLowerCase()===b)return!0}),t=m(function(c){var d=/[-~!@%&[\]/{}<>()*+?.,^$|:;'"#\s]/g,e=c[a];if(e){e=e.toLowerCase();var f=b.toLowerCase().split(d),g=f.join(".*");if(e.search(new RegExp(g))!==-1)return!0}}),u=m(function(a){var c=/[-~!@%&[\]/{}<>()*+?.,^$|:;'"#\s]/g,d=a[f];if(d){d=d.toLowerCase();var e=b.toLowerCase().split(c),g=e.join(".*");if(d.search(new RegExp(g))!==-1)return!0}});v(n,1),v(o,2),v(q,3),v(s,4),v(t,5),v(p,6),v(r,7),v(u,8);var w=n.concat(o,q,s,t,p,r,u);return d?w.slice(0,d):w.slice(0)}function hL(a){a.startsWith("#")&&(a=a.slice(1));var b=a.split(" "),c="";return b&&(b.length>1?c=b[0].charAt(0)+b[1].charAt(0):c=a.charAt(0)),ey(c.toUpperCase())}function hM(a,b){var c="",d=[];if(a.PARTICIPANTS)for(var e=0;e<a.PARTICIPANTS.length;e++)a.PARTICIPANTS[e].zuid!==J.get("zuid")&&d.push(a.PARTICIPANTS[e].zuid);if(d.length===1)return c=a.PHOTO?a.PHOTO:ef(d[0]),b?c:d[0]}function hN(a){var b;return a.PARTICIPANTS&&a.PARTICIPANTS.length==2?b=a.PARTICIPANTS[0].zuid==J.get("zuid")?a.PARTICIPANTS[1].zuid:a.PARTICIPANTS[0].zuid:fe(a.CHATID)&&(b=dg(a.CHATID)),b||""}function hO(a){if(a.LASTMSGINFO&&a.LASTMSGINFO.msg){var b="";if(a.LASTMSGINFO.__module){var c=eN(a.LASTMSGINFO.sender);return a.LASTMSGINFO.__module==="att"?b=c?K("chat.file.shared.you"):K("chat.file.shared",eB(a.LASTMSGINFO.sender,a.LASTMSGINFO.dname,!0)):a.LASTMSGINFO.__module==="contact"?b=c?K("chat.contact.shared.you"):K("chat.contact.shared",eB(a.LASTMSGINFO.sender,a.LASTMSGINFO.dname,!0)):a.LASTMSGINFO.__module==="location"?b=c?K("chat.location.shared.you"):K("chat.location.shared",eB(a.LASTMSGINFO.sender,a.LASTMSGINFO.dname,!0)):a.LASTMSGINFO.__module==="event"&&(b=c?K("chat.event.shared.you"):K("chat.event.shared",eB(a.LASTMSGINFO.sender,a.LASTMSGINFO.dname,!0))),b}if(typeof a.LASTMSGINFO.msg=="string"||typeof a.LASTMSGINFO.msg=="object"&&a.LASTMSGINFO.msg.isedited)if(a.LASTMSGINFO.msg.indexOf("<img")!==-1)b=K("chat.img");else if(a.LASTMSGINFO.msg.indexOf("<hr>")!==-1)b=a.LASTMSGINFO.msg.replace(/<hr>/g,"---");else{var d=a.LASTMSGINFO.msg.lastIndexOf("<br>"),e=a.LASTMSGINFO.msg.lastIndexOf("\n");b=a.LASTMSGINFO.msg.substring(d!==-1?d+4:e!==-1?e+1:0),b=ey(ez(b)),b=b_(b);var f=eJ(a.LASTMSGINFO,!0);f.msg=b,b=f.meta&&f.meta.mentions?eC(f,!0):eC(b),b=cm(b),b=Smiley.replace(b,!0)}else{if(typeof a.LASTMSGINFO.msg=="object"&&(a.LASTMSGINFO.mtype==="16"||a.LASTMSGINFO.mtype==="65"))return jo(a.LASTMSGINFO.msg);if(a.LASTMSGINFO.isdeleted)return a.LASTMSGINFO.msg.info_visiblity==1?'<span class="wms-delmsg">'+K("chat.info.deletemsg")+"</span>":""}return a.LASTMSGINFO.addinfo&&a.LASTMSGINFO.addinfo.sender?'<span class="wmsgrey">'+ey(ez(a.LASTMSGINFO.addinfo.sender.name))+": </span>"+b:a.PARTICIPANTSCOUNT==="2"&&a.LASTMSGINFO.sender!==J.get("zuid")?b:a.LASTMSGINFO.sender===J.get("zuid")?'<span class="wmsgrey">'+K("chat.you")+": </span>"+b:'<span class="wmsgrey">'+eB(a.LASTMSGINFO.sender,a.LASTMSGINFO.dname,!0)+": </span>"+b}return a.LASTMSGINFO&&a.LASTMSGINFO.mtype==="63"?a.LASTMSGINFO.info_visiblity==1?'<span class="wms-delmsg">'+K("chat.info.deletemsg")+"</span>":"":a.desc?a.desc:""}function hP(a,b,c,d){function z(a,b){if(a._filtertype===b._filtertype){if(a._filtertype===bA.HYBRIDSEARCH.CONTACT&&b._filtertype===bA.HYBRIDSEARCH.CONTACT)return+b.UC- +a.UC;if(a._filtertype===bA.HYBRIDSEARCH.CHAT&&b._filtertype===bA.HYBRIDSEARCH.CHAT)return+b.LMTIME- +a.LMTIME;var c=a[y[a._filtertype]].toLowerCase(),d=b[y[b._filtertype]].toLowerCase();return c<d?-1:c>d?1:0}return x.indexOf(a._filtertype)-x.indexOf(b._filtertype)}var e=b;c=typeof c!==undefined?c:!0;if(!e){e=[];var f=[],g=hQ(a),h=g.map(function(a){var b=hN(a);return b&&f.push(b),a.CHATID});h={CHATID:h};var i=hR(a,c,h),j=i.map(function(a){var b=hN(a);return b&&f.push(b),a.CHATID});f={USERID:f},d&&d.indexOf(bA.HYBRIDSEARCH.CHAT)===-1&&(f={});var k=hU(a,!1,f,d),l=k.map(function(a){return a.USERID});l={USERID:l.concat(f.USERID)},h={chid:h.CHATID.concat(j)};var m=hV(),n=document.getElementById("wms-fileupldwin")&&!0||d&&d.indexOf($WC.WmsConstants.HYBRIDSEARCH.JOINEDCHANNEL)!==-1?!0:!1;if(d){d.indexOf(bA.HYBRIDSEARCH.CONTACT)!==-1&&(e=e.concat(k)),d.indexOf(bA.HYBRIDSEARCH.ORGCONTACT)!==-1&&(e=k.concat(hW(a,!1,l),e)),d.indexOf($WC.WmsConstants.HYBRIDSEARCH.CHAT)!==-1&&(e=e.concat(g,i));if(d.indexOf($WC.WmsConstants.HYBRIDSEARCH.CHANNEL)!==-1||d.indexOf($WC.WmsConstants.HYBRIDSEARCH.JOINEDCHANNEL)!==-1){var o=d.indexOf($WC.WmsConstants.HYBRIDSEARCH.CHAT)!==-1?!0:!1;e=e.concat(hX(a,null,n,o?h:""))}d.indexOf($WC.WmsConstants.HYBRIDSEARCH.BOT)!==-1&&(e=e.concat(m))}else e=k.concat(hW(a,!1,l),m,g,i,hX(a,null,n,h))}var p=e.filter(function(a){return a._filterweight===1?!0:!1}),q=e.filter(function(a){return a._filterweight===2?!0:!1}),r=e.filter(function(a){return a._filterweight===3?!0:!1}),s=e.filter(function(a){return a._filterweight===4?!0:!1}),t=e.filter(function(a){return a._filterweight===5?!0:!1}),u=e.filter(function(a){return a._filterweight===6?!0:!1}),v=e.filter(function(a){return a._filterweight===7?!0:!1}),w=e.filter(function(a){return a._filterweight===8?!0:!1}),x=[bA.HYBRIDSEARCH.CHAT,bA.HYBRIDSEARCH.CONTACT,bA.HYBRIDSEARCH.BOT,bA.HYBRIDSEARCH.ORGCONTACT,bA.HYBRIDSEARCH.CHANNEL],y={};return y[bA.HYBRIDSEARCH.ORGCONTACT]="DNAME",y[bA.HYBRIDSEARCH.BOT]="DNAME",y[bA.HYBRIDSEARCH.GROUP]="NAME",y[bA.HYBRIDSEARCH.CHANNEL]="cn",p.sort(z).concat(q.sort(z),r.sort(z),s.sort(z),t.sort(z),u.sort(z),v.sort(z),w.sort(z))}function hQ(a){var b=hK("TITLE",a,hs(a),10);return b.sort(eF("LMTIME",!0)),b.map(function(a){return a._filtertype=bA.HYBRIDSEARCH.CHAT,a})}function hR(a,b,c){c=c||{};if(b){var d=fh(hS("searchresultdiv").querySelectorAll("[data-type='"+bA.HYBRIDSEARCH.CHAT+"'],[data-type='"+bA.HYBRIDSEARCH.CONTACT+"'],[data-type='"+bA.HYBRIDSEARCH.ORGCONTACT+"'],[data-type='"+bA.HYBRIDSEARCH.BOT+"']")),e=0,f="";if(d.length)for(e=0;e<d.length;e++)f=d[e].getAttribute("data-type")==bA.HYBRIDSEARCH.CHAT?"CHATID":"USERID",c[f]=c[f]||[],c[f].push(d[e].getAttribute("data-id"))}var g=hK("TITLE",a,gq(),10,c);return g.sort(eF("LMTIME",!0)),g.map(function(a){return a._filtertype=bA.HYBRIDSEARCH.CHAT,a})}function hS(a,b){var c={inputdiv:"wms_menu_search",resultcontainer:"wms_menu_contactlist",defaultresultdiv:"wms_menu_contactlist_def",searchresultdiv:"wms_menu_contactlist_searchres",inputcontainer:"wms_menu_search",loadingstatus:"wms-contact-loadstatus"},d={inputdiv:"wms_menu_search",resultcontainer:"wms_menu_grouplist",defaultresultdiv:"wms_menu_grouplist_def",searchresultdiv:"wms_menu_grouplist_searchres",inputcontainer:"wms_menu_search",loadingstatus:"wms-channel-loadstatus"},e={inputdiv:"wms_menu_search",resultcontainer:"wms_menu_chatlist",defaultresultdiv:"wms_menu_chatlist_def",searchresultdiv:"wms_menu_chatlist_searchres",recentchatdiv:"wms_menu_chatlist_def",recentchatsdiv:"wms_menu_chatlist_recentchats",inputcontainer:"wms_menu_search",loadingstatus:"wms-chat-loadstatus",recentchatswelcomemsg:"wms_welcome_recentchatsmsg"},f={mainUI:"wms-hysearch",inputcontainer:"wms-hysearch-inpcontainer",inputdiv:"wms-hysearch-actualinp",defaultresultdiv:"wms-hysearch-defrescont",freqcontactsdiv:"wms-hysearch-fcontacts",infomsgdiv:"wms-hysearch-infomsg",loadingstatus:"wms-hysearch-loadstatus",recentchatsdiv:"wms-hysearch-rchats",resultcontainer:"wms-hysearch-rescont",searchresultdiv:"wms-hysearch-searchres",thirdcolumn:"wms-hysearch-thirdcol",thirdcolumnheading:"wms-hysearch-thirdcolheading",fakeinput:"wms-fakeinput"},g={searchresultdiv:"wms-filefrwrdautocomplete",inputcontainer:"wms-filefrwrdrecipant",inputdiv:"wms-filefrwrdrecipant",loadingstatus:"wms-filefwd-loadstatus"},h={inputdiv:"wms_menu_search",resultcontainer:"wms_menu_customcontactlist",defaultresultdiv:"wms_menu_customcontactlist_def",searchresultdiv:"wms_menu_customcontactlist_searchres",inputcontainer:"wms_menu_search",loadingstatus:"wms-customcontact-loadstatus"},i;return b=b||hT(),b===bA.HYBRIDSEARCH.modules.SMARTCHAT?i=f:b===bA.HYBRIDSEARCH.modules.CONTACTMENU?i=c:b===bA.HYBRIDSEARCH.modules.GROUPMENU?i=d:b===bA.HYBRIDSEARCH.modules.CHATMENU?i=e:b===bA.HYBRIDSEARCH.modules.CUSTOMCONTACTMENU?i=h:b===bA.HYBRIDSEARCH.modules.FILEFWD?i=g:i=f,document.getElementById(i[a])}function hT(){var a=document.getElementById("wms-hysearch"),b=document.getElementById("wms-filefrwrdautocomplete");if(a)return bA.HYBRIDSEARCH.modules.SMARTCHAT;if(b)return bA.HYBRIDSEARCH.modules.FILEFWD;var c=document.getElementById("wms_menu_listcontainer");if(c){var d=c.querySelector("[data-selected=true]");if(d){var e=d.getAttribute("data-menuname");if(e==="contact")return bA.HYBRIDSEARCH.modules.CONTACTMENU;if(e==="channel")return bA.HYBRIDSEARCH.modules.GROUPMENU;if(e==="chat")return bA.HYBRIDSEARCH.modules.CHATMENU;if(e==="customcontact")return bA.HYBRIDSEARCH.modules.CUSTOMCONTACTMENU}}}function hU(a,b,c,d){var e,f,g=[];c=c||{USERID:[]};var h=0;if(b){var i=ds();for(h=0;h<i.length;h++){c.USERID.push(i[h]);var j=du(i[h]);j&&g.push(j)}e=hK("DNAME","",du(),null,c,"EMAILID"),f=hK("DNAME","",c$(!0),null,c,"EMAILID")}else{var k=hS("inputcontainer")&&hS("inputcontainer").querySelectorAll("[data-type='user']");if(k&&k.length)for(h=0;h<k.length;h++)c.USERID.push(k[h].getAttribute("data-id"));e=hK("DNAME",a,du(),10,c,"EMAILID"),f=hK("DNAME",a,c$(!0),10,c,"EMAILID")}e=g.concat(e);if(!d||d.indexOf(bA.HYBRIDSEARCH.BOT)!==-1)e=e.concat(f);return e.map(function(a){return a.ISBOT?a._filtertype=bA.HYBRIDSEARCH.BOT:a._filtertype=bA.HYBRIDSEARCH.CONTACT,a})}function hV(a,b){return[]}function hW(a,b,c,d){if(!a&&!d)return[];c=c||{USERID:[]};if(b){var e=fh(hS("inputcontainer").querySelectorAll("[data-type='user']"));e=e.concat(fh(hS("searchresultdiv").querySelectorAll("[data-type='"+bA.HYBRIDSEARCH.CONTACT+"'],[data-type='"+bA.HYBRIDSEARCH.ORGCONTACT+"'],[data-userid]")));var f=0;if(e.length)for(f=0;f<e.length;f++)e[f].getAttribute("data-userid")?c.USERID.push(e[f].getAttribute("data-userid")):c.USERID.push(e[f].getAttribute("data-id"))}var g=hK("DNAME",a,bF(),10,c,"EMAILID");return g.map(function(a){return a._filtertype=bA.HYBRIDSEARCH.ORGCONTACT,a})}function hX(a,b,c,d){d=d||{chid:[]};var e=[],f=c?null:10,g=hZ(),h;g&&(g.startsWith("@")?h="@":g.startsWith("#")&&(h="#"),g.indexOf("@")>-1&&g.indexOf("#")>-1&&(h="@#"));if(b){var i=fh(hS("searchresultdiv").querySelectorAll("[data-type='"+bA.HYBRIDSEARCH.CHANNEL+"'],[data-type='"+bA.HYBRIDSEARCH.CHAT+"']")),j=0;if(i.length)for(j=0;j<i.length;j++)d.chid.push(i[j].getAttribute("data-id"))}if(c)e=i$(a,!0);else if(h==="@")e=i_(a);else if(h==="#")e=ja(a);else if(h==="@#"){var k,l,m=a.split(/@|#/);g.startsWith("@")?(k=m[0],l=m[1]):g.startsWith("#")&&(k=m[1],l=m[0]),e=jb(k,l),a=l!==undefined?l:""}else e=i$(a);var n=hK("cn",a,e,f,d,"_teamname","lmtime");return n.map(function(a){return a._filtertype=bA.HYBRIDSEARCH.CHANNEL,a})}function hZ(){var a=hS("inputdiv"),b=a&&(a.value&&a.value.trim()||a.textContent.trim());return b||""}function h_(){var a=hZ();return a=a&&(a.startsWith("@")||a.startsWith("#"))?a.slice(1):a,a}function ia(){var a=hZ(),b=hT(),c="";if(be.check("emailid",a,!0)&&(b===bA.HYBRIDSEARCH.modules.CONTACTMENU||b===bA.HYBRIDSEARCH.modules.SMARTCHAT)&&J.get("other_orguser_chat")!="disable")return fi(hS("searchresultdiv").querySelector('[data-operation="addcontact"]')),b===bA.HYBRIDSEARCH.modules.CONTACTMENU?c='<div class="wms_menu_item wms_menu_addcontact" data-operation="addcontact" data-dname="{{searchtext}}" data-type="3">'+ii("",bA.HYBRIDSEARCH.CONTACT)+'<div class="wms_menu_item_name wms-truncate-ellipsis" title="{{searchtext}}">{{searchtext}}</div><div class="wms_menu_item_msg wms-truncate-ellipsis">'+K("contact.invite")+'</div><span data-addcontact="true" class="wms_menu_addicon wms-valign-mid-block"></span></div>':c='<div class="wms_hysearch_invite" data-operation="addcontact" data-email="{{searchtext}}">'+ij("",a,K("contact.invite"),null,null,bA.HYBRIDSEARCH.ADDCONTACT,null,null,null,bA.HYBRIDSEARCH.modules.SMARTCHAT)+'<div class="wms_hysearch_addicon wms-valign-mid-block" data-addcontact="true" data-type="'+bA.HYBRIDSEARCH.ADDCONTACT+'"></div></div>',c=fR(c,{searchtext:a}),hS("searchresultdiv").insertAdjacentHTML("beforeend",c),!0}function ib(){hY("fetch",null,hS("loadingstatus").getAttribute("data-reqid"))}function ic(a){var b=a.getAttribute("data-type");b&&(id(),fl(a,"data-select",!0),fj(a,"wms-hysearch-result-select"))}function id(){var a=hS("resultcontainer"),b;hS("searchresultdiv")&&getComputedStyle(hS("searchresultdiv")).display==="block"?b=hS("searchresultdiv").getElementsByClassName("wms-hysearch-result-select")[0]:b=a&&a.getElementsByClassName("wms-hysearch-result-select")[0],b&&(fk(b,"wms-hysearch-result-select"),b.removeAttribute("data-select"))}function ig(a,b,c,d,e){var f={chat:{},search:{}};f.search[bA.REQSTATUS.NORESULTS]=K("search.noresult"),f.search[bA.REQSTATUS.FAILED]=K("search.failed"),f.chat[bA.REQSTATUS.NORESULTS]=K("chat.noresult"),f.chat[bA.REQSTATUS.FAILED]=K("chat.retrievefailed");var g=a?a.getElementsByClassName("wms-hysearch-loadstatus")[0]:"";g&&(g.onclick=null);var h="",i="";e=e||hT();var j="wms-hysearch-loadstatus";e===bA.HYBRIDSEARCH.modules.FILEFWD?j="wms-filefwd-loadstatus":e===bA.HYBRIDSEARCH.modules.CHATMENU?j="wms-chat-loadstatus":e===bA.HYBRIDSEARCH.modules.CONTACTMENU?j="wms-contact-loadstatus":e===bA.HYBRIDSEARCH.modules.GROUPMENU?j="wms-channel-loadstatus":e===bA.HYBRIDSEARCH.modules.CUSTOMCONTACTMENU&&(j="wms-customcontact-loadstatus");if(b===bA.REQSTATUS.SUCCESS){fi(g);return}if(b===bA.REQSTATUS.NORESULTS)if(c==="chat"&&e===bA.HYBRIDSEARCH.modules.CHATMENU)if((!hc()||!hc().length)&&!gW()){var k=hS("recentchatswelcomemsg",e);fi(k),i='<div id="wms_welcome_recentchatsmsg"><div class="wms-welcome-img wms-welcome-recentchatsimg wms-halign"></div><div class="wms-welcome-msg wms-halign">'+K("recentchats.welcomemessage",['<span data-menuredirect="contact">'+K("chat.contact")+"</span>",'<span data-menuredirect="channel">'+K("chat.channel")+"</span>"])+"</div></div></div>"}else h='<div class="wms-hysearch-infotxt wms-hvalign">'+f[c][bA.REQSTATUS.NORESULTS]+"</div>";else!g&&a&&a.id==="wms-hysearch-rchats"&&e===bA.HYBRIDSEARCH.modules.SMARTCHAT&&c==="chat"?(a.getElementsByClassName("wms-hysearch-infotxt")[0]&&fi(a.getElementsByClassName("wms-hysearch-infotxt")[0]),i='<span id="'+j+'" class="wms-hysearch-infotxt">'+f[c][bA.REQSTATUS.NORESULTS]+"</span>"):h='<div class="wms-hysearch-error-info wms-hvalign"><img class="wms-hysearch-error-img" src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/search_empty.svg"><div class="wms-hysearch-infotxt"><div class="wms-hysearch-infotext-1">'+K("search.noresult")+'</div><div class="wms-hysearch-infotext-2">'+K("search.again")+"</div></div>";else if(b===bA.REQSTATUS.LOADING)h='<div class="wms_loading_container wms-hvalign"><div></div><div></div><div></div></div>';else if(b===bA.REQSTATUS.FAILED){if(c=="chat"&&!hs().length&&e===bA.HYBRIDSEARCH.modules.CHATMENU){var l=hS("recentchatswelcomemsg",e);fi(l)}i='<div id="'+j+'" class="wms-hysearch-loadstatus" data-retry="true" data-type="'+bA.REQSTATUS.FAILED+'">'+'<div class="wms-hysearch-infotxt wms-hvalign">'+f[c][bA.REQSTATUS.FAILED]+'<span class="wms-hysearch-retry-text"> '+K("suggestions.retry")+"</span></div>"+"</div>"}i=i||'<div id="'+j+'" class="wms-hysearch-loadstatus wms-nonselectable" data-type="'+b+'">'+h+"</div>",g?g.outerHTML=i:a&&(e===bA.HYBRIDSEARCH.modules.CHATMENU&&(!hc()||!hc().length)&&!gW()?a.innerHTML=i:a.insertAdjacentHTML("beforeend",i)),b===bA.REQSTATUS.FAILED&&(hS("loadingstatus").onclick=d)}function ih(a,b){var c="",d,e,f=hS("inputcontainer")&&hS("inputcontainer").querySelector("[data-type='topic']");for(var g=0;g<a.length;g++){d=a[g],e=il(d._filtertype,f);if(d._filtertype===bA.HYBRIDSEARCH.BOT)c+=ij(d.USERID,d.DNAME,ey(ez(d.STATUSMSG)),de(d.USERID),e,bA.HYBRIDSEARCH.BOT,null,null,d,b);else if(d._filtertype===bA.HYBRIDSEARCH.CONTACT)d.id?c+=ij(d.id,d.name,ey(ez(d.statusMsg)),d.photo,null,bA.HYBRIDSEARCH.CONTACT,null,null,d,b):c+=ij(d.USERID,d.DNAME,ey(ez(im(d))),null,e,bA.HYBRIDSEARCH.CONTACT,null,null,null,b);else if(d._filtertype===bA.HYBRIDSEARCH.ORGCONTACT)c+=ij(d.USERID,d.DNAME,d.EMAILID,null,e,bA.HYBRIDSEARCH.ORGCONTACT,null,null,null,b);else if(d._filtertype===bA.HYBRIDSEARCH.GROUP)c+=ij(d.ID,d.NAME,d.DESC,null,e,bA.HYBRIDSEARCH.GROUP,null,null,null,b);else if(d._filtertype===bA.HYBRIDSEARCH.CHANNEL)e=jg(d.chid)?il(bA.HYBRIDSEARCH.CHAT,f):e,c+=ij(d.chid,jh(d.chid),ey(d.cd),jf(d.chid),e,bA.HYBRIDSEARCH.CHANNEL,null,null,null,b,d.oc_id);else if(d._filtertype===bA.HYBRIDSEARCH.CHAT){var h=d.TITLE;fd(d.CHATID)&&(h=jh(d.CHATID)||h),c+=ij(d.CHATID,h,hO(d),io(d),e,bA.HYBRIDSEARCH.CHAT,d.LMTIME,"",d,b)}}return c}function ii(a,b,c,d){var e=b,f="",g="none",h;c&&(c.CUSTOMGROUP||c.CUSTOMGROUP=="true")&&c.CUSTOMGROUP!="false"&&(d=!0);if(e===bA.HYBRIDSEARCH.CHAT&&!c.SALESIQCHAT)if(fd(a)&&!fe(a)&&!c.FEEDSID)e=bA.HYBRIDSEARCH.CHANNEL;else if(fe(a)){var i=dg(c.CHATID);e=bA.HYBRIDSEARCH.BOT,a=i,f='<img data-zcprofileid="b-'+i+'" src="'+de(i)+'">'}else!d&&c&&c.PARTICIPANTS&&c.PARTICIPANTS.length==2&&(a=c.PARTICIPANTS[0].zuid===J.get("zuid")?c.PARTICIPANTS[1].zuid:c.PARTICIPANTS[0].zuid,e=bA.HYBRIDSEARCH.ORGCONTACT,typeof WmsMainUI!="undefined"&&WmsMainUI.setZuidForPrivateChat(c.CHATID,a));if(e===bA.HYBRIDSEARCH.CONTACT||e===bA.HYBRIDSEARCH.ORGCONTACT||e===bA.HYBRIDSEARCH.BOT)e===bA.HYBRIDSEARCH.BOT?h=a?de(a):"":h=a?ef(a):"",fp(a)?f='<img data-zcprofileid="'+a+'" src="'+h+'">':f='<div class="wms_menu_item_img wms_contacticon" data-imgid="'+a+'" data-originalsrc="'+h+'"></div>',g=dT(a);else{if(e===bA.HYBRIDSEARCH.CHANNEL)return jf(a);c&&c.FEEDSID?f='<span class="wms_badge_letter"><span class="wms_notifyicon"></span></span>':typeof c.TITLE=="string"&&c.TITLE.length&&(f='<span class="wms_badge_letter">'+hL(c.TITLE)+"</span>")}return'<span class="wms_badge_imgwrapper wms_badge_statusicon_'+g+'">'+f+"</span>"}function ij(a,b,c,d,e,f,g,h,i,j,k){j=j||hT(),f===bA.HYBRIDSEARCH.CHAT&&fd(a)&&!fe(a)?d=jf(a):(f===bA.HYBRIDSEARCH.BOT&&i&&(d=hH(a,de(i.USERID))),d=d||hH(a)),f===bA.HYBRIDSEARCH.CHANNEL&&(c=c||K("channel.nodescription")),b=ez(b);var l=e?'<span class="wms-hysearch-deschint">'+ey(e)+"</span>":"",m=a?"data-id={{id}} ":"";m+=k?"data-oc_id={{oc_id}}":"";var n;if(f===bA.HYBRIDSEARCH.TITLEHINT)return n='<div class="wms-hysearch-result" data-type="{{type}}"'+m+">"+d+'<div class="wms-hysearch-result-hint wms-truncate-ellipsis">'+iy(b)+"</div></div>",fR(n,{id:a,type:f});if(f===bA.HYBRIDSEARCH.MESSAGEHINT)return n='<div class="wms-hysearch-result"  data-type="{{type}}"'+m+">"+d+'<div class="wms-hysearch-result-hint wms-truncate-ellipsis">'+K("hint.openchatandsendmessage","<span>"+ey(b)+"</span>")+"</div></div>",fR(n,{id:a,type:f,name:b});if(j===bA.HYBRIDSEARCH.modules.SMARTCHAT){var o="";if(f===bA.HYBRIDSEARCH.CHAT&&typeof WmsMainUI!="undefined"){var p=WmsMainUI.getUnreadCount(a);p?o='<span style="display:block" class="wms_menu_item_count" data-unreadcount=true>'+p+"</span>":o='<span class="wms_menu_item_count" data-unreadcount=true></span>';var q=WmsMainUI.getMuteStatus(a);q&&(m+=' data-muted="true" ')}return n='<div class="wms-hysearch-result"  data-type="{{type}}"'+m+">"+d+'<div class="wms-hysearch-result-name wms-truncate-ellipsis">{{name}}</div><div class="wms-hysearch-result-desc wms-truncate-ellipsis">'+c+"</div>"+o+l+"</div>",fR(n,{id:a,name:b?ez(b):ez(eB(a,b)),type:f,oc_id:k})}return ik(a,b,c,d,f,g,h,i)}function ik(a,b,c,d,e,f,g,h){var i="wms_menu_item",j="",k="",l="",m="",n="",o="",p="",q="",r="",s="",t,u;if(f){var v=W(f,(new Date).getTime())?T(f):X(f);j='<span class="wms_menu_item_time" title="'+U(f)+'">'+v+"</span>"}r='<div class="wms_menu_item_name wms-truncate-ellipsis" title="{{dname}}">{{dname}}</div>',!a&&h&&h.FEEDSID&&(a=h.FEEDSID,r='<div class="wms_menu_item_name" title="{{dname}}">{{dname}}</div>'),k=ii(a,e,h);if(e===bA.HYBRIDSEARCH.CHAT&&typeof WmsMainUI!="undefined"){var w=WmsMainUI.getUnreadCount(a);w?l='<span style="display:block" class="wms_menu_item_count" data-unreadcount=true>'+w+"</span>":l='<span class="wms_menu_item_count" data-unreadcount=true></span>'}typeof WmsMainUI!="undefined"&&(u=WmsMainUI.getMuteStatus(a)),u&&(m=' data-muted="true" '),e===bA.HYBRIDSEARCH.CHAT&&typeof WmsMainUI!="undefined"&&WmsMainUI.getZuidForPrivateChat(a)&&(n=WmsMainUI.getZuidForPrivateChat(a)),e===bA.HYBRIDSEARCH.CHAT?o='<div class="wms_menu_item_msg wms-truncate-ellipsis">'+c+"</div>":e===bA.HYBRIDSEARCH.CONTACT?(eh(a)&&(c=ec(a),i="wms_menu_item_invitations"),o='<div class="wms_menu_item_msg wms-truncate-ellipsis" data-smsg="true" title="'+c+'">'+c+"</div>"):o='<div class="wms_menu_item_msg wms-truncate-ellipsis" title="'+c+'">'+c+"</div>";if(e===bA.HYBRIDSEARCH.CONTACT||e===bA.HYBRIDSEARCH.ORGCONTACT)p='<div class="wms_menu_item_profile_icon wms-valign-mid-block" data-zcprofileid="'+a+'"></div>';return e===bA.HYBRIDSEARCH.CONTACT&&eh(a)&&(q+='<div class="wms_menu_inv" data-id="{{id}}" data-dname="{{dname}}"><span data-operation="accept" title="'+K("Accept")+'" class="wms_menu_invaccept">'+K("Accept")+'</span><span>  |  </span><span title="'+K("remind.later")+'" data-operation="reject" class="wms_menu_invreject">'+K("remind.later")+"</span></div>"),s='<div class="'+i+'" data-id="{{id}}" {{useridforprivatechat}} data-dname="{{dname}}" '+m+' data-type="{{type}}">'+k+r+j+o+q+l+p+"</div>",e===bA.HYBRIDSEARCH.CHAT&&n&&(n="data-userid="+n),t={id:a,type:e,dname:ez(eB(a,b)),useridforprivatechat:n},fR(s,t)}function il(a,b){if(a===bA.HYBRIDSEARCH.CONTACT||a===bA.HYBRIDSEARCH.ORGCONTACT)return b?K("topic.adduser"):hZ().startsWith("@")?K("topic.addusertocreate"):K("chat.user");if(a===bA.HYBRIDSEARCH.GROUP)return K("chat.group");if(a===bA.HYBRIDSEARCH.CHANNEL)return K("channel.join");if(a===bA.HYBRIDSEARCH.CHAT)return K("chat.continue")}function im(a){if(a.USERID){var b=dX(a.USERID);return!b||b.STATUS=="-2"||b.STATUS=="-3"||b.STATUS=="-4"||b.STATUS=="-5"||b.STATUS=="-6"?a.EMAILID:dQ(a.USERID)}return""}function io(a){var b="",c=[],d;for(var e=0;e<a.PARTICIPANTS.length;e++)a.PARTICIPANTS[e].zuid!==J.get("zuid")&&c.push(a.PARTICIPANTS[e].zuid);if(a.CHATID&&fe(a.CHATID)){var f=dg(a.CHATID);b='<img class="wms-imgcollbot" src="'+de(f)+'"><div class="wms-img-badge wms-pos-bot"></div>'}else c.length!==1||!!a.CUSTOMGROUP&&a.CUSTOMGROUP!="false"?a.PARTICIPANTSCOUNT>5?b='<img class="wms-imgcoll1" src="'+ef(c[0])+'">'+'<img class="wms-imgcoll2" src="'+ef(c[1])+'">'+'<img class="wms-imgcoll3" src="'+ef(c[2])+'">'+'<span class="wms-numcoll">+'+(a.PARTICIPANTSCOUNT-4)+"</span>":c.length===2?b='<img class="wms-imgcoll1" src="'+ef(c[0])+'">'+'<img class="wms-imgcoll4" src="'+ef(c[1])+'">':c.length===3?b='<img class="wms-imgcoll1" src="'+ef(c[0])+'">'+'<img class="wms-imgcoll3" src="'+ef(c[1])+'">'+'<img class="wms-imgcoll4" src="'+ef(c[2])+'">':c.length===4?b='<img class="wms-imgcoll1" src="'+ef(c[0])+'">'+'<img class="wms-imgcoll2" src="'+ef(c[1])+'">'+'<img class="wms-imgcoll3" src="'+ef(c[2])+'">'+'<img class="wms-imgcoll4" src="'+ef(c[3])+'">':typeof a.TITLE=="string"&&a.TITLE.length&&(b='<div class="wms-lettercoll"><span>'+hL(a.TITLE)+"</span></div>"):a.PHOTO?b='<img class="wms-imgcoll1" src="'+a.PHOTO+'">':d=hH(c[0]);return d||'<div class="wms-imgcollage">'+b+"</div>"}function ip(a,b,c,d){var e=a.searchtext,f=a.chid,g=hP(unescape(e),null,!1,d),h={},i,j=0;g.forEach(function(a){i=hC(a),i.counter=j++,h[i.id]=i});var k=g.length<10?!0:!1;return typeof c=="function"?c(h,!0,b,e,d):gz.updateList(f,h,!0,b,e),k}function iq(a,b){var c="",d=!0;b=b||bA.HYBRIDSEARCH.modules.CHATMENU;var e=b===bA.HYBRIDSEARCH.modules.CHATMENU?"defaultresultdiv":"recentchatsdiv",f=hc(),g=hS("recentchatsdiv",b)||hS("defaultresultdiv",b);if(a===bA.REQSTATUS.FAILED||a===bA.REQSTATUS.NORESULTS)ig(g,a,"chat",ht,b);else if(!f||!f.length)ig(g,bA.REQSTATUS.NORESULTS,"chat",null,b);else if(b===bA.HYBRIDSEARCH.modules.CHATMENU){var h=ir(ha(),"pinnedchats"),i=ir(f,"recentchats");c+=h+i,typeof WmsMainUI!="undefined"&&WmsMainUI.bindRecentChatEvents()}else c+=iv(f,b);b!==bA.HYBRIDSEARCH.modules.SMARTCHAT&&parseInt(gW())&&(d=c?!0:!1,c=iv(gZ())+c);var j=hS(e,b),k;if(j&&c){var l=j.querySelector("[data-select]");k=is(),j.innerHTML=c,fm(j);var m=l?j.querySelector('[data-id="'+l.getAttribute("data-id")+'"]'):"";m&&ic(m)}c!=""&&d&&f.length>6&&ig(hS("recentchatsdiv",b),bA.REQSTATUS.LOADING,"chat",null,b),k&&typeof WmsMainUI!="undefined"&&WmsMainUI.filterUnreadChats(),typeof WmsMainUI!="undefined"&&WmsMainUI.updateUnreadChatsCount(),typeof WmsMainUI!="undefined"&&WmsMainUI.updateCountDependentUI()}function ir(a,b){var c="";if(a.length>0){var d,e="",f="",g="";a.sort(eF("LMTIME",!0));if(b=="pinnedchats"){g=it();var h=ha().length;if(h<=6)d="";else if(iu()){var i=Math.ceil(ha().length/6),j="height: "+i*50+"px";d=" data-expanded=true",e='style="'+j+'"',f=".expanded.filtertitle"}else d=" data-expanded=false",f=".shrinked.filtertitle"}else g=iv(a,bA.HYBRIDSEARCH.modules.CHATMENU),f=".filtertitle";c='<div id="wms_menu_'+b+'" class="wms_menu_'+b+'" data-menu="'+b+'"'+d+">"+'<div id="wms_menu_heading_'+b+'" class="wms_menu_subheading" data-heading="'+b+'">'+"<span>"+K(b+".title")+"</span>"+'<div class="wms_menu_filter_icon" title="'+K(b+f)+'"></div>'+"</div>"+'<div id="wms_menu_chatlist_'+b+'" class="wms_menu_chatlist_'+b+'" '+e+">"+g+"</div>"+"</div>"}return c}function is(){return typeof WmsMainUI!="undefined"?WmsMainUI.defaultchatlist.querySelector('[data-heading="unreadchats"]')?!0:!1:!1}function it(){var a="",b=ha().sort(eF("TITLE",!1));return b.forEach(function(b){var c=ii(b.CHATID,bA.HYBRIDSEARCH.CHAT,b),d="";typeof WmsMainUI!="undefined"&&WmsMainUI.getZuidForPrivateChat(b.CHATID)&&(d=" data-userid="+WmsMainUI.getZuidForPrivateChat(b.CHATID));var e='<div data-pc="true" data-type=2 data-id='+b.CHATID+d+' class="wms_menu_pinnedchats_fragment" title="{{title}}">'+c+"</div>",f=b.TITLE;fd(b.CHATID)&&(f=jh(b.CHATID)||f),a+=fR(e,{title:ez(f)})}),a}function iu(){return typeof WmsMainUI!="undefined"?WmsMainUI.defaultchatlist.querySelector('#wms_menu_pinnedchats[data-expanded="true"]')?!0:!1:!1}function iv(a,b){var c="",d="",e;a&&a.length?e=a:e=hQ();for(var f=0;f<e.length;f++){var g=e[f].TITLE;fd(e[f].CHATID)&&(g=jh(e[f].CHATID)||g),c+=ij(e[f].CHATID,g,hO(e[f]),io(e[f]),null,bA.HYBRIDSEARCH.CHAT,e[f].LMTIME,d,e[f],b),d=e[f].LMTIME}return c}function iw(){return hS("inputcontainer").querySelectorAll("[data-type='user']")}function ix(){var a=fh(iw());return a.map(function(a){var b=fs(a);return b.slice(1)})}function iy(a){a=ey(a);var b=ix().map(function(a){return ey(a)}),c=b.pop(),d=b.join(", ");if(c)return b.length===0?K("chat.topic.singlemember",["<span>"+a+"</span>","<span>"+c+"</span>"]):K("chat.topic.multiplemember",["<span>"+a+"</span>","<span>"+d+"</span>","<span>"+c+"</span>"]);if(b.length===0)return K("chat.topic.set","<span>"+a+"</span>")}function iH(a){return a?iA[a]:iA}function iI(){return iC}function iJ(){return iE}function iK(){iE=!0}function iL(){return iF}function iM(){iF=!0}function iN(){return iG}function iO(a){return a?iD[a]:iD}function iP(a,b){iD[a]||(iD[a]=b)}function iQ(a){var b=iH(a),c={};return b.scid.forEach(function(a){if(iD[a]){var b=iD[a];for(var d in b)c[d]=b[d]}}),c}function iR(a){var b=iH(a);return b&&b.sc===bA.CHANNELS.SHARED?!0:!1}function iS(a){var b=iH(a);return b&&b.sc===bA.CHANNELS.TEAM?!0:!1}function iT(a,b){var c=iH(a);if(c&&!eu(c)&&c.permissions){var d=c.currole,e=c.permissions;return d==bA.USERROLES.SUPER_ADMIN?!0:d==bA.USERROLES.ADMIN&&(e.adminp&1<<b)!=0?!0:d==bA.USERROLES.CREATOR&&(e.crp&1<<b)!=0?!0:d==bA.USERROLES.MODERATOR&&(e.modp&1<<b)!=0?!0:c.joined==1&&(e.partp&1<<b)!=0?!0:!1}return!0}function iU(){iC===null?(typeof WmsMainUI!="undefined"&&WmsMainUI.updateLoadingForPinnedChats(!0),bs("getchannels.do","pageload=true&mode=joined&limit=50",iY,iZ)):(iE||iC+216e5<(new Date).getTime())&&jj()}function iW(a){var b=[];for(var c in iA){var d=iA[c];d.joined&&cD(iG[d.sc])&&b.push(iA[c])}return b.sort(eF("lmtime",!0)),b.slice(0,a)}function iX(a,b,c){typeof iA[a]=="undefined"&&(iA[a]={}),iA[a][b]=c}function iY(a){iC=(new Date).getTime(),iF=!1;var b=a.data;b&&b.allowed&&b.allowed.forEach(function(a){a.st==="1"&&(iA[a.chid]=a,a.scid.length==1&&(iA[a.chid]._teamname=a.scid_name[a.scid[0]]))}),b&&b.joined&&b.joined.forEach(function(a){if(a.st==="1"){iA[a.chid]=a,a.scid.length==1&&(iA[a.chid]._teamname=a.scid_name[a.scid[0]]),iA[a.chid].read&&iA[a.chid].totmsg&&iA[a.chid].read!="-1"&&(iA[a.chid].unreadmsgs=iA[a.chid].totmsg-iA[a.chid].read);if(typeof WindowHandler!="undefined"){var b=WindowHandler.getWinObjById(a.chid);b&&b.setTitle(jh(a.chid))}}}),typeof WindowHandler!="undefined"&&WindowHandler.updateChannelProperties();if(this.opts){this.opts.callbackargs&&this.opts.callbackargs.params&&iB.push(this.opts.callbackargs.params);var c=this.opts.callbackargs&&this.opts.callbackargs.reqid,d=this.opts.callbackargs&&this.opts.callbackargs.topicname;d?eI.publish("/channels/"+d,{callbackargs:this.opts.callbackargs,reqid:c}):eI.publish("/channels/updateui",{callbackargs:this.opts&&this.opts.callbackargs,reqid:c})}setTimeout(function(){eI.publish("/channels/updatelist",eJ(a.data))}.bind(this),1),typeof WmsMainUI!="undefined"&&WmsMainUI.joinScheduledChannels()}function iZ(){var a=this.opts.callbackargs&&this.opts.callbackargs.reqid;eI.publish("/channels/updateui",{reqid:a,stat:bA.REQSTATUS.FAILED})}function i$(a,b,c){var d=hK(c||"cn",a,iA,null,null,"_teamname");return d=d.filter(function(a){if(cD(iG[a.sc]))if(b&&a.joined||!b)return!0}),d}function i_(a){return i$(a,!1,"_teamname")}function ja(a){return i$(a,!1,"cn")}function jb(a,b){var c=i_(a);return hK("cn",b,c)}function jc(a){return iB.indexOf(jd(a))!==-1}function jd(a){return"limit=20&search="+encodeURIComponent(a)}function je(a,b){var c=a.searchtext,d=jd(c),e=a.topicname,f=a.silentload,g=a.chid;iB.indexOf(d)===-1?bs("getchannels.do",d,iY,iZ,{reqid:b,params:d,topicname:e,chid:g,silentload:f,searchtext:c}):e?eI.publish("/channels/"+e,{callbackargs:a}):eI.publish("/channels/updateui",{reqid:b})}function jf(a){var b=iH(a);if(b){var c="";b.photoid&&(fp(a)?c='<img data-channelid="'+a+'" src="/'+J.get("CHATCONT")+"/channel/"+b.photoid+'/photo.do"></img>':c='<div data-channelimgid="'+a+'" data-originalsrc="/'+J.get("CHATCONT")+"/channel/"+b.photoid+'/photo.do"></div>');var d=b.sc,e;return d==="1"?e="orgchannel":d==="2"?e="orggroup":d==="3"?e="privatechannel":d==="4"&&(e="shared-channel"),c?'<span class="wms_badge_imgwrapper wms_channelimg_badge wms-'+e+'-small">'+c+"</span>":'<span class="wms_badge_imgwrapper wms_channelimg wms-'+e+'-small">'+c+"</span>"}var f="";return b=hc(a),b&&b.TITLE&&(f=b.TITLE),'<span class="wms_badge_imgwrapper"><span class="wms_badge_letter">'+hL(f)+"</span></span>"}function jg(a){var b=iH(a);return b&&b.joined&&b.joined==1?!0:!1}function jh(a){var b=iH(a);if(b){var c=b.dn;return c||(c=b.cn,b._teamname&&(c=c+"@"+b._teamname)),c}}function ji(){iC=(new Date).getTime(),iF=!1,iE=!1;var a=JSON.parse(this.response)[0].objString;if(this.getResponseHeader("x-zcoperation")==="clearchanneldb")iC=null,iU();else if(this.getResponseHeader("x-zcoperation"))iC=this.getResponseHeader("x-zcoperation");else if(a.leftchanneluids||a.deletedchanneluids){var b=a.leftchanneluids||a.deletedchanneluids;for(var c in b){var d=jk(c)[0],e=d&&d.chid;delete iA[e]}}else{if(a.newjoinedchannels){var f=a.newjoinedchannels;for(var g in f){var h=f[g].chid;iA[h]=f[g]}}if(a.groupsnamemodified){var i=a.groupsnamemodified,j=hK("sc",bA.CHANNELS.TEAM,iA),k=function(a){j.forEach(function(b){if(b.scid.indexOf(a)!==-1){var c=i[a];b._teamname&&(b._teamname=c),b.scid_name[a]=c}})};for(var l in i)k(l)}if(a.channelidvsdatamodified){var m=a.channelidvsdatamodified;for(var n in m){var o=jk(n)[0];if(o){var p=m[n];for(var q in p)o[q]=p[q]}}}}eI.publish("/channels/updateui",{})}function jj(){var a="lastsynctime="+iC;bs("synchannels.do",a,ji)}function jk(a){return hK("oc_id",a,iA)}function jn(a){var b=a.msg.type,c=eN(a.opruser.zuid),d=a.msg.event,e="",f=function(a,b,c){return c==="audio"?'<div class="'+jm.wms_callbutton_wrapper+'"><span data-infocallbtn="triggerAudioCall" class="'+jm.wms_audiocall+'" data-calleezuid="'+a+'"></span> <span data-infocallbtn="triggerAudioCall" class="'+jm.wms_callinfo+'" data-calleezuid="'+a+'">'+(b?K("info.call.again"):K("info.call.back"))+"</span></div>":'<div class="'+jm.wms_callbutton_wrapper+'"><span data-infocallbtn="triggerVideoCall" class="'+jm.wms_videocall+'" data-calleezuid="'+a+'"></span> <span data-infocallbtn="triggerVideoCall" class="'+jm.wms_callinfo+'" data-calleezuid="'+a+'">'+(b?K("info.call.again"):K("info.call.back"))+"</span></div>"};switch(d){case"completed":var g=a.msg.duration.split(":"),h=parseInt(g[0]),i=parseInt(g[1]),j=parseInt(g[2]),k=g[0]!=="00"?" "+h+" "+(h>1?"hrs":"hr"):"",l=g[1]!=="00"?" "+i+" "+(i>1?"mins":"min"):"",m=g[2]!=="00"?" "+j+" "+(j>1?"secs":"sec"):"";e='<span class="'+jm.inftxt+'"><span class="'+jm.wms_infotext+'">'+K("info.call.completed",[K("info.call."+b)])+'</span> <span class="'+jm.wms_callduration+'">'+(k+l+m)+"</span>"+f(c?a.msg.calleduser.zuid:a.opruser.zuid,!0,b)+"</span>";break;case"cancelled":e=c?'<span class="'+jm.inftxt+'"><span class="'+jm.wms_infotext+'">'+K("info.call.cancelled.caller",[K("info.call."+b)])+"</span>"+f(a.msg.calleduser.zuid,c,b)+"</span>":'<span class="'+jm.inftxt+'"><span class="'+jm.wms_infotext+'">'+K("info.call.cancelled.callee",['<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+a.opruser.zuid+">"+eB(a.opruser.zuid,a.opruser.nname,!0)+"</span>",K("info.call."+b)])+"</span>"+f(a.opruser.zuid,c,b)+"</span>";break;case"noresponse":case"busy_on_another_call":e=c?'<span class="'+jm.inftxt+'"><span class="'+jm.wms_infotext+'">'+K("info.call.noresponse.caller",['<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+a.msg.calleduser.zuid+">"+eB(a.msg.calleduser.zuid,a.msg.calleduser.nname,!0)+"</span>",K("info.call."+b)])+"</span>"+f(a.msg.calleduser.zuid,c,b)+"</span>":'<span class="'+jm.inftxt+'"><span class="'+jm.wms_infotext+'">'+K("info.call.noresponse.callee",[K("info.call."+b)])+"</span>"+f(a.opruser.zuid,c,b)+"</span>";break;case"rejected":e=c?'<span class="'+jm.inftxt+'"><span class="'+jm.wms_infotext+'">'+K("info.call.rejected.caller",['<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+a.msg.calleduser.zuid+">"+eB(a.msg.calleduser.zuid,a.msg.calleduser.nname,!0)+"</span>",K("info.call."+b+"call")])+"</span>"+f(a.msg.calleduser.zuid,c,b)+"</span>":'<span class="'+jm.inftxt+'"><span class="'+jm.wms_infotext+'">'+K("info.call.rejected.callee",[K("info.call."+b),'<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+a.opruser.zuid+">"+eB(a.opruser.zuid,a.opruser.nname,!0)+"</span>"])+"</span>"+f(a.opruser.zuid,c,b)+"</span>"}return e}function jo(a){var b=a.mode,c=a.msg,d;switch(b){case"GUEST ENTERED":c=K("Guest")+" "+a.nname+" "+K("entered_the_chat");break;case"USER ADDED":var e=new Array,f=a.userslist,g=a.opruser;if(f[g.zuid]){c=K("chat.member.joined",'<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>");break}for(var h in f)e.push('<span class="'+jm.wms_profileinfo_text+'"  data-zcprofileid='+h+">"+eB(h,f[h],!0)+"</span>");d="chat.member.add",c=K(d,['<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>",e.join(", ")]);break;case"GUEST LEFT":c=K("Guest")+" "+a.nname+" "+K("left_the_chat");break;case"USER DELETED":e=new Array,f=a.userslist,g=a.opruser;if(g){if(f[g.zuid]){c=K("chat.member.left",'<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>");break}for(h in f)e.push('<span class="'+jm.wms_profileinfo_text+'"  data-zcprofileid='+h+">"+eB(h,f[h],!0)+"</span>");d="chat.member.delete",c=K(d,['<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>",e.join(", ")])}else c=K("chat.participant.remove");break;case"GUEST ACCESS":g=a.opruser,c=eB(g.zuid,g.nname,!0)+" "+K("turned")+" "+(a.access=="on"?K("on"):K("off"))+" "+K("guest_access");break;case"TITLE CHANGE":g=a.opruser,d="chat.rename",a.title?c=K(d,['<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>",ey(a.title)]):c=K("chat.title.clear",['<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>"]);break;case"CALL STARTED":c=K("chat.call.start");break;case"CALL ENDED":c=K("chat.call.end");break;case"BROADCAST STARTED":g=a.opruser,c=K("chat.broadcast.live",[eB(g.zuid,g.nname,!0)]);break;case"BROADCAST STOPPED":c=K("chat.broadcast.stop");break;case"CALLNOTIFICATION":c=jn(a);break;case"MESSAGE EDITED":g=a.opruser;var i=eN(g.zuid)?K("You"):'<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.dname,!0)+"</span>";c=K("chat.edit.infomsg",[i,'<span data-replymsgtime="'+a.info.ref_msg_time+'">'+K("chat.edit.message")+"</span>"]);break;case"CHANNEL_MENTION":g=a.opruser;var i=eN(g.zuid)?K("common.you.have"):'<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>";c=K("channel.mention.infomsg",[i,a.msg.channelname]);break;case"CHANNEL_VISIBILITY_CHANGE":g=a.opruser;var i=eN(g.zuid)?K("common.you.have"):'<span class="'+jm.wms_profileinfo_text+'" data-zcprofileid='+g.zuid+">"+eB(g.zuid,g.nname,!0)+"</span>";if(a.msg.level==="1")a.msg.open_to_all==="true"?c=K("channel.org.opentoall.infomsg",[i]):a.msg.open_to_all==="false"&&(c=K("channel.org.inviteonly.infomsg",[i]));else if(a.msg.level==="2"){var j=iH(a.chid),k=j?j.scid_name[j.scid[0]]:"";a.msg.open_to_all==="true"?c=K("channel.team.opentoall.infomsg",[i,k]):a.msg.open_to_all==="false"&&(c=K("channel.team.inviteonly.infomsg",[i,k]))}break;case"MESSAGE_PINNED":var l=a.msg.msguid.split("%")[0],m=a.opruser.zuid,n=eB(a.opruser.zuid,a.opruser.nname,!0),o='<span data-pinned-msgtime="'+l+'" data-pinned-user="'+m+'" class="wms_pinmsg_infomsg">'+K("chat.edit.message")+"</span>";c=eN(m)?K("pinmsg.infomsg.you",[o]):K("pinmsg.infomsg",[n,o])}return typeof c=="string"?c:""}function jr(a,b,c,d,e){var f=a.providername,g=a.providerurl||"www."+f+".com",h="",i="",j=a.url,k=a.title||"",l="",m="",n="",o="",p="",q="",r=jq.previewfooter;c&&(m=c.date,n=c.time,o=c.sender,p=c.dname),d&&(l=jq.closeicon),a.description&&(j=a.description);if(!f){var s=/:\/\/(.[^/]+)/;f=a.url.match(s)[1],g="//"+f}if(a.thumbnailurl||a.mimetype.indexOf("image/")>-1){var t=!1,u=a.thumbnailurl,v=!1;e&&(t=!0),a.mimetype.indexOf("image/")>-1&&(u=a.url);var w=u.split(".")[u.split(".").length-1];w=="svg"&&(v=!0),i='<div class="{{imagecontainerclass}}"><img class="{{imageclass}}" src="{{imageurl}}" data-svgthumb="{{svgthumb}}" data-previewable="true" data-src="{{imageurl}}" data-fdate="{{date}}" data-ftime="{{time}}" data-fname="{{name}}" data-fsize data-fcontent data-fsender="{{sender}}" data-dname="{{dname}}" data-rich="{{richformat}}"/></div>',i=fR(i,{imagecontainerclass:jq.imagecontainer,imageclass:jq.image,imageurl:u,name:f,date:m,time:n,sender:o,dname:p,richformat:t,svgthumb:v})}e&&(h='<div data-previewable="true" data-ftime="{{time}}" data-fsender="{{sender}}" data-fdate="{{date}}" data-dname="{{dname}}" data-fname="{{name}}" data-unfurl="true" src="{{src}}" class="{{previewclass}}">{{preview}}</div>',h=fR(h,{previewclass:jq.preview,src:a.html||a.iframe_url,name:f,date:m,time:n,sender:o,dname:p,$preview:"chat.preview"})),a.faviconlink&&(q='<img class="{{faviconclass}}" src="{{faviconlink}}"/>',q=fR(q,{faviconclass:jq.favicon,faviconlink:a.faviconlink}));var x="";if(a.fields&&!a.unfurldata_cache_id){var y=a.fields.data,z="";for(var A=0;A<y.length;A++)z+=fR("<div class={{field}}><div class={{labelclass}} title='{{label}}'>{{label}}</div><div class={{valueclass}} title='{{value}}'>{{value}} </div></div>",{label:y[A].label,value:y[A].value,valueclass:jq.value,labelclass:jq.label,field:jq.field});x=fR("<div class={{fieldscontainer}}>"+z+"</div>",{fieldscontainer:jq.fieldscontainer})}var B='<div class={{previewheader}}><a target="_blank" rel="noopener" href="{{url}}" class="{{titleclass}}" tabindex="-1" title="{{title}}"> {{title}} </a><div class="{{closeicon}}" data-urlpreviewclose="true"/></div></div><div class="{{previewcontent}}">'+i+'<div class="{{descriptionclass}}" title="{{description}}">{{description}}</div></div>'+x+'<div class="{{previewfooter}}"><div class="{{domaindetails}}">'+q+'<div class="{{providernameclass}}">{{providername}}</div></div>'+h+"</div>";B=fR(B,{previewheader:jq.previewheader,url:a.url,titleclass:jq.title,title:k,closeicon:l,previewcontent:jq.previewcontent,urlclass:jq.url,previewfooter:r,domainname:g,domaindetails:jq.domaindetails,providernameclass:jq.providername,providername:f,winindex:b,descriptionclass:jq.description,description:j});var C='<div class="{{urlpreviewparent}}" data-urlpreview="true">'+B+"</div>";return fR(C,{urlpreviewparent:jq.urlpreviewparent})}function js(){return'<div class=wms-previewcardloader><span id="wms_contactdetails_loadingdiv" class="wms-hvalign wms_loading_div wms-fadeOut"></span></div>'}function jt(a){return a=be.replacer(be.getRegexToGetAttrValueInHtmlTag("iframe","src"),null,a,function(a,b,c,d,e,f){var g=e+(e.indexOf("?")===-1?"?":"&")+"autoplay=true";return b+g+f}),a}function ju(a){var b=a.meta.linkdetails,c="<div class='wms-urlinfoouterdiv'><div class='wms-urlinfo'><img src=\"{{urlproviderurl}}\"><a href='{{urlproviderurl}}' target='_blank'>{{urlprovider}}</a></div><div class='wms-urlinfolink'><a href='{{urllink}}' target='_blank'>{{urltitlelink}}</a></div></div><div class='wms-media'  data-playable='true' thumbnailimg='{{videoimg}}' iframe='{{iframe}}'>{{thumbnailimg}}</div>";if(b.html)var d='<p class="wms-videowrapper">'+jt(b.html)+"</p>";else if(b.iframe_url)var d='<p class="wms-videowrapper">'+jt('<iframe width="480" height="270" src='+b.iframe_url+' frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');var e="<div id='wms-urlvideo-play' class='wms-urlvideo-play wms-hvalign'></div><div class='wms_default_thumbnail'></div>";b.thumbnailurl&&(e="<div id='wms-urlvideo-play' class='wms-urlvideo-play wms-hvalign'></div><img class='wms_default_thumbnail' src='"+b.thumbnailurl+"' />");var f='<img src="'+b.thumbnailurl+'" />',g=fR(c,{thumbnailimg:e,videoimg:f,thumbnailurl:b.thumbnailurl,iframe:d,urllink:b.url,urltitlelink:b.title,urlauthorurl:b.authorurl,urlproviderurl:b.faviconlink||b.providerurl+"/favicon.ico",urlauthor:b.authorname,urlprovider:b.providername},"InSecureHTML");return g}function jv(a){return a=be.replacer(be.getRegexToGetAttrValueInHtmlTag("iframe","width"),null,a,function(a,b,c,d,e,f){return b+"100%"+f}),a=be.replacer(be.getRegexToGetAttrValueInHtmlTag("iframe","height"),null,a,function(a,b,c,d,e,f){return b+"100%"+f}),a}function jw(a){var b=a.meta.linkdetails,c="<div class='wms-urlinfoouterdiv'><div class='wms-urlinfo'><img src=\"{{urlproviderurl}}\"><a href='{{urlproviderurl}}' target='_blank'>{{urlprovider}}</a></div><div class='wms-urlinfolink'><a href='{{urllink}}' target='_blank'>{{urltitlelink}}</a></div></div><div class='wms-media' data-playable='true' iframe='{{iframe}}'>{{audioframe}}</div>";if(b.html)var d=b.html,e=jv(b.html);else if(b.iframe_url)var f='<iframe width="480" height="270" src='+b.iframe_url+' frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>',e=jv(f);var g=fR(c,{thumbnailurl:b.thumbnailurl,iframe:f,audioframe:e,urllink:b.url,urltitlelink:b.title,urlauthorurl:b.authorurl,urlproviderurl:b.faviconlink||b.providerurl+"/favicon.ico",urlauthor:b.authorname,urlprovider:b.providername},"InSecureHTML");return g}function jx(a){var b='<div class="wms-imgmetamsgcontainer"><img data-previewable="true" data-dname="{{dname}}" data-fsender="{{sender}}" data-fdate="{{date}}" data-ftime="{{time}}" data-src="{{url}}" src="{{url}}"></img></div>';return fR(b,{url:a.meta.linkdetails.imgurl||a.meta.linkdetails.url,dname:a.dname,sender:a.sender,date:V(a.time),time:T(a.time)})}function jy(a){var b="";a.thumb&&(b='<div class="wms-filethumb wms-imgmsgcontainer" data-filethumbnail="true" data-previewable="true" > <img style="width:'+a.dim.width+"px;height:"+a.dim.height+'px;max-height:100%;pointer-events:none;" src="'+a.thumbnailurl+'" > </div>');var c="",d="false",e=a.content,f=a.fName.split(".")[1],g="",h="";if(jA(e,f)&&jz(a.size)){var i=a.previewurl;g='<iframe src="'+i+'"></iframe>',c='<div class="wms-attachmentpreview" data-attachment="true" data-previewable="{{previewable}}" src="{{iframehtml}}" data-fname="{{filename}}" data-furl="{{url}}" data-fsize="{{filesize}}" data-fcomment="{{comment}}" data-fsrc="{{url}}" data-fcontent="{{type}}" data-dname="{{dname}}" data-fsender="{{sender}}" data-fdate="{{date}}" data-isv1="{{isv1}}"  data-ftime="{{time}}" data-filefwd="{{forward}}" >{{preview}}</div>',d="true"}a.isFileForwardSupported&&(h='<div class="wms-fileforward" data-isv1="{{isv1}}" data-filefrwrd="{{forward}}" data-furl="{{url}}" data-fcontent="{{type}}" src="{{src}}" data-fname="{{filename}}" data-fsize="{{filesize}}" data-fcomment="{{comment}}" data-fsrc="{{url}}" href={{src}} title="{{forwardtitle}}"></div>');var j='<div class="wms-filefragcontainer">'+b+'<div class="wms-filemsgcontainer" data-previewable="{{previewable}}" data-filedesc="true">'+'<div class="wms-filemsgimg"></div>'+'<div class="wms-filedesc wms-truncate-ellipsis">'+'<div class="wms-filetitle wms-truncate-ellipsis" title="{{filename}}">{{filename}}</div>'+'<div class="wms-filesize">{{filesize}}'+c+"</div></div>"+'<div class="wms-attachmenticon-container"><a class="wms-filedownloadicon-container" href="{{src}}" download="{{filename}}">'+'<span class="wms-filedownload" title="{{filesize}}"></span>'+"</a>"+h;return j+="</div></div></div>",fR(j,{previewable:d,iframehtml:g,src:a.constructeddownloadurl||a.url,filename:a.fName,type:a.content||a.contenttype,filesize:a.size||"",url:a.url||a.fileurl,comment:a.commentmsg,isv1:a.isv1?!0:!1,$preview:"chat.clickpreview",dname:a.dname,sender:a.sender,date:V(a.time),time:T(a.time),$forwardtitle:"chat.forward",forward:a.isFileForwardSupported?!0:!1})}function jz(a){var b=parseFloat(a);return b>200&&a.match("MB")||a.match("GB")?!1:!0}function jA(a,b){var c=a.indexOf("text/")!==-1||a.indexOf("application/pdf")!==-1||a.indexOf("application/xml")!==-1;return c=c&&b!="svg"||jB(a,b),c}function jB(a,b){var c=["application/msword","application/vnd.oasis.opendocument.text","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/rtf","application/ooxml","application/vnd.ms-excel","application/vnd.oasis.opendocument.spreadsheet","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.sun.xml.calc","text/csv"],d=["docx","sxc"],e=["csv","tsv"];return c.indexOf(a)!=-1||"application/zip"===a&&d.indexOf(b)!=-1||"text/plain"===a&&e.indexOf(b)!=-1}function jI(){jG=!0}function jJ(){jG&&jO()}function jK(a){jF=!0;var b=bh.getItem("wms_draft_lmtime");a=="-1"||a==b?jE=!1:jE=!0,jL(a)}function jL(a){bh.setItem("wms_draft_lmtime",a)}function jM(a){return jD[a]}function jN(){var a=bh.getItem($WC.Config.get("zuid")+"_wms_drafts");return a}function jO(){var a=jN();!jE&&eu(jD)&&a&&(jD=a);if(jF&&!jH&&(jE||!a)){var b=function(a){var b=JSON.parse(a).data,c=b&&b.chats,d={};for(var e=0;e<c.length;e++){var f=c[e].draftmsginfo&&JSON.parse(c[e].draftmsginfo);d[c[e].chatid]=f,jP(c[e].chatid,f)}jQ(d,!0),jG=!1,jE=!1,jH=!1,eI.publish("drafts/updateui")},c=function(){jH=!1},d="drafts=true&joined=true";bs("v1/chats",d,b,c),jH=!0}}function jP(a,b){jD[a]={msg:b.msg,meta:b.meta,mtype:b.mtype,time:b.time},b.replied_to&&(jD[a].replied_to=b.replied_to)}function jQ(a,b){var c={};if(b)c=a;else{var d=jN();if(d){if(d[a.chid]&&d[a.chid].time==a.time)return;d[a.chid]=a,c=d}else c[a.chid]=a;jL(a.time)}bh.setItem($WC.Config.get("zuid")+"_wms_drafts",c)}function jR(a,b){if(jF){var c="message="+b.msg;b.replied_to&&(c+="&replied_to="+b.replied_to);var d=function(){var a=this.opts.callbackargs;jP(a.chid,a)};bt("v2/chats/"+a+"/draft",c,d,null,b)}}function jS(a){delete jD[a],jT(a)}function jT(a){var b=jN();b&&b[a]&&(delete b[a],jQ(b,!0))}function jU(a){if(jM(a)){var b={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":ex()};bv("v2/chats/"+a+"/draft",null,function(){jS(a)},null,null,null,b)}}function jV(a){var b=jM(a.objId);if(b&&b.msg===a.composer.value)return;var c=new FormData,d={message:a.composer.value,nocache:(new Date).getTime()},e=a.getReplyMessageId();e&&(d.replied_to=e);var f=ex();f=f.split("="),d[f[0]]=f[1];var g="/"+J.get("CHATCONT")+"/v2/chats/"+a.objId+"/draft";for(var h in d)c.append(h,d[h]);navigator.sendBeacon(g,c)}function kf(){var a=function(a){var b=JSON.parse(a).data;kd={};for(var c=0;c<b.length;c++){var d=b[c].id;kd[d]={title:"("+b[c].offset+") "+b[c].label,empty_img:!0,label:b[c].label,offset:b[c].offset,id:b[c].id,index:c}}};bs("v2/timezones","version=0",a)}function kj(){ki=!0}function kk(){ki=!1}function kl(){return ki}function kp(a,b,c,d){var e={"Content-Type":"application/json","x-consents-version":"1","X-XHR-exception":!0,"X-ZCSRF-TOKEN":ex()},f=function(a){var b=JSON.parse(a);b.status=="Success"&&b.output.type!="form_error"&&(b.output.isTempResponse=!0,c(b.chid,b.output.meta.message_source.id,b)),d(b)};bt("v2/forms/"+b+"/actions/submit",a,f,null,null,null,e)}function kq(a,b){var c=function(a){var c=JSON.parse(a);c.status=="Success"&&(c.output.isTempResponse=!0,b(c.chid,c.output.meta.message_source.id,c))};bt("v2/forms/"+a+"/actions/cancel",null,c,null,null,null)}function kr(a,b,c){var d={"Content-Type":"application/json","x-consents-version":"1","X-XHR-exception":!0,"X-ZCSRF-TOKEN":ex()},e=function(a){var b=JSON.parse(a);if(b.status=="Success")c(b);else if(b.status=="Consent"){var d=new cz;d.mountComponent(b.chid,b,function(a,b){c(b.data.dreResponse)})}};bt("v2/forms/"+b+"/actions/change",a,e,null,null,null,d)}function ks(a,b,c){var d={"Content-Type":"application/json","x-consents-version":"1","X-XHR-exception":!0,"X-ZCSRF-TOKEN":ex()};bt("v2/forms/"+b+"/actions/input",a,c,null,null,null,d)}function kx(a,b,c){var d="updatelinkpreviewsettings.do",e="authentication_consent="+a;bt(d,e,b,c)}"use strict";var b,c,d,e,f,g,h={},i=[],j=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;b={__e:function(a,b){for(var c,d;b=b.__;)if((c=b.__c)&&!c.__)try{if(c.constructor&&null!=c.constructor.getDerivedStateFromError&&(d=!0,c.setState(c.constructor.getDerivedStateFromError(a))),null!=c.componentDidCatch&&(d=!0,c.componentDidCatch(a)),d)return s(c.__E=c)}catch(b){a=b}throw a}},p.prototype.setState=function(a,b){var c;c=this.__s!==this.state?this.__s:this.__s=k({},this.state),"function"==typeof a&&(a=a(c,this.props)),a&&k(c,a),null!=a&&this.__v&&(this.__e=!1,b&&this.__h.push(b),s(this))},p.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),s(this))},p.prototype.render=o,c=[],d="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,f=h,g=0;var H={calendarcontainer:"mc266c4d21_calendarcontainer",mountedtop:"mc266c4d21_mountedtop",mountedbottom:"mc266c4d21_mountedbottom",month:"mc266c4d21_month",monthcnt:"mc266c4d21_monthcnt",yearpadding:"mc266c4d21_yearpadding",arrowright:"mc266c4d21_arrowright",arrowleft:"mc266c4d21_arrowleft",weekheader:"mc266c4d21_weekheader",dayscontainer:"mc266c4d21_dayscontainer",weekscontainer:"mc266c4d21_weekscontainer",weekheadercnt:"mc266c4d21_weekheadercnt",days:"mc266c4d21_days",daysprev:"mc266c4d21_daysprev",slideanimation:"mc266c4d21_slideanimation",slidein:"mc266c4d21_slidein",slideout:"mc266c4d21_slideout",selecteddate:"mc266c4d21_selecteddate",zmNightMode:"zmNightMode",dayscrnt:"mc266c4d21_dayscrnt"},I={},J={get:function(a){return I[a]},set:function(a){if(typeof a=="object")for(var b in a)I[b]=a[b]}},N=function(a){function b(b){a.call(this,b),this.calnode=null,this.starting_date=null,this.selected_element=null,this.setfocusafterswitch=!1;var c=new Date;b.selecteddate&&(c=new Date(b.selecteddate)),c.setHours(0,0,0,0),this.state={selected_date:c,initial_date:c},this.onDateSelection=this.props.onDateSelection,this.moveBackward=this.moveBackward.bind(this),this.moveForward=this.moveForward.bind(this),this.setCalendarDomNode=this.setCalendarDomNode.bind(this),this.updateSelectedDate=this.updateSelectedDate.bind(this),this.getWeeks=this.getWeeks.bind(this),this.setSelectedDateNode=this.setSelectedDateNode.bind(this),this.setStartingDate(this.state.initial_date)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setCalendarDomNode=function(b){this.calnode=b},b.prototype.setSelectedDateNode=function(b){b&&b.classList.contains(H.selecteddate)&&(this.selected_element=b)},b.prototype.componentWillUnmount=function(){this.calnode.classList.contains(H.slidein)&&this.calnode.classList.remove(H.slidein),this.calnode.classList.contains(H.slideout)&&this.calnode.classList.remove(H.slideout)},b.prototype.componentDidUpdate=function(b,c){var d="",e=c.initial_date.getMonth(),f=this.state.initial_date.getMonth(),g=c.initial_date.getFullYear(),h=this.state.initial_date.getFullYear();e<f?g>h?d="slidein":d="slideout":e>f&&(g<h?d="slideout":d="slidein"),this.selected_element&&(this.setfocusafterswitch?this.selected_element.focus():this.selected_element.blur()),this.setTransition(d)},b.prototype.setTransition=function(b){b!=""&&(this.calnode.classList.remove(H.slideout),this.calnode.classList.remove(H.slidein),this.calnode.getBoundingClientRect(),this.calnode.classList.add(H[b]))},b.prototype.setStartingDate=function(b){this.starting_date=new Date(b.getTime()),this.starting_date.setDate(1),this.starting_date.setDate(this.starting_date.getDate()-this.starting_date.getDay())},b.prototype.switchMonth=function(b){if(this.state.initial_date.getTime()<b.getTime())return this.getNextInitialDate();if(this.state.initial_date.getTime()>b.getTime())return this.getPreviousInitialDate()},b.prototype.updateSelectedDate=function(b){var c=13,d=32;this.setfocusafterswitch=!1;if(b.type==="keydown"&&(b.keyCode===c||b.keyCode===d)||b.type=="click"){var e=new Date(this.starting_date.getTime()),f=this.state.initial_date,g=b.target.getAttribute("data-id");e.setDate(this.starting_date.getDate()+parseInt(g)),e.getMonth()!=this.state.initial_date.getMonth()&&(f=this.switchMonth(e),this.setfocusafterswitch=!0),this.setState({selected_date:e,initial_date:f}),this.onDateSelection(e)}},b.prototype.getNextInitialDate=function(){var b=new Date(this.state.initial_date.getTime());return b.setMonth(b.getMonth()+1),b.setDate(1),this.setStartingDate(b),b},b.prototype.getPreviousInitialDate=function(){var b=new Date(this.state.initial_date.getTime());return b.setMonth(b.getMonth()-1),b.setDate(1),this.setStartingDate(b),b},b.prototype.moveForward=function(){this.setState({initial_date:this.getNextInitialDate()})},b.prototype.moveBackward=function(){this.setState({initial_date:this.getPreviousInitialDate()})},b.prototype.getWeeks=function(){var b=new Date(this.starting_date),c=this.state.initial_date.getMonth(),d=[],e=0,f=this.state.selected_date,g=new Date(b.getTime());g.setHours(0,0,0,0);for(var h=0;h<6;h++){var i=[];for(var j=0;j<7;j++){var k=" "+H.dayscrnt;g.getMonth()!=c&&(k=" "+H.daysprev);var l="";f.getTime()===g.getTime()&&(l=" "+H.selecteddate),i.push(m("div",{key:g.getMonth()+""+g.getDate(),tabindex:"0","data-id":e++,"class":H.days+k+l,ref:this.setSelectedDateNode,onclick:this.updateSelectedDate,onkeydown:this.updateSelectedDate},g.getDate())),g.setDate(g.getDate()+1)}d.push(m("div",{"class":H.dayscontainer}," ",i," "))}return m("div",{"class":H.weekscontainer},d)},b.prototype.render=function(b,c){var d=b.mounttop?H.mountedtop:H.mountedbottom;return m("div",{"class":H.calendarcontainer+" "+d},m("div",{"class":H.month},m("button",{"class":H.arrowleft,onclick:this.moveBackward}),m("div",{"class":H.monthcnt},m(M,{month_number:this.state.initial_date.getMonth()}),", ",m("span",{"class":H.yearpadding},this.state.initial_date.getFullYear())),m("button",{"class":H.arrowright,onclick:this.moveForward})),m(L,null),m("div",{ref:this.setCalendarDomNode},this.getWeeks()))},b}(p),O={mountComponent:function(b,c){G(m(N,{onDateSelection:c}),b)}},P={notifications:{},close:function(b){this.notifications[b]!==undefined&&(this.notifications[b].notifyobj.close(),clearTimeout(this.notifications[b].timer),delete this.notifications[b])},requestPermission:function(){typeof Notification!="undefined"&&Notification.permission==="default"&&Notification.requestPermission()},show:function(b){if(typeof Notification!="undefined"&&Notification.permission==="granted"){if(b.checkownership&&b.checkownership.isOwner()===!1)return;b.tag=b.id,this.close(b.id),this.notifications[b.id]===undefined&&(this.notifications[b.id]={});var c=new Notification(b.title,b);return this.notifications[b.id].notifyobj=c,b.duration&&(this.notifications[b.id].timer=setTimeout(function(){this.close(b.id)}.bind(this),b.duration)),c.onclick=function(a){window.focus(),typeof b.onclick=="function"&&b.onclick.call(c,a),this.close(b.id)}.bind(this),c}}},Q={parentcomponent:"mcd44f5b7f_parentcomponent",borderallside:"mcd44f5b7f_borderallside",datepickercontainer:"mcd44f5b7f_datepickercontainer",mountedbottom:"mcd44f5b7f_mountedbottom",mountedtop:"mcd44f5b7f_mountedtop",calendarposition:"mcd44f5b7f_calendarposition",datecnt:"mcd44f5b7f_datecnt",placeholder:"mcd44f5b7f_placeholder",calendaricon:"mcd44f5b7f_calendaricon",calendarviaforms:"mcd44f5b7f_calendarviaforms",calendarwidth:"mcd44f5b7f_calendarwidth",zmNightMode:"zmNightMode"},R=function(a){function b(b){a.call(this,b),this.setContainerNode=this.setContainerNode.bind(this),this.clickOutsideListener=this.clickOutsideListener.bind(this),this.onClickOutside=this.props.onClickOutside}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setContainerNode=function(b){this.containernode=b},b.prototype.clickOutsideListener=function(b){this.containernode&&!this.containernode.contains(b.target)&&this.onClickOutside(b)},b.prototype.componentDidMount=function(){window.addEventListener("click",this.clickOutsideListener)},b.prototype.componentWillUnmount=function(){window.removeEventListener("click",this.clickOutsideListener)},b.prototype.render=function(b){return m("div",{ref:this.setContainerNode},b.children)},b}(p),_=Object.freeze({__proto__:null,formatTime:T,formatDTTime:U,formatDate:V,isSameDay:W,formatDateWithWords:X,getOtherZoneTime:Y,relativeTimeLeft:Z,formatTime24hr:$}),bd=Object.freeze({__proto__:null,set:ba,get:bb,remove:bc}),be={regexes:{gmail:/^[A-Za-z0-9](\.?[A-Za-z0-9]){5,}@gmail\.com$/,facebook:/^[A-Za-z0-9\.]+$/,yahoo:/^[A-Za-z0-9]((\.|_)?[A-Za-z0-9]){5,}@(yahoo|ymail|rocketmail)\.com$/,msn:/^[A-Za-z0-9-_](\.?[A-Za-z0-9-_]){5,}@(outlook|hotmail|live)\.com$/,edge_useragent_lowercase:/edge\/(\d+)/,chrome_useragent_lowercase:/(?:chrome|crios)\/(\d+)/,firefox_useragent_lowercase:/(?:firefox|fxios)\/(\d+)/,opera_useragent_lowercase:/(?:^opera.+?version|opr)\/(\d+)/,ie_useragent_lowercase:/(?:msie |trident.+?; rv:)(\d+)/,safari_useragent_lowercase:/version\/(\d+).+?safari/,qq:/^[0-9]+$/,icq:/^[0-9]+$/,emailid:/^[A-Za-z0-9]([A-Za-z0-9-._%+']*)@[A-Za-z0-9-.]+\.[a-zA-Z]{2,30}$/,empty:/^\s*$/,hexcolourcode:/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,customdate:/^(0?[1-9]|1[012])\/(0?[1-9]|[12][0-9]|3[01])\/([0-9]{1,4})$/,time:/^(0?[1-9]|1[012])(:[0-5]\d)[APap][mM]$|^([01]?[0-9]|2[0-3]):[0-5]\d$/,escaperegexp:/[-[\]{}()*+?.,\\^$|#\s]/g,escapeReplacementString:/\$/g,removespaces:/ /g,removehtmltag:/<([a-z0-9]+)(?:.*?)(?:>(?:([\s\S]*?)<\/\1>)?)/g,containerid:/[^a-zA-Z0-9]/g,mail:/([a-z0-9]([a-z0-9_\-.+]*)@([a-z0-9_\-.]*)(\.[a-z]{2,30}(\.[a-z]{2}){0,2}))/,link:/(?:(href|src)=["']?)?((https?:\/\/(?:www\.)?|www\.)[a-z0-9][^@]*?)(?=[\s"'<]|$)/gi,markdown_image:/(^|\s)!\[(.+?)\]\(((?:https?:\/\/(?:www\.)?|www\.)[a-z0-9][^@ ]*?)\)(?=$|\s)/gi,markdown_link:/(^|\s|<br>)\[((?:(?!\]\(.+?\)).)+?)\]\(((https?:\/\/(?:www\.)?|www\.)[a-z0-9][^@ ]*?)\)(?=$|\s|\.|\,|\n|<br>|<span)/gi,markdown_quote:/(?:^|\n)!(.+?)(?:\n|$)/gm,markdown_heading:/(?:^|\n)(\#{1,6}) (.*?\S *)(?:\n|$)/gm,markdown_line:/(^|[\n])(\*{3,}|\-{3,})(?=$|[\n])(.*)/g,markdown_codeblock:/(^|\s)`{3}((?:(?:.*?$)\n)?(?:[\s\S]*?))`{3}(?=$|\s)/g,markdown_code:/(^|\s)\`(.*?\S *)?\`(?=$|\s)/g,markdown_bold:/(|^|\s|[{\[])\*(.*?\S *)?\*(?=$|\s|<br>|[\.,\?:;\-}\]](?:$|\s))/g,markdown_italic:/(^|\s|[{\[])\_(.*?\S *)?\_(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_strike:/(^|\s|[{\[])\~(.*?\S *)?\~(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_underscore:/(^|\s|[{[])__(.*?\S *)?__(?=$|\s|[.,?:;\-}\]](?:$|\s))/g,atmention:/{mention:(.+?):([0-9]):(.+?):mention}/g,zcatmention:/{mention:(.*?):mention}/,atmention_for_transcript:/<div prop="mention"(.*?)>(.*?)<\/div><span prop="dname">(.*?)<\/span>/g,addmember:/{addchatmember:(.+?):([0-9]):(.+?):addchatmember}/g,addmember_for_transcript:/<div prop="addchatmember"(.*?)>(.*?)<\/div><span prop="dname">(.*?)<\/span>/g,deletemember:/{deletechatmember:(.+?):([0-9]):(.+?):deletechatmember}/g,deletemember_for_transcript:/<div prop="deletechatmember"(.*?)>(.*?)<\/div><span prop="dname">(.*?)<\/span>/g,text_doublequoted:/(^|\s|[{\[])\"(.*?\S *)?\"(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,text_singlequoted:/(^|\s|[{\[])\'(.*?\S *)?\'(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,addchatmember:/{addchatmember:(.*?):addchatmember}/g,deletechatmember:/{deletechatmember:(.*?):deletechatmember}/g,atmentiontemplate:/<div.*?prop="(mention|addchatmember|deletechatmember)"(.*?)>(.*?)<\/div><span prop="dname">(.*?)<\/span>/,imagemimetype:/^image\/.+$/,audiomimetype:/^audio\/.+$/,videomimetype:/^video\/.+$/,ipaddress:/^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$/,invalidfilenamechars:/[`~!\$%\^&\|\\\"<>\?\/]/g,chrome_useragent:/Chrome[\/\s]/g,domainurl:/((?:https?:\/\/)(?:www\.)?((?:[^\/]+)))(?:.*)/g,textpattern:/^[0-9a-zA-Z_\-#\&\,\.';\$@\?\,\:\+\%\^\*\(\)\`\|\\\=\/\!\[\]~\{\}\u0080-\u9fff\s]+$/,linkRegExp:/(((http(s){0,1}:\/\/))([^ <\n\"]*))/,invalidlink:/((href|src)=["']((http(s){0,1}:\/\/)|(www\.))([^ <\n]*))/,WWWlinkRegExp:/([^(href|src|\/\/)"'=])?((www\.)([^ <\n\"]*))/,zcWWWlinkRegExp:/((www\.)[a-z0-9][^@]*?)(?=&quot;|&#x27;|&lt;|[\s"')<]|$)/,threeletterendinglink:/(^|\ )(([\w\d-]+\.)+(com|org|net|int|edu|gov|mil|biz|info))(?=( |$))/,twoletterendinglink:/(^|\ )(([\w\d\-]+\.)+((?!js|cp|do)[a-z]){2})(?=( |$))/,escaperegexpinid:/([:\.\[\],\!\"\#\$@%\&\'\(\)\*\+\/\;\?\^\`\{\}\|\~])/g,commandpattern:/^([a-zA-Z])*$/,functionname:/^([a-zA-Z])*$/,removespecialchars:/(\s+)?[-~!@%&[\]{}<>()*+?.,_\/\\^$|:;'`"#\s](\s+)?/g,imagesize:/^(stamp|thumb|medium|original)$/,horizontal_rule_tag:/<hr>/,markdown_blockquote_html:/<blockquote>(.*?)<\/blockquote>/,markdown_codeblock_html:/<pre>(.*?)<\/pre>/,channelpermalink:/^\/channel\/((ext:)?[a-zA-Z])*$/,usersilentmention:/\[((?:(?!\]\(.+?\)).)+?)\](?:\(zohoid:([0-9]+?)\)|\(mail:([a-z0-9][a-z0-9_\-.+]*@[a-z0-9_\-.]*\.[a-z]{2,30}(?:\.[a-z]{2}){0,2})\))/g,phonenumber:/^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*$/,pincode:/^([A-Z0-9\-\. ])+$/,zcatmention_v2:/{[\+|\-]?[@#](.*?)}/g,markdown_instantbutton:/\[(\+|\-)?((?:(?!\]\(.+?\)).)+?)\]\(\$(\d+)\)/g,messagelinkregex:/\/chats\/([a-zA-Z0-9\-_]+)\/messages\/([a-zA-Z0-9_%\-]+)/,invalid_textpattern_chars:/[\"<>]/},regexReplaceStr:{escapeReplacementString:"$$$",escaperegexp:"\\$&",escaperegexpinid:"\\$1",removespaces:"",trimBRtag:"",containerid:"",mail:"<a href='mailto:$1'>$1</a>"},check:function(a,b,c){return c&&b&&(b=b.trim()),this.regexes[a].lastIndex=0,this.regexes[a].test(b)},checkWithFlag:function(a,b,c,d){d&&b&&(b=b.trim()),this.regexes[a].lastIndex=0;var e=new RegExp(this.regexes[a].source,c);return e.test(b)},match:function(a,b,c){var c=typeof c!="undefined"?c:"g",d=new RegExp(this.regexes[a].source,c);return b.match(d)},replacer:function(a,b,c,d){return typeof d=="undefined"&&(d=this.regexReplaceStr[b]),c.replace(a,d)},replace:function(a,b,c){return this.replacer(this.regexes[a],a,b,c)},replaceWithFlag:function(a,b,c,d){var e=new RegExp(this.regexes[a].source,c);return this.replacer(e,a,b,d)},getRegexToGetAttrValueInHtmlTag:function(a,b){return new RegExp("(<("+a+")[^>]*?\\s"+b+"=(\"|'|\\\\\"|\\\\'))(\\S+)((\\3)([^>]*?(?:>(?:[^<]*?<\\/\\2>)?)))")},getRegexToAddAttrToHtmlTag:function(a){return new RegExp("(<("+a+"))([^>]*?(\\s\\S+=\\S+)?>(?:(?:[^<]*?)<\\/\\2>)?)")}},bf=function(b){b==="session"?this.storage=sessionStorage:b==="local"&&(this.storage=localStorage)};bf.prototype.setItem=function(b,c){return this.storage.setItem(b,JSON.stringify(c))},bf.prototype.removeItem=function(b){return this.storage.removeItem(b)},bf.prototype.getItem=function(b){var c=this.storage.getItem(b);return c=c!=""?c:null,JSON.parse(c)},bf.prototype.setChatInfo=function(b){var c=""+b.chid,d=this.getItem("wms_openchats"),e=!1;if(d===null)this.setItem("wms_openchats",[b]);else{for(var f=0;f<d.length;f++)if(d[f].chid===c){for(var g in b)d[f][g]=b[g];e=!0}e===!1&&d.push(b),this.setItem("wms_openchats",d)}},bf.prototype.getChatInfo=function(b,c){b=""+b;var d=this.getItem("wms_openchats");if(d===null)return null;for(var e=0;e<d.length;e++)if(d[e].chid===b&&d[e][c])return d[e][c];return null},bf.prototype.removeChatState=function(b){b=""+b;var c=this.getItem("wms_openchats");for(var d=0;d<c.length;d++)if(c[d].chid===b){c.splice(d,1);break}c.length===0?this.removeItem("wms_openchats"):this.setItem("wms_openchats",c)};var bg=new bf("session"),bh=new bf("local"),bi=function(){this.tableToRowList={},this.tableArray=[]};bi.prototype.containsTable=function(b){var c=this.tableArray.length;for(var d=0;d<c;d++)if(this.tableArray[d]==b)return!0;return!1},bi.prototype.getRowsForTable=function(b){return this.tableToRowList[b]},bi.prototype.addNewTable=function(b){this.tableArray.push(b),this.tableToRowList[b]=[];return},bi.prototype.addRowsForTable=function(b,c){this.containsTable(b)||this.addNewTable(b);var d=this.tableToRowList[b];return d[d.length]=this.createRow(c),!0},bi.prototype.createRow=function(b){var c={};for(var d=0;d<b.length;d++)c[b[d][0]]=b[d][1];return c};var bz=Object.freeze({__proto__:null,_makeRequest:bj,_getRequest:bk,_postRequest:bl,_putRequest:bm,_deleteRequest:bn,request:bo,postRequest:bp,putRequest:bq,deleteRequest:br,requestToChat:bs,postRequestToChat:bt,putRequestToChat:bu,deleteRequestToChat:bv,postRequestToChatWithLocation:bw,callbackDispatcher:bx,getObject:by}),bA={CHATCFPARAMNAME:"zchat_csrparam",WMSCFPARAMNAME:"wms_csrparam",CHATCFCOOKIENAME:"CT_CSRF_TOKEN",WMSCFCOOKIENAME:"WMS_CSRF_TOKEN",WMSCONT:"_wms",WMSCHATURL:window.location.protocol+"//cliq.zoho.com/",REQSTATUS:{LOADING:1,SUCCESS:2,FAILED:3,NORESULTS:4,INITIALSTATE:5},KEYCODES:{BACKSPACE:8,TAB:9,LEFT:37,UP:38,RIGHT:39,DOWN:40,ESCAPE:27,ENTER:13,SPACE:32},TRIGGERS:{ADDMEM:"+",DELMEM:"-",ATMENTION:"@",SMILEY:":",SLASH:"/"},CONTACTSTATUS:{UNAPRD:-1,REJECT:-2,REQACC:-3,DELETE:-4,REMOVE:-5,NOCHAT:-6,ACCEPT:10},USERPERMISSIONS:{ADD_MEMBER:6,REMOVE_MEMBER:7,SEND_MESSAGE:8,MENTION_USERS:9,STICKY_MESSAGE:20},USERROLES:{SUPER_ADMIN:0,ADMIN:1,CREATOR:2,MODERATOR:3,PARTICIPANT:4,ALLOWED_USER:5,NONE:-1},CHANNELS:{ORG:"1",TEAM:"2",PRIVATE:"3",SHARED:"4"},TEMPUSERSTATUS:{OFFLINE:"5",ORGCONTACT:"6"},CHATTYPES:{CHANNEL:1,DEFAULT_BOT:"B1",CUSTOM_BOT:"B2"},HYBRIDSEARCH:{CHANNEL:1,CHAT:2,CONTACT:3,DEFAULTRESULT:4,EMPTY:5,FREQCONTACTS:6,GENERICLIST:7,GROUP:8,MESSAGEHINT:9,ORGCONTACT:10,TITLEHINT:11,USERLIST:12,EMPTYUSERHINT:13,EMPTYTITLEHINT:14,EMPTYMSGHINT:15,ADDCONTACT:16,USER_CHANNELLIST:17,CHANNELLIST:18,BOT:19,CUSTOMCONTACTLIST:20,JOINEDCHANNEL:21,modules:{CONTACTMENU:1,GROUPMENU:2,CHATMENU:3,SMARTCHAT:4,FILEFWD:5,CUSTOMCONTACTMENU:6}}},bB={},bC={result:[],noresult:[]},bD=!1,bT=Object.freeze({__proto__:null,isSuggestionsRequested:bE,getOrgContactsList:bF,setOrgContactsList:bG,updateList:bH,handleFailure:bI,_constructParams:bJ,getContacts:bK,fetchFromServer:bL,isCachedRequest:bM,checkAndUpdateContactsList:bN,pullContactsListFromLocalStorage:bO,putContactsListInLocalStorage:bP,removeContactsListFromLocalStorage:bQ,isEmptyResultReq:bR,updateDisplayName:bS}),bU={overlay:"mcf1ee8b17_overlay",container:"mcf1ee8b17_container",wms_dialog_container:"mcf1ee8b17_wms_dialog_container",close:"mcf1ee8b17_close",header:"mcf1ee8b17_header",wms_dialog_header:"mcf1ee8b17_wms_dialog_header",heading:"mcf1ee8b17_heading",footer:"mcf1ee8b17_footer",wms_dialog_footer:"mcf1ee8b17_wms_dialog_footer",button:"mcf1ee8b17_button",aligncenter:"mcf1ee8b17_aligncenter",alignend:"mcf1ee8b17_alignend",destructive_button:"mcf1ee8b17_destructive_button",confirmation_button:"mcf1ee8b17_confirmation_button",wms_dialogtext:"mcf1ee8b17_wms_dialogtext",wms_dialog_imgouter:"mcf1ee8b17_wms_dialog_imgouter",wms_dialog_imginner:"mcf1ee8b17_wms_dialog_imginner",wms_dialog_img:"mcf1ee8b17_wms_dialog_img",wms_dialog_txtcont:"mcf1ee8b17_wms_dialog_txtcont",wms_dialog_contentwrapper:"mcf1ee8b17_wms_dialog_contentwrapper",wms_dialog_txttitle:"mcf1ee8b17_wms_dialog_txttitle",wms_dialog_content:"mcf1ee8b17_wms_dialog_content",zmNightMode:"zmNightMode"},bV={focusoff:"mc4b6e3fc0_focusoff",focuson:"mc4b6e3fc0_focuson",button:"mc4b6e3fc0_button",icon:"mc4b6e3fc0_icon"},bW=function(a){function b(){a.call(this),this.state={clicked:!1},this.onButtonPress=this.onButtonPress.bind(this),this.setClickedState=this.setClickedState.bind(this),this.onBlur=this.onBlur.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setClickedState=function(){this.focusclass=bV.focusoff,this.setState({clicked:!0})},b.prototype.onBlur=function(){this.focusclass=bV.focuson,this.setState({clicked:!1})},b.prototype.onButtonPress=function(b){b.type==="click"&&this.props.onclick&&this.props.onclick(b);var c=13,d=32;b.type==="keydown"&&(b.keyCode===c||b.keyCode===d)&&this.props.onclick(b)},b.prototype.render=function(b){var c=b.classname+" "||"",d=b.tabindex||"0",e="",f="",g=(this.state.clicked?bV.focusoff:bV.focuson)+" ",h=b.children,i="";b.type==="button"&&(e=bV.button+" ",h=b.content),b.type==="icon"&&(e=bV.icon+" ",f=String.fromCharCode(parseInt(b.content,16))),b.size>=1&&(i=bV[b.type+"size"+b.size]);var j="";return b.theme>=1&&(j=bV["theme"+b.theme]+" "),m("div",{"data-content":f,title:b.title,"class":e+c+g+j+i,tabindex:d,style:b.style,onblur:this.onBlur,onclick:this.onButtonPress,onmouseover:this.props.onmouseover,onmousedown:this.setClickedState,onmouseout:this.props.onmouseout,onkeydown:this.onButtonPress},h)},b}(p),bX={mountComponent:function(b,c,d,e,f,g,h){G(m(bW,{type:c,size:d,content:e,theme:f,title:h,"class":g}),b)}},bY=function(a){function b(){a.call(this),this.destroy=this.destroy.bind(this),this.setContainerNode=this.setContainerNode.bind(this),this.container=null,this.escapeListener=function(a){var b=document.querySelectorAll("."+bU.overlay);b[b.length-1]===this.container&&a.keyCode===27&&(this.props.callbackOnClose&&this.props.callbackOnClose(),this.destroy(),a.stopImmediatePropagation(),a.stopPropagation())}.bind(this),document.addEventListener("keydown",this.escapeListener,!1)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.destroy=function(){this.props.nodeToBeFocusedOnClose&&this.props.nodeToBeFocusedOnClose.focus(),document.removeEventListener("keydown",this.escapeListener,!1)},b.prototype.setContainerNode=function(b){this.container=b},b.prototype.componentDidMount=function(){this.props.ignoreFocusOnMount||this.container.focus()},b.prototype.componentWillUnmount=function(){this.destroy()},b.prototype.render=function(b,c){if(c.dialogcontent===null)return null;var d=b.customDialogStyles?b.customDialogStyles.customContainerStyle:bU.container,e=b.customDialogStyles?b.customDialogStyles.customHeaderStyle:bU.header,f=b.customDialogStyles&&b.customDialogStyles.customButtonStyle?b.customDialogStyles.customButtonStyle:bU.close,g=b.customDialogStyles?b.customDialogStyles.customWrapperStyle:"",h=b.customDialogStyles&&b.customDialogStyles.customFooterStyle?b.customDialogStyles.customFooterStyle:bU.footer,i=m("div",{"data-dialogwrapper":"true","class":g},b.children),j=b.actions&&b.actions.map(function(a,b){a.buttonstyle=bU[a.buttonstyle]?bU[a.buttonstyle]:a.buttonstyle;var c=a.buttonstyle?a.buttonstyle:bU.aligncenter;return m(bW,{key:b,type:"button",content:a.text,classname:c,onclick:a.onclick,onkeydown:a.onclick})});return m("div",{tabindex:"0",ref:this.setContainerNode,"class":bU.overlay,style:{zIndex:J.get("zindex")}},m("div",{"class":d},m("div",{"class":e},b.heading,m(bW,{onclick:this.props.callbackOnClose,type:"icon",content:"e634",classname:f})),this.props.headerinfosuffix,i,m("div",{"class":h},b.footerinfoprefix,j,b.footerinfosuffix)))},b}(p),b$=function(b){this.module=b.type,this.id=b.id,this.name=b.name,this.photo_id=b.photo_id,b.store_appid&&(this.store_appid=b.store_appid,this.store_appname=b.store_appname)};b$.prototype.getModule=function(){return this.module},b$.prototype.getID=function(){return this.id},b$.prototype.getObject=function(){switch(this.module){case"command":return Commands.getObject(this.id)}},b$.prototype.getName=function(){var b=this.getObject(),c=this.name;return typeof b!="undefined"&&(c=b.name),this.module==="command"&&!c.startsWith("/")&&(c="/"+c),c},b$.prototype.getImageURL=function(){switch(this.module){case"command":return Commands.getImgUrl(this.id,this.photo_id);case"bot":return de(this.id,this.photo_id);case"application":return _WMSCHATURL+"appimg/"+this.photo_id+"/photo.do"}},b$.prototype.getCreatorName=function(){var b=this.getObject();if(typeof b!="undefined")return eB(b.creator,b.creator_name)},b$.prototype.getStoreAppId=function(){var b=this.getObject();return b&&b.appid?b.appid:this.store_appid},b$.prototype.getStoreAppName=function(){var b=this.getObject();return b&&b.appdetails?b.appdetails.name:this.store_appname};var cu=Object.freeze({__proto__:null,apply:b_,applyOnce:ca,applyRecursive:cb,getImageHTML:cc,getInstantButtonHTML:cd,getLinkHTML:ce,getQuoteHTML:cf,getHeadingHTML:cg,getLineHTML:ch,getCodeblockHTML:ci,putDummyCodeBlock:cj,replaceDummyCodeBlock:ck,replaceInstantButton:cl,replaceInstantButtonWithLabel:cm,getCodeHTML:cn,getBoldHTML:co,getItalicHTML:cp,getStrikeHTML:cq,getUnderscoreHTML:cr,encodeChars:cs,decodeChars:ct}),cv={description:"mc772a21ad_description",item:"mc772a21ad_item",detailsicon:"mc772a21ad_detailsicon",embedimg:"mc772a21ad_embedimg",delugeicon:"mc772a21ad_delugeicon",slideup:"mc772a21ad_slideup",slidedown:"mc772a21ad_slidedown",consentlist:"mc772a21ad_consentlist",dashedbox:"mc772a21ad_dashedbox",detailsfield:"mc772a21ad_detailsfield",botdialog_title:"mc772a21ad_botdialog_title",relative_container:"mc772a21ad_relative_container",consent_view_link:"mc772a21ad_consent_view_link",consent_hide_link:"mc772a21ad_consent_hide_link",consent_name:"mc772a21ad_consent_name",consent_desc:"mc772a21ad_consent_desc",remember_note:"mc772a21ad_remember_note",consent_headerimg:"mc772a21ad_consent_headerimg",consent_headertitle:"mc772a21ad_consent_headertitle",consent_header:"mc772a21ad_consent_header",consent_content:"mc772a21ad_consent_content",bullets:"mc772a21ad_bullets",extensionwrapper:"mc772a21ad_extensionwrapper",allowextn_text:"mc772a21ad_allowextn_text",customcheckbox:"mc772a21ad_customcheckbox",customcheckboxsel:"mc772a21ad_customcheckboxsel",extension_consents:"mc772a21ad_extension_consents",extn_container:"mc772a21ad_extn_container",consents_container:"mc772a21ad_consents_container",consentscontainer:"mc772a21ad_consentscontainer",loading:"mc772a21ad_loading",loadingicon:"mc772a21ad_loadingicon",grantedconsents:"mc772a21ad_grantedconsents",scopeheader:"mc772a21ad_scopeheader",scopepermissions:"mc772a21ad_scopepermissions",scopeinfo_wrapper:"mc772a21ad_scopeinfo_wrapper",scopeinfo:"mc772a21ad_scopeinfo",scopeinfoheader:"mc772a21ad_scopeinfoheader",scopeinfocontent:"mc772a21ad_scopeinfocontent",authenticationContainer:"mc772a21ad_authenticationContainer",header_wrapper:"mc772a21ad_header_wrapper"},cw=function(a){function b(b){a.call(this,b),this.toggleConsentsVerboseDetails=this.toggleConsentsVerboseDetails.bind(this),this.setConsentsVerboseDetailsNode=this.setConsentsVerboseDetailsNode.bind(this),this.setConsentsDetailsNode=this.setConsentsDetailsNode.bind(this),this.consentsVerboseDetails=this.consentsVerboseDetails.bind(this),this.consentsComponentDetails=this.consentsComponentDetails.bind(this),this.consentsVerboseDetailsNode=null,this.consentsDetailsNode=null,this.state={expanded_view:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setConsentsVerboseDetailsNode=function(b){this.consentsVerboseDetailsNode=b},b.prototype.setConsentsDetailsNode=function(b){this.consentsDetailsNode=b},b.prototype.toggleConsentsVerboseDetails=function(){this.state.expanded_view?this.setState({expanded_view:!1}):this.setState({expanded_view:!0})},b.prototype.componentDidUpdate=function(){var b=this.consentsVerboseDetailsNode;if(this.state.expanded_view){b.style="",b.style.display="block";var c=this.consentsDetailsNode,d=function(){setTimeout(function(){fb(c,{block:"start",behavior:"smooth"})},100)},e=b.getBoundingClientRect().height;eQ(b,"height",0,e,d)}else{var f=b.getBoundingClientRect().height;eQ(b,"height",f,0)}},b.prototype.consentsVerboseDetails=function c(a){var c=[];for(var b=0;b<a.length;b++){var d=cx(a[b].text);c.push(m("div",{"class":cv.description},m("span",{"class":cv.bullets,dangerouslySetInnerHTML:{__html:d}}),this.consentsComponentDetails(a[b].components)))}return c},b.prototype.consentsComponentDetails=function d(a){var d=[];if(!eM(a))for(var b=0;b<a.length;b++)d.push(m("span",{"class":cv.bullets},a[b]));return d},b.prototype.render=function(){var b=this.props.classname,c=this.props.consentsInfo.details,d=cx(this.props.consentsInfo.title),e=cx(this.props.consentsInfo.description),f=this.state.expanded_view?cv.slideup:cv.slidedown;return m("div",{onclick:this.toggleConsentsVerboseDetails.bind(this),ref:this.setConsentsDetailsNode,"class":cv.item},m("span",{"class":b}),m("div",{"class":cv.consent_content},m("div",{"class":cv.consent_name,dangerouslySetInnerHTML:{__html:d}}),m("div",{"class":cv.consent_desc,dangerouslySetInnerHTML:{__html:e}}),m("div",{ref:this.setConsentsVerboseDetailsNode,"class":cv.consentlist},m("div",{"class":cv.dashedbox},this.consentsVerboseDetails(c)))),m("span",{"class":f}))},b}(p),cy=function(a){function b(b){a.call(this,b),this.extensionConsentsNode=null,this.grantedConsentsNode=null,this.allowExtensionNode=null,this.toggleExtensionConsents=this.toggleExtensionConsents.bind(this),this.setExtensionConsentsNode=this.setExtensionConsentsNode.bind(this),this.setGrantedConsentsNode=this.setGrantedConsentsNode.bind(this),this.setAllowExtensionNode=this.setAllowExtensionNode.bind(this),this.integrationsdata=new b$(b.response.message_source||b.response.data.extension),this.state={allow_extension:!1,view_extension:!1,extension_resp:{},view_dialog:!0,loading_consents:!1,granted_consents:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setExtensionConsentsNode=function(b){this.extensionConsentsNode=b},b.prototype.setGrantedConsentsNode=function(b){this.grantedConsentsNode=b},b.prototype.setAllowExtensionNode=function(b){this.allowExtensionNode=b},b.prototype.getConsentsWindow=function(b,c,d){var e=[],f=[],g=[];if(b.resumeUrl){var h=[];if(typeof b.connectionDetails.scope!="undefined")for(var i in b.connectionDetails.scope){var j=b.connectionDetails.scope[i],k=j["Scope Name"];j["Scope Value"]&&k&&k.indexOf("/")>0&&(k.indexOf("Zoho")==0||k.indexOf("DRE/")==0)&&h.push(m("div",{"class":cv.scopeinfocontent},cx(j["Scope Value"])))}if(!h.length)return null;var l=K("app.req.scopes",[cx(b.connectionDetails.name)]);f.push(m("div",{"class":cv.scopeinfo_wrapper},m("div",{"class":cv.scopeinfo},m("div",{"class":cv.scopeinfoheader,dangerouslySetInnerHTML:{__html:l}}),h)))}else if(this.state.granted_consents===!1){var n=K("platformconsents.brief","<b>"+cx([this.integrationsdata.name])+"</b>");g.push(m("div",null,m("div",{"class":cv.botdialog_title,dangerouslySetInnerHTML:{__html:n}}),m("div",{"class":cv.consents_container},m("div",null,this.getConsents(b.consents)))))}else!eu(b.granted_consents)&&!this.integrationsdata.store_appid&&e.push(m("div",{"class":cv.granted_consents},m("div",{"class":cv.botdialog_title},K("platformconsents.granted.brief")),m("div",{consents_container:!0,"class":cv.relative_container},m("div",null,this.getConsents(b.granted_consents)))));var o=this.integrationsdata.store_appid?this.integrationsdata.store_appid:"";return m("div",{"class":cv.consentscontainer,"data-consentkey":c,"data-chid":d,"data-store_appid":o,"data-loadingstate":this.state.loading_consents},m("div",{"class":cv.loading},m("div",{"class":cv.loadingicon})),g,e,f)},b.prototype.getConsents=function(b){var c=[];return b.variables&&!eu(b.variables)&&c.push(m(cw,{classname:cv.detailsicon,consentsInfo:b.variables})),b.deluge_tasks&&!eu(b.deluge_tasks)&&c.push(m(cw,{classname:cv.delugeicon,consentsInfo:b.deluge_tasks})),b.api_calls&&!eu(b.api_calls)&&c.push(m(cw,{classname:cv.embedimg,consentsInfo:b.api_calls})),c},b.prototype.getConsentsHeader=function(b){if(b.resumeUrl){var c=K("app.req.permission",["<b>"+cx(b.connectionDetails.name)+"</b>","<b>"+cx(b.connectionDetails.serviceName)+"</b>"]);return m("div",{"class":cv.scopeheader},m("img",{src:b.connectionDetails.imageUrl}),m("div",{"class":cv.scopepermissions,dangerouslySetInnerHTML:{__html:c}}))}return m("div",{"class":cv.consent_header},m("span",{"class":cv.consent_headerimg},m("img",{src:this.integrationsdata.getImageURL()})),m("span",{"class":cv.consent_headertitle},this.integrationsdata.getName()))},b.prototype.getConsentsActions=function(b,c,d){var e={key:b,allow_for_extension:this.state.allow_extension},f={"Content-Type":"application/json","x-consents-version":"1","X-XHR-exception":!0,"X-ZCSRF-TOKEN":ex()},g=function(a){var b=JSON.parse(a);!eu(b)&&typeof d=="function"&&d(c,b)}.bind(this);return[{text:K("platformconsents.proceed"),onclick:function(){bt("v1/executions/1/confirmconsent",e,g,null,null,null,f),this.setState({view_dialog:!1,extension_resp:{}}),this.props.callbackOnClose()}.bind(this)}]},b.prototype.toggleExtensionConsents=function(b,c,d){var e=eO(d);e===this.extensionConsentsNode?this.state.view_extension?this.setState({view_extension:!1}):eu(this.state.extension_resp)?(this.setState({loading_consents:!0}),this.viewExtensionConsents(b,c)):this.setState({view_extension:!0}):e===this.allowExtensionNode?this.state.allow_extension?this.setState({allow_extension:!1}):this.setState({allow_extension:!0}):e===this.grantedConsentsNode&&(this.state.granted_consents?this.setState({granted_consents:!1}):this.setState({granted_consents:!0}))},b.prototype.viewExtensionConsents=function(b,c){var d="key="+c,e={"Content-Type":"application/json","x-consents-version":"1","X-XHR-exception":!0,"X-ZCSRF-TOKEN":ex()},f=function(a){var b=JSON.parse(a);this.setState({view_extension:!0,extension_resp:b,loading_consents:!1})}.bind(this);bs("v1/applications/"+b+"/impacts",d,f,null,null,null,e)},b.prototype.getExtensionConsents=function(b,c){var d=K("platformconsents.extension.title","<b>"+cx([c])+"</b>");return m("div",{id:"extension-consents","class":cv.extension_container},m("div",{"class":cv.botdialog_title,dangerouslySetInnerHTML:{__html:d}}),m("div",{"class":cv.extn_container},m("div",null,this.getConsents(b))))},b.prototype.render=function(b,c){var d=b.response,e=b.response.consent_key,f=b.chid,g=b.response.resumeUrl,h=b.callback,i=b.response.message_source.store_appid,j=m("span",{"class":cv.remember_note},m("strong",null," * "),K("platformconsents.remembernote")," "),k=null,l=null,n=null,o=this.getConsentsActions(e,f,h);if(this.integrationsdata.store_appid){var p=K("common.view"),q=c.allow_extension?cv.customcheckboxsel:cv.customcheckbox,r=K("platformconsents.extension.brief",cx([this.integrationsdata.store_appname]));c.view_extension&&(p=K("common.hide")),k=m("div",{"class":cv.extensionwrapper,onclick:this.toggleExtensionConsents.bind(this,i,e)},m("span",null,m("span",{"class":q}),m("input",{id:"allowextension",type:"checkbox",ref:this.setAllowExtensionNode}),m("label",{"for":"allowextension","class":cv.allowextn_text,dangerouslySetInnerHTML:{__html:r}})),m("span",{"class":cv.consent_view_link,ref:this.setExtensionConsentsNode},p))}else if(!eu(b.response.granted_consents)){var s=K("common.view");c.granted_consents&&(s=K("common.hide")),k=m("div",{"class":cv.extensionwrapper},m("span",{"class":cv.grantedconsents},K("platformconsents.grantednote")),m("span",{"class":cv.consent_view_link,ref:this.setGrantedConsentsNode,onclick:this.toggleExtensionConsents.bind(this,i,e)},s))}if(c.view_extension&&!eu(c.extension_resp)){var t=c.extension_resp.data.extension.store_appname,u=c.extension_resp.data.consents;l=this.getExtensionConsents(u,t)}else g?(k=null,j=null,l=this.getConsentsWindow(d,e,f),o=[{text:K("common.authenticate"),onclick:function(){window.open(g),this.setState({view_dialog:!1})}.bind(this)}],l===null&&(n={customContainerStyle:cv.authenticationContainer,customHeaderStyle:cv.header_wrapper})):l=this.getConsentsWindow(d,e,f);var v=null;return c.view_dialog&&(v=m(bY,{nodeToBeFocusedOnClose:this.props.nodeToBeFocusedOnClose,heading:this.getConsentsHeader(d),actions:o,footerinfoprefix:k,footerinfosuffix:j,customDialogStyles:n,callbackOnClose:this.props.callbackOnClose},l)),v},b}(p),cz=function(){};cz.prototype.mountComponent=function(b,c,d,e){if(document.querySelector("[data-consentkey]"))return;this.node=document.createElement("div"),document.body.appendChild(this.node),G(m(cy,{chid:b,response:c,callback:d,nodeToBeFocusedOnClose:e,callbackOnClose:this.removeParentNode.bind(this)}),this.node)},cz.prototype.removeParentNode=function(){this.node.parentElement.removeChild(this.node)};var cA={},cB={},cC={CS_DISABLED_BY_ADMIN:"module_disabled_by_admin",CS_ACTION_DISABLED_BY_ADMIN:"action_disabled_by_admin"},cM=Object.freeze({__proto__:null,errorcodes:cC,hasPermission:cD,isRegistered:cE,register:cF,init:cG,update:cH,handleModulesStatusChange:cI,isSecurityError:cJ,handleError:cK,registerCallbacks:cL}),cN={},cO={},cP=!1,cQ=null,cR=!1,dj=Object.freeze({__proto__:null,updateBotActions:cS,getFromServerAfterFocus:cT,syncFromServerAfterFocus:cU,getFromServerIfFocussed:cV,initBots:cX,fetchBots:cY,updateBotContacts:cZ,getList:c$,get:c_,removeFromBotsList:da,removeFromSubscribedList:db,getPhoto:de,subscribe:df,getBotId:dg,getBotName:dh,isBotId:di}),dk={ONLINE:1,OFFLINE:0,FEEDINFO:2,BUSY:3,IDLE:4,AWAY:7,WEB_LOGIN:1,MOB_LOGIN:3},dl=["Offline","Available","","Busy","Idle","","","Away"],dm=[],dn=[],dp={},dq=0,dr=!1,em=Object.freeze({__proto__:null,userstatus:dk,defaultstatusmsg:dl,getInvitedContactsList:ds,getPendingInvitedContactsList:dt,getContactsList:du,setContactsList:dv,removeFromContactsList:dw,setInvitedContactsList:dx,setPendingInvitedContactsList:dy,setLastUpdatedTime:dz,getLastUpdatedTime:dA,initialize:dB,getInitializedValue:dC,updateStatus:dD,updateDisplayName:dE,updateFromMDParent:dF,updateContacts:dG,copyContacts:dH,copyZohoContacts:dI,updateContact:dJ,deletecontact:dK,isInitialised:dL,init:dM,getcontacts:dN,isonline:dO,getZohoContacts:dP,getStatusMsg:dQ,getStatusType:dR,status:dS,getStatusClassName:dT,add:dU,reinvite:dV,remove:dW,get:dX,getDisplayName:dY,updateUserStatus:dZ,handleInviteOperation:d$,accept:d_,reject:ea,remindMeLater:eb,getEmailId:ec,getZuid:ed,verifyUserStatus:ee,getUserPhoto:ef,getSortedContacts:eg,isInvitedContact:eh,isInvitationPending:ei,removeInvitations:ej,isAnnonUser:ek,getContactsListWithoutBots:el}),en={},eq=Object.freeze({__proto__:null,getInfo:eo,storeInfo:ep}),eI={};(function(a){var b={},c=-1;a.subscribe=function(a,d){b[a]||(b[a]=[]);var e=(++c).toString();return b[a].push({token:e,func:d}),e},a.publish=function(){var a=arguments,c=a[0];return b[c]?(setTimeout(function(){var d=b[c],e=d?d.length:0;while(e--)d[e].func.apply(null,a)},0),!0):!1},a.unsubscribe=function(a){for(var c in b)if(b[c])for(var d=0,e=b[c].length;d<e;d++)if(b[c][d].token===a)return b[c].splice(d,1),a;return!1}})(eI);var eP=function(){return String.fromCodePoint?String.fromCodePoint:function(a){var b=arguments,c=String.fromCharCode,d=[],e=0,f="";for(var g=0,h=arguments.length;g!==h;++g){var i=+b[g];if(!(i<1114111&&i>>>0===i))throw RangeError("Invalid code point: "+i);i<=65535?e=d.push(i):(i-=65536,e=d.push((i>>10)+55296,i%1024+56320)),e>=16383&&(f+=c.apply(null,d),d.length=0)}return f+c.apply(null,d)}}(),fn={},fA=Object.freeze({__proto__:null,formatSecondsToHHMM:er,throttle:es,moveCaretPosition:et,isEmptyObject:eu,splitWmsFormattedString:ev,isEmptyString:ew,getCSRF:ex,safeHTML:ey,unescapeHTML:ez,isZuid:eA,getContactName:eB,formatMentions:eC,nocachefix:eD,removeElementFromArray:eE,sortBy:eF,compositeComparator:eG,getObjectLength:eH,pubsub:eI,cloneObject:eJ,extend:eK,isScrolledIntoView:eL,isEmpty:eM,isLocalUser:eN,getEventTarget:eO,fromCodePoint:eP,animate:eQ,toggle:eR,checkSessionConfig:eS,escapeHTML:eT,getCssAnimEndListener:eU,addMultipleListeners:eV,indexOf:eW,positionElement:eX,createElement:eY,consoleWarn:eZ,getUnfurlableLink:e$,decodeHTMLEntities:e_,addEvent:fa,scrollIntoView:fb,getChatType:fc,isChannelChid:fd,isBotChid:fe,isCustomBot:ff,debounce:fg,convertToArray:fh,removeElement:fi,addClass:fj,removeClass:fk,setAttribute:fl,loadOriginalImage:fm,isImageLazyLoaded:fp,loadImageWithDebounce:fq,isArray:fr,getInnerText:fs,findParent:ft,boldMatchedString:fu,isViewableInScroll:fv,bringElemToView:fw,getFileSize:fx,isFilesizeExceeded:fy,isFile:fz}),fB=function(a){function b(b){a.call(this,b);var c=b.placeholder||new Date;this.datepicickernode=null,b.presetdate&&(c=new Date(b.presetdate)),this.state={calendarvisible:!1,selecteddate:c,mountedtop:null},this.mountCalendar=this.mountCalendar.bind(this),this.onDateSelection=this.onDateSelection.bind(this),this.onDateSelectionCallBack=this.props.onDateSelection.bind(this),this.setDatepickerNode=this.setDatepickerNode.bind(this),this.onClickOutside=this.onClickOutside.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.updateDate=function(b){this.setState({selecteddate:new Date(b)})},b.prototype.setDatepickerNode=function(b){this.datepickernode=b},b.prototype.mountCalendar=function(b){if(b.type=="keydown"&&b.keyCode==13||b.type=="click"){var c=!1,d=this.datepickernode.getBoundingClientRect().bottom;if(d+250>window.innerHeight)c=!0;else if(this.props.mountedviaforms&&this.datepickernode){var e=ft(this.datepickernode,"[data-dialogwrapper=true]"),f=this.datepickernode.offsetParent.offsetParent.offsetTop-e.scrollTop+e.offsetTop+this.datepickernode.offsetParent.offsetParent.offsetHeight;f+200>e.offsetHeight&&(c=!0)}this.setState({calendarvisible:!this.state.calendarvisible,mountedtop:c})}},b.prototype.onDateSelection=function(b){this.onDateSelectionCallBack(b),this.setState({selecteddate:b,calendarvisible:!this.state.calendarvisible})},b.prototype.onClickOutside=function(){this.setState({calendarvisible:!1})},b.prototype.render=function(b,c){var d="",e=X(c.selecteddate),f=Q.datecnt,g=c.selecteddate;b.placeholder==c.selecteddate&&(e=c.selecteddate,f=Q.placeholder,g=new Date),c.mountedtop&&c.calendarvisible?d=Q.mountedtop:c.mountedtop===!1&&c.calendarvisible&&(d=Q.mountedbottom);var h=b.mountedviaforms?Q.calendarwidth:"",i=b.mountedviaforms?Q.calendarviaforms:Q.calendaricon,j="calendarview",k=m("div",{"class":Q.calendarposition+" "+h,key:j},m(N,{onDateSelection:this.onDateSelection,selecteddate:g,mounttop:c.mountedtop}));return m(R,{onClickOutside:this.onClickOutside},m("div",{tabindex:"0",onkeydown:this.mountCalendar,"class":Q.parentcomponent},c.mountedtop&&c.calendarvisible&&k,m("div",{ref:this.setDatepickerNode,key:"datepickerview","class":Q.datepickercontainer+" "+d,onclick:this.mountCalendar},m("span",{"class":f},e),m("span",{"class":i})),c.mountedtop===!1&&c.calendarvisible&&k))},b}(p),fC=function(){this.instance=null};fC.prototype.mountComponent=function(b,c,d){this.node=b,G(m(fB,{ref:function(a){this.instance=a}.bind(this),onDateSelection:d,presetdate:c}),b)},fC.prototype.unmountComponent=function(){G("",this.node)},fC.prototype.updateDate=function(b){this.instance.updateDate(b)};var fD={zomojiContainer:"mc854d52f3_zomojiContainer",searchBox:"mc854d52f3_searchBox",smileycnt:"mc854d52f3_smileycnt",smileycntlive:"mc854d52f3_smileycntlive",smileyContainer:"mc854d52f3_smileyContainer",toggler:"mc854d52f3_toggler",zmNightMode:"zmNightMode",zomoji:"mc854d52f3_zomoji",livezomoji:"mc854d52f3_livezomoji",togglertop:"mc854d52f3_togglertop",livezomojiicon:"mc854d52f3_livezomojiicon",row:"mc854d52f3_row",rowlast:"mc854d52f3_rowlast",selectedsmiley:"mc854d52f3_selectedsmiley",emoji:"mc854d52f3_emoji"},fE=function(b){var c=b&&b.type||"workplace";this.type=c==="workplace"?"w":"f",this.default_size=b&&b.default_size||72,this.along_text_size=b&&b.along_text_size||24;var d=b&&b.animation;this.animation_disabled=d==="disabled"?!0:!1,this.animation_default_size=d&&d.default_size||72,this.animation_along_text_size=d&&d.along_text_size||24,this.emoji_lookup={":grinning:":["#x1f600"],":grin:":["#x1f601"],":joy:":["#x1f602"],":smiley:":["#x1f603"],":smile:":["#x1f604"],":sweat-smile:":["#x1f605"],":laughing:":["#x1f606"],":wink:":["#x1f609"],":blush:":["#x1f60a"],":yum:":["#x1f60b"],":sunglasses:":["#x1f60e"],":heart-eyes:":["#x1f60d"],":kissing-heart:":["#x1f618"],":kissing:":["#x1f617"],":kissing-smiling-eyes:":["#x1f619"],":kissing-closed-eyes:":["#x1f61a"],":slight-smile:":["#x1f642"],":hug:":["#x1f917"],":thinking:":["#x1f914"],":neutral-face:":["#x1f610"],":expressionless:":["#x1f611"],":no-mouth:":["#x1f636"],":rolling-eyes:":["#x1f644"],":smirk:":["#x1f60f"],":persevere:":["#x1f623"],":cry:":["#x1f622"],":open-mouth:":["#x1f62e"],":zipper-mouth:":["#x1f910"],":hushed:":["#x1f62f"],":sleepy:":["#x1f62a"],":tired-face:":["#x1f62b"],":sleeping:":["#x1f634"],":relieved:":["#x1f60c"],":stuck-out-tongue:":["#x1f61b"],":stuck-out-tongue-winking-eye:":["#x1f61c"],":stuck-out-tongue-closed-eyes:":["#x1f61d"],":unamused:":["#x1f612"],":sweat:":["#x1f613"],":pensive:":["#x1f614"],":confused:":["#x1f615"],":upside-down:":["#x1f643"],":money-mouth:":["#x1f911"],":astonished:":["#x1f632"],":slight-frowning:":["#x1f641"],":confounded:":["#x1f616"],":disappointed:":["#x1f61e"],":worried:":["#x1f61f"],":triumph:":["#x1f624"],":disappointed-relieved:":["#x1f625"],":sob:":["#x1f62d"],":frowning-with-open-mouth:":["#x1f626"],":anguished:":["#x1f627"],":fearful:":["#x1f628"],":weary:":["#x1f629"],":grimacing:":["#x1f62c"],":cold-sweat:":["#x1f630"],":scream:":["#x1f631"],":flushed:":["#x1f633"],":dizzy-face:":["#x1f635"],":rage:":["#x1f621"],":angry:":["#x1f620"],":mask:":["#x1f637"],":sick:":["#x1f912"],":head-bandaged:":["#x1f915"],":halo-smiling:":["#x1f607"],":nerd:":["#x1f913"],":smiling-with-horns:":["#x1f608"],":imp:":["#x1f47f"],":japanese-ogre:":["#x1f479"],":japanese-goblin:":["#x1f47a"],":skull:":["#x1f480"],":ghost:":["#x1f47b"],":alien:":["#x1f47d"],":robot:":["#x1f916"],":hankey:":["#x1f4a9"],":smiley-cat:":["#x1f63a"],":smile-cat:":["#x1f638"],":joy-cat:":["#x1f639"],":heart-eyes-cat:":["#x1f63b"],":smirk-cat:":["#x1f63c"],":kissing-cat:":["#x1f63d"],":scream-cat:":["#x1f640"],":crying-cat-face:":["#x1f63f"],":pouting-cat:":["#x1f63e"],":baby:":["#x1f476"],":girl:":["#x1f467"],":boy:":["#x1f466"],":woman:":["#x1f469"],":man:":["#x1f468"],":older-woman:":["#x1f475"],":older-man:":["#x1f474"],":man-with-gua-pi-mao:":["#x1f472"],":man-with-turban:":["#x1f473"],":person-with-blond-hair:":["#x1f471"],":man-with-turban:":["#x1f473"],":cop:":["#x1f46e"],":construction-worker:":["#x1f477"],":guardsman:":["#x1f482"],":detective:":["#x1f575"],":bride-in-veil:":["#x1f470"],":princess:":["#x1f478"],":santa:":["#x1f385"],":angel:":["#x1f47c"],":bow:":["#x1f647"],":information-desk-person:":["#x1f481"],":no-good:":["#x1f645"],":ok-woman:":["#x1f646"],":raising-hand:":["#x1f64b"],":person-with-pouting-face:":["#x1f64e"],":person-frowning:":["#x1f64d"],":haircut:":["#x1f487"],":massage:":["#x1f486"],":nail-care:":["#x1f485"],":dancer:":["#x1f483"],":dancers:":["#x1f46f"],":levitating-man:":["#x1f574"],":walking:":["#x1f6b6"],":runner:":["#x1f3c3"],":couple:":["#x1f46b"],":boys:":["#x1f46c"],":girls:":["#x1f46d"],":couplekiss:":["#x1f48f"],":couple-with-heart:":["#x1f491"],":boyskiss:":["#x1f468","#x200d","#x2764","#xfe0f","#x200d","#x1f48b","#x200d","#x1f468"],":boys-with-heart:":["#x1f468","#x200d","#x2764","#xfe0f","#x200d","#x1f468"],":girlskiss:":["#x1f469","#x200d","#x2764","#xfe0f","#x200d","#x1f48b","#x200d","#x1f469"],":girls-with-heart:":["#x1f469","#x200d","#x2764","#xfe0f","#x200d","#x1f469"],":family:":["#x1f46a"],":family-man-woman-girl:":["#x1f468","#x200d","#x1f469","#x200d","#x1f467"],":family-man-woman-girl-boy:":["#x1f468","#x200d","#x1f469","#x200d","#x1f467","#x200d","#x1f466"],":family-man-woman-boy-boy:":["#x1f468","#x200d","#x1f469","#x200d","#x1f466","#x200d","#x1f466"],":family-man-woman-girl-girl:":["#x1f468","#x200d","#x1f469","#x200d","#x1f467","#x200d","#x1f467"],":family-man-man-boy:":["#x1f468","#x200d","#x1f468","#x200d","#x1f466"],":family-man-man-girl:":["#x1f468","#x200d","#x1f468","#x200d","#x1f467"],":family-man-man-girl-boy:":["#x1f468","#x200d","#x1f468","#x200d","#x1f467","#x200d","#x1f466"],":family-man-man-boy-boy:":["#x1f468","#x200d","#x1f468","#x200d","#x1f466","#x200d","#x1f466"],":family-man-man-girl-girl:":["#x1f468","#x200d","#x1f468","#x200d","#x1f467","#x200d","#x1f467"],":family-woman-woman-girl-boy:":["#x1f469","#x200d","#x1f469","#x200d","#x1f467","#x200d","#x1f466"],":family-woman-woman-boy-boy:":["#x1f469","#x200d","#x1f469","#x200d","#x1f466","#x200d","#x1f466"],":family-woman-woman-girl-girl:":["#x1f469","#x200d","#x1f469","#x200d","#x1f467","#x200d","#x1f467"],":family-woman-woman-boy:":["#x1f469","#x200d","#x1f469","#x200d","#x1f466"],":family-woman-woman-girl:":["#x1f469","#x200d","#x1f469","#x200d","#x1f467"],":see-no-evil:":["#x1f648"],":hear-no-evil:":["#x1f649"],":speak-no-evil:":["#x1f64a"],":fire:":["#x1f525"],":sparkles:":["#x2728"],":star2:":["#x1f31f"],":droplet:":["#x1f4a7"],":tophat:":["#x1f3a9"],":crown:":["#x1f451"],":womans-hat:":["#x1f452"],":athletic-shoe:":["#x1f45f"],":mans-shoe:":["#x1f45e"],":sandal:":["#x1f461"],":high-heel:":["#x1f460"],":boot:":["#x1f462"],":shirt:":["#x1f455"],":necktie:":["#x1f454"],":womans-clothes:":["#x1f45a"],":dress:":["#x1f457"],":running-shirt-with-sash:":["#x1f3bd"],":jeans:":["#x1f456"],":kimono:":["#x1f458"],":bikini:":["#x1f459"],":briefcase:":["#x1f4bc"],":handbag:":["#x1f45c"],":pouch:":["#x1f45d"],":purse:":["#x1f45b"],":eyeglasses:":["#x1f453"],":ribbon:":["#x1f380"],":closed-umbrella:":["#x1f302"],":gem:":["#x1f48e"],":speech-balloon:":["#x1f4ac"],":open-hands:":["#x1f450"],":raised-hands:":["#x1f64c"],":clap:":["#x1f44f"],":thumbs-up:":["#x1f44d"],":thumbs-down:":["#x1f44e"],":oncoming-fist:":["#x1f44A"],":fist:":["#x270A"],":sign-of-horns:":["#x1f918"],":ok-hand:":["#x1f44c"],":point-left:":["#x1f448"],":point-right:":["#x1f449"],":point-up-2:":["#x1f446"],":point-down:":["#x1f447"],":raised-hand:":["#x270B"],":spayed-fingers:":["#x1f590"],":vulcan-salute:":["#x1f596"],":wave:":["#x1f44b"],":muscle:":["#x1f4aa"],":middle-finger:":["#x1f595"],":pray:":["#x1f64f"],":ring:":["#x1f48d"],":lipstick:":["#x1f484"],":kiss:":["#x1f48b"],":lips:":["#x1f444"],":tongue:":["#x1f445"],":ear:":["#x1f442"],":nose:":["#x1f443"],":footprints:":["#x1f463"],":eye:":["#x1f441"],":eyes:":["#x1f440"],":speaking-head:":["#x1f5e3"],":bust-in-silhouette:":["#x1f464"],":busts-in-silhouette:":["#x1f465"],":dog:":["#x1f436"],":wolf:":["#x1f43a"],":cat:":["#x1f431"],":mouse:":["#x1f42d"],":hamster:":["#x1f439"],":rabbit:":["#x1f430"],":frog:":["#x1f438"],":tiger:":["#x1f42f"],":koala:":["#x1f428"],":bear:":["#x1f43b"],":pig:":["#x1f437"],":pig-nose:":["#x1f43d"],":cow:":["#x1f42e"],":boar:":["#x1f417"],":monkey-face:":["#x1f435"],":monkey:":["#x1f412"],":horse:":["#x1f434"],":sheep:":["#x1f411"],":elephant:":["#x1f418"],":panda-face:":["#x1f43c"],":penguin:":["#x1f427"],":bird:":["#x1f426"],":baby-chick:":["#x1f424"],":hatched-chick:":["#x1f425"],":hatching-chick:":["#x1f423"],":chicken:":["#x1f414"],":snake:":["#x1f40d"],":turtle:":["#x1f422"],":bug:":["#x1f41b"],":bee:":["#x1f41d"],":ant:":["#x1f41c"],":beetle:":["#x1f41e"],":snail:":["#x1f40c"],":octopus:":["#x1f419"],":shell:":["#x1f41a"],":tropical-fish:":["#x1f420"],":fish:":["#x1f41f"],":dolphin:":["#x1f42c"],":whale:":["#x1f433"],":racehorse:":["#x1f40e"],":dragon-face:":["#x1f432"],":blowfish:":["#x1f421"],":camel:":["#x1f42b"],":poodle:":["#x1f429"],":feet:":["#x1f43e"],":bouquet:":["#x1f490"],":cherry-blossom:":["#x1f338"],":tulip:":["#x1f337"],":four-leaf-clover:":["#x1f340"],":rose:":["#x1f339"],":sunflower:":["#x1f33b"],":hibiscus:":["#x1f33a"],":maple-leaf:":["#x1f341"],":leaves:":["#x1f343"],":fallen-leaf:":["#x1f342"],":herb:":["#x1f33f"],":ear-of-rice:":["#x1f33e"],":mushroom:":["#x1f344"],":cactus:":["#x1f335"],":palm-tree:":["#x1f334"],":chestnut:":["#x1f330"],":seedling:":["#x1f331"],":blossom:":["#x1f33c"],":new-moon:":["#x1f311"],":first-quarter-moon:":["#x1f313"],":moon:":["#x1f314"],":full-moon:":["#x1f315"],":first-quarter-moon-with-face:":["#x1f31b"],":crescent-moon:":["#x1f319"],":earth-asia:":["#x1f30f"],":volcano:":["#x1f30b"],":milky-way:":["#x1f30c"],":stars:":["#x1f320"],":partly-sunny:":["#x26C5"],":snowman:":["#x26C4"],":cyclone:":["#x1f300"],":foggy:":["#x1f301"],":rainbow:":["#x1f308"],":ocean:":["#x1f30a"],":house:":["#x1f3e0"],":house-with-garden:":["#x1f3e1"],":school:":["#x1f3eb"],":office:":["#x1f3e2"],":post-office:":["#x1f3e3"],":hospital:":["#x1f3e5"],":bank:":["#x1f3e6"],":convenience-store:":["#x1f3ea"],":love-hotel:":["#x1f3e9"],":hotel:":["#x1f3e8"],":wedding:":["#x1f492"],":church:":["#x26EA"],":department-store:":["#x1f3ec"],":city-sunrise:":["#x1f307"],":city-sunset:":["#x1f306"],":japanese-castle:":["#x1f3ef"],":european-castle:":["#x1f3f0"],":tent:":["#x26FA"],":factory:":["#x1f3ed"],":tokyo-tower:":["#x1f5fc"],":japan:":["#x1f5fe"],":mount-fuji:":["#x1f5fb"],":sunrise-over-mountains:":["#x1f304"],":sunrise:":["#x1f305"],":night-with-stars:":["#x1f303"],":statue-of-liberty:":["#x1f5fd"],":bridge-at-night:":["#x1f309"],":carousel-horse:":["#x1f3a0"],":ferris-wheel:":["#x1f3a1"],":fountain:":["#x26F2"],":roller-coaster:":["#x1f3a2"],":ship:":["#x1f6a2"],":boat:":["#x26F5"],":speedboat:":["#x1f6a4"],":rocket:":["#x1f680"],":seat:":["#x1f4ba"],":station:":["#x1f689"],":high-speed-train:":["#x1f684"],":bullet-train:":["#x1f685"],":metro:":["#x1f687"],":railway-car:":["#x1f683"],":bus:":["#x1f68c"],":blue-car:":["#x1f699"],":car:":["#x1f697"],":taxi:":["#x1f695"],":truck:":["#x1f69a"],":rotating-light:":["#x1f6a8"],":police-car:":["#x1f693"],":fire-engine:":["#x1f692"],":ambulance:":["#x1f691"],":bike:":["#x1f6b2"],":barber-pole:":["#x1f488"],":busstop:":["#x1f68f"],":ticket:":["#x1f3ab"],":traffic-light:":["#x1f6a5"],":construction:":["#x1f6a7"],":beginner:":["#x1f530"],":fuelpump:":["#x26FD"],":izakaya-lantern:":["#x1f3ee"],":slot-machine:":["#x1f3b0"],":moyai:":["#x1f5ff"],":circus-tent:":["#x1f3aa"],":performing-arts:":["#x1f3ad"],":round-pushpin:":["#x1f4cd"],":triangular-flag-on-post:":["#x1f6a9"],":red-heart:":["#x2764","#xfe0f"],":yellow-heart:":["#x1f49b"],":blue-heart:":["#x1f499"],":purple-heart:":["#x1f49c"],":green-heart:":["#x1f49a"],":broken-heart:":["#x1f494"],":heart-exclamation:":["#x2763","#xfe0f"],":two-hearts:":["#x1f495"],":revolving-hearts:":["#x1f49e"],":heartbeat:":["#x1f493"],":heartpulse:":["#x1f497"],":sparkling-heart:":["#x1f496"],":cupid:":["#x1f498"],":gift-heart:":["#x1f49d"],":heart-decoration:":["#x1f49f"],":love-letter:":["#x1f48c"],":dizzy:":["#x1f4ab"],":boom:":["#x1f4a5"],":anger:":["#x1f4a2"],":sweat-drops:":["#x1f4a6"],":zzz:":["#x1f4a4"],":dash:":["#x1f4a8"],":hole:":["#x1f573","#xfe0f"],":peace-symbol:":["#x262e","#xfe0f"],":latin-cross:":["#x271d","#xfe0f"],":crescent-and-star:":["#x262a","#xfe0f"],":om:":["#x1f549","#xfe0f"],":wheel-of-dharma:":["#x2638","#xfe0f"],":star-of-david:":["#x2721","#xfe0f"],":star-with-middle-point:":["#x1f52f"],":menorah:":["#x1f54e"],":yin-yang:":["#x262f","#xfe0f"],":orthodox-cross:":["#x2626","#xfe0f"],":place-of-workship:":["#x1f6d0"],":ophiuchus:":["#x26ce"],":aries:":["#x2648"],":taurus:":["#x2649"],":gemini:":["#x264a"],":cancer:":["#x264b"],":leo:":["#x264c"],":virgo:":["#x264d"],":libra:":["#x264e"],":scorpius:":["#x264f"],":sagittarius:":["#x2650"],":capricorn:":["#x2651"],":aquarius:":["#x2652"],":pisces:":["#x2653"],":squared-id:":["#x1f194"],":atom:":["#x269b","#xfe0f"],":japanese-vacancy-button:":["#x1f233"],":japanese-discount-button:":["#x1f239"],":radioactive:":["#x2622","#xfe0f"],":biohazard:":["#x2623","#xfe0f"],":japanese-not-free-of-charge-button:":["#x1f236"],":japanese-free-of-charge-button:":["#x1f21a"],":japanese-application-button:":["#x1f238"],":japanese-open-for-business-button:":["#x1f23a"],":japanese-monthly-amount:":["#x1f237","#xfe0f"],":eight-pointed-star:":["#x2734","#xfe0f"],":vs-button:":["#x1f19a"],":japanese-acceptable-button:":["#x1f251"],":white-flower:":["#x1f4ae"],":japanese-bargain-button:":["#x1f250"],":japanese-secret-button:":["#x3299","#xfe0f"],":japanese-congratulations-button:":["#x3297","#xfe0f"],":japanese-passing-grade-button:":["#x1f234"],":japanese-no-vacancy-button:":["#x1f235"],":japanese-prohibited-button:":["#x1f232"],":baby-symbol:":["#x1f6bc"],":a-group-blood":["#x1f170","#xfe0f"],":b-group-blood:":["#x1f171","#xfe0f"],":o-group-blood:":["#x1f17e","#xfe0f"],":cl-button:":["#x1f191"],":sos-button:":["#x1f198"],":no-entry:":["#x26d4"],":name-badge:":["#x1f4db"],":heavy-circle:":["#x2b55"],":prohibited:":["#x1f6ab"],":muted:":["#x1f507"],":bell-with-slash:":["#x1f515"],":no-smoking:":["#x1f6ad"],":no-pedestrains:":["#x1f6b7"],":no-littering:":["#x1f6af"],":no-bicycle:":["#x1f6b3"],":non-potable-water:":["#x1f6b1"],":no-one-under-18:":["#x1f51e"],":no-mobile-phones:":["#x1f4f5"],":exclamation-mark:":["#x2757"],":white-exclamation-mark:":["#x2755"],":question-mark:":["#x2753"],":white-question-mark:":["#x2754"],":hundred-points:":["#x1f4af"],":dim-button:":["#x1f505"],":bright-button:":["#x1f506"],":trident:":["#x1f531"],":fleur-de-lis:":["#x269c","#xfe0f"],":part-alternation-mark:":["#x303d","#xfe0f"],":warning:":["#x26a0","#xfe0f"],":children-crossing:":["#x1f6b8"],":japanese-beginner-button:":["#x1f530"],":recycling:":["#x267b","#xfe0f"],":japanese-reserved-button:":["#x1f22f"],":chart-increasing-with-yen:":["#x1f4b9"],":sparkle:":["#x2747","#xfe0f"],":eight-spoked-asterisk:":["#x2733","#xfe0f"],":cross-mark:":["#x274c"],":diamond-with-dot:":["#x1f4a0"],":globe-with-meridians:":["#x1f310"],":circled-m:":["#x24c2","#xfe0f"],":japanese-service-charge-button:":["#x1f202","#xfe0f"],":double-curly-loop:":["#x27bf"],":passport-control:":["#x1f6c2"],":customs:":["#x1f6c3"],":baggage-claim:":["#x1f6c4"],":left-luggage:":["#x1f6c5"],":wheel-chair:":["#x267f"],":water-closet:":["#x1f6be"],":p-button:":["#x1f17f","#xfe0f"],":potable-water:":["#x1f6b0"],":men-room:":["#x1f6b9"],":women-room:":["#x1f6ba"],":restroom:":["#x1f6bb"],":litter-in-bin:":["#x1f6ae"],":antenna-bars:":["#x1f4f6"],":japanese-here-button:":["#x1f201"],":ng-button:":["#x1f196"],":ok-button:":["#x1f197"],":up-button:":["#x1f199"],":cool-button:":["#x1f192"],":new-button:":["#x1f195"],":free-button:":["#x1f193"],":input-number:":["#x1f522"],":pause-button:":["#x23f8","#xfe0f"],":pause-or-play-button:":["#x23ef","#xfe0f"],":stop-button:":["#x23f9","#xfe0f"],":record-button:":["#x23fa"],":next-track-button:":["#x23ed","#xfe0f"],":last-track-button:":["#x23ee","#xfe0f"],":fast-forward:":["#x23e9"],":fast-reverse:":["#x23ea"],":shuffle-tracks-button:":["#x1f500"],":repeat-button:":["#x1f501"],":repeat-once-button:":["#x1f502"],":reverse-button:":["#x25c0","#xfe0f"],":fast-up-button:":["#x23eb"],":fast-down-button:":["#x23ec"],":right-arrow:":["#x27a1","#xfe0f"],":left-arrow:":["#x2b05","#xfe0f"],":up-arrow:":["#x2b06","#xfe0f"],":down-arrow:":["#x2b07","#xfe0f"],":up-right-arrow:":["#x2197","#xfe0f"],":down-left-arrow:":["#x2199","#xfe0f"],":counter-clockwise-arrows:":["#x1f504"],":left-arrow-curving-right:":["#x21aa","#xfe0f"],":right-arrow-curving-left:":["#x21a9","#xfe0f"],":right-arrow-curving-up:":["#x2934","#xfe0f"],":right-arrow-curving-down:":["#x2935","#xfe0f"],":info-button:":["#x2139","#xfe0f"],":input-latin-letters:":["#x1f524"],":input-latin-lowercase:":["#x1f521"],":input-latin-uppercase:":["#x1f520"],":input-symbols:":["#x1f523"],":play-button:":["#x25b6","#xfe0f"],":eject-button:":["#x23cf","#xfe0f"],":down-right-arrow:":["#x2198","#xfe0f"],":up-left-arrow:":["#x2196","#xfe0f"],":clockwise-vertical-arrows:":["#x1f503"],":on-arrow:":["#x1f51b"],":top-arrow:":["#x1f51d"],":soon-arrow:":["#x1f51c"],":ballot-box-with-check:":["#x2611","#xfe0f"],":end-arrow:":["#x1f51a"],":back-arrow:":["#x1f519"],":wavy-dash:":["#x3030","#xfe0f"],":curly-loop:":["#x27b0"],":heavy-check-mark:":["#x2714","#xfe0f"],":heavy-dollar-sign:":["#x1f4b2"],":currency-exchange:":["#x1f4b1"],":heavy-plus-sign:":["#x2795"],":heavy-minus-sign:":["#x2796"],":heavy-multiplication-sign:":["#x2716","#xfe0f"],":heavy-division-sign:":["#x2797"],":copyright:":["#xa9","#xfe0f"],":registered:":["#xae","#xfe0f"],":trade-mark:":["#x2122","#xfe0f"],":radio-button:":["#x1f518"],":white-circle:":["#x26aa"],":black-circle:":["#x26ab"],":red-circle:":["#x1f534"],":blue-circle:":["#x1f535"],":small-orange-diamond:":["#x1f538"],":small-blue-diamond:":["#x1f539"],":large-orange-diamond:":["#x1f536"],":large-blue-diamond:":["#x1f537"],":red-triangle-pointed-up:":["#x1f53a"],":red-triangle-pointed-down:":["#x1f53b"],":upwards-button:":["#x1f53c"],":downwards-button:":["#x1f53d"],":black-medium-small-square:":["#x25fe"],":white-medium-small-square:":["#x25fd"],":black-large-square:":["#x2b1b"],":white-large-square:":["#x2b1c"],":black-medium-square:":["#x25fc","#xfe0f"],":white-medium-square:":["#x25fb","#xfe0f"],":black-small-square:":["#x25aa","#xfe0f"],":white-small-square:":["#x25ab","#xfe0f"],":black-square-button:":["#x1f533"],":white-square-button:":["#x1f532"],":twelve-o-clock:":["#x1f55b"],":twelve-thirty:":["#x1f567"],":one-o-clock:":["#x1f550"],":one-thirty:":["#x1f55c"],":two-o-clock:":["#x1f551"],":two-thirty:":["#x1f55d"],":three-o-clock:":["#x1f552"],":three-thirty:":["#x1f55e"],":four-o-clock:":["#x1f553"],":four-thirty:":["#x1f55f"],":five-o-clock:":["#x1f554"],":five-thirty:":["#x1f560"],":six-o-clock:":["#x1f555"],":six-thirty:":["#x1f561"],":seven-o-clock:":["#x1f556"],":seven-thirty:":["#x1f562"],":eight-o-clock:":["#x1f557"],":eight-thirty:":["#x1f563"],":nine-o-clock:":["#x1f558"],":nine-thirty:":["#x1f564"],":ten-o-clock:":["#x1f559"],":ten-thirty:":["#x1f565"],":eleven-o-clock:":["#x1f55a"],":eleven-thirty:":["#x1f566"]},this.symbol_lookup={":)":":smile:",":-)":":smile:",":^)":":smile:",":]":":smile:",":(":":sad:",":-(":":sad:",":[":":sad:",":D":":happy:",":d":":happy:",":-D":":happy:",":))":":happy:",":-))":":happy:","X-(":":angry:",":-@":":angry:",":@":":angry:",":P":":razz:",":-p":":razz:",":p":":razz:",";)":":wink:",";-)":":wink:",":/":":smirk:",":-/":":smirk:",":o":":surprise:",":-o":":surprise:",":O":":surprise:",":-O":":surprise:",":-s":":worry:",":s":":worry:",":-S":":worry:",":S":":worry:","I-)":":sleepy:","|-)":":sleepy:",":-X":":keep-quiet:",":-x":":keep-quiet:",":-#":":keep-quiet:","(a)":":peace:","(A)":":peace:","O-)":":peace:","O:)":":peace:","O:-)":":peace:",":+1:":":thumbsup:","(y)":":thumbsup:","(Y)":":thumbsup:",":x-":":thumbsup:",":-1:":":thumbsdown:","(N)":":thumbsdown:","(n)":":thumbsdown:","B-)":":cool:",":xs":":love:",":-?":":thinking:","*-:)":":idea:","-_-":":relaxed:","D:":":anxious:","-.-":":stressed-out:","(=_=)":":tired:","?D":":doubt:","(6.6)":":faint:","(({..}))":":headache:","+o(":":sick:",":-{}":":feeling-cold:",":v:":":victory:","C(_)":":coffee-cup:"},this.textcodes=["smile!","happy!","joy!","grinning!","cool!","love!","curious!","awe!","thinking!","search!","idea!","wink!","razz!","relaxed!","peace!","blush!","yummy!","yuck!","sad!","upset!","anxious!","worry!","stressed-out!","angry!","tensed!","tired!","bored!","sleepy!","jealous!","evil!","facepalm!","doubt!","surprise!","faint!","headache!","sick!","injured!","neutral!","smirk!","keep-quiet!","feeling-warm!","feeling-cold!","hi!","thumbsup!","thumbsdown!","namaste!","super!","victory!","yoyo!","raising-hand!","clap!","bye-bye!","fist!","biceps!","birthday!","champagne","chicken","chicken!","christmas-tree!","coffee-cup!","eid-mubarak!","fireworks!","food!","gift-box!","kaaba!","new-year!","party!","peanuts!","santa-hat!","fire!","fire-extinguisher","first-aid-box","medicine!","poop!","gold-medal","silver-medal","bronze-medal","archer","archer!","refugee-olympic-team","badminton!","baseball!","basketball!","boxer!","canoeing!","chess!","cricket!","discus-throw!","diver!","equestrian!","fencer!","flag!","foosball!","football!","golf","golf!","hammer-throw","high-jump!","hockey!","hurdler!","javelin-throw!","judo!","long-jump!","pole-vault!","athlete!","rhythmic-gymnastics!","shooter","shooter!","shotput-throw!","snooker!","table-tennis!","target","target!","tennis","tennis!","volleyball","volleyball!","weightlifting","weightlifting!","wrestling","wrestling!","badminton-player","badminton-player!","basketball-player","basketball-player!","batsman","batsman!","batter","batter!","bowler","break-boy","break-boy!","break-girl","break-girl!","chess-player","chess-player!","football-player","football-player!","female-tennis-player","female-tabletennis-player","female-volleyball-player","female-tennis-player!","female-tabletennis-player!","female-volleyball-player!","golfer","golfer!","gymnast","gymnast!","hockey-player","hockey-player!","karate","karate!","man-dancing","man-dancing!","man-cycling","man-cycling!","man-running","man-running!","man-swimming","man-swimming!","male-tabletennis-player","male-volleyball-player","male-tennis-player","male-tabletennis-player!","male-volleyball-player!","male-tennis-player!","pitcher","pitcher!","singing","singing!","snooker-player","snooker-player!","woman-dancing","woman-cycling","woman-running","woman-swimming","woman-dancing!","woman-cycling!","woman-running!","woman-swimming!","yoga","yoga!","bicycle","bicycle!","sports-bike","sports-bike!","cruiser-bike","cruiser-bike!","motor-scooter","motor-scooter!","car","car!","taxi","taxi!","bus","bus!","train","train!","police-car","police-car!","ambulance","ambulance!","fire-engine","fire-engine!","aeroplane","aeroplane!","passenger-ship","passenger-ship!","parking","cafeteria","bug","milestone","calendar","security","processor","laptop","server","garden","playground","home","office","library","auditorium","store","mail-room","pharmacy","task","report","gym","americas","europe-africa","asia-pacific"],this.type==="f"&&(this.textcodes=["smile!","happy!","joy!","grinning!","cool!","love!","curious!","awe!","thinking!","search!","idea!","wink!","razz!","relaxed!","peace!","blush!","yummy!","yuck!","sad!","upset!","anxious!","worry!","stressed-out!","angry!","tensed!","tired!","bored!","sleepy!","jealous!","evil!","facepalm!","doubt!","surprise!","faint!","headache!","sick!","injured!","neutral!","smirk!","keep-quiet!","feeling-warm!","feeling-cold!","hi!","thumbsup!","thumbsdown!","namaste!","super!","victory!","yoyo!","raising-hand!","clap!","bye-bye!","fist!","biceps!","birthday!","champagne","christmas-tree!","coffee-cup!","eid-mubarak!","fireworks!","food!","gift-box!","kaaba!","new-year!","party!","peanuts!","santa-hat!","fire!","medicine!","poop!","target!","badminton!","baseball!","basketball!","boxer!","canoeing!","chess!","cricket!","discus-throw!","diver!","equestrian!","fencer!","flag!","foosball!","football!","high-jump!","hockey!","hurdler!","javelin-throw!","judo!","long-jump!","pole-vault!","athlete!","rhythmic-gymnastics!","shooter","shotput-throw!","snooker!","table-tennis!"]),this.textcodes_lookup={},this.textcodes.forEach(function(a){this.textcodes_lookup[":"+a.replace("!","")+":"]=K("smiley."+a.replace("!",""));if(a.charAt(a.length-1)==="!"&&this.animation_disabled===!1){var b=a.replace("!","");this.textcodes_lookup[":"+a+":"]=K("smiley."+b)}},this),this.smiley_lookup={};for(var e in this.symbol_lookup)this.smiley_lookup[e]=K("smiley."+this.symbol_lookup[e]);for(var f in this.textcodes_lookup)this.smiley_lookup[f]=this.textcodes_lookup[f];var g="";for(var h in this.smiley_lookup)g!==""?g+="|"+h:g=h;g=g.replace(/\|-\)/g,"\\|-)"),g=g.replace(/[[\]()*+.?^]/g,function(a){return"\\"+a}),g="("+g+")",this.smiley_regex=new RegExp("([ >\n]|^)"+g+"(?=[ <\n]|$)","g")};fE.prototype.updateSmiley=function(b,c,d){if(b!=null){var e=b.selectionStart,f=b.value;f=f.substring(0,e);var g=this.smiley_lookup[c];c.indexOf("!")>-1&&(g=this.smiley_lookup[c]+"!"),f===""||f.endsWith(" ")||f.endsWith("\n")?c.indexOf(":")==-1?(g=c,b.value=f+g+" "+b.value.substring(e)):b.value=f+":"+g+":"+" "+b.value.substring(e):c.indexOf(":")==-1?(g=c,b.value=f+" "+g+" "+b.value.substring(e)):b.value=f+" "+":"+g+":"+" "+b.value.substring(e),et(b,e+c.length+2,e+c.length+2)}},fE.prototype._isAnimationCode=function(b){return b.indexOf("!:")!==-1?!0:!1},fE.prototype._replacer=function(b,c,d,e){d=d.replace(e,""),d in this.symbol_lookup&&(d=this.symbol_lookup[d]);var f=this.smiley_lookup[d];for(var g in this.textcodes_lookup)g==d&&(f=g.replace(/:/g,""));var h=arguments[arguments.length-1];h=h&&h.trim();var i=h.replace(d,"").length!==0?!0:!1,j=this.default_size;if(this._isAnimationCode(d)&&this.type==="f"){f=f.replace("!",""),j=this.animation_default_size,i&&(j=this.animation_along_text_size);var k=" title="+K("smiley."+f);return b&&(k=""),b=!1,e+"<em"+k+" data-reaction="+d+" class='zomojianim-"+j+"-"+f+"'></em>"}var l=this.type;this._isAnimationCode(d)&&(l="f",f=f.replace("!",""));var k=" title="+K("smiley."+f);return b&&(k=""),i?j=this.along_text_size:c&&l!=="w"&&(j=48),b=!1,e+"<em"+k+" data-reaction="+d+" class='zomoji-"+l+"-"+j+"-"+f+"'></em>"},fE.prototype.getSmileyLookup=function(b){var c={};if(b){b=b.toLowerCase();for(var d in this.smiley_lookup)if((this.smiley_lookup[d].startsWith(":"+b)||this.smiley_lookup[d].indexOf(b)>-1)&&d in this.symbol_lookup==0)c[d]=this.smiley_lookup[d];else if(d.startsWith(":"+b)&&d in this.symbol_lookup){var e=this.symbol_lookup[d],f=K("smiley."+e.replace(/:/g,""));c[e]=f}}else for(var g in this.textcodes_lookup)c[g]=this.textcodes_lookup[g];return c},fE.prototype.replace=function(b,c,d){return this.animation_disabled&&(b=b.replace(/:(.*?):/g,function(a){for(var b in this.smiley_lookup)if(b==a.replace(/!/g,""))return b;return a}.bind(this))),typeof b=="string"?b.replace(this.smiley_regex,this._replacer.bind(this,c,d)):b},fE.prototype.getSmiley=function(b){var c=this.smiley_lookup[b],d=this.default_size,e=this.type,f=b.replace("!","");return f=f.replace(/:/g,""),this._isAnimationCode(b)?(c=c.replace("!",""),d=this.animation_default_size,e="f",m("em",{title:c,"data-smileycode":b,"class":"zomoji-"+e+"-"+d+"-"+f})):m("em",{title:c,"data-smileycode":b,"class":"zomoji-"+e+"-"+d+"-"+f})},fE.prototype.replaceSmileyForHtml=function(b){var c=/<em (?:.*?) data-reaction="(.*?)" (?:.*?)><\/em>/g;return be.replacer(c,null,b,function(a,b){for(var c in this.textcodes_lookup)if(b===c)return c=c.replace(/:/g,""),c.indexOf("!")>-1?c=":"+K("smiley."+c.replace("!",""))+"!:":(c=c.replace(/:/g,""),c=":"+K("smiley."+c)+":"),c}.bind(this))},fE.prototype.replaceTextToEnglishCodes=function(b){if(!this.smileycode_regex){var c="";for(var d in this.textcodes_lookup)c!==""?c+="|:"+this.textcodes_lookup[d]+":":c=":"+this.textcodes_lookup[d]+":",this.animation_disabled||(c+="|:"+this.textcodes_lookup[d]+"!:");this.smileycode_regex=new RegExp("("+c+")","g")}var e=function(a){for(var b in this.textcodes_lookup)if(!this.animation_disabled&&a.indexOf("!")>-1){if(this.textcodes_lookup[b]==a.replace(/:/g,"").replace("!","")&&b.indexOf("!")>-1)return b}else if(this.textcodes_lookup[b]==a.replace(/:/g,"")&&b.indexOf("!")===-1)return b}.bind(this);return b.replace(this.smileycode_regex,e)},fE.prototype.getSmileyName=function(b){return this.smiley_lookup[b]},fE.prototype.sortSmileys=function(b,c,d){var e=[];if(c){if(d)for(var f in this.symbol_lookup)if(f.startsWith(":"+c)){var g=this.symbol_lookup[f];e.push(g)}for(var h in b)b[h].startsWith(c)&&e.indexOf(h)===-1&&e.push(h);for(var i in b)!b[i].startsWith(c)&&e.indexOf(i)===-1&&e.push(i)}else for(var j in b)e.push(j);return e},fE.prototype.getEmojiLookup=function(b){var c={};if(b)for(var d in this.emoji_lookup)d.indexOf(b)>-1&&(c[d]=this.emoji_lookup[d]);else c=this.emoji_lookup;return c},fE.prototype.sortEmojis=function(b,c){var d=[];if(c){for(var e in b)e.startsWith(":"+c)&&d.push(e);for(var f in b)f.indexOf(c)>-1&&d.indexOf(f)===-1&&d.push(f)}else for(var g in b)d.push(g);return d},fE.prototype.getEmoji=function(b){var c="";for(var d=0;d<this.emoji_lookup[b].length;d++)c+=eP(parseInt(this.emoji_lookup[b][d].replace("#x",""),16));var e=K("smiley."+b.replace(/:/g,""));return m("span",{title:e,"data-smileycode":c},c)};var fF={},fG=function(a){function b(){a.call(this);var b={default_size:"24",animation:{default_size:"48"}};this.getSmileyCode=this.getSmileyCode.bind(this),this.searchSmiley=this.searchSmiley.bind(this),this.setZomojiNode=this.setZomojiNode.bind(this),this.displayZomoji=this.displayZomoji.bind(this),this.closeZomojiComponent=this.closeZomojiComponent.bind(this),this.displayLiveZomoji=this.displayLiveZomoji.bind(this),this.selectSmiley=this.selectSmiley.bind(this),this.setSmileyPosition=this.setSmileyPosition.bind(this),this.displayEmoji=this.displayEmoji.bind(this),this.zm=new fE(b),this.currentsmileyposition={row:0,column:0},this.state={smileyvalue:"",smileycodes:this.zm.sortSmileys(this.zm.getSmileyLookup(null)),currentpane:"zomoji",smiley_array:[],smileycodepositions:[]}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentDidUpdate=function(){var b=this.zomojinode.querySelector("div[data-selected=true]");b&&!eL(b,this.zomojinode.childNodes[1],!1)&&fb(b)},b.prototype.componentDidMount=function(){this.zomojinode.querySelector("input[type=text]").focus(),this.containerwidth=this.zomojinode.offsetWidth-14,this.populateSmiley()},b.prototype.setSmileyPosition=function(b){var c=0,d=0;b.type==="blur"&&(c=-1,d=-1),this.currentsmileyposition.row=c,this.currentsmileyposition.column=d,this.populateSmiley()},b.prototype.selectSmiley=function(b){var c=39,d=37,e=38,f=40,g=13,h=this.currentsmileyposition.row,i=this.currentsmileyposition.column;switch(b.keyCode){case c:i++,b.preventDefault();break;case d:i--,b.preventDefault();break;case e:h--;break;case f:h++;break;case g:this.state.smileycodepositions[h][i]&&this.props.getSmileyCode(this.state.smileycodepositions[h][i],b),b.preventDefault();break;default:h=0,i=0}i>this.totalcolumns&&(h++,i=0),i<0&&(h--,i=this.totalcolumns);if(h>this.totalrows||h<0||i>(this.state.smiley_array[h]&&this.state.smiley_array[h].props.children.length-1))return;this.currentsmileyposition.row=h,this.currentsmileyposition.column=i,this.populateSmiley()},b.prototype.addAnimationClass=function(b){var c=b.target.firstChild||b.target,d=c.getAttribute("data-smileycode").replace(/:/g,"").replace("!",""),e="https://img.zohostatic.com/chat/default/officechat/images/default/sm-animation/48/"+d+".png";J.get("builddomain")&&(e=J.get("builddomain")+e);if(fF[e])c.className=c.className.replace("zomoji-f-48","zomojianim-48");else{var f=new Image;f.src=e,f.onload=function(){fF[e]=!0,c.className=c.className.replace("zomoji-f-48","zomojianim-48")}}},b.prototype.removeAnimationClass=function(b){var c=b.target.firstChild||b.target;c.className=c.className.replace("zomojianim-48","zomoji-f-48")},b.prototype.displayLiveZomoji=function(b){this.zomojinode.querySelector("input[type=text]").focus(),this.setState({currentpane:"livezomoji"},function(){this.searchSmiley(null,this.state.smileyvalue)}),b.stopPropagation()},b.prototype.displayZomoji=function(b){this.zomojinode.querySelector("input[type=text]").focus(),this.setState({currentpane:"zomoji"},function(){this.searchSmiley(null,this.state.smileyvalue)}),b.stopPropagation()},b.prototype.displayEmoji=function(b){this.zomojinode.querySelector("input[type=text]").focus(),this.setState({currentpane:"emoji"},function(){this.searchSmiley(null,this.state.smileyvalue)}),b.stopPropagation()},b.prototype.closeZomojiComponent=function(b){var c=27;b.keyCode===c&&this.props.closeComponent()},b.prototype.setZomojiNode=function(b){this.zomojinode=b},b.prototype.getSmileyCode=function(b){var c=b.target.getAttribute("data-smileycode")||b.target.querySelector("[data-smileycode]").getAttribute("data-smileycode");this.props.getSmileyCode(c,b),b.preventDefault()},b.prototype.searchSmiley=function(b,c){var d=b&&b.target.value.toLowerCase().trim()||c,e=null;this.state.currentpane==="emoji"?e=this.zm.sortEmojis(this.zm.getEmojiLookup(d),d):e=this.zm.sortSmileys(this.zm.getSmileyLookup(d),d),this.setState({smileyvalue:d,smileycodes:e},function(){this.populateSmiley()})},b.prototype.populateSmiley=function(){var b=[],c=[],d=[],e=[],f=this.state.smileycodes,g=0,h=0;for(var i=0;i<f.length;i++){var j=f[i],k=!1;if(this.state.currentpane==="livezomoji"&&this.zm._isAnimationCode(j)){j=this.zm.getSmiley(j),this.totalcolumns=(this.containerwidth-this.containerwidth%58)/58;var l=fD.smileycnt+" "+fD.smileycntlive;this.currentsmileyposition.row===h&&this.currentsmileyposition.column===g&&(l+=" "+fD.selectedsmiley,k=!0),c.push(m("div",{"class":l,"data-selected":k,onmouseover:this.addAnimationClass,onmouseout:this.removeAnimationClass,onclick:this.getSmileyCode,tabindex:"-1"},j)),d.push(j.props["data-smileycode"]),g++}else if((this.state.currentpane==="zomoji"||this.state.currentpane==="emoji")&&!this.zm._isAnimationCode(j)){var n=fD.smileycnt;this.state.currentpane==="zomoji"?j=this.zm.getSmiley(j):(j=this.zm.getEmoji(f[i]),n+=" "+fD.emoji),this.totalcolumns=(this.containerwidth-this.containerwidth%32)/32,this.currentsmileyposition.row===h&&this.currentsmileyposition.column===g&&(n+=" "+fD.selectedsmiley,k=!0),c.push(m("div",{"class":n,tabindex:"-1","data-selected":k,onclick:this.getSmileyCode},j)),d.push(j.props["data-smileycode"]),g++}g===this.totalcolumns&&(b.push(m("div",{"class":fD.row},c)),c=[],g=0,e.push(d),d=[],h++)}c&&(b.push(m("div",{"class":fD.rowlast},c)),e.push(d),d=[],h++),this.totalrows=h-1,this.totalcolumns-=1,this.setState({smiley_array:b,smileycodepositions:e})},b.prototype.render=function(b,c){var d=fD.togglertop,e="",f="";c.currentpane==="livezomoji"&&(e=fD.togglertop,d=""),c.currentpane==="emoji"&&(f=fD.togglertop,d="");var g="";return b.animation&&(g=m("div",{"class":fD.toggler},m(bW,{classname:fD.zomoji+" "+d,onclick:this.displayZomoji},m(bW,{classname:fD.zomojiicon,content:"e958",type:"icon",tabindex:"-1"})),m(bW,{classname:fD.livezomoji+" "+e,onclick:this.displayLiveZomoji},m(bW,{content:"e987",type:"icon",tabindex:"-1"}),m(bW,{classname:fD.livezomojiicon,content:"e988",type:"icon",tabindex:"-1"}),m(bW,{classname:fD.livezomojiicon,content:"e989",type:"icon",tabindex:"-1"})),m(bW,{classname:fD.zomoji+" "+f,onclick:this.displayEmoji},m(bW,{classname:fD.zomojiicon,content:"e952",type:"icon",tabindex:"-1"})))),m("div",{"class":fD.zomojiContainer,ref:this.setZomojiNode,onkeydown:this.closeZomojiComponent},m("div",{"class":fD.searchBox},m("input",{"data-purpose":"search",type:"text",placeholder:"Search",onfocus:this.setSmileyPosition,onblur:this.setSmileyPosition,oninput:this.searchSmiley,onkeydown:this.selectSmiley})),m("div",{"class":fD.smileyContainer},this.state.smiley_array),g)},b}(p),fH=function(){this.unmountComponent=this.unmountComponent.bind(this)};fH.prototype.mountComponent=function(b,c,d,e){this.node=b,G(m(fG,{animation:c,getSmileyCode:d,closeComponent:e}),b)},fH.prototype.unmountComponent=function(){G("",this.node)};var fI={hours:"mc6f7529c1_hours",minutes:"mc6f7529c1_minutes",timeperiod:"mc6f7529c1_timeperiod",timecontainer:"mc6f7529c1_timecontainer",timeicon:"mc6f7529c1_timeicon",timecnt:"mc6f7529c1_timecnt",invalidcnt:"mc6f7529c1_invalidcnt",colon:"mc6f7529c1_colon",zmNightMode:"zmNightMode"},fJ=function(a){function b(b){a.call(this,b),b.time?this.state=this.constructStateFromTime(b.time):this.state=this.constructStateFromTime(),this.handleTimeInput=this.handleTimeInput.bind(this),this.handleUpDownArrows=this.handleUpDownArrows.bind(this),this.handleTimePeriod=this.handleTimePeriod.bind(this),this.onTimeChange=this.props.onTimeChange}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.constructStateFromTime=function(b){var c="--",d="--",e="--";return b&&(b=new Date(b),c=b.getHours()%12,c=c===0?12:c,c+="",c=c.length===1?"0"+c:c,d=b.getMinutes(),d+="",d=d.length===1?"0"+d:d,e=b.getHours()<12?"AM":"PM"),{hours:c,minutes:d,timeperiod:e,invalid_hours:!1,invalid_minutes:!1,invalid_timeperiod:!1}},b.prototype.updateTime=function(b){this.setState(this.constructStateFromTime(b))},b.prototype.componentDidUpdate=function(b,c){if(c.hours==this.state.hours&&c.minutes==this.state.minutes&&c.timeperiod==this.state.timeperiod)return;var d=this.state.hours+":"+this.state.minutes,e=d+" "+this.state.timeperiod,f=d,g=!1,h=!1;if(this.state.timeperiod=="AM"){var i=parseInt(this.state.hours);this.state.hours==12&&(i="00"),f=i+":"+this.state.minutes}if(this.state.timeperiod==="PM"){var j=parseInt(this.state.hours)+12;j==24&&(j="12"),f=j+":"+this.state.minutes}if(this.state.invalid_hours||this.state.hours==="--")g=!0;if(this.state.invalid_minutes||this.state.minutes==="--")h=!0;this.onTimeChange(e,f,g,h)},b.prototype.handleTimePeriod=function(b){var c=38,d=40,e=65,f=80,g=9;b.keyCode!=g&&b.preventDefault();var h=this.state.timeperiod;b.type==="click"&&h==="--"&&(h="AM");if(b.keyCode===c||b.keyCode===d)this.state.timeperiod==="AM"?h="PM":h="AM";b.keyCode==e?h="AM":b.keyCode==f?h="PM":h!="AM"&&h!="PM"&&(h="AM"),this.setState({timeperiod:h})},b.prototype.handleUpDownArrows=function(b,c){var d=38,e=40,f=b.target.value!="--"?parseInt(b.target.value):0;if(b.keyCode===d||b.keyCode===e)b.keyCode===d&&f++,b.keyCode===e&&f--,c==="hours"&&(f>12?f=1:f<1&&(f=12)),c==="minutes"&&(f>59?f=0:f<0&&(f=59)),this.handleTimeInput(f+"",c)},b.prototype.handleTimeInput=function(b,c){var d=!1;isNaN(parseInt(b))&&(b="",d=!0);if(!isNaN(b)&&b.length<=2){b.length==1&&(b="0"+b);if(c=="hours"){if(b>12||b<=0)d=!0}else b>59&&(d=!0)}else b="",d=!0;c=="hours"?this.setState({hours:b,invalid_hours:d}):this.setState({minutes:b,invalid_minutes:d})},b.prototype.render=function(){var b=this,c=this.state.invalid_hours?fI.invalidcnt:"",d=this.state.invalid_minutes?fI.invalidcnt:"",e=this.state.invalid_timeperiod?fI.invalidcnt:"";return m("div",{"class":fI.timecontainer},m("span",{"class":fI.timecnt},m("input",{type:"text",maxlength:"2",value:this.state.hours,onchange:function(a){b.handleTimeInput(a.target.value,"hours")},onkeydown:function(a){b.handleUpDownArrows(a,"hours")},"class":fI.hours+" "+c}),m("span",{"class":fI.colon},":"),m("input",{type:"text",maxlength:"2",value:this.state.minutes,onchange:function(a){b.handleTimeInput(a.target.value,"minutes")},onkeydown:function(a){b.handleUpDownArrows(a,"minutes")},"class":fI.minutes+" "+d}),m("input",{type:"text",maxlength:"2",value:K(this.state.timeperiod),onclick:this.handleTimePeriod,onkeydown:this.handleTimePeriod,"class":fI.timeperiod+""+e})),m("span",{"class":fI.timeicon}," "))},b}(p),fK=function(){this.instance=null};fK.prototype.mountComponent=function(b,c,d){G(m(fJ,{ref:function(a){this.instance=a}.bind(this),onTimeChange:d,time:c}),b)},fK.prototype.updateTime=function(b){this.instance.updateTime(b)},Object.keys===undefined&&(Object.keys=function(a){var b=[];for(var c in a)b.push(c);return b}),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.indexOf(a,b)===b}),String.prototype.endsWith||(String.prototype.endsWith=function(a,b){if(b===undefined||b>this.length)b=this.length;return this.substring(b-a.length,b)===a}),Array.prototype.filter||(Array.prototype.filter=function(a){if(this===void 0||this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=[],e=arguments.length>=2?arguments[1]:void 0;for(var f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(this===null||this===undefined)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if(typeof a!="function")throw new TypeError(a+" is not a function");arguments.length>1&&(c=b),d=new Array(g),e=0;while(e<g){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(this===null||this===undefined)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if(typeof a!="function")throw new TypeError(a+" is not a function");arguments.length>1&&(c=b),d=0;while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){if(this==null)throw new TypeError("'this' is null or not defined");var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError("predicate must be a function");var d=arguments[1],e=0;while(e<c){var f=b[e];if(a.call(d,f,e,b))return f;e++}return undefined}}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){var b=(this.document||this.ownerDocument).querySelectorAll(a),c=b.length;while(--c>=0&&b.item(c)!==this)continue;return c>-1}),Element.prototype.closest||(Element.prototype.closest=function(a){var b=this;while(b.matches){if(b.matches(a))return b;b=b.parentNode}return null}),Array.prototype.some||(Array.prototype.some=function(a){if(this==null)throw new TypeError("Array.prototype.some called on null");if(typeof a!="function")throw new TypeError;var b=Object(this),c=b.length>>>0,d=arguments.length>=2?arguments[1]:void 0;for(var e=0;e<c;e++)if(e in b&&a.call(d,b[e],e,b))return!0;return!1}),typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(b,c){var d=arguments;if(b==null)throw new TypeError("Cannot convert undefined or null to object");var e=Object(b);for(var f=1;f<arguments.length;f++){var g=d[f];if(g!=null)for(var h in g)Object.prototype.hasOwnProperty.call(g,h)&&(e[h]=g[h])}return e},writable:!0,configurable:!0});var fL,fS=Object.freeze({__proto__:null,setResource:fM,replace:fR}),fT={theatremode_overlay:"mc183cf01f_theatremode_overlay",playerfwdcontainer:"mc183cf01f_playerfwdcontainer",playerforwardicon:"mc183cf01f_playerforwardicon",posterimage:"mc183cf01f_posterimage",playeroverlay:"mc183cf01f_playeroverlay",playerparent_container:"mc183cf01f_playerparent_container",playerpopout:"mc183cf01f_playerpopout",displayminiplayer:"mc183cf01f_displayminiplayer",theatremode:"mc183cf01f_theatremode",videoplayer_container:"mc183cf01f_videoplayer_container",video_content:"mc183cf01f_video_content",playpausecontainer:"mc183cf01f_playpausecontainer",fullscreenplaypause:"mc183cf01f_fullscreenplaypause",playpauseinitial:"mc183cf01f_playpauseinitial",forwardiconcontainer:"mc183cf01f_forwardiconcontainer",downloadiconcontainer:"mc183cf01f_downloadiconcontainer",playicon:"mc183cf01f_playicon",forwardicon:"mc183cf01f_forwardicon",overlaydownloadicon:"mc183cf01f_overlaydownloadicon",videodesc:"mc183cf01f_videodesc",videodesc_theatremode:"mc183cf01f_videodesc_theatremode",rightarrow:"mc183cf01f_rightarrow",rightarrow_theatremode:"mc183cf01f_rightarrow_theatremode",closeicon:"mc183cf01f_closeicon",controller_bgclass:"mc183cf01f_controller_bgclass",controls_container:"mc183cf01f_controls_container",controls_container_theatremode:"mc183cf01f_controls_container_theatremode",seekbar:"mc183cf01f_seekbar",seekbar_theatremode:"mc183cf01f_seekbar_theatremode",leftpane:"mc183cf01f_leftpane",rightpane:"mc183cf01f_rightpane",duration_content:"mc183cf01f_duration_content",duration_theatremode:"mc183cf01f_duration_theatremode",tooltip:"mc183cf01f_tooltip",tooltip_theatremode:"mc183cf01f_tooltip_theatremode",buffer:"mc183cf01f_buffer",seekguide:"mc183cf01f_seekguide",progressbar:"mc183cf01f_progressbar",sliderthumb:"mc183cf01f_sliderthumb",seekbar_hoverspace:"mc183cf01f_seekbar_hoverspace",popedin:"mc183cf01f_popedin",seekbarfocus:"mc183cf01f_seekbarfocus",volume_slider_container:"mc183cf01f_volume_slider_container",volumesliderparent:"mc183cf01f_volumesliderparent",volumeslider_theatremode:"mc183cf01f_volumeslider_theatremode",volfocuson:"mc183cf01f_volfocuson",volumeslider_background:"mc183cf01f_volumeslider_background",volume_lowerfill:"mc183cf01f_volume_lowerfill",volume_thumb:"mc183cf01f_volume_thumb",iconsmall:"mc183cf01f_iconsmall",iconmed:"mc183cf01f_iconmed",iconlarge:"mc183cf01f_iconlarge",ffbuttoncontainer:"mc183cf01f_ffbuttoncontainer",videomodeplayicon:"mc183cf01f_videomodeplayicon",display:"mc183cf01f_display",details:"mc183cf01f_details",displaydetails:"mc183cf01f_displaydetails",header:"mc183cf01f_header",topgradiant:"mc183cf01f_topgradiant",videoend_details:"mc183cf01f_videoend_details",downloadicon:"mc183cf01f_downloadicon",actionscontainer:"mc183cf01f_actionscontainer",videomodefwdicon:"mc183cf01f_videomodefwdicon",basic_controlscontainer:"mc183cf01f_basic_controlscontainer",ffbutton:"mc183cf01f_ffbutton",rewbutton:"mc183cf01f_rewbutton",revbutton:"mc183cf01f_revbutton",loadingdiv:"mc183cf01f_loadingdiv",progressbar_parent:"mc183cf01f_progressbar_parent",seekbar_thumb:"mc183cf01f_seekbar_thumb",replayicon:"mc183cf01f_replayicon"},fU=function(a){function b(b){a.call(this),this.progressbarwidth=b.current_time/b.duration||0,this.tooltip_time="00:00",this.seekbarwidth=0,this.setSeekBarNode=this.setSeekBarNode.bind(this),this.setProgressBarWidth=this.setProgressBarWidth.bind(this),this.setSeekGuideWidth=this.setSeekGuideWidth.bind(this),this.seekVideo=this.seekVideo.bind(this),this.setClickedState=this.setClickedState.bind(this),this.dragThumb=this.dragThumb.bind(this),this.removeThumbEventListener=this.removeThumbEventListener.bind(this),this.state={seekguidewidth:0,clicked:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentWillUnmount=function(){document.removeEventListener("mouseup",this.removeThumbEventListener,!0)},b.prototype.componentDidMount=function(){document.addEventListener("mouseup",this.removeThumbEventListener,!0)},b.prototype.removeThumbEventListener=function(){document.removeEventListener("mousemove",this.seekVideo)},b.prototype.componentWillUpdate=function(b){b.current_time===0&&(this.progressbarwidth=0)},b.prototype.componentDidUpdate=function(b){Math.floor(b.current_time)!=Math.floor(this.props.current_time)&&this.setProgressBarWidth(),this.props.current_time===0&&(this.progressbarwidth=0)},b.prototype.setSeekBarNode=function(b){this.seekbarnode=b},b.prototype.setClickedState=function(){this.setState({clicked:!1})},b.prototype.setProgressBarWidth=function(b){var c=this.props.duration,d=b||this.props.current_time;this.progressbarwidth=0,c!=0&&(this.progressbarwidth=d/c),this.progressbarwidth>1&&(this.progressbarwidth=1),this.seekbarnode.offsetWidth*this.progressbarwidth<6&&(this.progressbarwidth=6/this.seekbarnode.offsetWidth)},b.prototype.getWidthPerSecond=function(){return this.seekbarwidth=this.seekbarnode.getBoundingClientRect().width,this.seekbarwidth/this.props.duration},b.prototype.setToolTip=function(b){this.tooltippos=b-20,b+20>this.seekbarwidth&&(this.tooltippos=this.seekbarwidth-40),b-20<0&&(this.tooltippos=0),this.tooltip_time=er(Math.ceil(b/this.getWidthPerSecond()))},b.prototype.setSeekGuideWidth=function(b){var c=b.clientX-b.target.getBoundingClientRect().left,d=c/this.seekbarwidth;d>1&&(d=1),this.setToolTip(c),this.setState({seekguidewidth:d})},b.prototype.seekVideo=function(b){if(b.type==="keydown"){var c=39,d=37,e=this.props.current_time;b.keyCode===c&&(e=this.props.current_time+10,e>this.props.duration&&(e=this.props.duration)),b.keyCode===d&&(e=this.props.current_time-10,e<0&&(e=0)),this.props.updateCurrentTime(e)}if(b.type==="mousedown"||b.type=="mousemove"){var f=b.clientX-this.seekbarnode.getBoundingClientRect().left,g=f/this.getWidthPerSecond();g<0&&(g=0),this.setProgressBarWidth(g),this.props.updateCurrentTime(g),this.setState({clicked:!0})}b.stopPropagation()},b.prototype.dragThumb=function(b){document.addEventListener("mousemove",this.seekVideo),this.seekVideo(b)},b.prototype.render=function(b,c){var d=c.clicked?"":fT.seekbarfocus,e=fT.seekbar,f=fT.tooltip;if(b.fullscreen||b.theatremode)e=fT.seekbar_theatremode,f=fT.tooltip_theatremode;return m("div",{"class":e+" "+d,ref:this.setSeekBarNode,tabindex:"0",onkeydown:this.seekVideo,onblur:this.setClickedState,onmousedown:this.dragThumb,onmousemove:this.setSeekGuideWidth},m("div",{"class":fT.buffer,style:{transform:"scaleX("+b.bufferpercentage+")"}}),m("div",{"class":fT.seekguide,style:{transform:"scaleX("+c.seekguidewidth+")"}}),m("div",{"class":fT.progressbar_parent,onmousedown:this.dragThumb,style:{transform:"scaleX("+this.progressbarwidth+")"}},m("div",{"class":fT.progressbar}),m("div",{"class":fT.seekbar_thumb,style:{transform:"scaleX("+1/this.progressbarwidth+")"}})),m("div",{"class":fT.seekbar_hoverspace,onmousedown:this.dragThumb}),m("div",{"class":f,style:{left:this.tooltippos+"px"}},this.tooltip_time))},b}(p),fV=function(a){function b(b){a.call(this),this.slidernode=null,this.volume=b.volume||1,this.state={position:this.volume*64,clicked:!1},this.setEventListener=this.setEventListener.bind(this),this.setThumbPosition=this.setThumbPosition.bind(this),this.setSliderNode=this.setSliderNode.bind(this),this.setVolume=this.setVolume.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.volumeBlur=this.volumeBlur.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentDidMount=function(){window.addEventListener("mouseup",this.removeEventListener,!0)},b.prototype.setSliderNode=function(b){this.slidernode=b},b.prototype.setVolume=function(b){if(!b.type||b.type!=="click"&&b.type!=="keydown")this.volume=b;else{var c=0;this.volume>0?this.volume=0:(this.volume=1,c=64),this.setState({position:c})}this.props.setVolume(this.volume)},b.prototype.volumeBlur=function(){this.setState({clicked:!1})},b.prototype.setEventListener=function(b){window.addEventListener("mousemove",this.setThumbPosition),this.slidernode.addEventListener("mouseup",this.setThumbPosition),this.setState({clicked:!0}),b.stopPropagation()},b.prototype.setThumbPosition=function(b){var c=this.state.position;if(b.type==="keydown"){var d=38,e=40;b.keyCode===d&&(c+=5.2),b.keyCode===e&&(c-=5.2),b.preventDefault(),b.stopPropagation()}if(b.type==="mouseup"||b.type==="mousemove")c=b.clientY-this.slidernode.getBoundingClientRect().top,c=70-c,b.preventDefault(),b.stopPropagation();c<0&&(c=0),c>64&&(c=64),this.setVolume(c/64),this.setState({position:c})},b.prototype.removeEventListener=function(){window.removeEventListener("mousemove",this.setThumbPosition),window.removeEventListener("mouseup",this.setThumbPosition)},b.prototype.render=function(b,c){var d=fT.iconsmall,e="ea16";this.volume===0&&(e="ea11");var f=c.clicked?"":fT.volfocuson,g=fT.volumesliderparent;if(b.theatremode||b.fullscreen)d=fT.iconmed,g=g+" "+fT.volumeslider_theatremode;return m("div",{"class":fT.volume_slider_container},m(bW,{classname:d,type:"icon",title:K("videoplayer.volume"),content:e,onclick:this.setVolume}),m("div",{"class":g+" "+f,ref:this.setSliderNode,onmousedown:this.setEventListener,onmouseup:this.removeEventListener,onkeydown:this.setThumbPosition,onblur:this.volumeBlur,tabindex:"0"},m("div",{"class":fT.volumeslider_background},m("span",{"class":fT.volume_lowerfill,style:{height:c.position+"px"}}),m("span",{"class":fT.volume_thumb,style:{bottom:c.position+"px"}}))))},b}(p),fX={},fY=[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenElement"],["webkitRequestFullScreen","webkitExitFullscreen","webkitfullscreenchange","webkitFullscreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullscreenElement"],["msRequestFullscreen","msExitFullscreen","msfullscreenchange","msFullscreenElement"]];for(var fZ=0;fZ<fY.length;fZ++){var f$=fY[fZ];if(f$&&f$[1]in document)for(var f_=0;f_<f$.length;f_++)fX[fY[0][f_]]=f$[f_]}var ga=function(b,c){this.node=b,this.onFullScreenChangeCallBack=c,this.onFullScreenChange=this.onFullScreenChange.bind(this),document.addEventListener(fX.fullscreenchange,this.onFullScreenChange,!1)};ga.prototype.onFullScreenChange=function(){this.onFullScreenChangeCallBack()},ga.prototype.requestFullScreen=function(){this.node[fX.requestFullscreen]()},ga.prototype.exitFullScreen=function(){document[fX.exitFullscreen]()},ga.prototype.toggleFullScreen=function(){document[fX.fullscreenElement]?this.exitFullScreen():this.requestFullScreen()},ga.prototype.removeEventListener=function(){document.removeEventListener(fX.onscreenchange,this.onFullScreenChange,!1)};var gb=function(b,c,d){this.node=b,this.dragStart=this.dragStart.bind(this),this.dragOver=this.dragOver.bind(this),this.dragEnd=this.dragEnd.bind(this),this.dragStartCallBack=c,this.dragEndCallBack=d,this.node.onmousedown=this.dragStart,this.node.onmouseup=this.dragEnd};gb.prototype.dragStart=function(b){this.mouse_xposition=this.node.getBoundingClientRect().width-(b.clientX-this.node.getBoundingClientRect().x),this.mouse_yposition=this.node.getBoundingClientRect().height-(b.clientY-this.node.getBoundingClientRect().y),document.addEventListener("mousemove",this.dragOver),this.dragStartCallBack&&this.dragStartCallBack()},gb.prototype.dragOver=function(b){var c=0,d=0;this.node.setAttribute("data-drag","true"),c=document.documentElement.clientWidth-(b.clientX+this.mouse_xposition),d=document.documentElement.clientHeight-(b.clientY+this.mouse_yposition),d<0&&(d=0),d+this.node.offsetHeight>document.documentElement.clientHeight&&(d=document.documentElement.clientHeight-this.node.offsetHeight),c+this.node.offsetWidth>document.documentElement.clientWidth&&(c=document.documentElement.clientWidth-this.node.offsetWidth),c<0&&(c=0),this.node.style.right=c+"px",this.node.style.bottom=d+"px"},gb.prototype.dragEnd=function(b){this.dragEndCallBack&&this.dragEndCallBack(),document.removeEventListener("mousemove",this.dragOver),b.preventDefault(),b.stopPropagation()};var gc=function(a){function b(b){a.call(this),this.videoplayernode=null,this.videosourcenode=null,this.timeout=null,this.state={fullscreen:!1,videostate:b.videostate||"playing",volume:b.volume||1,current_time:b.current_time||0,duration:b.duration||0,bufferpercentage:0,displayopacity:fT.displaydetails,display:"block",displayminiplayer:!1},this.toggleFullScreen=this.toggleFullScreen.bind(this),this.setVideoPlayerNode=this.setVideoPlayerNode.bind(this),this.onFullScreenChange=this.onFullScreenChange.bind(this),this.toggleVideoPlay=this.toggleVideoPlay.bind(this),this.setVideoSourceNode=this.setVideoSourceNode.bind(this),this.setVolume=this.setVolume.bind(this),this.onVideoEnd=this.onVideoEnd.bind(this),this.updateTime=this.updateTime.bind(this),this.updateCurrentTime=this.updateCurrentTime.bind(this),this.handleDragEnd=this.handleDragEnd.bind(this),this.toggleMiniPlayer=this.toggleMiniPlayer.bind(this),this.handleDragStart=this.handleDragStart.bind(this),this.toggleTheatreMode=this.toggleTheatreMode.bind(this),this.escEventListener=this.escEventListener.bind(this),this.displayPlayerDetails=this.displayPlayerDetails.bind(this),this.detailsTransitionEnd=this.detailsTransitionEnd.bind(this),this.playerMouseOut=this.playerMouseOut.bind(this),this.throttle=es(this.displayPlayerDetails,this,300),this.calcBufferPercentage=this.calcBufferPercentage.bind(this),this.ffVideo=this.ffVideo.bind(this),this.rewVideo=this.rewVideo.bind(this),this.setLoadingState=this.setLoadingState.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentWillUnmount=function(){window.removeEventListener("keydown",this.escEventListener),window.removeEventListener("keydown",this.toggleVideoPlay),this.fullscreen.removeEventListener(),this.activeelement.focus()},b.prototype.calcBufferPercentage=function(){if(this.videosourcenode){var b=0,c=0,d=this.videosourcenode.buffered,e=this.videosourcenode.currentTime;if(this.videosourcenode.readyState>=2){for(var f=0;f<d.length;f++)if(e>=d.start(f)&&e<=d.end(f)){c=f;break}b=d.end(c)/this.videosourcenode.duration}this.setState({bufferpercentage:b})}},b.prototype.componentDidMount=function(){this.fullscreen=new ga(this.videoplayernode,this.onFullScreenChange),this.activeelement=document.activeElement,window.addEventListener("keydown",this.escEventListener);if(this.props.current_time||this.props.current_time===0)this.videoplayernode.focus(),this.videosourcenode.currentTime=this.props.current_time,this.props.videostate==="paused"?this.videosourcenode.pause():this.props.videostate==="playing"&&this.videosourcenode.play();this.props.theatremode&&window.addEventListener("keydown",this.toggleVideoPlay),this.props.popout&&(new gb(this.videoplayernode,this.handleDragStart,this.handleDragEnd),this.setState({displayminiplayer:!0})),this.props.config.theatremode==1&&this.toggleTheatreMode(null,!1)},b.prototype.playerMouseOut=function(b){b.relatedTarget.closest("div[data-playerparent=true]")||this.setState({displayopacity:""})},b.prototype.detailsTransitionEnd=function(b){b.srcElement.getAttribute("data-id")==="playerdetails"&&this.state.displayopacity==""&&this.setState({display:"none"})},b.prototype.displayPlayerDetails=function(){this.videoplayernode&&(this.setState({displayopacity:fT.displaydetails,display:"block"}),clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.setState({displayopacity:""})}.bind(this),2500))},b.prototype.escEventListener=function(b){var c=27,d=39,e=37,f=0;b.keyCode===c&&this.props.theatremode&&this.toggleTheatreMode(b),b.keyCode==d&&this.props.theatremode?(f=this.state.current_time+5,f>this.state.duration&&(f=this.state.duration),this.updateCurrentTime(f)):b.keyCode==e&&this.props.theatremode&&(f=this.state.current_time-5,f<0&&(f=0),this.updateCurrentTime(f))},b.prototype.handleDragStart=function(){this.state.videostate==="playing"&&this.videosourcenode.pause()},b.prototype.handleDragEnd=function(){this.state.videostate==="playing"&&this.videosourcenode.play()},b.prototype.toggleMiniPlayer=function(b){if(b.type!="click"&&this.state.videostate==="ended")return;var c=!0;this.videosourcenode.currentTime=0,this.videosourcenode.pause(),this.props.popout&&(c=!1),this.props.theatremode&&this.toggleTheatreMode(b,"pausepreviousplayer"),this.props.toggleMiniPlayer(this.props.videosrc,this.state.current_time,c,this.state.videostate,this.state.volume,this.state.duration,this.props.videoname,this.props.videotype,this.props.uploadername,this.props.zindex,this.props.videoid,this.props.config),this.setState({videostate:"paused"}),b.preventDefault(),b.stopPropagation()},b.prototype.toggleTheatreMode=function(b,c){var d=!0;this.videosourcenode.currentTime=0,this.videosourcenode.pause(),this.props.theatremode&&(d=!1),this.props.toggleTheatreView(this.props.videosrc,this.state.current_time,d,this.videoplayernode,this.state.videostate,this.state.volume,this.state.duration,this.props.videoname,this.props.videotype,this.props.uploadername,this.props.zindex,this.props.videoid,this.props.config),c||this.setState({videostate:"paused"}),b&&(b.preventDefault(),b.stopPropagation())},b.prototype.updateTime=function(){if(this.videosourcenode&&this.videosourcenode.readyState>2){this.state.bufferpercentage===0&&this.calcBufferPercentage();var b=this.state.videostate;this.state.videostate=="ended"?b="paused":this.state.videostate=="loading"&&(b="playing"),this.setState({current_time:this.videosourcenode.currentTime,duration:Math.floor(this.videosourcenode.duration),videostate:b})}},b.prototype.setVideoSourceNode=function(b){this.videosourcenode=b},b.prototype.setVolume=function(b){b=Math.round(parseFloat(b)*100)/100,this.setState({volume:b}),this.videosourcenode.volume=b},b.prototype.setVideoPlayerNode=function(b){this.videoplayernode=b},b.prototype.updateCurrentTime=function(b){this.setState({current_time:b}),this.videosourcenode.currentTime=b},b.prototype.onFullScreenChange=function(){this.setState({fullscreen:!this.state.fullscreen})},b.prototype.toggleFullScreen=function(){this.fullscreen.toggleFullScreen()},b.prototype.toggleVideoPlay=function(b){if(this.videoplayernode.getAttribute("data-drag")==="true"){this.videoplayernode.setAttribute("data-drag","false");return}if(this.state.videostate=="loading")return;if(b.type==="click"||b.type==="keydown"&&(b.keyCode===32||b.keyCode===13)){var c=null;if(this.videosourcenode.paused)this.videosourcenode.play(),c="playing",this.props.pauseRemainingInstances&&this.props.pauseRemainingInstances(b);else if(this.videosourcenode.play){if(this.videosourcenode.readyState==0)return;this.videosourcenode.pause(),c="paused"}this.setState({videostate:c})}},b.prototype.onVideoEnd=function(){this.videosourcenode.ended&&this.setState({videostate:"ended"})},b.prototype.ffVideo=function(b){this.updateCurrentTime(this.state.current_time+5)},b.prototype.rewVideo=function(b){this.updateCurrentTime(this.state.current_time-5)},b.prototype.setLoadingState=function(b){this.state.videostate=="playing"&&this.setState({videostate:"loading"}),b.stopPropagation(),b.preventDefault()},b.prototype.render=function(b,c){var d="vidplayer",e="",f="",g="ea1b",h=fT.videodesc,i=fT.playpausecontainer,j=null,k=null,l=fT.iconsmall,n=fT.popedin,o="",p="",q="",r=K("videoplayer.pause"),s="",t="",u="",v="",w="";c.videostate==="playing"&&(g="ea12"),c.videostate==="ended"&&(g="ea17",q=fT.videoend_details,r=K("videoplayer.replay"),w=fT.replayicon),c.videostate==="paused"&&(q=fT.videoend_details,r=K("videoplayer.play")),this.props.popout&&(k=m(bW,{classname:fT.closeicon+" "+fT.iconsmall,type:"icon",title:K("Close"),content:"e9ee",onclick:this.toggleMiniPlayer}),e=fT.playerpopout,f={"z-index":b.zindex});if(!c.fullscreen&&b.theatremode||c.fullscreen)i=i+" "+fT.fullscreenplaypause,h=h+" "+fT.videodesc_theatremode,l=fT.iconlarge,s=m("div",{"class":fT.ffbuttoncontainer,onclick:this.ffVideo},m(bW,{type:"icon",classname:fT.iconlarge+" "+fT.ffbutton,content:"ea14"})),t=m("div",{"class":fT.ffbuttoncontainer,onclick:this.rewVideo},m(bW,{type:"icon",classname:fT.iconlarge+" "+fT.rewbutton,content:"ea0c"}));!c.fullscreen&&b.theatremode&&(j=m(bW,{classname:fT.closeicon+" "+fT.iconmed,type:"icon",title:K("Close"),content:"e9ee",onclick:this.toggleTheatreMode}),d="wms_theatremode",e=fT.theatremode,n="",f={"z-index":b.zindex});var x=m("video",{autoplay:!0,onloadstart:this.setLoadingState,onwaiting:this.setLoadingState,preload:"none",onprogress:this.calcBufferPercentage,poster:b.poster,"class":fT.video_content,ref:this.setVideoSourceNode,onended:this.onVideoEnd,src:b.videosrc,ontimeupdate:this.updateTime});return b.popout&&(d="wms_playerpopout",n=""),c.displayminiplayer&&(p=fT.displayminiplayer),c.display==="none"&&(o=fT.display),this.state.videostate=="loading"?v=m("div",{key:"loader","class":fT.basic_controlscontainer},m("div",{"class":i},m("div",{"class":fT.loadingdiv}))):u=m("div",{key:"controls","class":fT.basic_controlscontainer},t,m("div",{"class":i,title:r,onclick:this.toggleVideoPlay},m(bW,{classname:l+" "+fT.videomodeplayicon+" "+w,type:"icon",content:g})),s),m("div",{tabindex:"0",ref:this.setVideoPlayerNode,id:d,"class":fT.playerparent_container+" "+n+" "+c.displayopacity+" "+e+" "+p+" "+q,"data-playerparent":"true","data-videoplayer":"true",style:f,onmousemove:this.throttle,mouseout:this.playerMouseOut,onclick:this.displayPlayerDetails},m("div",{"data-id":"videoplayer","class":fT.videoplayer_container,onclick:this.toggleVideoPlay},x),v,m("div",{key:"playerdetails","data-id":"playerdetails","class":o+" "+fT.details,ontransitionend:this.detailsTransitionEnd},m("div",{"class":fT.header},m("div",{"class":fT.topgradiant}),m("div",{"class":h},m("span",{title:b.videoname},b.videoname)),k,j),u,m(fW,{fullscreen:c.fullscreen,toggleFullScreen:this.toggleFullScreen,setVolume:this.setVolume,volume:c.volume,current_time:c.current_time,duration:c.duration,updateCurrentTime:this.updateCurrentTime,renderSettings:this.renderSettings,bufferpercentage:c.bufferpercentage,popout:this.props.popout,toggleMiniPlayer:this.toggleMiniPlayer,theatremode:b.theatremode,toggleTheatreMode:this.toggleTheatreMode,videoplayernode:this.videoplayernode,forwardAttachment:b.forwardAttachment,videosrc:b.videosrc,config:b.config})))},b}(p),gd=function(){this.forwardAttachment=null,this.toggleMiniPlayer=this.toggleMiniPlayer.bind(this),this.toggleTheatreView=this.toggleTheatreView.bind(this),this.forwardAttachmentCallBack=this.forwardAttachmentCallBack.bind(this),this.pauseRemainingInstances=this.pauseRemainingInstances.bind(this),this.pauseVideoPlayer=this.pauseVideoPlayer.bind(this)};gd.prototype.forwardAttachmentCallBack=function(){this.forwardAttachment()},gd.prototype.invokeToggleMiniPlayer=function(b){this.instance.state.videostate==="playing"&&this.instance.toggleMiniPlayer(b)},gd.prototype.toggleTheatreModeOverlay=function(b,c){if(b){var d=eY("div","wms_theatremode_overlay",fT.theatremode_overlay);d.style.zIndex=c,document.body.appendChild(d)}else fi(document.getElementById("wms_theatremode_overlay"))},gd.prototype.toggleTheatreView=function(b,c,d,e,f,g,h,i,j,k,l,n,o){this.toggleTheatreModeOverlay(d,l);var p=document.getElementById("wms_theatre_mountpoint");p||(p=eY("div","wms_theatre_mountpoint"),document.body.appendChild(p));if(d){o.theatremode==1&&(o.theatremode=!1,this.unmountComponent());var q=m(gc,{ref:function(a){this.storeTheatremodeInstance(a)}.bind(this),videosrc:b,current_time:c,videostate:f,volume:g,duration:h,videoname:i,videotype:j,uploadername:k,theatremode:d,zindex:l,videoid:n,toggleTheatreView:this.toggleTheatreView,toggleMiniPlayer:this.toggleMiniPlayer,forwardAttachment:this.forwardAttachmentCallBack,config:o});if(document.getElementById("wms_popout_mountpoint")){var r=document.getElementById("wms_popout_mountpoint");G("",r),fi(r)}G(q,p)}else G(null,p),fi(p),o&&o.onComponentClose&&o.onComponentClose()},gd.prototype.toggleMiniPlayer=function(b,c,d,e,f,g,h,i,j,k,l,n){var o=document.getElementById("wms_popout_mountpoint");o||(o=eY("div","wms_popout_mountpoint"),document.body.appendChild(o));if(d){var p=m(gc,{ref:function(a){this.storeMiniPlayerInstance(a)}.bind(this),"class":fT.name,key:b,videosrc:b,current_time:c,videostate:e,volume:f,duration:g,videoname:h,videotype:i,uploadername:j,popout:d,zindex:k,videoid:l,toggleMiniPlayer:this.toggleMiniPlayer,toggleTheatreView:this.toggleTheatreView,forwardAttachment:this.forwardAttachmentCallBack,config:n});this.unmountComponent(),document.getElementById("wms_popout_mountpoint")&&G("",document.getElementById("wms_popout_mountpoint")),G(p,o)}else G(null,o),fi(o),this.storeMiniPlayerInstance(null)},gd.prototype.createOverlay=function(){this.poster=this.poster||"";var b=this.createInitialState(this.poster,this.config);this.node.innerHTML=b},gd.prototype.createInitialState=function(b,c){var d="<img class='{{posterclass}}' src='{{posterurl}}'>";b.indexOf("&x-cli-msg=%7Bthumbnail%3Atrue%7D")===-1&&b.indexOf("/thumbnail")===-1&&(d="");var e=b.replace("&x-cli-msg=%7Bthumbnail%3Atrue%7D","");e=e.replace("/thumbnail","");var f="<div class='{{forwardiconcontainer}}' title='{{forwardtitle}}' data-filefrwrd=true><div class='{{forwardicon}}' data-id=fwdicon></div></div>";c&&c.hideforwardicon==1&&(f="");var g="<div class='{{overlayclass}}' data-id=initialovrlay>"+d+"<div class='{{playpauseclass}}' data-id=playbtncontainer title='{{playicontitle}}'><div class='{{playicon}}' data-id=playicon></div></div> <div class='{{actionscontainer}}'>"+f+"<div class='{{downloadiconcontainer}}' data-filedownload=true title='{{downloadtitle}}'> <a download target='_blank' href='{{videourl}}'><span class='{{downloadicon}}'></span></a></div></div></div>";return fR(g,{overlayclass:fT.playeroverlay,posterclass:fT.posterimage,posterurl:b,playpauseclass:fT.playpauseinitial,playicon:fT.playicon,forwardiconcontainer:fT.forwardiconcontainer,forwardicon:fT.forwardicon,videourl:e,downloadiconcontainer:fT.downloadiconcontainer,downloadicon:fT.overlaydownloadicon,actionscontainer:fT.actionscontainer,$forwardtitle:"chat.forward",$downloadtitle:"chat.download",$playicontitle:"videoplayer.play"})},gd.prototype.pauseRemainingInstances=function(b){this.pauseVideosCallback&&this.pauseVideosCallback(this.instance,b)},gd.prototype.pauseVideoPlayer=function(b){this.instance.state.videostate=="playing"&&this.instance.toggleVideoPlay(b)},gd.prototype.mountComponent=function(b,c,d,e,f,g,h,i,j,k,l,n,o,p){this.node=b,this.poster=g,this.node.removeChild(this.node.childNodes[0]),this.forwardAttachment=j,this.onComponentUnmount=k,this.pauseVideosCallback=l,this.storeMiniPlayerInstance=n,this.storeTheatremodeInstance=o,this.videoid=i,this.config=p,G(m(gc,{ref:function(a){this.instance=a}.bind(this),videosrc:c,videotype:d,videoname:e,uploadername:f,poster:g,zindex:h,videoid:i,toggleMiniPlayer:this.toggleMiniPlayer,toggleTheatreView:this.toggleTheatreView,forwardAttachment:this.forwardAttachmentCallBack,pauseRemainingInstances:this.pauseRemainingInstances,config:this.config}),this.node)},gd.prototype.unmountComponent=function(){this.onComponentUnmount(this.videoid),G("",this.node),this.createOverlay()};var ge={},gf=null,gg=null,gi={create:function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=new $WC.VideoPlayer,o=$WC.Util.throttle(gj,a,100);n.mountComponent(c,d,e,f,g,h,i,l,j,gh,gk,gl,gm,m),ge[a]||(ge[a]={},b.addEventListener("scroll",o)),ge[a][l]=n,gk(n,k)},removeAllComponents:function(a){if(ge[a]){for(var b in ge[a])ge[a][b].unmountComponent();delete ge[a]}},removeExternalVideoPlayers:function(b){gf&&gf.props.videoid==b&&gf.props.toggleMiniPlayer(null,null,!1),gg&&gg.props.videoid==b&&gg.props.toggleTheatreView(null,null,!1)}},go={},gp=[],gx=Object.freeze({__proto__:null,get:gq,updateList:gr,handleFailure:gs,getList:gt,isCachedRequest:gu,_constructParams:gv,fetchFromServer:gw}),gy={},gz={create:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(p){var t=new $WC.SearchContainerComponent;t.mountComponent(a,d,gB,p)}var u=new $WC.MultiSelectorListDialogComponent;u.mountComponent(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,gA,this.removeComponent,r,s),gy[a]||(gy[a]=u)},updateList:function(b,c,d,e,f){gy[b].updateList(c,d,e,f)},removeComponent:function(b){gy[b]&&(gy[b].unmountComponent(),delete gy[b])}},gC={listItems:"mc118439ee_listItems",listimgcontainer:"mc118439ee_listimgcontainer",default_img:"mc118439ee_default_img",virtuallist:"mc118439ee_virtuallist",listimgstatus:"mc118439ee_listimgstatus",listinfocontainer:"mc118439ee_listinfocontainer",listinfotitle:"mc118439ee_listinfotitle",listinfodesc:"mc118439ee_listinfodesc",listContainer:"mc118439ee_listContainer",listContainerWrapper:"mc118439ee_listContainerWrapper",listwrapper:"mc118439ee_listwrapper",searchBox:"mc118439ee_searchBox",searchBoxInput:"mc118439ee_searchBoxInput",listContainerHeader:"mc118439ee_listContainerHeader",titlewrapper:"mc118439ee_titlewrapper",header:"mc118439ee_header",listContainerClose:"mc118439ee_listContainerClose",listContainerFooter:"mc118439ee_listContainerFooter",container:"mc118439ee_container",infotext:"mc118439ee_infotext",loading:"mc118439ee_loading",optionscontainer:"mc118439ee_optionscontainer",optionswrapper:"mc118439ee_optionswrapper",optionsitem:"mc118439ee_optionsitem",valign_mid_block:"mc118439ee_valign_mid_block",listselected:"mc118439ee_listselected",zmNightMode:"zmNightMode",badgeimg:"mc118439ee_badgeimg",loading_container:"mc118439ee_loading_container",hvalign:"mc118439ee_hvalign",error_info:"mc118439ee_error_info",error_img:"mc118439ee_error_img",infotxt:"mc118439ee_infotxt",infotext_1:"mc118439ee_infotext_1",infotext_2:"mc118439ee_infotext_2",hv_align:"mc118439ee_hv_align"},gD=function(a){function b(b){a.call(this,b),this.setListNode=this.setListNode.bind(this),this.toggleOptionsContainer=this.toggleOptionsContainer.bind(this),this.hoverOff=this.hoverOff.bind(this),this.listnode=null,this.state={image_loaded:!1,show_options:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setListNode=function(b){this.listnode=b},b.prototype.selectListItem=function(b,c){if(this.props.onListItemClicked){var d=eO(c);this.props.onListItemClicked(b,d,c)}},b.prototype.toggleOptionsContainer=function(){this.setState({show_options:!this.state.show_options})},b.prototype.hoverOff=function(){this.state.show_options&&this.setState({show_options:!1})},b.prototype.componentDidUpdate=function(){this.props.setFocussedNode(this.props.item,this.listnode)},b.prototype.render=function(){var b=this.props.item;if(b.id==="loading")return m("div",{"class":gC.listItems+" "+gC.hvalign},m("div",{"class":gC.loading_container},m("div",null),m("div",null),m("div",null)));var c=m("div",{"class":gC.default_img});b.empty_img?c="":b.badge_img?c=m("div",{"class":gC.badgeimg},b.badge_letter):this.state.image_loaded&&(c=m("img",{"data-zcprofileid":b.id,src:b.imgsrc}));if(!this.state.image_loaded&&b.imgsrc){var d=new Image;d.src=b.imgsrc,d.onload=function(){this.setState({image_loaded:!0})}.bind(this)}var e=b.classname?b.classname:"",f=b.empty_img&&!b.fonticon_class?"":gC.listimgcontainer+" "+e,g=b.desc||b.htmldesc?"":gC.valign_mid_block,h=gC.listinfocontainer+" "+g+" ";h+=this.props.isfocussed?gC.listselected:"";var i=null;this.state.show_options&&(i=b.options.map(function(a){return m("div",{key:a.name,"data-operation":a.operation,"class":gC.optionsitem},a.name)}),i=m("div",{"class":gC.optionswrapper}," ",i," "));var j=b.options?m("div",{"class":gC.optionscontainer,onclick:this.toggleOptionsContainer},i):null,k=m("div",{"class":gC.listinfodesc},b.desc);b.htmldesc&&(k=m("div",{"class":gC.listinfodesc,dangerouslySetInnerHTML:{__html:b.htmldesc}}));var l=this.props.customlistitemstyles&&this.props.customlistitemstyles.customContainerStyles?this.props.customlistitemstyles.customContainerStyles:gC.listItems;return m("div",{ref:this.setListNode,"class":l,onclick:this.selectListItem.bind(this,b),onMouseLeave:this.hoverOff},m("div",{"class":f},c),m("div",{"class":h},m("div",{"data-zcprofileid":b.id,"class":gC.listinfotitle},b.title),k),j)},b}(p),gF="position:relative; overflow:hidden; width:100%; min-height:100%;",gG="position:absolute; top:0; left:0; height:100%; width:100%; overflow:visible;",gH=function(a){function b(){a.call(this),this.resize=this.resize.bind(this),this.handleScroll=this.handleScroll.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.resize=function(){this.state.height!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})},b.prototype.handleScroll=function(){this.setState({offset:this.base.scrollTop}),this.props.sync&&this.forceUpdate()},b.prototype.componentDidUpdate=function(){this.resize()},b.prototype.componentDidMount=function(){this.resize(),addEventListener("resize",this.resize)},b.prototype.componentWillUnmount=function(){removeEventListener("resize",this.resize)},b.prototype.render=function(b,c){var d=b.data,e=b.rowHeight,f=b.renderRow,g=b.overscanCount;g===void 0&&(g=10);var h=b.sync,i=gE(b,["data","rowHeight","renderRow","overscanCount","sync"]),j=i,k=c.offset;k===void 0&&(k=0);var l=c.height;l===void 0&&(l=0);var n=k/e|0,o=l/e|0;g&&(n=Math.max(0,n-n%g),o+=g);var p=n+1+o,q=d.slice(n,p);return m("div",Object.assign({},{onScroll:this.handleScroll},j),m("div",{style:gF+" height:"+d.length*e+"px;"},m("div",{style:gG+" top:"+n*e+"px;"},q.map(f))))},b}(p),gI=function(a){function b(b){a.call(this,b),this.navigateListItems=this.navigateListItems.bind(this),this.setFocussedNode=this.setFocussedNode.bind(this),this.isListItemFocussed=this.isListItemFocussed.bind(this),this.setListContainer=this.setListContainer.bind(this),this.curr_index_onfocus=0,this.isKeyPressed=!1,this.focussednode=null,this.containernode=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setListContainer=function(b){this.containernode=b},b.prototype.setFocussedNode=function(b,c){this.props.list[this.curr_index_onfocus]===b&&(this.focussednode=c)},b.prototype.componentDidUpdate=function(){this.isKeyPressed&&(this.props.navigation_keycode===bA.KEYCODES.ENTER&&this.props.onListItemClicked(this.props.list[this.curr_index_onfocus],this.focussednode),this.focussednode&&!fv(this.focussednode,null,this.containernode.firstChild)&&fw(this.focussednode,null,null,this.containernode.firstChild),this.isKeyPressed=!1)},b.prototype.isListItemFocussed=function(b){return this.props.list[this.curr_index_onfocus]===b?!0:!1},b.prototype.renderRow=function(b){return m(gD,{setFocussedNode:this.setFocussedNode,isfocussed:this.isListItemFocussed(b),key:b.id,item:b,onListItemClicked:this.props.onListItemClicked,customlistitemstyles:this.props.customlistitemstyles})},b.prototype.navigateListItems=function(){var b=this.props.list.length;this.props.navigation_keycode===bA.KEYCODES.DOWN||this.props.navigation_keycode===bA.KEYCODES.UP||this.props.navigation_keycode===bA.KEYCODES.ENTER?(this.props.navigation_keycode===bA.KEYCODES.DOWN&&this.curr_index_onfocus!=b-1?this.curr_index_onfocus++:this.props.navigation_keycode===bA.KEYCODES.UP&&this.curr_index_onfocus>0&&this.curr_index_onfocus--,this.isKeyPressed=!0):this.curr_index_onfocus=0},b.prototype.render=function(){var b=this.props.list.slice(),c=null;b.length<10&&!this.props.iscompletelist&&!this.props.isinitiallist&&b.push({id:"loading"});if(b.length){this.navigateListItems();var d=this.props.customlistitemstyles&&this.props.customlistitemstyles.rowHeight||56;c=m(gH,{data:b,rowHeight:d,renderRow:this.renderRow.bind(this),overscanCount:20,"class":gC.virtuallist})}else this.props.loadingstate?c=m("div",{"class":gC.loading+" "+gC.hv_align}):this.props.iscompletelist&&(c=gJ());var e=(this.props.customlistitemstyles&&this.props.customlistitemstyles.customListWrapper)+" "+gC.listwrapper;return m("div",{"class":e,ref:this.setListContainer},c)},b}(p),gK=function(){};gK.prototype.mountComponent=function(b,c,d,e,f){this.listContainerNode=f,G(m(gI,{list:b,onListItemClicked:c,loadingstate:d,customlistitemstyles:e}),this.listContainerNode)},gK.prototype.unmountComponent=function(){G("",this.listContainerNode)};var gL=function(a){function b(b){a.call(this,b),this.setSearchTextInputNode=this.setSearchTextInputNode.bind(this),this.searchTextInputNode=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setSearchTextInputNode=function(b){this.searchTextInputNode=b},b.prototype.componentDidMount=function(){this.searchTextInputNode.focus(),this.searchTextInputNode.value=""},b.prototype.componentDidUpdate=function(){this.searchTextInputNode.value=this.props.searchvalue,this.searchTextInputNode.focus()},b.prototype.render=function(b){return m("div",{"class":gC.searchBox+" "+(b.customsearchstyle&&b.customsearchstyle.searchcontainerstyle||"")},m("input",{"class":gC.searchBoxInput+" "+(b.customsearchstyle&&b.customsearchstyle.searchinputstyle||""),ref:this.setSearchTextInputNode,"data-purpose":"search",type:"text",placeholder:this.props.searchplaceholder,oninput:this.props.componentid?this.props.handleChange.bind(this,this.props.componentid):this.props.handleChange,onkeydown:this.props.handleKeyPress}))},b}(p),gM=function(){};gM.prototype.mountComponent=function(b,c,d,e){this.searchContainerNode=e,G(m(gL,{componentid:b,searchplaceholder:c,handleChange:d}),this.searchContainerNode)},gM.prototype.unmountComponent=function(){G("",this.searchContainerNode)};var gN={zmNightMode:"zmNightMode",deletenode:"mc31303ae8_deletenode",alignend:"mc31303ae8_alignend",containerwrapper:"mc31303ae8_containerwrapper",imgwrapper:"mc31303ae8_imgwrapper",img:"mc31303ae8_img",container:"mc31303ae8_container",wms_badgeimg:"mc31303ae8_wms_badgeimg"},gO=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.render=function(){var b=this.props.selectedItems,c=this.props.fetchImageSource,d=b.map(function(a){var b=null,d=c(a);return d.imgsrc?b=m("img",{"class":gN.img,src:d.imgsrc}):d.fonticon_class?b=m("div",{"class":d.fonticon_class}):b=m("div",{"class":gN.wms_badgeimg},d.badge_letter),m("div",{key:a,"class":gN.imgwrapper,onclick:this.props.removeSelectedItem.bind(this,a)},b,m("div",{"class":gN.deletenode}))}.bind(this));if(this.props.selectedItems.length){var e=this.props.actionCallback&&this.props.actionCallback.map(function(a,b){var c=a.buttonstyle?gN[a.buttonstyle]:gN.aligncenter,d=function(){a.onclick(this.props.selectedItems)}.bind(this);return m(bW,{key:b,type:"button",content:a.text,classname:c,onclick:d})}.bind(this));return m("div",{"class":gN.containerwrapper},m("div",{"class":gN.container},d),e)}return null},b}(p),gP=function(a){function b(b){a.call(this,b),this.storeListInstance=this.props.storeListInstance,this.removeSelectedItem=this.removeSelectedItem.bind(this),this.handleMultipleItemsSelection=this.handleMultipleItemsSelection.bind(this),this.handleItemSelection=this.handleItemSelection.bind(this),this.initial_list=this.props.list,this.bulk_list=eK({},this.props.list),this.state={excluded_list:{},filtered_list:this.convertToArrayList(this.initial_list),sort_on_search:!0,loading_state:this.props.loadingstate,iscompletelist:this.props.iscompletelist,searchtext:"",navigation_keycode:""}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentDidUpdate=function(b,c){b.loadingstate!==this.props.loadingstate&&this.updateList(this.props.list,null,this.props.iscompletelist),this.props.customsearch&&c.searchtext!==this.props.searchtext&&this.onSearch(null,this.props.searchtext)},b.prototype.componentWillUpdate=function(b){this.props.updateinitiallist&&(this.initial_list=eK(this.initial_list,b.list),this.bulk_list=eK(this.bulk_list,b.list))},b.prototype.updateList=function(b,c,d,e){var f=Object.keys(b);if(e)if(c&&f.length&&this.state.searchtext===e){var g=this.state.filtered_list.slice(0),h=g.length;f.forEach(function(a){this.bulk_list[a]||(b[a].counter=h++,g.push(b[a]))}.bind(this)),this.setState({filtered_list:g,sort_on_search:this.props.sortonsearch,iscompletelist:d})}else this.setState({iscompletelist:d});else d&&this.setState({filtered_list:this.convertToArrayList(b),loading_state:!1});this.bulk_list=eK(this.bulk_list,b)},b.prototype.convertToArrayList=function(b){var c=[];return Object.keys(b).forEach(function(a){c.push(b[a])}),c},b.prototype.defaultSearch=function(b,c,d,e){var f=hP(b,null,!1,d);f.length<10&&hY("fetch",null,null,!0,"searchlist",{topicname:"searchlist",searchtext:b},d,e);var g={},h,i=0;return f.forEach(function(a){h=hC(a),h.counter=i++,g[h.id]=h}.bind(this)),e(g,null,!1),Object.keys(g)},b.prototype.handleKeyPress=function(b){this.setState({navigation_keycode:b.keyCode}),(b.keyCode===bA.KEYCODES.DOWN||b.keyCode===bA.KEYCODES.UP)&&b.preventDefault()},b.prototype.onSearch=function(b,c){var d=b?eO(b).value:c;if(d===""){var e=eu(this.initial_list)?this.bulk_list:this.initial_list;this.setState({filtered_list:this.convertToArrayList(e),sort_on_search:!0,searchtext:d})}else{var f=this.bulk_list,g=this.props.defaultsearch?this.defaultSearch(d,f,this.props.searchsequence,this.updateList.bind(this)):this.props.onSearch&&this.props.onSearch(d,f,b);if(g.length){var h=g.map(function(a){if(f.hasOwnProperty(a))return f[a]});this.setState({filtered_list:h,sort_on_search:this.props.sortonsearch,searchtext:d})}else this.setState({filtered_list:[],searchtext:d,iscompletelist:this.state.iscompletelist})}},b.prototype.excludeSelectedItemsFromList=function(b){var c=this.props.excluded_list?this.props.excluded_list:this.state.excluded_list,d=eK({},c);return Object.assign(d,this.props.invisible_excluded_list),b.filter(function(a){if(d.hasOwnProperty(a.id)===!1)return!0})},b.prototype.removeSelectedItem=function(b){var c=this.state.excluded_list;delete c[b],this.onSearch(null,this.state.searchtext)},b.prototype.handleMultipleItemsSelection=function(b,c,d){var e=b.id,f=this.state.excluded_list;typeof this.props.selection_limit=="undefined"||eH(f)<this.props.selection_limit?(f[e]=this.bulk_list[e],this.setState({excluded_list:f,iscompletelist:!0,searchtext:"",filtered_list:this.convertToArrayList(this.initial_list),navigation_keycode:""}),this.props.onListItemClicked&&this.props.onListItemClicked(b,c,d)):this.props.onSelectionLimitExceed()},b.prototype.handleItemSelection=function(b,c,d){this.setState({navigation_keycode:""}),this.props.onListItemClicked(b,c,d)},b.prototype.render=function(){var b=this.excludeSelectedItemsFromList(this.state.filtered_list);this.props.updateinitiallist&&this.state.searchtext===""&&(b=this.excludeSelectedItemsFromList(this.convertToArrayList(this.initial_list)));var c=this.props.multiselect?this.handleMultipleItemsSelection:this.handleItemSelection;if(this.state.sort_on_search){var d=this.props.defaultsearch?eF("counter",!1):this.props.sortComparator||eF("title");b=Object.keys(b).map(function(a){return b[a]}),b=b.sort(d)}var e={customContainerStyle:gC.listContainer,customHeaderStyle:gC.listContainerHeader,customButtonStyle:gC.listContainerClose,customWrapperStyle:gC.listContainerWrapper};this.props.multiselect&&eH(this.state.excluded_list)&&(e.customFooterStyle=gC.listContainerFooter),this.props.customDialogStyles&&this.props.customDialogStyles.footerWrapper&&(e.customFooterStyle=this.props.customDialogStyles.footerWrapper);var f=m("div",{"class":gC.titlewrapper},m("div",{"class":gC.header},this.props.title)),g=[];this.props.footerprefix&&g.push(this.props.footerprefix),g.push(m(gO,{selectedItems:Object.keys(this.state.excluded_list),fetchImageSource:this.props.fetchImageSource,actionCallback:this.props.actions,removeSelectedItem:this.removeSelectedItem}));var h=this.props.multiselect?[]:this.props.actions;if(this.props.dialogview)return m(bY,{heading:f,actions:h,customDialogStyles:e,callbackOnClose:this.props.callbackOnClose,footerinfoprefix:g,ignoreFocusOnMount:!0},m(gL,{searchplaceholder:this.props.searchplaceholder,handleChange:this.onSearch.bind(this),searchvalue:this.state.searchtext,handleKeyPress:this.handleKeyPress.bind(this)}),m(gI,{list:b,onListItemClicked:c,loadingstate:this.state.loading_state,iscompletelist:this.state.iscompletelist,customlistitemstyles:this.props.customlistitemstyles,isinitiallist:this.state.searchtext?!1:!0,navigation_keycode:this.state.navigation_keycode}));if(this.props.searchnode||this.props.customsearch)return m(gI,{list:b,onListItemClicked:c,loadingstate:this.state.loading_state,iscompletelist:this.state.iscompletelist,customlistitemstyles:this.props.customlistitemstyles,isinitiallist:this.state.searchtext?!1:!0,navigation_keycode:this.props.navigation_keycode});var i=this.props.customlistitemstyles&&this.props.customlistitemstyles.containerWrapperStyle;return m("div",{"class":i},m(gL,{customsearchstyle:this.props.customlistitemstyles&&this.props.customlistitemstyles.customsearchstyle,searchplaceholder:this.props.searchplaceholder,handleChange:this.onSearch.bind(this),searchvalue:this.state.searchtext,handleKeyPress:this.handleKeyPress.bind(this)}),m(gI,{list:b,onListItemClicked:c,loadingstate:this.state.loading_state,iscompletelist:this.state.iscompletelist,customlistitemstyles:this.props.customlistitemstyles,navigation_keycode:this.state.navigation_keycode}))},b}(p),gQ=function(){this.instance=null};gQ.prototype.mountComponent=function(b,c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,z){this.listid=b,this.removeComponent=u,p?(this.node=document.getElementById("wms_listviewdialog"),this.node==null&&(this.node=document.createElement("div"),this.node.id="wms_listviewdialog",document.body.appendChild(this.node))):(this.storeListInstance=t,this.node=s),G(m(gP,{ref:function(a){this.instance=a,this.storeListInstance&&this.storeListInstance(a,b)}.bind(this),list:c,title:d,searchplaceholder:e,onSearch:f,sortComparator:g,onListItemClicked:h,sortonsearch:i,loadingstate:j,actions:k,multiselect:l,fetchImageSource:n,iscompletelist:o,dialogview:p,customlistitemstyles:q,searchnode:r,callbackOnClose:u&&u.bind(this,b),defaultsearch:v,searchsequence:w,updateinitiallist:x,selection_limit:y,onSelectionLimitExceed:z}),this.node)},gQ.prototype.updateList=function(b,c,d,e){this.instance.updateList(b,c,d,e)},gQ.prototype.removeParentNode=function(){this.node.parentElement.removeChild(this.node)},gQ.prototype.unmountComponent=function(){G("",this.node),this.removeParentNode()};var gR=[],gS=null,gT=[],gU=null,gV=0;eI.subscribe("/channels/updateui",function(){eI.publish("/recentchats/updateui",bA.REQSTATUS.SUCCESS)});var hw=Object.freeze({__proto__:null,getUnreadFeedsCount:gW,setUnreadFeedsCount:gX,incrementUnreadFeedsCount:gY,wrapUnreadFeedsObj:gZ,getPinnedChatsLastFetchedTime:g$,setPinnedChatsLastFetchedTime:g_,getPinnedChats:ha,initRecentChats:hb,get:hc,updateLastSeenTime:hd,getLastSeenTime:he,updateTitle:hf,updatePinnedChatList:hg,getFromPinnedChatList:hh,updateLastMsgInfo:hi,removeFromRecentChats:hj,getChats:hk,getChatIdList:hl,getRecentChatsFromChatServer:hm,updateFromActiveChats:hn,updatePinnedChat:ho,updateUnReadChats:hp,wrapUnreadObj:hq,checkPresence:hr,getList:hs,loadPreviousChatList:ht,getRecentChatTime:hu,getUnreadChatList:hv});eI.subscribe("/orgcontacts/searchlist",function(a,b){hY("update",null,b.callbackargs.reqid,null,b.callbackargs.topicname,b.callbackargs)}),eI.subscribe("/channels/searchlist",function(a,b){hY("update",null,b.callbackargs.reqid,null,b.callbackargs.topicname,b.callbackargs)}),eI.subscribe("/chatlist/searchlist",function(a,b){hY("update",null,b.callbackargs.reqid,null,b.callbackargs.topicname,b.callbackargs)});var hF=Object.freeze({__proto__:null,showList:hx,getRefinedParticipantsList:hy,getTempParticipantStatus:hz,updateList:hA,getRefinedChatslist:hC,fetchImageSource:hD,showChatsList:hE}),hJ=Object.freeze({__proto__:null,getStatusHtml:hG,createUserImageHtml:hH,getStatusClass:hI}),hY=function(){function d(a,b){return c[a]&&typeof c[a].seqno!="undefined"&&c[a].seqno<b.length?!0:!1}function e(a,b){return!c[a]||typeof c[a].seqno=="undefined"?!0:c[a].seqno>=b.length?!0:!1}var a=[bA.HYBRIDSEARCH.ORGCONTACT,bA.HYBRIDSEARCH.CHANNEL,bA.HYBRIDSEARCH.CHAT],b=[bA.HYBRIDSEARCH.ORGCONTACT,bA.HYBRIDSEARCH.CHAT],c={};return function(f,g,h,i,j,k,l,m){h=h||(new Date).getTime(),j=j||"updateui";var n=a;if(!J.get("isOrgUser")()||J.get("channels")=="disable"||!cD("channels"))n=b;!J.get("isOrgUser")()&&n.indexOf(bA.HYBRIDSEARCH.ORGCONTACT)!=-1&&n.splice(n.indexOf(bA.HYBRIDSEARCH.ORGCONTACT),1);if(c[h])typeof c[h].sequence!="undefined"&&(n=c[h].sequence),typeof c[h].seqno!="undefined"?(g=n[c[h].seqno],f==="update"&&d(h,n)&&c[h].seqno++):g=c[h].type;else{c[h]={},c[h].sequence=l||n,c[h].updateCallback=m,n=c[h].sequence,i&&(g?c[h].seqno=n.indexOf(g):(c[h].seqno=0,g=n[0])),c[h].type=g;if(Object.keys(c).length>50){var o=(new Date).getTime()-18e5;Object.keys(c).forEach(function(a){a<o&&delete c[a]})}}if(f==="fetch")g===bA.HYBRIDSEARCH.JOINEDCHANNEL?hY("update",g,h,i,j,k,l,m):ie(g,h,k)===!1&&j=="updateui"&&(g===bA.HYBRIDSEARCH.ORGCONTACT&&!J.get("isOrgUser")()?ia()?ig(hS("searchresultdiv"),bA.REQSTATUS.SUCCESS,"search"):hS("searchresultdiv")&&hS("searchresultdiv").children.length===0&&hZ()&&ig(hS("searchresultdiv"),bA.REQSTATUS.NORESULTS,"search"):ig(hS("searchresultdiv"),bA.REQSTATUS.LOADING,"search"));else if(f==="update"){if(j=="updateui"){var p=h$(g),q;p&&p.length?(ig(hS("searchresultdiv"),bA.REQSTATUS.SUCCESS,"search"),q=ih(p),hS("searchresultdiv").insertAdjacentHTML("beforeend",q),typeof WmsMainUI!="undefined"&&fm(hS("searchresultdiv",hT())),!hS("searchresultdiv").getElementsByClassName("wms-hysearch-result-select").length&&hS("searchresultdiv").querySelector("[data-type]")&&ic(hS("searchresultdiv").querySelector("[data-type]"))):ia(),e(h,n)&&(ig(hS("searchresultdiv"),bA.REQSTATUS.SUCCESS,"search"),hS("searchresultdiv")&&hS("searchresultdiv").children.length===0&&hZ()&&ig(hS("searchresultdiv"),bA.REQSTATUS.NORESULTS,"search")),d(h,n)&&hS("searchresultdiv")&&hS("searchresultdiv").children.length<10&&hY("fetch",null,h)}else if(j=="searchlist"){var r=ip(k,e(h,n),c[h].updateCallback,c[h].sequence);r&&d(h,n)&&hY("fetch",null,h,!0,j,k)}}else f==="failureupdate"&&hZ()&&(ia()?ig(hS("searchresultdiv"),bA.REQSTATUS.SUCCESS,"search"):(ig(hS("searchresultdiv"),bA.REQSTATUS.FAILED,"search",ib),hS("loadingstatus").setAttribute("data-reqid",h)))}}(),h$=function(){var a={};return a[bA.HYBRIDSEARCH.ORGCONTACT]=hW,a[bA.HYBRIDSEARCH.CHAT]=hR,a[bA.HYBRIDSEARCH.CHANNEL]=hX,function(b){var c=h_(),d;b==1&&document.getElementById("wms-fileupldwin")&&(d=!0);if(c!==""&&b)return a[b](c,!0,d)}}(),ie=function(){var a=fg(function(a,b,c){c=c||h_(),a===bA.HYBRIDSEARCH.ORGCONTACT?bL(c,b):a===bA.HYBRIDSEARCH.CHAT?gw(c,b):a===bA.HYBRIDSEARCH.CHANNEL&&je(c,b)},this,300);return function(b,c,d){d=d||{searchtext:h_()},a(b,c,d);if(b===bA.HYBRIDSEARCH.ORGCONTACT)return bM(d);if(b===bA.HYBRIDSEARCH.CHAT)return gu(d);if(b===bA.HYBRIDSEARCH.CHANNEL)return jc(d)}}(),iz=Object.freeze({__proto__:null,filter:hK,getBadgeLetters:hL,getPrivateChatDetails:hM,getZuidForPrivateChat:hN,createLastMsgInfoHtml:hO,generateSearchResults:hP,generateRecentChatResults:hQ,generateChatResults:hR,getNode:hS,getCurrentModule:hT,generateContactResults:hU,generateUnsubscribedBotResults:hV,generateOrgContactResults:hW,generateChannelResults:hX,updateManager:hY,getSearchText:hZ,getResultSet:h$,getPlainSearchText:h_,showContactInvite:ia,invokeRetry:ib,changeHover:ic,resetHover:id,fetchFromServer:ie,updateLoadingStatus:ig,generateHtml:ih,generateImageHtml:ii,createResultFragment:ij,generateContactHtml:ik,getResultInfo:il,getDescription:im,createImageCollageHtml:io,updateListAndCheckIfIncomplete:ip,populateRecentChats:iq,generateChatMenuHtml:ir,isUnreadFilterOpen:is,generatePinnedChatMenuHtml:it,isPinnedChatsExpanded:iu,generateRecentChatResultsHTML:iv,getChosenUsers:iw,getChosenUsersName:ix,getTitleHint:iy}),iA={},iB=[],iC=null,iD={},iE=!1,iF=!1,iG={1:"org_channels",2:"team_channels",3:"private_channels",4:"external_channels"},iV=fg(function(){(!eH(iA)||iC===null||iE)&&iU()},null,1e3,!0),jl=Object.freeze({__proto__:null,get:iH,getLastFetchedTime:iI,getChannelsSync:iJ,setChannelsSync:iK,getChannelsIfFocussed:iL,setChannelsFocussed:iM,getChannelTypes:iN,getTeamMembersList:iO,insertTeamMemberslist:iP,getTeamChannelMembers:iQ,isSharedChannel:iR,isTeamChannel:iS,isUserHasPermission:iT,initChannels:iU,getChannels:iV,getJoinedChannels:iW,updateChannel:iX,updateList:iY,handleFailure:iZ,getList:i$,getListByTeamName:i_,getListByChannelName:ja,getListByTeam_ChannelName:jb,isCachedRequest:jc,_constructParams:jd,fetchFromServer:je,getChannelImageHTML:jf,isJoinedChannel:jg,getChannelName:jh,updateModifiedData:ji,syncChannels:jj,getChannelByOC_id:jk}),jm={wms_callbutton_wrapper:"mc00c08e4a_wms_callbutton_wrapper",wms_audiocall:"mc00c08e4a_wms_audiocall",wms_videocall:"mc00c08e4a_wms_videocall",wms_callinfo:"mc00c08e4a_wms_callinfo",inftxt:"mc00c08e4a_inftxt",wms_infotext:"mc00c08e4a_wms_infotext",wms_callduration:"mc00c08e4a_wms_callduration","wms-msgsenderhl":"wms-msgsenderhl",wms_profileinfo_text:"mc00c08e4a_wms_profileinfo_text","wms-msgsender":"wms-msgsender","wms-msginfo":"wms-msginfo"},jp=Object.freeze({__proto__:null,getCallNotificationMessage:jn,getInfoMsgString:jo}),jq={urlpreviewparent:"mcfb690f8a_urlpreviewparent",imagecontainer:"mcfb690f8a_imagecontainer",previewcontent:"mcfb690f8a_previewcontent",image:"mcfb690f8a_image",previewdetails:"mcfb690f8a_previewdetails",title:"mcfb690f8a_title",url:"mcfb690f8a_url",providername:"mcfb690f8a_providername",preview:"mcfb690f8a_preview",description:"mcfb690f8a_description",closeicon:"mcfb690f8a_closeicon",previewfooter:"mcfb690f8a_previewfooter",previewheader:"mcfb690f8a_previewheader",favicon:"mcfb690f8a_favicon",domaindetails:"mcfb690f8a_domaindetails",fieldscontainer:"mcfb690f8a_fieldscontainer",field:"mcfb690f8a_field",label:"mcfb690f8a_label",value:"mcfb690f8a_value"},jC=Object.freeze({__proto__:null,populate:jr,showLoadingPreview:js,constructVideoLinkFragment:ju,constructAudioLinkFragment:jw,constructImageLinkFragment:jx,constructFileFragment:jy,isFileSupportedByCliq:jB}),jD={},jE=!0,jF=!1,jG=!1,jH=!1,jW=Object.freeze({__proto__:null,getFromServerAfterFocus:jI,getFromServerIfFocussed:jJ,checkAndUpdateLMTime:jK,get:jM,getFromServer:jO,update:jP,updateInLocalStorage:jQ,updateInServer:jR,deleteDraft:jS,deleteDraftInServer:jU,updateBeforeUnload:jV}),jX=function(){};jX.prototype.mountComponent=function(b){this.node=document.createElement("div"),document.body.appendChild(this.node);var c=m("div",{"class":bU.wms_dialog_imgouter},m("div",{"class":bU.wms_dialog_imginner},m("div",{"class":bU.wms_dialog_img}))),d=b.headerimgsrc?m("img",{key:b.headerimgsrc,src:b.headerimgsrc}):c,e=m("div",{"class":bU.wms_dialogtext},d,m("div",{"class":bU.wms_dialog_txtcont},b.heading)),f=b.content?b.content.map(function(a){return m("div",{"class":bU.wms_dialog_content}," ",a," ")}):null,g=b.bodytitle?m("div",{"class":bU.wms_dialog_txttitle},b.bodytitle):null,h=b.actions,i={customContainerStyle:bU.wms_dialog_container,customHeaderStyle:bU.wms_dialog_header,customFooterStyle:bU.wms_dialog_footer};if(g||f)i.customWrapperStyle=bU.wms_dialog_contentwrapper;G(m(bY,{heading:e,actions:h,customDialogStyles:i,callbackOnClose:this.removeParentNode.bind(this)},g,f),this.node)},jX.prototype.removeParentNode=function(){this.node.parentElement.removeChild(this.node)},jX.prototype.unmountComponent=function(){G("",this.node)};var jY={msgactions_container:"mc2f762162_msgactions_container",actioncontainer:"mc2f762162_actioncontainer",msgactionicon:"mc2f762162_msgactionicon",deleteaction:"mc2f762162_deleteaction",actionname:"mc2f762162_actionname",iconreply:"mc2f762162_iconreply",newglitter:"mc2f762162_newglitter",zmNightMode:"zmNightMode"},jZ=function(a){function b(){a.call(this),this.setMessageActionsNode=this.setMessageActionsNode.bind(this),this.closeComponent=this.closeComponent.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentDidMount=function(){this.msgactionsnode.focus()},b.prototype.setMessageActionsNode=function(b){this.msgactionsnode=b},b.prototype.closeComponent=function(b){var c=27;b.keyCode===c&&this.props.closeComponent&&this.props.closeComponent()},b.prototype.getMessageActionsList=function(){var b=this.props.allowedactions,c={reply:"e659",copy:"e921",react:"e9f8",fork:"e922",setreminder:"e9a2",markasunread:"e9b3",messagelink:"e991",edit:"e620","delete":"e633",forward:"e659",pinmsg:"ea1a",unpinmsg:"ea1a"},d=["react","reply","forward","markasunread","fork","setreminder","copy","messagelink","pinmsg","unpinmsg","edit","delete"],e=[];if(!b.include_all)for(var f=0;f<d.length;f++)b[d[f]]||delete d[f];for(var g=0;g<d.length;g++)d[g]&&e.push(m(j$,{actionname:d[g],actionvalue:c[d[g]],msgnode:this.props.msgnode,messageActionCallBack:this.props.messageActionsCallBack}));return e},b.prototype.render=function(){return m("div",{tabindex:"0","class":jY.msgactions_container,onkeydown:this.closeComponent,ref:this.setMessageActionsNode,"data-msgoperations":!0},this.getMessageActionsList())},b}(p),j$=function(a){function b(){a.call(this),this.messageActionsCallBack=this.messageActionsCallBack.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.messageActionsCallBack=function(b){this.props.messageActionCallBack(this.props.msgnode,this.props.actionname),b.preventDefault(),b.stopPropagation()},b.prototype.render=function(b){var c=b.actionname,d=jY.actioncontainer;c=="delete"?d=jY.actioncontainer+" "+jY.deleteaction:c=="pinmsg"&&(d+=" "+jY.newglitter);var e=jY.msgactionicon;return c=="reply"&&(e=jY.msgactionicon+" "+jY.iconreply),m(bW,{classname:d,onclick:this.messageActionsCallBack},m(bW,{classname:e,type:"icon",tabindex:"-1",content:b.actionvalue}),m("span",{"class":jY.actionname},K("message.actions."+c)))},b}(p),j_=function(){this.unmountComponent=this.unmountComponent.bind(this)};j_.prototype.mountComponent=function(b){this.node=b.node,G(m(jZ,{msgnode:b.msgnode,allowedactions:b.allowed_actions,messageActionsCallBack:b.messageactionscallback,closeComponent:b.closeComponent}),b.node)},j_.prototype.unmountComponent=function(){G("",this.node)};var ka={formparent:"mc9fea9169_formparent",footer:"mc9fea9169_footer",cancelbutton:"mc9fea9169_cancelbutton",submitbutton:"mc9fea9169_submitbutton",header:"mc9fea9169_header",formcontent:"mc9fea9169_formcontent",footerprefix:"mc9fea9169_footerprefix",hint:"mc9fea9169_hint",singleselectvalue:"mc9fea9169_singleselectvalue",placeholderstyle:"mc9fea9169_placeholderstyle",options:"mc9fea9169_options",formitem:"mc9fea9169_formitem",inputfield:"mc9fea9169_inputfield",singleselect:"mc9fea9169_singleselect",inputtextarea:"mc9fea9169_inputtextarea",multiselectparent:"mc9fea9169_multiselectparent",multiselectparentfocus:"mc9fea9169_multiselectparentfocus",groupedinput:"mc9fea9169_groupedinput",searchstyle:"mc9fea9169_searchstyle",closeicon:"mc9fea9169_closeicon",singleselectclose:"mc9fea9169_singleselectclose",labelcontainer:"mc9fea9169_labelcontainer",label:"mc9fea9169_label",mandatory:"mc9fea9169_mandatory",formhint:"mc9fea9169_formhint",botimage:"mc9fea9169_botimage",botname:"mc9fea9169_botname",selectedelements_container:"mc9fea9169_selectedelements_container",selectedoption:"mc9fea9169_selectedoption",closeiconcontainer:"mc9fea9169_closeiconcontainer",form_error:"mc9fea9169_form_error",opendropdown:"mc9fea9169_opendropdown",badge_letter:"mc9fea9169_badge_letter",textfieldicon:"mc9fea9169_textfieldicon",selectedtext:"mc9fea9169_selectedtext",dropdowncontainer:"mc9fea9169_dropdowncontainer",dropdownoptions:"mc9fea9169_dropdownoptions",dropdownmin:"mc9fea9169_dropdownmin",listwrapperstyle:"mc9fea9169_listwrapperstyle",dropdownitemstyle:"mc9fea9169_dropdownitemstyle",groupeditem:"mc9fea9169_groupeditem",customitem:"mc9fea9169_customitem",grouped_item_sel:"mc9fea9169_grouped_item_sel",dropdownnoimg:"mc9fea9169_dropdownnoimg",nativeitem:"mc9fea9169_nativeitem",showmandatoryerror:"mc9fea9169_showmandatoryerror",itemloading:"mc9fea9169_itemloading",dotone:"mc9fea9169_dotone",dottwo:"mc9fea9169_dottwo",dotthree:"mc9fea9169_dotthree",disable:"mc9fea9169_disable",mountedfixed:"mc9fea9169_mountedfixed",containerwrapperstyle:"mc9fea9169_containerwrapperstyle",multiselectlist_search:"mc9fea9169_multiselectlist_search",emptysearch:"mc9fea9169_emptysearch",removescroll:"mc9fea9169_removescroll",mountedtop:"mc9fea9169_mountedtop",groupeditemtitle:"mc9fea9169_groupeditemtitle",groupeditemcontainer:"mc9fea9169_groupeditemcontainer",emptysearchcontainer:"mc9fea9169_emptysearchcontainer",contactimg:"mc9fea9169_contactimg",icontext:"mc9fea9169_icontext",groupeditemslistcontainer:"mc9fea9169_groupeditemslistcontainer",loader:"mc9fea9169_loader",zmNightMode:"zmNightMode"},kb=function(a){function b(){a.call(this),this.storeDropDownNode=this.storeDropDownNode.bind(this),this.addValueToSelectedList=this.addValueToSelectedList.bind(this),this.removeDataFromSelectedList=this.removeDataFromSelectedList.bind(this),this.selected_options=[],this.toggleDropDown=this.toggleDropDown.bind(this),this.hideDropDown=this.hideDropDown.bind(this),this.onMultiSelectSearch=this.onMultiSelectSearch.bind(this),this.storeSearchNode=this.storeSearchNode.bind(this),this.focusInputContainer=this.focusInputContainer.bind(this),this.getGroupedDropDown=this.getGroupedDropDown.bind(this),this.storeGroupedSearchInputNode=this.storeGroupedSearchInputNode.bind(this),this.storeSelectedItemNode=this.storeSelectedItemNode.bind(this),this.storeSingleselectNode=this.storeSingleselectNode.bind(this),this.state={dropdownvisible:!1,searchterm:"",focusinputcontainer:!1,groupeditem_selectedindex:0,navigation_keycode:""}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentDidUpdate=function(){this.groupedsearchnode&&this.groupedsearchnode.focus(),this.selecteditemnode&&!eL(this.selecteditemnode,this.selecteditemnode.parentElement)&&(this.selecteditemnode.offsetTop>167?this.selecteditemnode.parentElement.scrollTop+=this.selecteditemnode.scrollHeight*2:this.selecteditemnode.parentElement.scrollTop-=this.selecteditemnode.scrollHeight*2)},b.prototype.componentDidMount=function(){this.props.setfocus&&this.searchnode&&(this.focusedonmount=!0,this.searchnode.focus())},b.prototype.storeSingleselectNode=function(b){this.singleselectnode=b},b.prototype.focusInputContainer=function(b){var c=!0;this.focusedonmount&&(this.focusedonmount=!1,c=!1),b.type=="focus"&&!this.state.dropdownvisible?(this.props.list.type=="dynamic_select"&&this.props.onTriggerInput(this.props.list.name),this.setState({focusinputcontainer:!0,dropdownvisible:c})):this.setState({focusinputcontainer:!1})},b.prototype.storeSearchNode=function(b){this.searchnode=b},b.prototype.storeDropDownNode=function(b){this.dropdownnode=b},b.prototype.storeGroupedSearchInputNode=function(b){this.groupedsearchnode=b},b.prototype.storeSelectedItemNode=function(b){this.selecteditemnode=b},b.prototype.onMultiSelectSearch=function(b){if(b.type=="keydown"){if(b.keyCode==bA.KEYCODES.BACKSPACE&&b.target.value==""){this.removeDataFromSelectedList(this.selected_options[this.selected_options.length-1],b);return}if(b.keyCode==bA.KEYCODES.ESCAPE&&this.state.dropdownvisible){b.stopPropagation(),b.preventDefault(),this.hideDropDown();return}if(b.keyCode==bA.KEYCODES.TAB){this.hideDropDown();return}if(b.keyCode==bA.KEYCODES.ENTER){if(this.groupedsearchnode){this.addValueToSelectedList(this.getItemBasedOnIndex(this.state.groupeditem_selectedindex)),this.hideDropDown();return}if(this.searchnode){this.setState({navigation_keycode:b.keyCode});return}}else if(b.keyCode==bA.KEYCODES.DOWN||b.keyCode==bA.KEYCODES.UP){if(this.groupedsearchnode){this.navigateGroupedItems(b);return}if(this.searchnode){this.setState({navigation_keycode:b.keyCode});return}}}this.setState({searchterm:b.target.value.toLowerCase(),dropdownvisible:!0})},b.prototype.getItemBasedOnIndex=function(b){var c=this.state.searchterm?this.filterGroupedList(this.props.list.options):this.props.list.options,d=0;for(var e=0;e<c.length;e++)if(c[e].options)for(var f=0;f<c[e].options.length;f++){if(d==b)return c[e].options[f];d++}else{if(d==b)return c[e];d++}},b.prototype.countTotalGroupedItems=function(){var b=this.state.searchterm?this.filterGroupedList(this.props.list.options):this.props.list.options,c=b.length;for(var d=0;d<b.length;d++)b[d].options&&(c+=b[d].options.length-1);return c-1},b.prototype.navigateGroupedItems=function(b){var c=b.keyCode,d=this.state.groupeditem_selectedindex,e=this.countTotalGroupedItems();c==bA.KEYCODES.DOWN&&d++,c==bA.KEYCODES.UP&&d--,d<0&&(d=0),d>e&&(d=e),this.setState({groupeditem_selectedindex:d})},b.prototype.toggleDropDown=function(b){if(b.target.getAttribute("data-purpose")=="groupedsearch"||b.target.getAttribute("data-purpose")=="search"&&b.type=="keydown"&&b.keyCode!=bA.KEYCODES.ENTER)return;if(this.searchnode&&b.type=="keydown"&&b.keyCode===bA.KEYCODES.ENTER)return;if(b.type==="keydown"&&(b.keyCode===bA.KEYCODES.ENTER||b.keyCode==bA.KEYCODES.SPACE&&!this.props.multiple)||b.type=="click")!this.state.dropdownvisible&&this.props.list.type=="dynamic_select"&&this.props.onTriggerInput(this.props.list.name),this.searchnode&&this.searchnode.focus(),b.stopPropagation(),b.preventDefault(),this.setState({dropdownvisible:!this.state.dropdownvisible,groupeditem_selectedindex:0})},b.prototype.hideDropDown=function(){this.state.dropdownvisible&&this.setState({dropdownvisible:!1})},b.prototype.onSearch=function(b,c){var d=hK("title",b,c,null,null,"desc");return d.map(function(a){return a.id})},b.prototype.addValueToSelectedList=function(b,c,d){if(this.props.multiple&&this.props.list.type=="native_select"){var e=this.props.list.value;if(this.props.list.max_selections&&e.length==this.props.list.max_selections||e.length==10)return}this.props.onItemSelection(this.props.list.name,b),this.props.list.trigger_on_change&&this.props.triggerOnChange(this.props.list.name),this.props.multiple&&d&&(d.stopPropagation(),d.preventDefault()),this.searchnode&&this.searchnode.focus(),this.singleselectnode&&this.singleselectnode.focus(),this.setState({searchterm:"",navigation_keycode:""})},b.prototype.removeDataFromSelectedList=function(b,c){c.stopPropagation(),c.preventDefault(),this.singleselectnode&&this.singleselectnode.focus(),this.props.removeDataFromList(this.props.list.name,b)},b.prototype.filterGroupedList=function(b){var c=[],d=[],e=[];for(var f=0;f<b.length;f++)if(b[f].options){var g=b[f].options,h=[],i=[];for(var j=0;j<g.length;j++)g[j].label.toLowerCase().startsWith(this.state.searchterm)?h.push(g[j]):g[j].label.toLowerCase().indexOf(this.state.searchterm)>-1&&i.push(g[j]);c.push({options:h.concat(i),label:b[f].label})}else b[f].label.toLowerCase().startsWith(this.state.searchterm)?d.push(b[f]):b[f].label.toLowerCase().indexOf(this.state.searchterm)>-1&&e.push(b[f]);return d.concat(e).concat(c)},b.prototype.getGroupedDropDown=function(b){var c=[];this.state.searchterm&&(b=this.filterGroupedList(b));var d=0;for(var e=0;e<b.length;e++)if(b[e].options){var f=b[e].options;if(!f.length)continue;c.push(m("div",{"class":ka.groupeditemtitle},b[e].label));for(var g=0;g<f.length;g++){var h="",i=null;this.state.groupeditem_selectedindex==d&&(h=ka.grouped_item_sel,i=this.storeSelectedItemNode),d++,c.push(m("div",{ref:i,"class":ka.groupeditem+" "+h,onclick:this.addValueToSelectedList.bind(this,f[g])},fu(f[g].label,this.state.searchterm)))}}else{var j="",k=null;this.state.groupeditem_selectedindex==d&&(j=ka.grouped_item_sel,k=this.storeSelectedItemNode),c.push(m("div",{ref:k,onclick:this.addValueToSelectedList.bind(this,b[e]),"class":ka.customitem+" "+j},fu(b[e].label,this.state.searchterm))),d++}c=c.length?c:m("div",{"class":ka.emptysearchcontainer},gJ());var l=c.length?"":ka.dropdownmin;return m("div",{"class":ka.groupeditemcontainer+" "+l},m("input",{ref:this.storeGroupedSearchInputNode,onkeydown:this.onMultiSelectSearch,placeholder:K("Search"),oninput:this.onMultiSelectSearch,"class":ka.groupedinput,"data-purpose":"groupedsearch"}),m("div",{"class":ka.groupeditemslistcontainer},c))},b.prototype.getDropDownContainer=function(b){var c={},d={};for(var e=0;e<b.length;e++){if(b[e].options)return this.getGroupedDropDown(fh(b));b[e].title=b[e].label,b[e].empty_img!=0&&(b[e].empty_img=!0,b[e].classname||(b[e].classname=ka.dropdownnoimg));var f=b[e].id||e;b[e].id=f,d[f]=b[e];if(this.props.multiple&&this.props.list.type=="native_select")for(var g=0;g<this.selected_options.length;g++)this.selected_options[g].id==d[f].id&&(c[f]=d[f]);this.props.multiple&&this.selected_options.indexOf(b[e].label)>-1&&(c[e]=d[e])}if(Object.keys(d).length==0&&this.props.list.type!="dynamic_select")return this.hideDropDown(),null;var h=!1,i=!1,j="id",k=eF(j),l=30,n="",o=ka.listwrapperstyle;return this.props.list.type=="native_select"&&(h=!0,k=eF("UC"),l=55,n=ka.nativeitem),this.props.list.type=="dynamic_select"&&b.length==0&&!this.props.list.isemptyresp&&(i=!0),this.props.searchable?m(gP,{listid:"1",list:d,searchplaceholder:K("Search"),container:this.dropdownnode,fetchImageSource:!1,iscompletelist:!0,multiselect:this.props.multiple,onSearch:this.onSearch,sortComparator:k,excluded_list:c,customlistitemstyles:{customContainerStyles:ka.dropdownitemstyle+" "+n,containerWrapperStyle:ka.containerwrapperstyle,customListWrapper:o,rowHeight:l,customsearchstyle:{searchinputstyle:ka.searchstyle}},onListItemClicked:this.addValueToSelectedList,searchsequence:this.props.searchsequence,defaultsearch:h,loadingstate:i,searchtext:this.state.searchterm,customsearch:this.props.multiple,sortonsearch:!0,navigation_keycode:this.state.navigation_keycode}):m(gI,{completelist:!0,list:b,container:this.dropdownnode,customlistitemstyles:{customContainerStyles:ka.dropdownitemstyle+" "+n,containerWrapperStyle:ka.containerwrapperstyle,rowHeight:l,customListWrapper:o},onListItemClicked:this.addValueToSelectedList,iscompletelist:!0,loadingstate:i,navigation_keycode:this.state.navigation_keycode})},b.prototype.populateDropDown=function(){var b=this.props.list;this.selected_options=[];var c="",d="",e=b.type=="native_select"||!b.options||b.options.length==0?ka.dropdownmin:"";if(this.dropdownnode){var f=ft(this.dropdownnode,"[data-dialogwrapper=true]"),g=this.dropdownnode.offsetParent.offsetTop-f.scrollTop+f.offsetTop+this.dropdownnode.offsetParent.offsetHeight;g+200>f.offsetHeight&&(c=this.dropdownnode.offsetHeight,f.scrollHeight<490&&(d=ka.mountedfixed,c=""))}var h=c?ka.mountedtop:"";if(this.props.multiple){if(b.value)if(typeof b.value!="string")this.selected_options=b.value;else if(b.value.split){var i=b.value.split(",")!=""?b.value.split(","):[];for(var j=0;j<i.length;j++)for(var k=0;k<b.options.length;k++)b.options[k].value==i[j]&&this.selected_options.push(b.options[k].label)}var l=[],n=null;if(this.selected_options.length)for(var o=0;o<this.selected_options.length;o++){var p=this.selected_options[o].label||this.selected_options[o].title||this.selected_options[o];if(b.type=="native_select"){this.selected_options[o].id=this.selected_options[o].id?this.selected_options[o].id:this.selected_options[o].value;var q=hD(this.selected_options[o].id),r=q.imgsrc?q.imgsrc:"";n=m("img",{"class":ka.contactimg+" "+q.classname,src:r}),q.badge_letter&&(n=m("div",{"class":ka.contactimg+" "+ka.badge_letter},q.badge_letter))}l.push(m("div",{"class":ka.selectedoption},m("div",{"class":ka.closeiconcontainer},n,m(bW,{classname:ka.closeicon,type:"icon",content:"e9ee",onclick:this.removeDataFromSelectedList.bind(this,this.selected_options[o])})),m("span",{"class":ka.selectedtext},p)))}b.options&&b.options.length==l.length&&b.type!="native_select"&&(e=ka.dropdownmin);var s=b.options?b.options:[],t="dropdowncontainer",u=l.length?"":ka.emptysearch,v=l.length?" ":b.placeholder,w=this.state.dropdownvisible?m("div",{style:{bottom:c},"class":ka.dropdowncontainer+" "+d+" "+e+" "+h,key:t},this.getDropDownContainer(s)):null,x=this.state.focusinputcontainer?ka.multiselectparentfocus:"";return m("div",{"class":ka.multiselectparent+" "+x,onclick:this.toggleDropDown,onkeydown:this.toggleDropDown},m("div",{"class":ka.selectedelements_container},l,m("input",{placeholder:v,onfocus:this.focusInputContainer,onblur:this.focusInputContainer,ref:this.storeSearchNode,value:this.state.searchterm,"class":ka.multiselectlist_search+" "+u,onkeydown:this.onMultiSelectSearch,oninput:this.onMultiSelectSearch})),m(bW,{classname:ka.opendropdown,type:"icon",content:"e632",tabindex:"-1"}),w)}var y=b.options?b.options:[],z=null,A=this.state.dropdownvisible?m("div",{style:{bottom:c},"class":ka.dropdowncontainer+" "+d+" "+e+" "+h},this.getDropDownContainer(y)):null,B=b.placeholder,C=ka.placeholderstyle;if(b.value&&b.value!=""){C=ka.singleselectvalue;for(var D=0;D<b.options.length;D++)if(b.options[D].options){var E=b.options[D].options;for(var F=0;F<E.length;F++)E[F].value==b.value&&(B=E[F].label)}else b.options[D].value==b.value&&(B=b.options[D].label);b.type=="native_select"&&(B=b.value[0].title||b.value[0].label),z=m(bW,{onclick:this.removeDataFromSelectedList.bind(this,b),classname:ka.singleselectclose,type:"icon",content:"e634"}),b.type=="native_select"&&b.value.length==0&&(z=null)}return m("div",{ref:this.storeSingleselectNode,"class":ka.singleselect,tabindex:"0",onkeydown:this.toggleDropDown,onclick:this.toggleDropDown},m("span",{"class":C},B),z,m(bW,{classname:ka.opendropdown,type:"icon",content:"e632",tabindex:"-1"}),A)},b.prototype.render=function(b){var c=null;return b.list.isloading&&(c=m("div",{"class":ka.itemloading},m("span",{"class":ka.dotone}),m("span",{"class":ka.dottwo}),m("span",{"class":ka.dotthree}))),m("div",{"class":ka.options,ref:this.storeDropDownNode},m(R,{onClickOutside:this.hideDropDown},this.populateDropDown()),c)},b}(p),kc={pickerparent:"mc070469d7_pickerparent",pickerdropdown:"mc070469d7_pickerdropdown",calendarparent:"mc070469d7_calendarparent",timeinput:"mc070469d7_timeinput",pickertoggler:"mc070469d7_pickertoggler",timezonecontainer:"mc070469d7_timezonecontainer",cancelbutton:"mc070469d7_cancelbutton",setdate:"mc070469d7_setdate",actionscontainer:"mc070469d7_actionscontainer",selectedval:"mc070469d7_selectedval",calendaricon:"mc070469d7_calendaricon",placeholder:"mc070469d7_placeholder",value:"mc070469d7_value",closeicon:"mc070469d7_closeicon",zonepicker:"mc070469d7_zonepicker",timeinputparent:"mc070469d7_timeinputparent",timetxt:"mc070469d7_timetxt",itemfontsize:"mc070469d7_itemfontsize",mountedtop:"mc070469d7_mountedtop",mountedbottom:"mc070469d7_mountedbottom",labelcontainerbottom:"mc070469d7_labelcontainerbottom",labelcontainertop:"mc070469d7_labelcontainertop",listwrapperstyle:"mc070469d7_listwrapperstyle",searchstyle:"mc070469d7_searchstyle",searchcontainerstyle:"mc070469d7_searchcontainerstyle",zmNightMode:"zmNightMode"},kd=null,ke=function(a){function b(b){a.call(this,b),kd||kf(),this.togglePicker=this.togglePicker.bind(this),this.storePickerNode=this.storePickerNode.bind(this),this.onTimeChange=this.onTimeChange.bind(this),this.hidePicker=this.hidePicker.bind(this),this.submitDateTime=this.submitDateTime.bind(this),this.onSelectTimeZone=this.onSelectTimeZone.bind(this),this.onDateSelection=this.onDateSelection.bind(this),this.clearValues=this.clearValues.bind(this),this.toggleZonePicker=this.toggleZonePicker.bind(this),this.selecteddate=b.presetdate?new Date(b.presetdate):new Date;var c=b.placeholder;this.time=[T(this.selecteddate.getTime()),$(this.selecteddate.getTime())],this.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone,b.presetdate&&(c=X(this.selecteddate)+", "+this.selecteddate.toLocaleTimeString()+", "+this.timezone,this.props.onDateSelection(this.selecteddate,this.time,this.timezone)),this.state={pickervisible:!1,value:c,zonepickervisible:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clearValues=function(){this.setState({value:this.props.placeholder}),this.props.onDateSelection(null,null,null)},b.prototype.onSelectTimeZone=function(b,c,d){this.timezone=b,this.toggleZonePicker(d)},b.prototype.submitDateTime=function(){if(this.time=="Invalid")return;this.props.onDateSelection(this.selecteddate,this.time[1],this.timezone.id?this.timezone.id:this.timezone),this.setState({value:X(this.selecteddate)+", "+this.time[0]+", "+(this.timezone.id?this.timezone.id:this.timezone)}),this.hidePicker()},b.prototype.onDateSelection=function(b){this.selecteddate=b},b.prototype.onTimeChange=function(b,c,d,e){if(d||d)this.time="Invalid";else{var f=parseInt(c.split(":")[0]);this.time=[b,f<10&&f!=0?"0"+c+":00":c+":00"]}},b.prototype.storePickerNode=function(b){this.pickernode=b},b.prototype.hidePicker=function(b){if(b&&b.target.getAttribute("data-id"))return;this.setState({pickervisible:!1})},b.prototype.onSearchTimeZone=function(b,c){var d=hK("title",b,c,null,null,"desc");return d.map(function(a){return a.id})},b.prototype.togglePicker=function(b){if(b.type=="keydown"&&b.keyCode==13||b.type=="click"){var c=!1,d=this.pickernode.getBoundingClientRect().bottom;if(d+250>window.innerHeight)c=!0;else if(this.props.mountedviaforms&&this.pickernode){var e=ft(this.pickernode,"[data-dialogwrapper=true]"),f=this.pickernode.offsetParent.offsetParent.offsetTop-e.scrollTop+e.offsetTop+this.pickernode.offsetParent.offsetParent.offsetHeight;f+200>e.offsetHeight&&(c=!0)}this.setState({pickervisible:!this.state.pickervisible,mountedtop:c,zonepickervisible:!1})}},b.prototype.toggleZonePicker=function(b){if(b.type=="click"||b.type=="keydown"&&(b.keyCode==bA.KEYCODES.ENTER||b.keyCode==bA.KEYCODES.SPACE))b.stopPropagation(),b.preventDefault(),this.setState({zonepickervisible:!this.state.zonepickervisible})},b.prototype.getDateTimePickerContainer=function(){var b=this.timezone&&this.timezone.offset?this.timezone.offset:this.selecteddate.toTimeString().split(" ")[1].replace("GMT","GMT "),c=this.time[1].split(":");c=(new Date(this.selecteddate)).setHours(c[0],c[1]);var d=this.state.zonepickervisible?m(R,{onClickOutside:this.toggleZonePicker},m("div",{"class":kc.zonepicker},m(gP,{listid:"1",list:eJ(kd),searchplaceholder:K("Search"),iscompletelist:!0,onSearch:this.onSearchTimeZone,excluded_list:this.timezone,onListItemClicked:this.onSelectTimeZone,searchsequence:this.props.searchsequence,sortComparator:eF("index"),sortonsearch:!0,customlistitemstyles:{customContainerStyles:ka.dropdownitemstyle+" "+kc.itemfontsize,containerWrapperStyle:ka.containerwrapperstyle,customListWrapper:kc.listwrapperstyle,rowHeight:30,customsearchstyle:{searchinputstyle:kc.searchstyle,searchcontainerstyle:kc.searchcontainerstyle}}}))):"",e=this.state.mountedtop?kc.mountedtop:kc.mountedbottom;return m("div",{"class":kc.pickerdropdown+" "+e},m("div",{"class":kc.calendarparent},m(N,{onDateSelection:this.onDateSelection,selecteddate:this.selecteddate})),m("div",{"class":kc.timeinputparent},m("div",{"class":kc.timeinput},m("span",{"class":kc.timetxt},K("pinmsg.time.heading")),m(fJ,{onTimeChange:this.onTimeChange,time:c})),m("div",{"class":kc.timezonecontainer},m("div",{tabindex:"0","class":kc.selectedval,onkeydown:this.toggleZonePicker,onclick:this.toggleZonePicker},b),d)),m("div",{"class":kc.actionscontainer},m(bW,{classname:kc.cancelbutton,type:"button",content:K("Cancel"),onclick:this.hidePicker}),m(bW,{classname:kc.setdate,type:"button",content:K("datetime.setdatetime"),onclick:this.submitDateTime})))},b.prototype.render=function(b,c){var d=null,e=b.value?kc.value:kc.placeholder,f=b.value?m(bW,{classname:kc.closeicon,type:"icon",content:"e9ee",onclick:this.clearValues}):null,g="";return c.pickervisible&&(g=c.mountedtop?kc.labelcontainertop:kc.labelcontainerbottom,d=this.getDateTimePickerContainer()),m(R,{onClickOutside:this.hidePicker},m("div",{ref:this.storePickerNode,"class":kc.pickerparent},m("div",{tabindex:"0","class":kc.pickertoggler+" "+g,onclick:this.togglePicker,onkeydown:this.togglePicker},m("div",{"class":e},c.value),f,m(bW,{classname:kc.calendaricon,type:"icon",content:"e9e6",tabindex:"-1"})),d))},b}(p),kg={filesharecontainer:"mcfceb2bb4_filesharecontainer",fileinput:"mcfceb2bb4_fileinput",descriptioncontainer:"mcfceb2bb4_descriptioncontainer",fileiconcontainer:"mcfceb2bb4_fileiconcontainer",addiconcontainer:"mcfceb2bb4_addiconcontainer",uploadicon:"mcfceb2bb4_uploadicon",fileshareinputfocus:"mcfceb2bb4_fileshareinputfocus",fileitem:"mcfceb2bb4_fileitem",fileitemcontainer:"mcfceb2bb4_fileitemcontainer",filedetails:"mcfceb2bb4_filedetails",filename:"mcfceb2bb4_filename",itemclose:"mcfceb2bb4_itemclose",filesize:"mcfceb2bb4_filesize",addicon:"mcfceb2bb4_addicon",fileicon:"mcfceb2bb4_fileicon",progressbarcontainer:"mcfceb2bb4_progressbarcontainer",progressbar:"mcfceb2bb4_progressbar",progressbarinvisible:"mcfceb2bb4_progressbarinvisible",imgthumb:"mcfceb2bb4_imgthumb"},kh=function(a){function b(b){a.call(this,b),this.state={filelist:{},inputfocused:!1},this.onUploadFile=this.onUploadFile.bind(this),this.constructFileItem=this.constructFileItem.bind(this),this.clearFileItem=this.clearFileItem.bind(this),this.uploadToCliq=this.uploadToCliq.bind(this),this.storeInputNode=this.storeInputNode.bind(this),this.toggleInputBgColor=this.toggleInputBgColor.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentDidMount=function(){this.props.setfocus&&this.inputnode&&this.inputnode.focus()},b.prototype.storeInputNode=function(b){this.inputnode=b},b.prototype.toggleInputBgColor=function(){this.setState({inputfocused:!this.state.inputfocused})},b.prototype.convertToFilesArray=function(b){var c=[];for(var d in b)c.push(b[d]);return c},b.prototype.uploadToCliq=function(b){var c="v2/forms/"+this.props.formid+"/files",d=function(a,b){var c=JSON.parse(b),d=this.state.fileslist;d[a.name]&&d[a.name].status=="inprogress"&&(d[a.name].status="completed",d[a.name].id=c.id),this.props.addFilesToList(this.props.item.name,this.convertToFilesArray(d)),this.setState({fileslist:d})}.bind(this,b),e=function(a,b){var c=this.state.filelist;c[a.name]&&(c[a.name].loaded=b.loaded,c[a.name].total=b.total,this.setState({fileslist:c}))}.bind(this,b),f=new FormData;f.append("zchat_csrparam",bb(J.get("CHATCFCOOKIENAME"))),f.append("files",b),bt(c,f,d,null,null,null,null,{usedefaultcontenttype:!0},{progress:e})},b.prototype.onUploadFile=function(b){var c=b.target.files,d=this.state.filelist?this.state.filelist:{},e=this.props.item.max_selections?this.props.item.max_selections:this.props.item.multiple?10:1;for(var f=0;f<c.length;f++){if(d[c[f].name]){b.target.value=null;return}if(Object.keys(d).length==e)break;if(fz(c[f])&&!fy([c[f]],52428800)){c[f].status="inprogress",d[c[f].name]=c[f];if(c[f].type.indexOf("image")>-1){var g=new FileReader;g.readAsDataURL(c[f]),g.onloadend=function(a,b){var c=this.state.filelist;c[a.name].imgsrc=b.target.result,this.setState({filelist:c})}.bind(this,c[f])}this.uploadToCliq(c[f])}}b.target.value=null,this.props.addFilesToList(this.props.item.name,this.convertToFilesArray(d)),this.setState({filelist:d})},b.prototype.clearFileItem=function(b,c){var d=this.state.filelist;delete d[b.name],this.props.addFilesToList(this.props.items,this.convertToFilesArray(d)),this.setState({filelist:d})},b.prototype.constructFileItem=function(){var b=[],c=this.state.filelist;for(var d in c){var e="";if(c[d].status=="completed"||!c[d].status)e=kg.progressbarinvisible;var f=c[d].loaded/c[d].total||0,g=m("div",{"class":kg.progressbarcontainer+" "+e},m("div",{"class":kg.progressbar,style:{transform:"scaleX( "+f+" ) "}})),h=m(bW,{classname:kg.fileicon,type:"icon",tabindex:"-1",content:"e9b1"});c[d].type.indexOf("image")>-1&&c[d].imgsrc&&(h=m("img",{"class":kg.imgthumb,src:c[d].imgsrc})),b.push(m("div",{"class":kg.fileitem},m("div",{"class":kg.fileiconcontainer},h),m("div",{"class":kg.filedetails},m("div",{"class":kg.filename},c[d].name),m("div",{"class":kg.filesize},fx(c[d].size))),m("div",{"class":kg.itemclose,onclick:this.clearFileItem.bind(this,c[d])},m(bW,{type:"icon",tabindex:"-1",content:"e634"})),g))}var i=this.props.item.max_selections?this.props.item.max_selections:this.props.item.multiple?10:1;return b.length&&i!=Object.keys(this.state.filelist).length&&b.push(m("div",{"class":kg.addiconcontainer},m(bW,{classname:kg.addicon,type:"icon",tabindex:"-1",content:"e636"}))),m("div",{"class":kg.fileitemcontainer}," ",b," ")},b.prototype.render=function(b,c){var d=b.item.max_selections?b.item.max_selections:b.item.multiple?10:1,e=m("div",{"class":kg.descriptioncontainer},m(bW,{type:"icon",tabindex:"-1",content:"e911",classname:kg.uploadicon}),m("div",null,K("forms.filesharedescription1")),m("div",null,K("forms.filesharedescription2",[d]))),f=eu(c.filelist)?e:this.constructFileItem(),g=m("input",{ref:this.storeInputNode,onfocus:this.toggleInputBgColor,onblur:this.toggleInputBgColor,"class":kg.fileinput,onchange:this.onUploadFile,type:"file",multiple:!0});d==Object.keys(c.filelist).length&&(g=null);var h=this.state.inputfocused?kg.fileshareinputfocus:"";return m("div",{"class":kg.filesharecontainer+" "+h},g,f)},b}(p),ki=!1,km=Object.freeze({__proto__:null,"default":kh,setLastUploadStatus:kj,resetLastUploadStatus:kk,getLastUploadStatus:kl}),kn=function(a){function b(b){a.call(this,b),this.setLabelInputValue=this.setLabelInputValue.bind(this),this.setDateInputValue=this.setDateInputValue.bind(this),this.setDateTimeValue=this.setDateTimeValue.bind(this),this.storeFormItemNode=this.storeFormItemNode.bind(this),this.state={showvalidationerror:!1},this.storeItemNode=this.storeItemNode.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentWillReceiveProps=function(b){(b.inputfield.showmandatoryerror||b.inputfield.max_length_error||b.inputfield.max_selection_error)&&b.scroll_to_error&&this.scrollIntoView()},b.prototype.componentDidMount=function(){this.props.setfocus&&this.itemnode&&this.itemnode.focus()},b.prototype.storeItemNode=function(b){this.itemnode=b},b.prototype.storeFormItemNode=function(b){this.formitemnode=b},b.prototype.setLabelInputValue=function(b){var c=this.props.inputfield,d=!1;c.showmandatoryerror&&(c.showmandatoryerror=!1),c.format=="email"&&!b.target.value.match(be.regexes.emailid)?d="invalidemail":c.invalidemail&&(d=!1),c.format=="url"&&!b.target.value.match(be.regexes.link)?d="invalidurl":c.invalidlink&&(d=!1),c.format=="tel"&&!b.target.value.match(be.regexes.phonenumber)?d="invalidtel":c.invalidphonenumber&&(d=!1),this.props.addDataToList(c.name,b.target.value),this.setState({showvalidationerror:d})},b.prototype.setDateInputValue=function(b){var c=b.getDate()<10?"0"+b.getDate():b.getDate(),d=b.getMonth()+1;d=d<10?"0"+d:d;var e="";this.props.inputfield.type=="date"&&(e=b.getFullYear()+"-"+d+"-"+c),this.props.addDataToList(this.props.inputfield.name,e)},b.prototype.setDateTimeValue=function(b,c,d){var e="";if(b&&c&&d){var f=b.getDate()<10?"0"+b.getDate():b.getDate(),g=b.getMonth()+1;g=g<10?"0"+g:g,e={date_time:b.getFullYear()+"-"+g+"-"+f+"T"+c,time_zone_id:d}}this.props.addDataToList(this.props.inputfield.name,e)},b.prototype.scrollIntoView=function(){fb(this.formitemnode)},b.prototype.constructOptionsDetails=function(b){var c={},d=[];if(b=="contacts"){c=hU("",!0).concat(hW(""));if(c.length)for(var e=0;e<c.length;e++){if(c[e].ISBOT)continue;var f=hC(c[e]);d.push({label:c[e].DNAME,value:c[e].DNAME,desc:c[e].EMAILID,imgsrc:f.imgsrc,classname:f.classname,empty_img:!1,id:c[e].USERID,UC:c[e].UC,counter:e})}}if(b=="conversations"){c=hQ("");if(c.length)for(var g=0;g<c.length;g++){var h=hC(c[g]),i=h.badge_img?!0:!1,j=h.badge_letter?h.badge_letter:!1,k=h.imgsrc?!1:!0;d.push({label:c[g].TITLE,value:c[g].TITLE,imgsrc:h.imgsrc,classname:h.classname,empty_img:k,id:c[g].CHATID,UC:c[g].UC,badge_img:i,badge_letter:j,fonticon_class:h.fonticon_class})}}if(b=="channels"){c=hX("",null,!0);if(c.length)for(var l=0;l<c.length;l++){var m=hC(c[l]),n=m.imgsrc?!1:!0;d.push({label:c[l].dn,value:c[l].dn,imgsrc:m.imgsrc,classname:m.classname,empty_img:n,id:c[l].chid,UC:c[l].unreadmsgs,fonticon_class:m.fonticon_class,oc_id:c[l].oc_id})}}return d},b.prototype.constructFormItem=function(){var b=[],c=eJ(this.props.inputfield),d=ka.label,e=null;c.mandatory&&(d=d+" "+ka.mandatory),c.hint&&(e=m("span",{"class":ka.hint}," - ",c.hint)),b.push(m("div",{"class":ka.labelcontainer},m("div",{"class":d},c.label),e));var f=null;c.isloading&&(f=m("div",{"class":ka.itemloading},m("span",{"class":ka.dotone}),m("span",{"class":ka.dottwo}),m("span",{"class":ka.dotthree})));if(c.type=="text"||c.type=="number"){var g=null,h="text";c.type=="number"&&(h="number",g=m(bW,{classname:ka.textfieldicon+" "+ka.icontext,type:"icon",tabindex:"-1"},123)),c.format&&c.format=="password"&&(h="password",g=m(bW,{classname:ka.textfieldicon,type:"icon",content:"e65c",tabindex:"-1"})),c.format&&c.format=="tel"&&(g=m(bW,{classname:ka.textfieldicon,type:"icon",content:"e9fe",tabindex:"-1"})),c.format&&c.format=="email"&&(g=m(bW,{classname:ka.textfieldicon,type:"icon",content:"e669",tabindex:"-1"})),c.format&&c.format=="url"&&(g=m(bW,{classname:ka.textfieldicon,type:"icon",content:"e991",tabindex:"-1"})),b.push(m("div",{"class":ka.options},f,m("input",{ref:this.storeItemNode,"class":ka.inputfield,type:h,maxlength:c.max_length,placeholder:c.placeholder,onchange:this.setLabelInputValue,value:c.value}),g))}c.type=="textarea"&&b.push(m("div",{"class":ka.options},f,m("textarea",{ref:this.storeItemNode,"class":ka.inputtextarea,type:"text",maxlength:c.max_length,placeholder:c.placeholder,onchange:this.setLabelInputValue,value:c.value})));if(c.type=="date"){var i=c.value?c.value.date:"";b.push(m("div",{"class":ka.options},f,m(fB,{placeholder:c.placeholder,mountedviaforms:!0,presetdate:i,onDateSelection:this.setDateInputValue})))}if(c.type=="datetime"){var j=c.value?c.value.date_time:"";b.push(m("div",{"class":ka.options},f,m(ke,{onDateSelection:this.setDateTimeValue,placeholder:c.placeholder,value:c.value,presetdate:j,mountedviaforms:!0})))}if(c.type=="native_select"){var k=c.multiple?!0:!1,l=[];c.data_source=="contacts"?(c.options=this.constructOptionsDetails(c.data_source),c.filter&&c.filter[0]=="colleagues"?l=[bA.HYBRIDSEARCH.ORGCONTACT]:l=[bA.HYBRIDSEARCH.ORGCONTACT]):c.data_source=="channels"?(c.options=this.constructOptionsDetails(c.data_source),l=[bA.HYBRIDSEARCH.JOINEDCHANNEL],c.filter&&c.filter=="organization"&&(l=[bA.HYBRIDSEARCH.CHANNEL])):c.data_source=="conversations"&&(c.options=this.constructOptionsDetails(c.data_source),l=[bA.HYBRIDSEARCH.CHAT]),b.push(m(kb,{setfocus:this.props.setfocus,list:c,searchable:!0,multiple:k,searchsequence:l,triggerOnChange:this.props.triggerOnChange,onTriggerInput:this.props.onTriggerInput,onItemSelection:this.props.addDataToList,removeDataFromList:this.props.removeDataFromList}))}if(c.type=="select"||c.type=="dynamic_select"){var n=c.multiple?!0:!1,o=n?!0:!1;c.type=="dynamic_select"&&(o=!0),c||(c=[]),b.push(m(kb,{setfocus:this.props.setfocus,list:c,searchable:o,multiple:n,triggerOnChange:this.props.triggerOnChange,onTriggerInput:this.props.onTriggerInput,onItemSelection:this.props.addDataToList,removeDataFromList:this.props.removeDataFromList}))}return c.type=="file"&&b.push(m(kh,{item:c,formid:this.props.formid,addFilesToList:this.props.addFilesToList,setfocus:this.props.setfocus})),b},b.prototype.render=function(b,c){var d=null,e=null,f=null,g=null;b.inputfield.form_error_msg&&(f=m("div",{"class":ka.showmandatoryerror},b.inputfield.form_error_msg)),b.inputfield.showmandatoryerror&&b.inputfield.mandatory&&(d=m("div",{"class":ka.showmandatoryerror},K("forms.mandatory"))),b.inputfield.max_length_error&&(g=m("div",{"class":ka.showmandatoryerror},K("forms.maxlengtherror",[b.inputfield.max_length]))),b.inputfield.max_selection_error&&(g=m("div",{"class":ka.showmandatoryerror},K("forms.maxselectionerror",[b.inputfield.max_selections]))),c.showvalidationerror=="invalidemail"&&(e=m("div",{"class":ka.showmandatoryerror},K("forms.invalidemail"))),c.showvalidationerror=="invalidurl"&&(e=m("div",{"class":ka.showmandatoryerror},K("forms.invalidurl"))),c.showvalidationerror=="invalidtel"&&(e=m("div",{"class":ka.showmandatoryerror},K("forms.invalidtel"))),b.inputfield.uploadprogresserror&&(e=m("div",{"class":ka.showmandatoryerror},K("forms.uploadprogresserror")));var h="";return b.inputfield.status=="disable"&&(h=ka.disable),e&&(d=null,f=null),m("div",{"class":ka.formitem+" "+h,ref:this.storeFormItemNode},this.constructFormItem(),d,e,f,g)},b}(p),ko=function(a){function b(b){a.call(this,b),this.state={list:eJ(b.params.output,!0).inputs,global_form_error:null,removescroll:!1,submitloader:!1},this.scroll_to_error=!1,this.submitForm=this.submitForm.bind(this),this.cancelForm=this.cancelForm.bind(this),this.triggerOnChange=this.triggerOnChange.bind(this),this.handleTriggerOnChange=this.handleTriggerOnChange.bind(this),this.handleFormInput=this.handleFormInput.bind(this),this.onTriggerInput=this.onTriggerInput.bind(this),this.addDataToList=this.addDataToList.bind(this),this.removeDataFromList=this.removeDataFromList.bind(this),this.disableScrollToMandatory=this.disableScrollToMandatory.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.removeFormError=this.removeFormError.bind(this),this.addFilesToList=this.addFilesToList.bind(this),this.handleEscapeListener=this.handleEscapeListener.bind(this),document.addEventListener("keydown",this.handleEscapeListener)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.componentDidMount=function(){var b=this.props.parentnode.querySelector("[data-dialogwrapper=true]");b&&b.scrollHeight<490&&this.setState({removescroll:!0})},b.prototype.handleEscapeListener=function(b){b&&b.keyCode==27&&this.cancelForm(b)},b.prototype.disableScrollToMandatory=function(){this.scroll_to_error=!1},b.prototype.removeFormError=function(){this.setState({global_form_error:null})},b.prototype.addFilesToList=function(b,c){var d=this.state.list;for(var e=0;e<d.length;e++)d[e].name==b&&(d[e].value=c);this.setState({list:d})},b.prototype.addDataToList=function(b,c){var d=this.state.list,e="",f=this.state.global_form_error;for(var g=0;g<d.length;g++)if(d[g].name==b){e=d[g].value,f&&(f=null),d[g].form_error_msg&&(d[g].form_error_msg=null),d[g].multiple?d[g].type=="native_select"?e?e.push(c):e=[c]:e=e?e+","+c.value:c.value:d[g].type=="native_select"?(e||(e={}),e=[c]):e=c.value||c,d[g].value=e,d[g].showmandatoryerror&&e&&(d[g].showmandatoryerror=!1);break}this.setState({list:d,global_form_error:f})},b.prototype.removeDataFromList=function(b,c){var d=this.state.list,e="";for(var f=0;f<d.length;f++)if(d[f].name==b){var g=d[f];e=g.value;if(g.type=="native_select")if(g.multiple){for(var h=0;h<e.length;h++)if(c.id==e[h].id){e.splice(h,1);break}}else e="";else if(g.multiple){e=e.split(",");var i=d[f].options;for(var j=0;j<i.length;j++)if(i[j].title==c||i[j].label==c)c=i[j].value;e.splice(e.indexOf(c),1),e=e.toString()}else e="";d[f].value=e}this.setState({list:d})},b.prototype.onTriggerInput=function(b){var c={};c.values=this.constructFormData(),c.target={name:b,query:""};if(c.values[b]&&c.values[b]!="")return;ks(c,this.props.params.output.id,this.handleFormInput)},b.prototype.handleFormInput=function(b){var c=JSON.parse(b),d=this.state.list;if(c.status=="Consent"){var e=new cz;e.mountComponent(c.chid,c,function(a,b){this.handleFormInput(JSON.stringify(b.data.dreResponse))}.bind(this))}else{for(var f=0;f<d.length;f++)d[f].name==c.output.target&&(c.output.options.length?(d[f].options=c.output.options,d[f].isemptyresp&&(d[f].isemptyresp=!1)):d[f].isemptyresp=!0);this.setState({list:d})}},b.prototype.checkFormValuesLength=function(b){for(var c=0;c<b.length;c++)if((b[c].max_length||b[c].max_selections)&&b[c].value)if(b[c].multiple){if(b[c].type=="native_select"&&b[c].value.length>b[c].max_selections||b[c].value.split&&b[c].value.split(",").length>b[c].max_selections)b[c].max_selection_error=!0,this.scroll_to_error=!0}else b[c].value.length>b[c].max_length&&(b[c].max_length_error=!0,this.scroll_to_error=!0);return b},b.prototype.checkMandatoryFields=function(b){var c=this.state.list;for(var d=0;d<c.length;d++)if(c[d].type=="file"&&c[d].value&&c[d].value.length){var e=c[d].value;for(var f=0;f<e.length;f++)e[f].status=="inprogress"&&(c[d].showmandatoryerror=!1,c[d].uploadprogresserror=!1,e.length==1&&c[d].mandatory?c[d].showmandatoryerror=!0:c[d].uploadprogresserror=!0,this.scroll_to_error=!0)}else c[d].mandatory&&(!c[d].value||c[d].value=="")&&(c[d].showmandatoryerror=!0,this.scroll_to_error=!0);c=this.checkFormValuesLength(c),this.setState({list:c})},b.prototype.submitForm=function(){var b=this.constructFormData();this.checkMandatoryFields(b);if(this.scroll_to_error)return;var c=this.state.list;for(var d=0;d<c.length;d++)c[d].type=="file"&&kj();kp({values:b},this.props.params.output.id,this.props.submitCallBack,this.handleFormSubmit),this.setState({submitloader:!0})},b.prototype.cancelForm=function(b){this.props.params.output.trigger_on_cancel&&kq(this.props.params.output.id,this.props.submitCallBack),this.props.closeCallBack(),b.stopPropagation(),b.preventDefault(),document.removeEventListener("keydown",this.handleEscapeListener),this.props.unmountComponent()},b.prototype.handleFormSubmit=function(b){if(b.output&&b.output.type=="form_error"){if(b.output.inputs){var c=this.state.list,d=b.output.inputs;for(var e=0;e<c.length;e++)for(var f in d)f==c[e].name&&(c[e].form_error_msg=d[f]);this.setState({list:c,global_form_error:b.output.text,submitloader:!1})}}else if(b.status=="Consent"){var g=new cz;g.mountComponent(b.chid,b,function(a,b){var c=b.data.dreResponse.message_source?b.data.dreResponse.message_source.id:b.data.dreResponse.output.meta.message_source.id;this.props.submitCallBack(a,c,b.data.dreResponse),this.props.closeCallBack(),document.removeEventListener("keydown",this.handleEscapeListener),this.props.unmountComponent()}.bind(this))}else{if(b.status=="Failure"){var h=new cz;h.mountComponent(b.chid,b)}this.props.closeCallBack(),document.removeEventListener("keydown",this.handleEscapeListener),this.props.unmountComponent()}},b.prototype.triggerOnChange=function(b){var c={};c.values=this.constructFormData(),c.target={name:b},this.changeLoadingStatus(b,!0),kr(c,this.props.params.output.id,this.handleTriggerOnChange)},b.prototype.handleTriggerOnChange=function(b){var c=b.output.actions,d=this.state.list;for(var e=0;e<c.length;e++)for(var f=0;f<d.length;f++)if(d[f].name==c[e].name){if(c[e].type=="remove"){d.splice(f,1);break}if(c[e].type=="add_after"){d.splice(f+1,0,c[e].input);break}if(c[e].type=="add_before"){d.splice(f-1,0,c[e].input);break}if(c[e].type=="update"){this.updateFormItem(c[e].input);break}if(c[e].type=="disable"){this.changeFormItemStatus(c[e].type,c[e].name);break}if(c[e].type=="enable"){this.changeFormItemStatus(c[e].type,c[e].name);break}c[e].type=="clear"&&(d[e].value="")}this.changeLoadingStatus(null,!1),this.setState({list:d})},b.prototype.changeFormItemStatus=function(b,c){var d=this.state.list;for(var e=0;e<d.length;e++)d[e].name==c&&(d[e].status=b);this.setState({list:d})},b.prototype.updateFormItem=function(b){var c=this.state.list;for(var d=0;d<c.length;d++)c[d].name==b.name&&(c[d]=b);this.setState({list:c})},b.prototype.constructFormData=function(){var b=this.state.list||{},c={};for(var d=0;d<b.length;d++){var e=b[d].name;if(b[d].type=="native_select"){var f=b[d].data_source;if(b[d].value&&b[d].value.length>0){c[e]={},c[e][f]=[];var g=b[d].value;for(var h=0;h<g.length;h++){var i=g[h].id;f=="channels"&&(i=g[h].oc_id?g[h].oc_id:iH(g[h].id).oc_id),c[e][f].push(i)}}}else if(b[d].type=="file"&&b[d].value&&b[d].value.length){var j=[];for(var k=0;k<b[d].value.length;k++)j.push(b[d].value[k].id);c[e]=j.join(",")}else b[d].value&&(c[e]=b[d].value)}return c},b.prototype.changeLoadingStatus=function(b,c){var d=this.state.list;for(var e=0;e<d.length;e++){if(d[e].name==b){d[e].isloading=c;break}if(!c&&!b&&d[e].isloading){d[e].isloading=c;break}}this.setState({list:d})},b.prototype.getFormDialog=function(){var b=this.props.params.output,c=b.title,d=[];this.state.global_form_error||d.push({text:K("Cancel"),buttonstyle:ka.cancelbutton,onclick:this.cancelForm}),b.actions.submit&&!this.state.global_form_error&&(this.state.submitloader?d.push({buttonstyle:ka.submitbutton+" "+ka.loader}):d.push({text:b.button_label||K("forms.submit"),buttonstyle:ka.submitbutton,onclick:this.submitForm}));var e=this.state.removescroll?ka.removescroll:"",f={customFooterStyle:ka.footer,customContainerStyle:ka.formparent,customHeaderStyle:ka.header,customWrapperStyle:ka.formcontent+" "+e},g=this.state.list,h=[],i=null;b.hint&&(i=m("div",{"class":ka.formhint},b.hint));for(var j=0;j<g.length;j++){!g[j].value&&g[j].type=="native_select"&&(g[j].value=[]);var k=!1;j==0&&(k=!0),h.push(m(kn,{inputfield:g[j],triggerOnChange:this.triggerOnChange,onTriggerInput:this.onTriggerInput,addDataToList:this.addDataToList,removeDataFromList:this.removeDataFromList,scroll_to_error:this.scroll_to_error,setfocus:k,formid:this.props.params.output.id,addFilesToList:this.addFilesToList})),this.scroll_to_error&&(g[j].showmandatoryerror||g[j].max_length_error)&&this.disableScrollToMandatory()}var l=[];if(this.props.params.message_source){var n=this.props.params.message_source,o=null,p=null;if(n.name){var q=n.store_appname?n.store_appname:"/"+n.name;o=m("div",{"class":ka.botname},q)}if(n.photo_id){var r="/_chat/botimg/"+n.photo_id+"/photo.do";n.type=="command"&&(r="/_chat/commandimg/"+n.photo_id+"/photo.do"),p=m("img",{"class":ka.botimage,src:r})}l=[m("div",{"class":ka.footerprefix},p,o)]}return this.state.global_form_error&&(l=[m("div",{"class":ka.form_error},m("div",null," ",this.state.global_form_error),m(bW,{classname:ka.closeicon,type:"icon",content:"e9ee",onclick:this.removeFormError}))]),m(bY,{heading:c,headerinfosuffix:i,actions:d,footerinfoprefix:l,customDialogStyles:f,ignoreFocusOnMount:!0},h)},b.prototype.render=function(){return m("div",null,this.getFormDialog()," ")},b}(p),kt=function(){this.unmountComponent=this.unmountComponent.bind(this)};kt.prototype.mountComponent=function(b,c,d){this.node=document.createElement("div"),document.body.appendChild(this.node),G(m(ko,{params:b,unmountComponent:this.unmountComponent,submitCallBack:c,parentnode:this.node,closeCallBack:d}),this.node)},kt.prototype.unmountComponent=function(){G("",this.node),this.node.parentElement&&this.node.parentElement.removeChild(this.node)};var ku={consentparent:"mc1e6ad615_consentparent",linkicon:"mc1e6ad615_linkicon",headercontainer:"mc1e6ad615_headercontainer",headercontent:"mc1e6ad615_headercontent",footer:"mc1e6ad615_footer",footerprefix:"mc1e6ad615_footerprefix",texthint:"mc1e6ad615_texthint",headerdescription:"mc1e6ad615_headerdescription",bodycontainer:"mc1e6ad615_bodycontainer",text:"mc1e6ad615_text",restrict:"mc1e6ad615_restrict",allow:"mc1e6ad615_allow"},kv=function(a){function b(b){a.call(this,b),this.state={remember:!1},this.rememberTheChoice=this.rememberTheChoice.bind(this),this.allowPermission=this.allowPermission.bind(this),this.restrictPermission=this.restrictPermission.bind(this),this.dialogCloseCallBack=this.dialogCloseCallBack.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.dialogCloseCallBack=function(){this.props.onResponse(!0,!1)},b.prototype.updateLinkPreviewSettings=function(b){var c=function(a){a.authentication_consent==1?(this.props.onResponse(!0,!0),this.props.unmountComponent()):a.authentication_consent==-1&&(this.props.onResponse(!1,!0),this.props.unmountComponent())}.bind(this);kx(b,c)},b.prototype.rememberTheChoice=function(){this.setState({remember:!this.state.remember})},b.prototype.allowPermission=function(){this.state.remember?this.updateLinkPreviewSettings(1):(this.props.onResponse(!0,!0),this.props.unmountComponent())},b.prototype.restrictPermission=function(){this.state.remember?this.updateLinkPreviewSettings(-1):(this.props.onResponse(!1,!0),this.props.unmountComponent())},b.prototype.render=function(){var b=m("div",{"class":ku.headercontent},m(bW,{classname:ku.linkicon,type:"icon",content:"e991"}),m("div",{"class":ku.headerdescription},K("urlconsent.zoholinkpreview"))),c=m("div",null,m("div",{"class":ku.text},K("urlconsent.description1")),m("div",{"class":ku.text},K("urlconsent.description2")),m("div",{"class":ku.text}," ",K("urlconsent.description3")),m("div",{"class":ku.text+" "+ku.texthint},m("span",null,K("urlconsent.description4",K("urlconsent.zoholinkprivacy"))))),d={customFooterStyle:ku.footer,customContainerStyle:ku.consentparent,customHeaderStyle:ku.headercontainer,customWrapperStyle:ku.bodycontainer},e=[{text:K("urlconsent.restrict"),buttonstyle:ku.restrict,onclick:this.restrictPermission},{text:K("urlconsent.allow"),buttonstyle:ku.allow,onclick:this.allowPermission}],f=[m("div",{"class":ku.footerprefix},m("input",{id:"rememberme",type:"checkbox",oninput:this.rememberTheChoice}),m("label",{"for":"rememberme"},K("urlconsent.remember")))];return m("div",{"class":ku.consentparent},m(bY,{customDialogStyles:d,actions:e,callbackOnClose:this.dialogCloseCallBack,footerinfoprefix:f,heading:b},c))},b}(p),kw=function(){this.unmountComponent=this.unmountComponent.bind(this)};kw.prototype.mountComponent=function(b){this.node=document.createElement("div"),document.body.appendChild(this.node),G(m(kv,{onResponse:b,unmountComponent:this.unmountComponent}),this.node)},kw.prototype.unmountComponent=function(){G("",this.node),this.node.parentElement.removeChild(this.node)};var ky={timeselector_wrapper:"mc2e590262_timeselector_wrapper",calendar_wrapper:"mc2e590262_calendar_wrapper",duration_item_style:"mc2e590262_duration_item_style",duration_list_wrapper:"mc2e590262_duration_list_wrapper",duration_selector_wrapper:"mc2e590262_duration_selector_wrapper",duration_wrapper_expanded:"mc2e590262_duration_wrapper_expanded",duration_footer_wrapper:"mc2e590262_duration_footer_wrapper",duration_text:"mc2e590262_duration_text",duration_text_invalid:"mc2e590262_duration_text_invalid",duration_apply_button:"mc2e590262_duration_apply_button",duration_apply_invalid:"mc2e590262_duration_apply_invalid",time_space:"mc2e590262_time_space",zmNightMode:"zmNightMode"},kz=function(a){function b(b){a.call(this,b),this.state={display_customcalendar:!1,display_duration_selector:!0,selected_date:Date.now(),selected_time:(new Date).getHours()+":"+((new Date).getMinutes()+1),duration_list:[{id:"3600000",title:K("chat.hour",[1]),empty_img:!0},{id:"28800000",title:K("chat.hours",[8]),empty_img:!0},{id:"86400000",title:K("chat.day",[1]),empty_img:!0},{id:"604800000",title:K("chat.week",[1]),empty_img:!0},{id:"-1",title:K("chat.forever"),empty_img:!0},{id:"custom",title:K("pinmsg.duration.custom"),empty_img:!0}]},this.onListItemClicked=this.onListItemClicked.bind(this),this.onDateChange=this.onDateChange.bind(this),this.onTimeChange=this.onTimeChange.bind(this),this.onDurationSelect=this.onDurationSelect.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.onDurationSelect=function(b,c,d){c=c||this.combineDateAndTimeAsEpoch(),d=d||K("pinmsg.duration.customtime",U(c)),this.setState({display_duration_selector:!1}),this.props.onDurationSelect(c,d)},b.prototype.onListItemClicked=function(b,c,d){var e=b.id==="-1"?"-1":(new Date).getTime()+parseInt(b.id);b.id==="custom"?this.setState({display_customcalendar:!this.state.display_customcalendar}):this.onDurationSelect(null,e,b.title),d.stopPropagation()},b.prototype.constructDurationList=function(){var b={customContainerStyles:ky.duration_item_style,rowHeight:30};return m("div",{"class":ky.duration_list_wrapper},m(gI,{list:this.state.duration_list,onListItemClicked:this.onListItemClicked,iscompletelist:!0,customlistitemstyles:b}))},b.prototype.onDateChange=function(b){b=(new Date(b)).getTime(),this.setState({selected_date:b})},b.prototype.onTimeChange=function(b,c){this.setState({selected_time:c})},b.prototype.combineDateAndTimeAsEpoch=function(){var b=V(this.state.selected_date),c=(new Date(this.state.selected_date)).getFullYear();b.indexOf(c)===-1&&(b+=" "+c);var d=b+" "+this.state.selected_time;return(new Date(d)).getTime()},b.prototype.constructCalendarAndTimeComp=function(){var b=ky.duration_text,c=ky.duration_apply_button,d=K("pinmsg.duration.till")+" "+U(this.combineDateAndTimeAsEpoch());return Date.now()>this.combineDateAndTimeAsEpoch()&&(b+=" "+ky.duration_text_invalid,c+=" "+ky.duration_apply_invalid,d=K("pinmsg.duration.invalid")),m("div",{"class":ky.calendar_wrapper},m("div",null,m(N,{onDateSelection:this.onDateChange,selecteddate:this.state.selected_date}),m("div",{"class":ky.time_space},K("pinmsg.time.heading"),m(fJ,{time:this.combineDateAndTimeAsEpoch(),onTimeChange:this.onTimeChange})),m("div",{"class":ky.duration_footer_wrapper},m("span",{"class":b},d),m(bW,{type:"button",key:"apply",content:K("pinmsg.custom.apply"),classname:c,onclick:this.onDurationSelect}))))},b.prototype.render=function(){if(!this.state.display_duration_selector)return null;var b=null,c=ky.duration_selector_wrapper+" "+this.props.selectorWrapperCustomStyle;return this.state.display_customcalendar&&(b=this.constructCalendarAndTimeComp(),c+=" "+ky.duration_wrapper_expanded),m("div",{"class":c},this.constructDurationList(),b)},b}(p),kA=function(){};kA.prototype.mountComponent=function(b,c,d){this.node=b,G(m(kz,{node:b,onDurationSelect:c,selectorWrapperCustomStyle:d}),b)},kA.prototype.unmountComponent=function(){G("",this.node)};var kB={allownotification_checkbox:"mc541d7947_allownotification_checkbox",allownotification_checkboxsel:"mc541d7947_allownotification_checkboxsel",allownotification_text:"mc541d7947_allownotification_text",pinheader:"mc541d7947_pinheader",pinheader_wrapper:"mc541d7947_pinheader_wrapper",pinmsg_wrapper:"mc541d7947_pinmsg_wrapper",pinicon:"mc541d7947_pinicon",pinmsg:"mc541d7947_pinmsg",content_wrapper:"mc541d7947_content_wrapper",duration_label:"mc541d7947_duration_label",duration_dropdown_wrapper:"mc541d7947_duration_dropdown_wrapper",duration_selector_wrapper:"mc541d7947_duration_selector_wrapper",duration_selector_text:"mc541d7947_duration_selector_text",pinnote:"mc541d7947_pinnote",button_style:"mc541d7947_button_style",container:"mc541d7947_container",header:"mc541d7947_header",notificationwrapper:"mc541d7947_notificationwrapper",footer:"mc541d7947_footer",button_pin:"mc541d7947_button_pin",button_cancel:"mc541d7947_button_cancel",duration_selector_position:"mc541d7947_duration_selector_position",zmNightMode:"zmNightMode"},kC=function(a){function b(b){a.call(this,b),this.state={allow_notification:!1,show_duration_dropdown:!1,duration_text:K("chat.forever")},this.duration_time="-1",this.setDurationSelectorNode=this.setDurationSelectorNode.bind(this),this.duration_selector_node=null,this.onPinAction=this.onPinAction.bind(this),this.onDurationSelect=this.onDurationSelect.bind(this),this.onDurationWrapperClick=this.onDurationWrapperClick.bind(this),this.onClickOutsideList=this.onClickOutsideList.bind(this),this.toggleNotificationConsents=this.toggleNotificationConsents.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setDurationSelectorNode=function(b){this.duration_selector_node=b},b.prototype.getHeader=function(){return m("div",{"class":kB.pinheader_wrapper},m("div",{"class":kB.pinheader},K("pin.this.msg")),m("div",{"class":kB.header_highlighter}),m("div",{"class":kB.pinmsg_wrapper},m("div",{"class":kB.pinicon}),m("div",{"class":kB.pinmsg,dangerouslySetInnerHTML:{__html:this.props.msgtopin}})))},b.prototype.toggleNotificationConsents=function(b){this.setState({allow_notification:!this.state.allow_notification}),b.stopPropagation()},b.prototype.onPinAction=function(){this.props.pinactionCallback(this.duration_time,this.state.allow_notification),this.props.removeComponent()},b.prototype.onDurationSelect=function(b,c){this.setState({duration_text:c,show_duration_dropdown:!1}),this.duration_time=b},b.prototype.onDurationWrapperClick=function(b){b.target===this.duration_selector_node&&(this.setState({show_duration_dropdown:!this.state.show_duration_dropdown}),b.stopPropagation())},b.prototype.onClickOutsideList=function(){this.setState({show_duration_dropdown:!1})},b.prototype.render=function(){var b=this.state.allow_notification?kB.allownotification_checkboxsel:kB.allownotification_checkbox,c=[{text:K("Cancel"),onclick:this.props.removeComponent,buttonstyle:kB.button_cancel},{text:K("pinmsg.pin"),onclick:this.onPinAction,buttonstyle:kB.button_pin}],d=K("channel.deluge.note"),e=this.props.show_pin_note?m("div",{"class":kB.pinnote},m("strong",null,d)," "+K("pinmsg.existing.note")):"",f=this.state.show_duration_dropdown?m(R,{onClickOutside:this.onClickOutsideList},m(kz,{onDurationSelect:this.onDurationSelect,selectorWrapperCustomStyle:kB.duration_selector_position})):"",g=m("div",{"class":kB.content_wrapper},m("div",{"class":kB.duration_dropdown_wrapper},m("div",{"class":kB.duration_label},K("pinmsg.duration.label")),m("div",{"class":kB.duration_selector_wrapper,"data-pin-dropdown":!0,ref:this.setDurationSelectorNode,onclick:this.onDurationWrapperClick},this.state.duration_text,f)),e),h=m("div",{"class":kB.notificationwrapper,onclick:this.toggleNotificationConsents},m("span",{"class":b}),m("input",{type:"checkbox"}),m("label",{"class":kB.allownotification_text},K("pinmsg.notify"))),i={customButtonStyle:kB.button_style,customContainerStyle:kB.container,customHeaderStyle:kB.header,customFooterStyle:kB.footer},j=m(bY,{heading:this.getHeader(),actions:c,footerinfoprefix:h,customDialogStyles:i,callbackOnClose:this.props.removeComponent},g);return j},b}(p),kD=function(){};kD.prototype.mountComponent=function(b,c,d){this.node=document.createElement("div"),document.body.appendChild(this.node),G(m(kC,{pinactionCallback:b,msgtopin:c,removeComponent:this.unmountComponent.bind(this),show_pin_note:d}),this.node)},kD.prototype.unmountComponent=function(){G("",this.node),fi(this.node)};var kE={fork_title_wrapper:"mc8f31fab0_fork_title_wrapper",fork_chattitle:"mc8f31fab0_fork_chattitle",fork_includeall:"mc8f31fab0_fork_includeall",participants_checkboxsel:"mc8f31fab0_participants_checkboxsel",participants_checkbox:"mc8f31fab0_participants_checkbox",fork_dialog_footer:"mc8f31fab0_fork_dialog_footer",zmNightMode:"zmNightMode"},kF=function(a){function b(b){a.call(this,b),this.state={include_all_participants:fd(this.props.listid)?!1:!0,chat_title:this.props.chattitle},this.toggleParticipantsInclusion=this.toggleParticipantsInclusion.bind(this),this.handleTitleChange=this.handleTitleChange.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.toggleParticipantsInclusion=function(){this.setState({include_all_participants:!this.state.include_all_participants})},b.prototype.handleTitleChange=function(b){var c=eO(b);this.setState({chat_title:c.value})},b.prototype.render=function(){var b=[{text:K("Create"),buttonstyle:"alignend",onclick:function(a){if(ew(this.state.chat_title)){this.props.failureCallback(K("fork.title.empty"));return}var b={includeparticipants:this.state.include_all_participants,msguid:this.props.msgid,sid:J.get("sid"),title:this.state.chat_title,userids:a.toString()},c={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":ex()},d=function(){this.props.failureCallback(K("fork.chat.failed"))}.bind(this);bt("v1/chats/"+this.props.listid+"/fork",b,null,d,null,null,c),this.props.unmountComponent()}.bind(this)}],c=this.state.include_all_participants?kE.participants_checkboxsel:kE.participants_checkbox,d=m("div",{"class":kE.fork_header_wrapper},m("div",{"class":kE.fork_title_wrapper},m("div",{"class":kE.fork_chattitle},K("fork.chat.title")),m("input",{type:"text","class":kE.fork_chattitle_input,onChange:this.handleTitleChange,placeholder:K("fork.title.enter"),value:this.state.chat_title})),m("div",{"class":kE.fork_includeall,onclick:this.toggleParticipantsInclusion},m("span",{"class":c}),m("input",{type:"checkbox"}),m("label",{"class":kE.checkbox_label},K("fork.chat.includeall")))),e=this.state.include_all_participants&&this.props.participantslist?{USERID:this.props.participantslist}:"",f=[bA.HYBRIDSEARCH.ORGCONTACT],g=hK("DNAME","",el(),10,e,"EMAILID"),h={},i=0;g.forEach(function(a){var b=hC(a);b.counter=i++,h[a.USERID]=b});var j={};e.USERID&&e.USERID.forEach(function(a){var b={id:a};j[a]=b});var k={footerWrapper:kE.fork_dialog_footer};return m(gP,{listid:this.props.listid,title:K("fork.chat.heading"),list:h,searchplaceholder:K("users.name.search"),fetchImageSource:hD,multiselect:!0,dialogview:!0,searchsequence:f,defaultsearch:!0,actions:b,callbackOnClose:this.props.unmountComponent,footerprefix:d,customDialogStyles:k,invisible_excluded_list:j,updateinitiallist:!0,sortonsearch:!0,sortComparator:eF("UC")})},b}(p),kG=function(){this.unmountComponent=this.unmountComponent.bind(this)};return kG.prototype.mountComponent=function(b,c,d,e,f){this.node=document.createElement("div"),document.body.appendChild(this.node),G(m(kF,{listid:b,chattitle:c,msgid:d,participantslist:e,failureCallback:f,unmountComponent:this.unmountComponent}),this.node)},kG.prototype.unmountComponent=function(){G("",this.node),fi(this.node)},a.Ajax=bz,a.BadgeImage=hJ,a.Bots=dj,a.Button=bX,a.Calendar=O,a.Channels=jl,a.Chats=gx,a.Config=J,a.ConfirmationDialog=jX,a.Consents=cz,a.Cookie=bd,a.DataObject=bi,a.DatePicker=fC,a.DateUtil=_,a.DesktopNotification=P,a.Dialog=bZ,a.DialogView=bY,a.Drafts=jW,a.DurationSelector=kA,a.ForkChat=kG,a.FormFileShare=km,a.Forms=kt,a.HybridSearch=iz,a.I18N=K,a.IntegrationsData=b$,a.ListFactory=gz,a.ListViewComponent=gK,a.Markdown=cu,a.Matcher=be,a.MessageActions=j_,a.Moveable=gb,a.MsgUtil=jp,a.MultiSelectList=gO,a.MultiSelectorListDialogComponent=gQ,a.NotificationOwner=gn,a.Participants=hF,a.PinMsgDialog=kD,a.RecentChats=hw,a.SearchContainer=gL,a.SearchContainerComponent=gM,a.SecurityManager=cM,a.Time=fK,a.UrlConsent=kw,a.UrlPreview=jC,a.Users=eq,a.Util=fA,a.VideoPlayer=gd,a.VideoPlayerFactory=gi,a.WmsConstants=bA,a.WmsContacts=em,a.WmsLocalStorage=bh,a.WmsOrgContacts=bT,a.WmsSessionStorage=bg,a.Zomoji=fE,a.ZomojiComponent=fH,a.template=fS,a.updateLinkPreviewSettings=kx,a}({});"use strict";var $WC=$WC||{};$WC.VirtualList=function(a){function l(){if(Date.now()-k>100){var a=this.container.querySelectorAll('[data-rm="1"]');for(var b=0,c=a.length;b<c;b++)this.container.removeChild(a[b])}}var b=a&&a.w+"px"||"100%",c=a&&a.h+"px"||"100%",d=this.itemHeight=a.itemHeight;this.excessHeightObj={},this.items=a.items,this.generatorFn=a.generatorFn,this.hoverFunction=a.hoverFunction,this.totalRows=a.totalRows||a.items&&a.items.length;var e=$WC.VirtualList.createScroller(d*this.totalRows);this.container=a.container?a.container:$WC.VirtualList.createContainer(b,c),this.container.appendChild(e);var f=Math.ceil(a.h/d);this.cachedItemsLen=f*4;if(this.container.scrollTop!=0){var g=parseInt(this.container.scrollTop/d)-f;g=g<0?Math.ceil(this.container.scrollTop/d):g,this.container.scrollTop=g*d,this._renderChunk(this.container,g)}else this._renderChunk(this.container,0);var h=this,i,j=f*d,k=0;this.onScroll=function(a){var b=a.target.scrollTop,c=h.container.querySelector("[data-id]");if(!i||c.getAttribute("data-select")&&c.getAttribute("data-rc")!=0||Math.abs(b-i)>j){var e=h.container.querySelector("[data-select]"),g=parseInt(b/d)-f;h._renderChunk(h.container,g<0?0:g),e=e?h.container.querySelector('[data-rc="'+e.getAttribute("data-rc")+'"]:not([data-rm])'):"",e&&h.hoverFunction(e),i=b}k=Date.now(),a.preventDefault&&a.preventDefault(),h.rmNodeInterval==null&&(h.rmNodeInterval=setInterval(l.bind(h),300)),$WC.Util.debounce(function(){clearInterval(h.rmNodeInterval),h.rmNodeInterval=null},h,1e3)},this.clearRmNodeInterval=$WC.Util.debounce(function(){clearInterval(this.rmNodeInterval),this.rmNodeInterval=null},this,1e3),this.remove_event_listeners=function(){this.container.removeEventListener("scroll",this.onScroll),this.container.removeEventListener("scroll",this.clearRmNodeInterval)},this.container.addEventListener("scroll",this.onScroll),this.container.addEventListener("scroll",this.clearRmNodeInterval)},$WC.VirtualList.prototype.createRow=function(a){var b;if(this.generatorFn)b=this.generatorFn(a);else if(this.items)if(typeof this.items[a]=="string"){var c=document.createTextNode(this.items[a]);b=document.createElement("div"),b.style.height=this.itemHeight+"px",b.appendChild(c)}else b=this.items[a];$WC.Util.isArray(b)&&(this.excessHeightObj[a]=b[1],b=b[0]);var d=0;for(var e in this.excessHeightObj)a>e&&(d+=this.excessHeightObj[e]);return b.style.position="absolute",b.style.top=a*this.itemHeight+d+"px",$WC.Util.setAttribute(b,"data-rc",a),b},$WC.VirtualList.prototype._renderChunk=function(a,b){var c=b+this.cachedItemsLen;c>this.totalRows&&(c=this.totalRows);var d=document.createDocumentFragment();for(var e=b;e<c;e++)d.appendChild(this.createRow(e));for(var f=1,g=a.childNodes.length;f<g;f++)a.childNodes[f].style.display="none",a.childNodes[f].setAttribute("data-rm","1");a.appendChild(d)},$WC.VirtualList.createContainer=function(a,b){var c=document.createElement("div");return c.style.width=a,c.style.height=b,c.style.overflow="auto",c.style.position="relative",c.style.padding=0,c.style.border="1px solid black",c},$WC.VirtualList.createScroller=function(a){var b=document.createElement("div");return b.style.opacity=0,b.style.position="absolute",b.style.top=0,b.style.left=0,b.style.width="1px",b.style.height=a+"px",b};var $WC=$WC||{},op=/opera|opera 5|opera\/5/i.test(navigator.userAgent),ie=!op&&/msie/i.test(navigator.userAgent);$WC.$CUtil={processXSS:function(a,b){return a?(b||(a=$WC.Util.decodeHTMLEntities(a)),a.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")):a},trim:function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},getNextRotationalNode:function(a,b){if(b===39||b===40)return a.nextSibling||a.parentNode.firstChild;if(b===37||b===38)return a.previousSibling||a.parentNode.lastChild},center:function(a){if(!a)return;var b=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a.offsetHeight,d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=a.offsetWidth,f=a.style,g=b<c?0:(b-c)/2,h=d<e?0:(d-e)/2;f.top=g+"px",f.left=h+"px"},removeAllClass:function(a,b){if(!a)return;var c=a.querySelectorAll("."+b),d=c.length;if(!d)return;for(var e=0;e<d;e++)$WC.Util.removeClass(c[e],b)},cloneArray:function(a){return a.slice(0)},setInnerTextById:function(a,b){return $WC.$CUtil.setInnerText(document.getElementById(a),b)},setInnerText:function(a,b){if(!a)return;var c=document.getElementsByTagName("body")[0];c.textContent?a.textContent=b:a.innerText=b},getConditionalNextNode:function(a,b,c){function d(b,c){if(a[c]){if(a[c].getAttribute(b))return a[c];var d=a[c];while(d){if(d.getAttribute(b))return d;d=d[c]}}var e=a.parentNode.querySelectorAll("["+b+"]");if(e&&e.length>1){if(c==="nextSibling")return e[0];if(c==="previousSibling")return e[e.length-1]}return a}if(b===39||b===40||b===9)return d(c,"nextSibling");if(b===37||b===38)return d(c,"previousSibling")},removeEvent:function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener?a.removeEventListener(b,c,!0):a["on"+b]=null},isScrolledIntoView:function(a,b,c){var d=b.getBoundingClientRect().top,e=b.getBoundingClientRect().bottom,f=a.getBoundingClientRect().top,g=a.getBoundingClientRect().bottom;return d===0&&e===0||f===0&&g===0?!1:c?g>=d&&f<=e:f>=d&&g<=e},preventHandlingTabUpDownEnter:function(a){(a.keyCode===$WC.WmsConstants.KEYCODES.DOWN||a.keyCode===$WC.WmsConstants.KEYCODES.UP||a.keyCode===$WC.WmsConstants.KEYCODES.ENTER||a.keyCode===$WC.WmsConstants.KEYCODES.TAB)&&a.preventDefault()},hasClass:function(a,b){return(new RegExp("(\\s|^)"+b+"(\\s|$)")).test(a.className)},hasFocus:function(a){if(a)return a===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(a.type||a.href||~a.tabIndex);return},getAttribute:function(a,b){if(!a||typeof a.getAttribute!="function")return;return a.getAttribute(b)},getDirectText:function(a){var b=a.firstChild,c=[];while(b)b.nodeType==3&&c.push(b.data),b=b.nextSibling;return c.join("")},getDirectTextFromHtmlString:function(a){var b=document.createElement("div");b.innerHTML=a;var c=b.firstChild,d=[];while(c)c.nodeType==3?d.push(c.data):d.push(c.textContent),c=c.nextSibling;return d.join("")},createOverlay:function(a){if(document.getElementById("wms-overlay")==null){var b=document.createElement("div");b.id="wms-overlay",b.className="wms-overlay",b.onclick=a,b.style.zIndex=$WC.Config.get("zindex");var c=document.getElementById("wmstoolbar");c?document.body.insertBefore(b,c.nextSibling):document.body.appendChild(b)}},removeOverlay:function(){var a=document.getElementById("wms-overlay");a&&a.parentNode.removeChild(a)},getAspectRatioFit:function(a,b,c,d,e){var f=[c/a,d/b];return f=Math.min(f[0],f[1]),!e&&f>1?{width:a,height:b}:{width:a*f,height:b*f,ratio:f}},getBrowserName:function(){var a=navigator.userAgent.toLowerCase();if($WC.Matcher.check("firefox_useragent_lowercase",a))return"firefox";if($WC.Matcher.check("opera_useragent_lowercase",a))return"opera";if($WC.Matcher.check("chrome_useragent_lowercase",a))return"chrome";if($WC.Matcher.check("safari_useragent_lowercase",a))return"safari";if($WC.Matcher.check("ie_useragent_lowercase",a))return"ie"},isChrome:function(){return this.getBrowserName()==="chrome"},isFirefox:function(){return this.getBrowserName()==="firefox"},isSafari:function(){return this.getBrowserName()==="safari"},isIEVersion11:function(){var a=navigator.userAgent.toLowerCase();if(a.indexOf("trident/")>0){var b=a.indexOf("rv:"),c=a.substring(b+3,a.indexOf(".",b));return c=="11"}},checkAndUpdateLocationPermissionStatus:function(){typeof navigator!="undefined"&&navigator.permissions!==undefined&&navigator.permissions.query({name:"geolocation"}).then(function(a){$WC.Config.get("LOCATION_INFO").PERMISSIONSTATE=a.state,a.onchange=function(){$WC.Config.get("LOCATION_INFO").PERMISSIONSTATE=a.state}})},chatTypes:{CHANNEL:1,DEFAULT_BOT:"B1",CUSTOM_BOT:"B2"}};var $WC=$WC||{};$WC.Functions={},$WC.Functions.init=function(){Gator(document).on("click","[custombuttonclick_onmsg],[zc-quickbutton]",function(a){$WC.CMsgUtil.handleButtons(this,a,function(b,c,d,e){if(a.target.getAttribute("data-cmsgbtn")){var f=a.target,g=$WC.Util.createElement("span","wms_cmsg_loader","wms_cmsg_loader");f.className+=" wms_cmsg_loadingon",f.parentElement.style.pointerEvents="none",f.appendChild(g);var h=function(){$WC.Util.removeElement(g),f.className="cmsg-btn",f.parentElement.style.pointerEvents=""}}var i=$WC.Functions.isTempResponse(a.target,c,d);$WC.Functions.execute(b,c,d,e,i,a.type,h)})})},$WC.Functions.execute=function(a,b,c,d,e,f,g){var h="chid="+b+"&msgid="+c+"&fname="+a+"&btnindex="+d+"&isTempResponse="+e+"&event="+f,i=document.getElementById("buttonconfirminput");i&&(h+="&input="+i.value);var j={"x-consents-version":"1","X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()},k=function(){var c=JSON.parse(this.response)[0].objString;if(c.status==="Consent"){var d=new $WC.Consents;d.mountComponent(b,c)}else if(c.status==="Success"){var e=c.output;if(e)if(e.widget){var f=JSON.parse(e.widget);$WC.Widgets.construct(f)}else if((e.text||e.msg)&&typeof $WC.Functions.showResponse=="function")$WC.Functions.showResponse(c.output,b);else if(e.actions){$WC.Channels.initChannels();var h=new $WC.Forms;h.mountComponent(c,Commands.showResponse,function(){var a=WindowHandler.getWinObjById(b);a&&a.composer.focus()})}}else if(c.status==="Failure"&&typeof $WC.Functions.showErrorResponse=="function")if(!$WC.Util.isEmpty(c.resumeUrl)){if(document.getElementById("zcwindows")===null){var i=document.createElement("div");i.id="zcwindows",i.className="zcoverlay",i.style.zIndex=WebMessanger.setzindex,document.body.appendChild(i)}var j="<b>"+c.connectionDetails.serviceName+"</b>",k="<b>"+a+"</b>";$WC.$Dlg.confirm({id:"wms_oauthprompt",bodyhtml:$WC.I18N("common.access.permission",[k,j]),imagehtml:"<img src="+c.connectionDetails.imageUrl+">",buttons:[{text:$WC.I18N("common.authenticate"),action:function(){window.open(c.resumeUrl)}}]})}else $WC.Functions.showErrorResponse(c,b);g&&g()};$WC.Ajax.postRequestToChat("executefunction.do",h,k,null,null,null,j)};var WmsImplHandler={};WmsImplHandler.invoke=function(){var a=arguments;setTimeout(function(){var b=Array.prototype.slice.call(a,1);typeof a[0]=="function"&&a[0].apply(null,b)},1)},WmsImplHandler.invokeSynchronously=function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);if(typeof a=="function")try{return a.apply(null,b)}catch(c){setTimeout(function(){throw c},1)}};var WmsAVChat={};WmsAVChat={CALLSTATUSCODE:{STARTED:0,CALLING:1,WAITING:2,CONNECTING:3,CONNECTED:4,ENDED:5},DISCONNECT_MSG:{ERROR:"0",CANCELLED:"4",COMPLETED:"3",REJECTED:"5",NORESPONSE:"6",BUSY_ON_OTHER_CALL:"15"},CALL_TYPE_VOICE:"voice",CALL_TYPE_VIDEO:"video",CALL_TYPE_SCREENSHARE:"screen",CALL_MODE_INCOMING:"incoming",CALL_MODE_OUTGOING:"outgoing",CALLCONNECTION_TIMEOUT:2e4,PERMISSION_DIALOGUE_DELAY:1200,isRunning:!1,isFullScreen:!1,isConnectNotifyReceived:!1,isMinimized:!1,isVideoSwitched:!1,isScreenShared:!1,chromeExtensionAvailable:!1,callType:null,logData:[],api:{},localStream:null,remoteStream:null,lastCallAPI:null,zuid:"",chid:"",devicePreference:{},dom:{localVideo:null,remoteVideo:null,localuserimg:null,remoteuserimg:null,videocontainer:null},checkChromeExtensionAvailability:function(){window.postMessage({requestId:"zoho_cliq_extn_check",message:"ZOHOCLIQ-EXTN-CHECK"},"*")},init:function(){if(!$WC.$CUtil.isFirefox()){var a=$WC.WmsLocalStorage.getItem("mediadevicepref");$WC.Util.isEmpty(a)||(this.devicePreference=a)}this.AnswerCall.init(),this.bindEvents(),$WC.$CUtil.isChrome()&&this.checkChromeExtensionAvailability()},bindEvents:function(){var a="onfullscreenchange"in document?"fullscreenchange":"onwebkitfullscreenchange"in document?"webkitfullscreenchange":"mozfullscreenchange";document.addEventListener(a,function(){WmsAVChat.isRunning&&WmsAVChat.toggleFullscreen(!0)}),window.addEventListener("message",function(a){var b=a.data;b.source==="ZOHOCLIQ-EXTENSION"&&(WmsAVChat.chromeExtensionAvailable=!0)})},close:function(a){this.isRunning=!1;try{a||this.api.stopChat(),this.AnswerCall.isVisible||VideoCallReceiver.stop()}catch(b){this.log(b.message)}this.sid=null,this.lastCallAPI=this.api,this.api=null,this.remoteStream=null,this.localStream=null,this.isReconnecting=!1,this.isVideoSwitched=!1,this.isScreenShared=!1,this.isRemoteCamOff=!1,this.isConnectNotifyReceived=!1,this.setCallStatus(this.CALLSTATUSCODE.ENDED),this.handleChatwindowOpen=null,this.isFullScreen&&this.handleAction("togglefullscreen"),$WC.Util.setAttribute(this.dom.videocontainer.querySelector("[media-action='togglemic']"),"data-micoff","false"),$WC.Util.setAttribute(this.dom.videocontainer.querySelector("[media-action='togglemic']"),"title",$WC.I18N("mediacall.mic.off")),$WC.Util.setAttribute(this.dom.videocontainer.querySelector("[media-action='togglecam']"),"data-videooff","false"),$WC.Util.setAttribute(this.dom.videocontainer.querySelector("[media-action='togglecam']"),"title",$WC.I18N("mediacall.cam.off")),this.isMinimized&&this.toggleMinimize(),$WC.Util.setAttribute(this.dom.localVideo,"src",""),$WC.Util.setAttribute(this.dom.remoteVideo,"src",""),$WC.Util.setAttribute(this.dom.sharedScreen,"src",""),this.dom.remoteVideo.style.display="none",this.dom.localVideo.style.display="none",$WC.Util.setAttribute(this.dom.localuserimg.firstChild,"src",""),$WC.Util.setAttribute(this.dom.remoteuserimg.firstChild,"src",""),this.dom.videocontainer.getElementsByClassName("wms_remotevideo_container")[0].className="wms_remotevideo_container",$WC.$CUtil.setInnerText(this.dom.timercontainer,""),this.dom.videocontainer.getElementsByClassName("wms_mediaoff_notify")[0].className="wms_mediaoff_notify",this.dom.videocontainer.getElementsByClassName("wms_videocall_buttons_list")[0].className="wms_videocall_buttons_list",this.dom.videocontainer.getElementsByClassName("wms_options_container")[0].style.display="none";var c=WindowHandler.getWinObjById(this.chid);c&&(c.iscallongoing=!1,c.win.className="wms_cw_cont wms_chatwindow wms_bubbletheme",this.dom.videocontainer.style.display="none")},establishConnectedCall:function(){WmsAVChat.callType==WmsAVChat.CALL_TYPE_VIDEO&&(WmsAVChat.dom.remoteuserimg.style.display="none",WmsAVChat.dom.remoteVideo.style.display="block",$WC.Util.addClass(WmsAVChat.dom.videocontainer.getElementsByClassName("wms_videocall_buttons_list")[0],"wms-halign")),WmsAVChat.forcePlay(),$WC.$CUtil.setInnerText(WmsAVChat.dom.videocontainer.getElementsByClassName("wms_callstatus_text")[0],""),$WC.Util.setAttribute(WmsAVChat.dom.videocontainer,"data-connecting","")},forcePlay:function(){this.dom.localVideo.src!=""&&this.dom.localVideo.play(),this.dom.remoteVideo.src!=""&&this.dom.remoteVideo.play()},resetScreenShareOpt:function(){var a=WmsAVChat.dom.videocontainer.getElementsByClassName("wms_sharescreen_option")[0];$WC.Util.setAttribute(a,"media-action","startscreenshare"),$WC.$CUtil.setInnerText(a,$WC.I18N("mediacall.screenshare.start"))},showCallFailedBanner:function(){var a=WindowHandler.getWinObjById(this.chid);a&&a.showErrorMsg($WC.I18N("mediacall.failed")),this.log("call_failed")},switchVideo:function(){var a=[];a.push([this.dom.localVideo,this.dom.remoteVideo]),a.push([this.dom.localuserimg,this.dom.remoteuserimg]);for(var b in a){var c=a[b][0],d=a[b][1],e=c.id,f=c.className;c.id=d.id,c.className=d.className,d.id=e,d.className=f;var g=c.parentNode;d.parentNode.prepend(c),g.prepend(d)}this.forcePlay(),this.isVideoSwitched=!this.isVideoSwitched},toggleFullscreen:function(a){var b=this.dom.videocontainer,c=b.querySelector("[media-action='togglefullscreen']");if(a){this.isFullScreen?($WC.Util.removeClass(b,"wms_mediacall_fullscreen"),this.isFullScreen=!1,$WC.Util.setAttribute(c,"title",$WC.I18N("mediacall.fullscreen"))):($WC.Util.addClass(b,"wms_mediacall_fullscreen"),this.isFullScreen=!0,$WC.Util.setAttribute(c,"title",$WC.I18N("mediacall.exit.fullscreen")));return}this.isFullScreen?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen()},toggleMinimize:function(){var a=WindowHandler.getWinObjById(this.chid),b=a.win.getElementsByClassName("wms_cw_header_photo")[0];if(this.isMinimized)b.style.display="",$WC.Util.removeElement(a.win.getElementsByClassName("wms_cw_header_video")[0]),$WC.Util.removeClass(a.win,"wms_videocall_minimized"),this.dom.videocontainer.style.display="block",this.isMinimized=!1,this.log("Maximized");else{var c=this.dom.remoteVideo.src;this.isRemoteCamOff&&(c=this.dom.localVideo.src);var d='<video src="'+c+'" class="wms_cw_header_video" onclick="WmsAVChat.toggleMinimize()" title="'+$WC.I18N("maximize")+'"></video>';b.insertAdjacentHTML("beforeBegin",d),b.style.display="none";var e=a.win.getElementsByClassName("wms_cw_header_video")[0];e.play(),this.dom.videocontainer.style.display="none",$WC.Util.addClass(a.win,"wms_videocall_minimized"),this.isMinimized=!0,this.log("Minimized")}},notifyChatwinOpen:function(a){typeof this.handleChatwindowOpen=="function"&&this.handleChatwindowOpen(a)},handleAction:function(a){if(a=="togglefullscreen")this.toggleFullscreen();else if(a=="endcall")this.close();else if(a=="options")this.showMoreOptions();else if(a=="startvideo")this.handleAction("togglecam"),this.showMoreOptions();else if(a=="startscreenshare")WmsAVChat.api.addScreenShare(function(){var a=WindowHandler.getWinObjById(WmsAVChat.chid);a.win.className="wms_cw_cont wms_chatwindow wms_bubbletheme wms_mediacall_screenshare",WmsAVChat.isScreenShared=!0}),this.showMoreOptions();else if(a=="stopscreenshare")WmsAVChat.api.removeScreenShare(),this.showMoreOptions();else if(a=="togglemic"){var b=this.dom.videocontainer.querySelector("[media-action='togglemic']");this.api.isMicOff()?(this.api.micOn(),$WC.Util.setAttribute(b,"title",$WC.I18N("mediacall.mic.off")),$WC.Util.setAttribute(b,"data-micoff","false")):(this.api.micOff(),$WC.Util.setAttribute(b,"title",$WC.I18N("mediacall.mic.on")),$WC.Util.setAttribute(b,"data-micoff","true"))}else if(a=="togglecam"){var c=this.dom.videocontainer.querySelector("[media-action='togglecam']");this.api.isCameraOff()?this.api.cameraOn()&&(this.dom.localVideo.style.display="block",this.dom.localuserimg.style.display="none",$WC.Util.setAttribute(c,"data-videooff","false"),$WC.Util.setAttribute(c,"title",$WC.I18N("mediacall.cam.off"))):this.api.cameraOff()&&(this.dom.localVideo.style.display="none",this.dom.localuserimg.style.display="block",$WC.Util.setAttribute(c,"data-videooff","true"),$WC.Util.setAttribute(c,"title",$WC.I18N("mediacall.cam.on")))}else a=="switchvideo"?(this.switchVideo(),this.isVideoSwitched?$WC.Util.addClass(this.dom.videocontainer.getElementsByClassName("wms_mediacall_container")[0],"wms_video_switched"):$WC.Util.removeClass(this.dom.videocontainer.getElementsByClassName("wms_mediacall_container")[0],"wms_video_switched")):a=="minimize"?this.toggleMinimize():a=="devicesettings"&&(this.showDevicePreference(),this.showMoreOptions())},setWMSConnectionStatus:function(a){this.isRunning&&this.api&&this.api.setWmsServerUpStatus(a)},log:function(a){this.logData.push((new Date).getTime()+" : "+a),this.logData.length>100&&this.logData.shift()},isScreenShareSupportedBrowser:function(){return $Util.Browser.isChrome()||$Util.Browser.isFirefox()},showMediaPermissionWin:function(){var a=$WC.$CUtil.isChrome()?"chrome":$WC.$CUtil.isFirefox()?"firefox":$WC.$CUtil.isSafari()?"safari":"opera",b=WmsAVChat.callType==WmsAVChat.CALL_TYPE_VIDEO?"cam":"mic",c="permission-"+a+"-"+b+"-2",d=WmsAVChat.callType==WmsAVChat.CALL_TYPE_VIDEO?"videocall":"audiocall",e=$WC.I18N(d+".permission.device"),f=$WC.I18N(d+".permission.guideline"),g=$WC.I18N(d+".permission.info"),h="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/"+c+".png",i='<div class="wms_mediacall_permission_headertext">{{header_text}}</div><img src="{{image_source}}" class="wms_mediacall_permission_img"><div class="wms_mediacall_permission_text">{{permission_guideline}}</br>{{permission_infomsg}}</div>',j=$WC.template.replace(i,{header_text:e,permission_guideline:f,permission_infomsg:g,image_source:h}),k={bodyhtml:j,focusbutton:1,width:690,operations:[{name:$WC.I18N("mediacall.permission.okay")}]};WmsDialog.showModal(k)},startCall:function(a,b,c,d,e){d?WmsAVChat.startMediaChat(d,b,c):(WmsAVChat.zuid=a,WmsAVChat.handleChatwindowOpen=function(a){(WmsAVChat.AnswerCall.chid&&a.objId==WmsAVChat.AnswerCall.chid||!WmsAVChat.AnswerCall.chid&&a.recipant==WmsAVChat.zuid)&&WmsAVChat.startMediaChat(a,b,c)},clearTimeout(WmsAVChat.acceptCallTimer),WmsAVChat.acceptCallTimer=setTimeout(function(){WmsAVChat.handleChatwindowOpen=null},WmsAVChat.CALLCONNECTION_TIMEOUT),e=e||"mainui",WebMessanger.openUserChat(a,"","","",e))},startMediaChat:function(a,b,c){if(!this.isRunning){this.isRunning=!0,this.zuid=a.recipant,this.chid=a.objId,this.callType=b,this.dom.localVideo=a.win.getElementsByClassName("wms_localstream")[0],this.dom.remoteVideo=a.win.getElementsByClassName("wms_remotestream")[0],this.dom.sharedScreen=a.win.getElementsByClassName("wms_sharedscreen")[0],this.dom.localuserimg=a.win.getElementsByClassName("wms_localuserimg")[0],this.dom.remoteuserimg=a.win.getElementsByClassName("wms_remoteuserimg")[0],this.dom.videocontainer=a.win.getElementsByClassName("wms_mediacall_space")[0],this.dom.timercontainer=a.win.getElementsByClassName("wms_mediacall_timer")[0],this.setCallStatus(this.CALLSTATUSCODE.STARTED),$WC.Util.setAttribute(this.dom.localuserimg.firstChild,"src",WmsContacts.getUserPhoto($WC.Config.get("zuid"))),this.dom.localuserimg.style.display="block",$WC.Util.setAttribute(this.dom.remoteuserimg.firstChild,"src",WmsContacts.getUserPhoto(this.zuid)),this.dom.remoteuserimg.style.display="block";var d={zuid:this.zuid,chid:this.chid};a.iscallongoing=!0,a.isMinimized()&&a.maximize(),$WC.Util.setAttribute(this.dom.videocontainer,"data-connecting","true"),c==WmsAVChat.CALL_MODE_OUTGOING?(d.callingZUID=WebMessanger.getZuid(),d.calledZUID=this.zuid,$WC.$CUtil.isChrome()&&(d.extAvailable=this.chromeExtensionAvailable),a.win.getElementsByClassName("wms_mediacall_space")[0].style.display="block",$WC.$CUtil.setInnerText(this.dom.videocontainer.getElementsByClassName("wms_callstatus_text")[0],$WC.I18N("mediacall.calling")),VideoCallReceiver.startChat(this.zuid,b,d,this.VideoChatHandler)):(this.setCallStatus(this.CALLSTATUSCODE.CONNECTING),$WC.$CUtil.setInnerText(this.dom.videocontainer.getElementsByClassName("wms_callstatus_text")[0],$WC.I18N("mediacall.connecting")),a.win.getElementsByClassName("wms_mediacall_space")[0].style.display="block",VideoCallReceiver.answerChat(this.zuid,this.sid,b,this.VideoChatHandler),VideoCallReceiver.stop()),b=="video"?$WC.Util.addClass(a.win,"wms_mediacall_video"):b=="voice"?($WC.Util.addClass(this.dom.videocontainer.getElementsByClassName("wms_remotevideo_container")[0],"wms-valign-mid-block"),$WC.Util.addClass(a.win,"wms_mediacall_audio")):b=="screen"&&(c==WmsAVChat.CALL_MODE_OUTGOING?($WC.Util.addClass(this.dom.videocontainer.getElementsByClassName("wms_remotevideo_container")[0],"wms-valign-mid-block"),$WC.Util.addClass(a.win,"wms_mediacall_audio")):$WC.Util.addClass(a.win,"wms_mediacall_screenshare"))}},setCallStatus:function(a){this.callStatus=a},setPreferredDevice:function(a){var b=[],c=function(){if(a.speaker&&a.speaker.deviceId){var c=WmsAVChat.dom.remoteVideo;typeof c.setSinkId=="function"&&(c.setSinkId(a.speaker.deviceId),WmsAVChat.api?WmsAVChat.api.setSpeakerDevice(a.speaker):WmsAVChat.lastCallAPI&&WmsAVChat.lastCallAPI.setSpeakerDevice(a.speaker))}if(WmsAVChat.isRunning&&b.length){var d=WindowHandler.getWinObjById(WmsAVChat.chid),e=WmsAVChat.callType;WmsAVChat.close(),WmsAVChat.startMediaChat(d,e,WmsAVChat.CALL_MODE_OUTGOING)}WmsAVChat.devicePreference=a,$WC.WmsLocalStorage.setItem("mediadevicepref",a)};if(this.isRunning)if(!this.devicePreference.hasOwnProperty("mic")||this.devicePreference.mic.deviceId!=a.mic.deviceId){var d='<div class="wms_devicepref_confirm_body"><div class="wms_devicepref_confirm_subheading">'+$WC.I18N("mediacall.devicesetting.info")+"</div>"+'<div class="wms_devicepref_confirm_info">'+$WC.I18N("mediacall.devicesetting.info1")+"</div>"+'<div class="wms_devicepref_confirm_info">'+$WC.I18N("mediacall.devicesetting.info2")+"</div>"+"</div>",e='<div class="wms_devicepref_confirm_header">'+$WC.I18N("mediacall.device.settings")+"</div>"+d,f={bodyhtml:e,focusbutton:1,width:650,operations:[{name:$WC.I18N("mediacall.close.proceed"),classname:"wms_devicepref_button",action:function(){b.push(a.mic),c()}}]};WmsDialog.showModal(f)}else c();else b.push(a.mic),c()},showMoreOptions:function(){var a=WmsAVChat.dom.videocontainer.getElementsByClassName("wms_options_container")[0];if(a.style.display=="block")a.style.display="none";else{var b=WmsAVChat.isScreenShared?"mediacall.screenshare.stop":"mediacall.screenshare.start",c=WmsAVChat.isScreenShared?"startscreenshare":"stopscreenshare",d='<span class="wms_mediacall_option wms_devicesettings_option" media-action="devicesettings">'+$WC.I18N("mediacall.preference.header")+"</span>"+'<span class="wms_mediacall_option wms_sharescreen_option" sharescreen="'+!WmsAVChat.isScreenShared+'" media-action="'+c+'" style="display: none;">'+$WC.I18N(b)+"</span>"+'<span class="wms_mediacall_option wms_startvideo_option" media-action="startvideo" style="display: none;">'+$WC.I18N("mediacall.start.video")+"</span>";a.innerHTML=d,a.style.display="block"}},showDevicePreference:function(){var a={camera:[],mic:[],speaker:[]},b={};navigator.mediaDevices.enumerateDevices().then(function(c){c.forEach(function(c){b[c.kind+"&"+c.deviceId]=c,c.kind=="videoinput"?a.camera.push(c):c.kind=="audioinput"?a.mic.push(c):c.kind=="audiooutput"&&a.speaker.push(c)});var d='<div class="wms_devicepref_header">'+$WC.I18N("mediacall.preference.header")+"</div>",e='<div class="wms_devicepref_leftpane"><div class="wms_devicepref_options wms_devicepref_options_input" data-settings="mic">'+$WC.I18N("mediacall.preference.input")+"</div>"+'<div class="wms_devicepref_options wms_devicepref_options_output" data-settings="speaker">'+$WC.I18N("mediacall.preference.output")+"</div>"+"</div>",f='<div class="wms_devicepref_rightpane"><div id="wms_devicepref_mic" class="wms_devicepref_rightpane_options"><div>'+$WC.I18N("mediacall.preference.mic")+'</div><select id="wms_devicelist_mic" class="wms_devicepref_dropdown" style="font-size: 12px;"></select></div>'+'<div id="wms_devicepref_speaker" class="wms_devicepref_rightpane_options"><div>'+$WC.I18N("mediacall.preference.speaker")+'</div><select id="wms_devicelist_speaker" class="wms_devicepref_dropdown" style="font-size: 12px;"></select></div>'+"</div>",g='<div id="wms_devicepref_body" class="wms_devicepref_body" data-shown="mic">'+e+f+"</div>",h=d+g,i={bodyhtml:h,focusbutton:1,width:600,operations:[{name:$WC.I18N("mediacall.permission.save"),classname:"wms_devicepref_button",action:function(){var a=document.getElementById("wms_devicelist_mic").value,c=document.getElementById("wms_devicelist_speaker").value;WmsAVChat.setPreferredDevice({mic:b["audioinput&"+a],speaker:b["audiooutput&"+c]})}}]};WmsDialog.showModal(i);var j=document.getElementById("wms_devicepref_body"),k='<option value="{{DID}}" {{SEL}}>{{NAME}}</option>',l=function(a,b){var c="";for(var d=0;d<a.length;d++)c+=$WC.template.replace(k,{NAME:a[d].label,DID:a[d].deviceId,SEL:a[d].deviceId==b?'selected="selected"':""});return c};if(a.mic.length){var m="default";WmsAVChat.devicePreference.mic&&(m=WmsAVChat.devicePreference.mic.deviceId),document.getElementById("wms_devicelist_mic").innerHTML=l(a.mic,m)}a.speaker.length&&(m="default",WmsAVChat.devicePreference.speaker&&(m=WmsAVChat.devicePreference.speaker.deviceId),document.getElementById("wms_devicelist_speaker").innerHTML=l(a.speaker,m)),Gator(j).on("click","[data-settings]",function(){var a=this.getAttribute("data-settings");$WC.Util.setAttribute(j,"data-shown",a)})})},stopScreenShare:function(){WmsAVChat.log("handleStopSharing"),WmsAVChat.isScreenShared=!1,WmsAVChat.dom.sharedScreen.src="";var a=WindowHandler.getWinObjById(WmsAVChat.chid);WmsAVChat.callType==WmsAVChat.CALL_TYPE_SCREENSHARE&&a&&$WC.Util.removeClass(a.win,"wms_mediacall_screenshare"),WmsAVChat.resetScreenShareOpt()}},WmsAVChat.AnswerCall={CLOSE_TIMEOUT:3e4,dom:{},zuid:null,sid:null,chid:null,closeTimer:null,isVisible:!1,init:function(){this.dom.main=document.getElementById("wms_incomingcall"),this.dom.acceptButton=document.getElementById("wms_answercall_button"),this.dom.rejectButton=document.getElementById("wms_rejectcall_button"),this.bindEvents()},show:function(a,b,c,d){if(this.isVisible||WmsAVChat.isRunning&&WmsAVChat.zuid==a&&WmsAVChat.callStatus==WmsAVChat.CALLSTATUSCODE.CONNECTED&&!WmsAVChat.isReconnecting){VideoCallReceiver.ignoreChat(a,b,VideoConstants.BUSY_ON_ANOTHER_CALL),VideoCallReceiver.stop();return}if(!WmsSettings.getAdminSetting("isMediacallAllowed")){VideoCallReceiver.stop();return}this.isReplying&&this.hide(!0);var e=WmsContacts.getDisplayName(a),f=WmsContacts.getUserPhoto(a,"200"),g=$WC.I18N(c==WmsAVChat.CALL_TYPE_VIDEO?"mediacall.incoming.video":"mediacall.incoming.audio");this.isVisible=!0,this.sid=b,this.zuid=a,this.chid=d.chid||WebMessanger.ucmap[a],this.type=c,c==WmsAVChat.CALL_TYPE_VIDEO?($WC.Util.addClass(this.dom.acceptButton,"wms_video_accept"),$WC.Util.addClass(this.dom.rejectButton,"wms_video_reject")):($WC.Util.removeClass(this.dom.acceptButton,"wms_video_accept"),$WC.Util.removeClass(this.dom.rejectButton,"wms_video_reject")),$WC.$CUtil.setInnerText(document.getElementById("wms_callername"),e),document.getElementById("wms_callerimg").src=f,$WC.$CUtil.setInnerText(document.getElementById("wms_calltype"),g),document.getElementById("wms_caller_container").style.display="block",$WC.Util.setAttribute(document.getElementById("wms_caller_container"),"data-type","3"),$WC.Util.setAttribute(document.getElementById("wms_caller_container"),"data-id",a),WmsNotification.notifyNewCall(e,c,a),this.closeTimer=setTimeout(function(){WmsAVChat.AnswerCall.hide(),VideoCallReceiver.stop()},this.CLOSE_TIMEOUT)},bindEvents:function(){var a=this;Gator(this.dom.main).on("click","[call-action]",function(){var b=this.getAttribute("call-action");b=="acceptcall"?a.checkAndAcceptCall():b=="rejectcall"&&a.rejectCall(),$WC.DesktopNotification.close("call")})},checkAndAcceptCall:function(){if(WmsAVChat.isRunning){var a={bodyhtml:$WC.I18N("mediacall.confirm.disconnect",[WmsContacts.getDisplayName(WmsAVChat.zuid),WmsContacts.getDisplayName(WmsAVChat.AnswerCall.zuid)]),focusbutton:2,operations:[{name:$WC.I18N("mediacall.close.proceed"),action:function(){WmsAVChat.close(),WmsAVChat.AnswerCall.acceptCall()}},{name:$WC.I18N("Cancel"),classname:"wms-dialog-rejectbtn",action:function(){WmsAVChat.AnswerCall.rejectCall()}}]};WmsDialog.showModal(a)}else WmsAVChat.AnswerCall.acceptCall()},close:function(a){this.isVisible&&this.sid==a&&this.hide(),VideoCallReceiver.stop()},hide:function(){this.isVisible=!1,clearTimeout(this.closeTimer),ChatBlink.stopRepeat(),this.closeTimer=null,$WC.Util.setAttribute(document.getElementById("wms_callerimg"),"src",""),$WC.$CUtil.setInnerText(document.getElementById("wms_callername"),""),document.getElementById("wms_caller_container").style.display="none",$WC.Util.setAttribute(document.getElementById("wms_caller_container"),"data-type",""),$WC.Util.setAttribute(document.getElementById("wms_caller_container"),"data-id","")},acceptCall:function(){var a=WmsAVChat.AnswerCall.zuid,b=WmsAVChat.AnswerCall.chid||WebMessanger.ucmap[a],c=WmsAVChat.AnswerCall.type,d=null;WmsAVChat.sid=WmsAVChat.AnswerCall.sid,b&&(d=WindowHandler.getWinObjById(b)),WmsAVChat.startCall(a,c,WmsAVChat.CALL_MODE_INCOMING,d),WmsAVChat.AnswerCall.hide(!0),WmsAVChat.log("acceptedcall")},rejectCall:function(){this.hide(!0),VideoCallReceiver.ignoreChat(this.zuid,this.sid,WmsAVChat.DISCONNECT_MSG.REJECTED),VideoCallReceiver.stop(),WmsAVChat.log("rejectedcall")}},WmsAVChat.VideoChatHandler={setVideoChatAPI:function(a){WmsAVChat.api=a;var b=WmsContacts.getDisplayName(WmsAVChat.zuid)||WindowHandler.getWinObjById(WmsAVChat.chid)&&WindowHandler.getWinObjById(WmsAVChat.chid).getTitle();a.setChatUserName(b),WmsAVChat.setWMSConnectionStatus(!WebMessanger.systemdown);var c=[];WmsAVChat.devicePreference.mic&&c.push(WmsAVChat.devicePreference.mic),c&&a.setDevices(c),WmsAVChat.devicePreference.speaker&&a.setSpeakerDevice(WmsAVChat.devicePreference.speaker)},getVideoChatAPI:function(){return WmsAVChat.api},handleMediaPermission:function(a){WmsAVChat.log("handleMediaPermission "+a);if(a=="pending")clearTimeout(WmsAVChat.permissionDialogueTimer),WmsAVChat.permissionDialogueTimer=setTimeout(function(){WmsAVChat.showMediaPermissionWin(),WmsAVChat.setCallStatus(WmsAVChat.CALLSTATUSCODE.WAITING)},WmsAVChat.PERMISSION_DIALOGUE_DELAY);else if(a=="granted")clearTimeout(WmsAVChat.permissionDialogueTimer),WmsDialog.removeModal(),WmsAVChat.callStatus<WmsAVChat.CALLSTATUSCODE.CONNECTING&&(WmsAVChat.callMode==WmsAVChat.CALL_MODE_INCOMMING?WmsAVChat.setCallStatus(WmsAVChat.CALLSTATUSCODE.CONNECTING):WmsAVChat.setCallStatus(WmsAVChat.CALLSTATUSCODE.CALLING));else if(a=="denied"||a=="blocked"){clearTimeout(WmsAVChat.permissionDialogueTimer),WmsDialog.removeModal();var b="";WmsAVChat.callType==WmsAVChat.CALL_TYPE_VIDEO?b=$WC.I18N("videocall.permission.device"):b=$WC.I18N("audiocall.permission.device"),WmsAVChat.close();var c={bodyhtml:b,focusbutton:1,operations:[{name:$WC.I18N("mediacall.permission.okay")}]};WmsDialog.showModal(c)}},handleChatReceived:function(){},handleChatAnswered:function(){},handleLocalStream:function(a){WmsAVChat.localStream=a,WmsAVChat.log("handleLocalStream "+d);if(!WmsAVChat.isRunning){WmsAVChat.lastCallAPI&&WmsAVChat.lastCallAPI.stopChat(),WmsAVChat.close();return}var b=WmsAVChat.dom.localVideo,c=window.URL||window.webkitURL;if(typeof b.srcObject=="object")b.srcObject=a;else{var d=c.createObjectURL(a);$WC.Util.setAttribute(b,"src",d)}b.muted=!0,b.style.display="block",b.play(),WmsAVChat.dom.localuserimg.style.display="none"},handleLocalSrc:function(){},handleRemoteStream:function(a){WmsAVChat.remoteStream=a,WmsAVChat.log("handleRemoteStream "+d);var b=WmsAVChat.dom.remoteVideo;b.muted=!0,$WC.Util.addEvent(b,"loadedmetadata",function(){this.muted=!1,WmsAVChat.isConnectNotifyReceived&&WmsAVChat.establishConnectedCall()});var c=window.URL||window.webkitURL;if(typeof b.srcObject=="object")b.srcObject=a;else{var d=c.createObjectURL(a);$WC.Util.setAttribute(WmsAVChat.dom.remoteVideo,"src",d)}$WC.Util.setAttribute(WmsAVChat.dom.remoteVideo,"src",d)},handleRemoteSrc:function(){},handleRemoteMediaStatus:function(a,b){WmsAVChat.log("handleRemoteMediaStatus "+a+b);var c=WmsAVChat.dom.videocontainer.getElementsByClassName("wms_mediaoff_notify")[0];a=="camera"&&(b=="1"?(WmsAVChat.isRemoteCamOff=!1,$WC.Util.removeClass(c,"wms_mediacall_videooff"),WmsAVChat.dom.remoteVideo.style.display="block",WmsAVChat.dom.remoteuserimg.style.display="none"):b=="0"&&(WmsAVChat.isRemoteCamOff=!0,$WC.Util.addClass(c,"wms_mediacall_videooff"),WmsAVChat.dom.remoteVideo.style.display="none",WmsAVChat.dom.remoteuserimg.style.display="block")),a=="mic"&&(b=="1"?$WC.Util.removeClass(c,"wms_mediacall_audiooff"):b=="0"&&$WC.Util.addClass(c,"wms_mediacall_audiooff"))},handleSwitchingDevices:function(){},handleConnectNotify:function(){WmsAVChat.callType==WmsAVChat.CALL_TYPE_SCREENSHARE&&(WmsAVChat.isScreenShared=!0,WmsAVChat.callMode==WmsAVChat.CALL_MODE_OUTGOING&&(WmsAVChat.dom.videocontainer.getElementsByClassName("wms_mediacall_timer")[0].style.display="none",$WC.$CUtil.setInnerText(WmsAVChat.dom.videocontainer.getElementsByClassName("wms_callstatus_text")[0],$WC.I18N("mediacall.screenshare.viewing")))),WmsAVChat.setCallStatus(WmsAVChat.CALLSTATUSCODE.CONNECTED),WmsAVChat.isConnectNotifyReceived=!0,WmsAVChat.establishConnectedCall()},handleChatRunningTime:function(a){$WC.$CUtil.setInnerText(WmsAVChat.dom.timercontainer,a)},handleVideoChatStatus:function(){},handleSessionId:function(a){WmsAVChat.log("handleSessionId "+a),WmsAVChat.sid=a},handleCloseRequest:function(a){if(WmsAVChat.api&&WmsAVChat.api.getSessionId()!==WmsAVChat.sid){WmsAVChat.log("old session id");return}if(WmsAVChat.callStatus==WmsAVChat.CALLSTATUSCODE.CONNECTED&&a==WmsAVChat.DISCONNECT_MSG.NORESPONSE){WmsAVChat.log("Invalid close request");return}WmsAVChat.log("handleCloseRequest "+a);var b=WindowHandler.getWinObjById(WmsAVChat.chid);WmsAVChat.isRunning&&(WmsAVChat.close(!0),b&&(a==WmsAVChat.DISCONNECT_MSG.COMPLETED?b.showErrorMsg($WC.I18N("mediacall.ended")):a==WmsAVChat.DISCONNECT_MSG.ERROR?WmsAVChat.showCallFailedBanner():a==WmsAVChat.DISCONNECT_MSG.NORESPONSE?b.showErrorMsg($WC.I18N("mediacall.noresponse")):(a==WmsAVChat.DISCONNECT_MSG.REJECTED||a==WmsAVChat.DISCONNECT_MSG.BUSY_ON_OTHER_CALL)&&b.showErrorMsg($WC.I18N("mediacall.userbusy"))))},handleReconnect:function(a){WmsAVChat.log("handleReconnect"+a);if(!WmsAVChat.isRunning)return;if(WmsAVChat.api&&WmsAVChat.api.getSessionId()!==WmsAVChat.sid){WmsAVChat.log("old session id");return}if(WmsAVChat.callStatus!=WmsAVChat.CALLSTATUSCODE.CONNECTED){WmsAVChat.close(),WmsAVChat.showCallFailedBanner();return}a=="started"?(WmsAVChat.isReconnecting=!0,WmsAVChat.callType==WmsAVChat.CALL_TYPE_VIDEO&&(WmsAVChat.dom.remoteuserimg.style.display="block",WmsAVChat.dom.remoteVideo.style.display="none",$WC.Util.removeClass(WmsAVChat.dom.videocontainer.getElementsByClassName("wms_videocall_buttons_list")[0],"wms-halign")),$WC.$CUtil.setInnerText(WmsAVChat.dom.videocontainer.getElementsByClassName("wms_callstatus_text")[0],$WC.I18N("mediacall.reconnecting")),$WC.Util.setAttribute(WmsAVChat.dom.videocontainer,"data-connecting","true")):a=="connected"?(WmsAVChat.isReconnecting=!1,WmsAVChat.setCallStatus(WmsAVChat.CALLSTATUSCODE.CONNECTED),WmsAVChat.establishConnectedCall()):a=="failed"&&(WmsAVChat.setCallStatus(WmsAVChat.CALLSTATUSCODE.ENDED),WmsAVChat.close(),WmsAVChat.showCallFailedBanner())},handleLocalMediaStatus:function(){},handleVideoError:function(a){WmsAVChat.log("handleVideoError "+a),WmsAVChat.close(),WmsAVChat.showCallFailedBanner()},handleSwitchingToVideoCall:function(a){WmsAVChat.log("handleSwitchingToVideoCall "+a)},handleBrowserNotSupported:function(a){WmsAVChat.log("handleBrowserNotSupported "+a)},handleRemoteScreenShareStreamAdded:function(a){WmsAVChat.log("handleRemoteScreenShareStreamAdded");var b=WmsAVChat.dom.sharedScreen;$WC.Util.addEvent(b,"loadedmetadata",function(){WmsAVChat.isScreenShared=!0;var a=WmsAVChat.dom.videocontainer.querySelector("[media-action='togglecam']");WmsAVChat.callType==WmsAVChat.CALL_TYPE_SCREENSHARE&&($WC.Util.setAttribute(a,"data-videooff","true"),$WC.Util.setAttribute(a,"title",$WC.I18N("mediacall.cam.on")))});var c=window.URL||window.webkitURL;if(typeof WmsAVChat.dom.sharedScreen.srcObject=="object")WmsAVChat.dom.sharedScreen.srcObject=a;else{var d=c.createObjectURL(a);$WC.Util.setAttribute(WmsAVChat.dom.sharedScreen,"src",d)}},handleStopSharing:function(){WmsAVChat.log("handleStopSharing"),WmsAVChat.stopScreenShare()},handleRemoteScreenShareStreamRemoved:function(){WmsAVChat.log("handleRemoteScreenShareStreamRemoved"),WmsAVChat.stopScreenShare()},handleExtInstallSuccess:function(){WmsAVChat.chromeExtensionAvailable=!0},handleScreenOn:function(){},handleScreenOnButton:function(){},handleCameraOn:function(){}},WmsAVChat.videoChatImplHandler=function(){window.VideoChatMessageNotifier={handleVideoChat:function(){return WmsAVChat.log("handleVideoChat"),!0},handleChatRequest:function(a,b,c,d,e,f){WmsAVChat.log("handleChatRequest"),e?e=JSON.parse(e):e={},WmsAVChat.CALL_TYPE_SCREENSHARE==f&&(d=f),WmsAVChat.AnswerCall.show(a,c,d,e)},handleChatAnswered:function(a){WmsAVChat.log("handleChatAnswered"),WmsAVChat.AnswerCall.close(a)},handleCloseRequest:function(a,b){WmsAVChat.log("handleCloseRequest"+a+" "+b),WmsAVChat.AnswerCall.close(a)},handleBrowserNotSupported:function(){WmsAVChat.log("handleBrowserNotSupported");var a={bodyhtml:$WC.I18N("mediacall.browser.notsupported"),focusbutton:1,operations:[{name:$WC.I18N("mediacall.permission.okay")}]};WmsDialog.showModal(a),WmsAVChat.close(!0)}}},WmsResource.init=function(){this.MessageObject={},typeof $WC!="undefined"&&$WC.template&&$WC.template.setResource(WmsResource)},WmsResource.getRealValue=function(a,b){try{var c="";return this.MessageObject[""+a]==undefined||this.MessageObject[""+a]==null?c=a:c=this.MessageObject[a],c&&c.length&&(c=c.replace(/_/g," ")),b==null?c||"":(c=WmsResource.replaceParams(c,b),c)}catch(d){setTimeout(function(){throw d},1)}try{return a.replace(/_/g," ")}catch(d){return""}},WmsResource.getRealData=function(a,b){try{var c=a.trim();return c=c.replace(/ /g,"_"),c=c.replace(/\.$/,""),WmsResource.getRealValue(c,b)}catch(d){return a}},WmsResource.getTrimmedValue=function(a,b){var c=WmsResource.getRealValue(a,b);return c=c.replace(/\s/g,"&nbsp;"),c},WmsResource.replaceParams=function(a,b){b instanceof Array||(b=b.split(","));for(var c=0;c<b.length;c++){var d=b[c],e=new RegExp("\\$"+(c+1),"g");a=a.replace(e,d)}return a},WmsResource.init();var dext=".sas",lfromstatic=!1,wmsjsversion="v265",silent=!1,WMSIAMURL=window.location.protocol+"//accounts.zoho.com",wmsmeetingurl=window.location.protocol+"//meeting.zoho.com",_WMSIAMTICKETNAME="IAMAGENTTICKET",_WMSMAILURL=window.location.protocol+"//zmail.zoho.com/",_WMSCHATURL=window.location.protocol+"//chat.zoho.com/",_WMSPHOTOSERVER=window.location.protocol+"//contacts.zoho.com",_WMSSALESIQSERVER=window.location.protocol+"//salesiq.zoho.com",_WMSCONFIG="15",_WMSCALENDARSERVER=window.location.protocol+"//calendar.zoho.com",_WMSCONT="_wms",_CHATCONT="_chat",_WMSDOMAIN="zoho.com",_WMS_SAMEDOMAIN=!1,_WMS_FORCEDOMAIN=!1,_WMS_NODOMAINCHANGE=!1,_WMSCFPARAMNAME,_CHATCFPARAMNAME="zchat_csrparam",_CHATCFTOKEN="CT_CSRF_TOKEN",_WMSDRAGDROP=!0,_WMSSST=!1,_RETRYREGINTERVAL=1e4,iswmsframemonitorrunning=!1,iswmsframeloaded=!1,retryregistertimer=null,wmsdebuginfo,wmsnotifyowner,_WMSWINFOCUS=!0,_WMSEMPTYBAR=!1,_WMSAPPACCOUNTID,_PRIMETIMEHELPLINK="https://www.zoho.com/cliq/help/primetime/",_UPLOADSERVERURL,_DOWNLOADSERVERURL,_UDS_CLIQ_SERVICE="CLIQ",_isGSearchAppended=!1,_isVideoJSAppended=!1,_WMSDISABLEAVCHAT=!1,_WMSOPENINCLIQ=!0,_WMS_RETRY_COUNT=0,_WMSAUTHTOKEN,_WMSAUTHSCOPE,_WMSZAID,_WMSORIGINALIMG_LOAD_TIMEOUT=250,_WMS_LP="false",_WMS_REQLOG=[],_TZOFFSET=(new Date).getTimezoneOffset()*-1,_WMSOAUTHTOKEN,_WMSOAUTHORGSCOPE,_WMSOAUTHUSERSCOPE,_WMSOAUTHOPRSCOPE,_WMSCHATHIDDEN=!1,op=navigator.userAgent.indexOf("Opera")!=-1,opera_browser=op,ie=!op&&/msie/i.test(navigator.userAgent),mz=!op&&!ie&&/mozilla\/5/i.test(navigator.userAgent),wms_sf=navigator.userAgent.indexOf("Safari")!=-1,WM_ACK_CONNECT=0,WM_INFO=1,WM_CUSTOM=2,WM_CROSSPRODUCT=4,WM_PRESENCE=6,WM_RECONNECT=-1,WM_SERVER_UP=-3,WM_NFY_LOGOUT=-2,WM_AUTH_FAILED=-5,WM_INVALID_AUTH_PARAMS=-12,PS_REG_ACK=-16,WM_INVALID_TOKEN=-17,WM_NFY_ATTACH=-8,WM_NFY_DETACH=-9,SHOW_INFO=-10,CT_JOIN=10,CT_TXT_MSG=12,CT_NFY_USERSTATUS=13,CT_NFY_USERADD=14,CT_NFY_USERDELETE=15,CT_INF_MSG=16,CT_NFY_APPROVAL=102,CT_ATT_MSG=20,WM_NFY_COLLABADD=21,WM_NFY_COLLABDELETE=22,CT_NFY_SETTITLE=19,WM_NFY_STATUS=23,WM_NFY_CSTATUSCHANGE=24,WM_NFY_USERIMGCHANGE=25,CONTACT_INFO=27,CT_CLOSE_WIN=28,WM_AV_MSG=29,WM_CLEAR_NOTI=32,CT_NFY_ACTCHATADD=50,CT_NFY_ACTCHATDELETE=34,WM_SKIPTRANS=36,WM_USER_LANG_CHANGE=37,WM_SYSTEM_MSG=38,ACS_MSG=43,WM_TICKET_MSG=46,CT_MSG_STORAGE=47,CT_ATTACH=49,WM_DEF_STATUS=54,CT_NFY_MUTECHAT=58,CT_BOT_LIST=60,CT_BOT_OPR=61,WM_ZTI_CROSSPRODUCT=62,CT_DELETED_MSG=63,CT_EDITED_MSG=64,CT_MSG_ADDL=70,CT_NFY_MSG=112,NFY_USER_TYPING=104,NFY_USER_IDLE=105,NFY_USER_ENTERED=110,WM_ZTI_FAIL_MSG=601,WMS_ONLINE=1,WMS_INVISIBLE=2,CT_NFY_LIVESUPPORT=4,CT_NFY_ZOHOGROUP=5,NFY_REQ_CSUPPORT=106,NFY_ACC_CSUPPORT=108,NFY_QIT_CSUPPORT=109,NFY_ENDLIVESUPPORT=113,CT_GUEST_REQ=100,WM_PUB_SUB=800,PR_MSG=700,WM_WEBRTC_MSG=59;WebMessanger.chatdeactivated=!1,WebMessanger.allprdchatdeactivated=!1,WebMessanger.chatdisabled=!1,WebMessanger.ismediacallnewwindow=null,WebMessanger.jsstaticdomain="js.zohostatic.com",WebMessanger.cssstaticdomain="css.zohostatic.com",WebMessanger.isIdle=!1,WebMessanger.smartchatshortcutdisabled=!1,WebMessanger.userslist,WebMessanger.forkedlist,WebMessanger.sync_adminsettings_onfocus=!1,WebMessanger.get_pinmsg_onfocus=!1,WebMessanger.is_create_channel_link_disabled=!1,WebMessanger.is_copy_message_link_disabled=!1,WebMessanger.is_set_reminder_option_disabled=!1,WebMessanger.prefetch_channels=!1,WebMessanger.is_zoho_links_settings_disabled=!1,WebMessanger.is_msgpin_option_disabled=!1,$WC.Util.addEvent(window,"beforeunload",function(a){if(_WMS_REQLOG.length){var b="Your message is being sent. Do you still want to leave this page?";return a.returnValue=b,b}}),$WC.Util.addEvent(window,"unload",function(){var a=WindowHandler.openedChats;for(var b in a){var c=WindowHandler.getWinObjById(b);c&&c.composer.value!=""&&$WC.Drafts.updateBeforeUnload(c)}}),Smiley=new $WC.Zomoji({default_size:"24",animation:{default_size:"24"}}),Smiley.init=function(){},Smiley.extrasmiley_lookup=Smiley.symbol_lookup,Smiley.defaultsmiley_lookup=Smiley.symbol_lookup,WmsContacts=Object.assign({},$WC.WmsContacts),WmsOrgContacts=$WC.WmsOrgContacts,WebMessanger.checkNetworkAndUpdateBanner=function(){var a,b="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/spacer.gif";return function(){typeof a=="undefined"&&(a=$WC.Util.createElement("img"),a.style.display="none",document.body.appendChild(a),EventsUtil.attachonload.call(a,function(){document.getElementById("wmsbannertext")&&setTimeout(function(){document.getElementById("wmsbannertext").innerHTML=$WC.I18N("connectionerror.chatfail")},1)})),a.src=b+"?nocache="+(new Date).getTime()}}(),function(){var a=(new Date).getTime()+"_"+Math.floor(Math.random()*1e4);window.getWmsTabId=function(){return WebMessanger.zuid+"_"+WebMessanger.prd+"_"+a}}(),WebMessanger.getDebugInfo=function(){return wmsdebuginfo},WebMessanger.updateDebugInfo=function(a){wmsdebuginfo=a},WebMessanger.setOAuthCredentials=function(a,b,c,d){_WMSOAUTHTOKEN=a,_WMSOAUTHORGSCOPE=b||_WMSOAUTHORGSCOPE,_WMSOAUTHUSERSCOPE=c||_WMSOAUTHUSERSCOPE,_WMSOAUTHOPRSCOPE=d||_WMSOAUTHOPRSCOPE,typeof WebMessanger.updateOAuthCredInBridge=="function"&&WebMessanger.updateOAuthCredInBridge()},function(){var a=[];WebMessanger.updateClientDebugStore=function(b){a.length>=1e3&&a.shift(),b.timestamp=(new Date).getTime(),b.mtype&&b.mtype==="12"&&b.msg&&(b.msg.msg="******"),a.push(b)},WebMessanger.getClientDebugStore=function(){return a}}(),function(){var a=[];WebMessanger.updateReminderInfo=function(b){var c=Object.keys(b)[0];a.length>=100&&a.shift();var d=a.some(function(a){if(a.hasOwnProperty(c))return!0});d===!1&&a.push(b)},WebMessanger.getReminderInfo=function(b){var c=a.find(function(a){if(a.hasOwnProperty(b))return a});return c&&c[b]}}(),WebMessanger.postDebugInfoToServer=function(a,b){var c="zuid="+WebMessanger.zuid+"&wmsdebuginfo="+JSON.stringify(WebMessanger.getDebugInfo())+"&sid="+WebMessanger.sid+"&rawsid="+WebMessanger.rawsid;b&&(c+="&source="+b),document.location.hostname.indexOf(".manageengine.com")===-1&&$WC.Ajax.postRequestToChat("printlog.do",c,function(){a&&WMSUI.showInfoMsg("Debug info sent successfully!")})},WebMessanger.showBanner=$WC.Util.throttle(function(a,b){WebMessanger.offline=!0,WebMessanger.checkNetworkAndUpdateBanner();var c=!WMSUI.isBannerShown("wms-netdownbanner")||WebMessanger.initcountdown?!0:!1;WebMessanger.initcountdown=!1,iswmsframeloaded===!1?(WMSUI.showBanner(WebMessanger.forceRegister),WebMessanger.reconnectTimer(c,WebMessanger.retryRegister,a,b)):(WMSUI.showBanner(WebMessanger.forceReconnect),WebMessanger.reconnectTimer(c,WebMessanger.triggerbind,a,b))},null,4e3),WebMessanger.hideBanner=function(){WebMessanger.offline=!1,WMSUI.hideBanner()},WebMessanger.init=function(a){_WMS_NODOMAINCHANGE||!_WMS_SAMEDOMAIN&&!opera_browser&&(!ie||ie&&_WMS_FORCEDOMAIN)&&(document.domain=_WMSDOMAIN);if(typeof document.querySelector!="undefined"){var b=document.querySelector('script[src*="wmsbar"]');b&&(WebMessanger.jsstaticdomain=b.src.split("/")[2]);var c=document.querySelector("link[href*=wmsbar]");c&&(WebMessanger.cssstaticdomain=c.href.split("/")[2])}silent=a,typeof this.countrycode=="undefined"&&(this.countrycode="US"),typeof this.language=="undefined"&&(this.language="en"),typeof this.rebrand=="undefined"&&(this.rebrand=""),typeof this.meeting=="undefined"&&(this.meeting=!0),typeof this.theme=="undefined"&&(this.theme="grey"),typeof this.setzindex=="undefined"&&(this.setzindex=999),typeof this.disablenetworkdownbanner=="undefined"&&(this.disablenetworkdownbanner=!1),WebMessanger.statusarr=new Array("Offline","Available","Invisible","Busy","Idle","Away"),WebMessanger.scodearr=new Array(0,1,3,4,7),WebMessanger.lastconnect=-1,WebMessanger.wmsservicestatus=!0,WebMessanger.offline=!0,WebMessanger.locationurl=window.location.href,WebMessanger.disablewms=!1,WebMessanger.showbannertime=0,WebMessanger.showchatbannertime=0,WebMessanger.lastmessage="",WebMessanger.lastmessagetime="",WebMessanger.reconnectPrevlimit=30,WebMessanger.isPresenceEnabled()&&(setTimeout(function(){WMSUI.runIdleTimer()},10),setTimeout(function(){WMSUI.checkDocumentActive()},20)),WMSUI.init(),WebMessanger.systemdown=!1,WebMessanger.ucmap={},WebMessanger.waitchats={},WebMessanger.liveChats=new Array,WebMessanger.chatmap={}},WebMessanger.forceRegister=function(){WebMessanger.initcountdown=!0,document.getElementById("recntime").innerHTML=$WC.I18N("connectionerror.reconnect"),WebMessanger.retryRegister()},WebMessanger.forceReconnect=function(){WebMessanger.initcountdown=!0,document.getElementById("recntime").innerHTML=$WC.I18N("connectionerror.reconnect"),WebMessanger.triggerbind()},WebMessanger.reconnectTimer=function(){function c(a,b){return a=+a,b=+b,Math.floor(Math.random()*(b-a+1)+a)}var a=[30,60,90,120,300],b=0;return function(d,e,f,g){d?(b=0,a[0]=c(5,30)):b<a.length-1&&b++;var h=a[b];f&&(g=g||f,h=c(f,g)),WMSUI.showCountDownInBanner(h,e)}}(),WebMessanger.reconnect=function(a,b,c){c!=null&&c==1&&(this.reconnecting=!1);if(this.reconnecting==1)return;this.reconnecting=!0,this.retry==undefined&&(this.retry=0),this.retry++,setTimeout(function(){WebMessanger.registerWms(WebMessanger.prd,WebMessanger.zuid,WebMessanger.uname,WebMessanger.nname,silent,!0)},a),WebMessanger.serverdown(),WMSUI.RestartTimers()},WebMessanger.isReconnecting=function(){return this.reconnecting},WebMessanger.registerZuid=function(a,b,c,d){WebMessanger.registerWms(a,b,c,null,d)},WebMessanger.registerAnnon=function(a,b,c,d){WebMessanger.disableContacts(),WebMessanger.disableGroups(),WebMessanger.disableActiveChat(),WebMessanger.disableProfile(),WebMessanger.disableMeeting(),WebMessanger.disableNotification(),WebMessanger.disableCWActions(),WebMessanger.disableSmartChat(),this.registerAnnonUser=!0,WebMessanger.authtype=4,WebMessanger.registerWms(a,b,b,c,d)},WebMessanger.register=function(a,b,c,d,e,f){function j(){_WMSAUTHTOKEN=d,_WMSAUTHSCOPE=e,_WMSZAID=f,_WMSAUTHTOKEN&&_WMSAUTHSCOPE&&(c=!0,WebMessanger.authtype=1),_WMSAUTHTOKEN&&_WMSZAID&&(c=!0,WebMessanger.authtype=8),_WMSZAID&&WebMessanger.tokenpairauth&&(c=!0,WebMessanger.authtype=10),_WMSOAUTHTOKEN&&(c=!0,WebMessanger.authtype=9),$WC.Util.isZuid(b)?WebMessanger.registerWms(a,b,null,null,c):WebMessanger.registerWms(a,null,b,null,c)}if(typeof JSON=="undefined"){var g=$WC.Util.createElement("script"),h=window.location.protocol,i=h==="https:"?wmsjsversion+"_https":wmsjsversion;g.type="text/javascript",g.src=h+"//"+this.jsstaticdomain+"/ichat/"+i+"/js/json2.min.js",document.body.appendChild(g),EventsUtil.attachonload.call(g,j)}else j()},WebMessanger.showEmptyBar=function(){_WMSEMPTYBAR=!0},WebMessanger.disableToggleUI=function(){},WebMessanger.disableDragDrop=function(){_WMSDRAGDROP=!1},WebMessanger.setIamTicketName=function(a){_WMSIAMTICKETNAME=a},WebMessanger.setPhotoServer=function(a){_WMSPHOTOSERVER=window.location.protocol+"//"+a,$WC.Config.set({photoserver:_WMSPHOTOSERVER})},WebMessanger.setIamServer=function(a){WMSIAMURL=a},WebMessanger.setChatServer=function(a){_WMSCHATURL=window.location.protocol+"//"+a+"/"},WebMessanger.setMailServer=function(a){_WMSMAILURL=window.location.protocol+"//"+a+"/"},WebMessanger.setCalendarServer=function(a){_WMSCALENDARSERVER=window.location.protocol+"//"+a},WebMessanger.setTheme=function(a){},WebMessanger.setDomain=function(a){_WMSDOMAIN=a},WebMessanger.isChatPaused=function(){return WebMessanger.chatdeactivated||WebMessanger.allprdchatdeactivated||WebMessanger.chatdisabled},WebMessanger.disableAudioVideoChat=function(){_WMSDISABLEAVCHAT=!0},WebMessanger.disableOpenInCliq=function(){_WMSOPENINCLIQ=!1},WebMessanger.enableMediacallInNewWindow=function(){WebMessanger.ismediacallnewwindow=!0},WebMessanger.isMediaCallNewWindow=function(){return WebMessanger.orgid!="456089"&&navigator.userAgent.indexOf("Electron")===-1||!!WebMessanger.isChatPaused()?!0:!1},WebMessanger.getDomain=function(){return _WMSDOMAIN},WebMessanger.getServiceName=function(){return this.servicename},WebMessanger.setConfig=function(a){_WMSCONFIG=a},WebMessanger.setChatBarPrimaryColor=function(a){document.documentElement.style.setProperty("--wms-primary-color",a)},WebMessanger.checkAndEnableChatBar=function(a,b,c){var d;a?d=_WMSCHATURL+"users/"+a:b&&(d=_WMSCHATURL+"chats/"+b);if(c&&silent){window.open(d,"_blank","toolbar=1,menubar=1,location=1,status=1,scrollbars=1,noopener");return}var e={bodyhtml:$WC.I18N("chat.disabled.info1"),focusbutton:1,operations:[{name:$WC.I18N("chat.enable"),action:function(){WebMessanger.turnOnChat()}}]};c&&_WMSOPENINCLIQ&&(WebMessanger.isCliqUser()||WebMessanger.isOrgUser())&&(e.bodyhtml=$WC.I18N("chat.disabled.info2"),e.focusbutton=2,e.operations.push({name:$WC.I18N("chats.cliq.open"),link:d})),WmsDialog.showModal(e)},WebMessanger.loadSalesIQJS=function(){if(wmsUserConfig.salesiqjsurl&&WmsSettings.salesiq_chatbar==="1"&&wmsUserConfig.salesiq_enabled_prdlist&&wmsUserConfig.salesiq_enabled_prdlist.split(",").indexOf(WebMessanger.prd)!==-1&&!silent){var a=document.getElementsByTagName("head");if(!a||a.length==0)a=[],a[0]=$WC.Util.createElement("head"),document.insertBefore(doc.body,a[0]);var b=$WC.Util.createElement("script");b.defer=!0,b.src=wmsUserConfig.salesiqjsurl,b.onload=function(){WmsMainUI.applyChatBarOptions()},a[0].appendChild(b)}},WebMessanger.setSalesIQServerURL=function(a){_WMSSALESIQSERVER=window.location.protocol+"//"+a},WebMessanger.getSalesIQServerURL=function(){return _WMSSALESIQSERVER},WebMessanger.loadAVjscss=function(){if(_WMSDISABLEAVCHAT)return;if(!_isVideoJSAppended){var a=document.getElementsByTagName("head");if(!a||a.length==0)a=[],a[0]=$WC.Util.createElement("head"),document.insertBefore(doc.body,a[0]);if(wmsUserConfig.zvv||wmsUserConfig.zvideojsurl){var b=$WC.Util.createElement("link");b.rel="stylesheet",wmsUserConfig.zvideocssurl?b.href=wmsUserConfig.zvideocssurl:b.href=window.location.protocol+"//"+WebMessanger.cssstaticdomain+"/zohovideo/"+wmsUserConfig.zvv+"/styles/blue/zvasall.css",a[0].appendChild(b);var c=$WC.Util.createElement("script");c.defer=!0,wmsUserConfig.zvideojsurl?c.src=wmsUserConfig.zvideojsurl:c.src=window.location.protocol+"//"+WebMessanger.jsstaticdomain+"/zohovideo/"+wmsUserConfig.zvv+"/js/zvaschat.js",c.onload=function(){WmsAVChat.init();var a=WmsSettings.adminsettings&&WmsSettings.adminsettings.service_configurations&&WmsSettings.adminsettings.service_configurations.dc;MediaFrameWorkAPI.init(a)},a[0].appendChild(c)}_isVideoJSAppended=!0}},EventsUtil.attachonload=function(a){typeof this.readyState!="undefined"?this.onreadystatechange=function(){(this.readyState=="loaded"||this.readyState=="complete")&&a.call(this)}:this.onload=function(){a.call(this)}},WebMessanger.registerWms=$WC.Util.throttle(function(a,b,c,d,e,f){WebMessanger.prd=a,WebMessanger.uname=c!=null&&c!=undefined?c:"",WebMessanger.zuid=b!=null&&b!=undefined?b:"",WebMessanger.authtype===undefined&&WebMessanger.enableTokenPairAuth(),typeof WebMessanger.nname=="undefined"&&(WebMessanger.nname=d!=null&&d!=undefined?d:""),f==undefined&&WebMessanger.settings==undefined&&WebMessanger.init(e!=undefined?e:!1);var g=document.getElementById("pconnect");if(!g){var h=$WC.Util.createElement("iframe","pconnect");h.name="wmspconnect",h.style.display="none",document.body.appendChild(h),g=document.getElementById("pconnect")}WebMessanger.lastconnect=(new Date).getTime();var i=WebMessanger.zuid!=""?WebMessanger.zuid:WebMessanger.uname,j=!1;if(!e||WebMessanger.silentOverriddenForAnnouncement)j=!0;var k=WebMessanger.prd;_WMS_RETRY_COUNT++;var l="/"+_WMSCONT+"/pconnect"+dext+"?prd="+k+"&uname="+i+"&samedomain="+_WMS_SAMEDOMAIN+$WC.Util.nocachefix(!0)+"&config="+_WMSCONFIG+"&settings="+j+"&wmscont="+_WMSCONT+"&nodomainchange="+_WMS_NODOMAINCHANGE+"&retrycount="+_WMS_RETRY_COUNT;lfromstatic&&(l+="&staticdomain="+WebMessanger.jsstaticdomain+"&staticversion="+wmsjsversion),_WMSSST&&(l+="&sst=true"),WebMessanger.tokenpairauth&&(l+="&tokenpair=true"),WebMessanger.frameorigin&&(l+="&frameorigin="+WebMessanger.frameorigin),WebMessanger.fp_hash&&(l+="&hash="+WebMessanger.fp_hash["wmsbridge.js"].split("_")[0]),g.src=l,iswmsframeloaded=!1,WebMessanger.scheduleWMSFrameMonitor()},null,_RETRYREGINTERVAL),WebMessanger.scheduleWMSFrameMonitor=function(){iswmsframemonitorrunning||(iswmsframemonitorrunning=!0,clearTimeout(retryregistertimer),retryregistertimer=setTimeout(function(){WebMessanger.registerMonitor()},_RETRYREGINTERVAL*6))},WebMessanger.registerMonitor=function(){WebMessanger.offline=!0,WebMessanger.isReuseSession()?WebMessanger.retryRegister():WebMessanger.showBanner()},WebMessanger.clearWMSFrameMonitor=function(a){clearTimeout(retryregistertimer),iswmsframemonitorrunning=!1,a&&(WebMessanger.offline=!1,WebMessanger.isReuseSession()||WebMessanger.hideBanner())},WebMessanger.retryRegister=function(){WebMessanger.isReuseSession()?(op||!top.WebMessanger.offline)&&WebMessanger.reconnect(0,"Retry Register",!0):WebMessanger.reconnect(0,"Retry Register",!0),clearTimeout(retryregistertimer),retryregistertimer=setTimeout(function(){WebMessanger.registerMonitor()},_RETRYREGINTERVAL)},WebMessanger.isReuseSession=function(){return(_WMSCONFIG&WMSSessionConfig.REUSE_SESSION)==WMSSessionConfig.REUSE_SESSION},WebMessanger.getZuid=function(){return this.zuid},WebMessanger.uisettingsconst={contacts:1,groups:2,activechats:4,notifications:8,settings:16,smartchat:32},WebMessanger.disableContacts=function(){WMSUI.contactsenabled=!1,WebMessanger.disabledmenus|=WebMessanger.uisettingsconst.contacts},WebMessanger.disableGroups=function(){WMSUI.groupsenabled=!1,WebMessanger.disabledmenus|=WebMessanger.uisettingsconst.groups},WebMessanger.disableActiveChat=function(){WMSUI.activechatenabled=!1,WebMessanger.disabledmenus|=WebMessanger.uisettingsconst.activechats},WebMessanger.disableProfile=function(){WMSUI.profileenabled=!1,WebMessanger.disabledmenus|=WebMessanger.uisettingsconst.settings},WebMessanger.disableNotification=function(){WMSUI.notificationenabled=!1,WebMessanger.disabledmenus|=WebMessanger.uisettingsconst.notifications},WebMessanger.disableSmartChat=function(){WMSUI.smartchatenabled=!1,WebMessanger.disabledmenus|=WebMessanger.uisettingsconst.smartchat},WebMessanger.disableCWActions=function(){this.disableCWAction=!0},WebMessanger.hideChatBar=function(){document.getElementById("wmstoolbar")&&(_WMSCHATHIDDEN=!0,document.getElementById("wmstoolbar").style.display="none")},WebMessanger.showChatBar=function(){document.getElementById("wmstoolbar")&&_WMSCHATHIDDEN&&(document.getElementById("wmstoolbar").style.display="block",_WMSCHATHIDDEN=!1)},WebMessanger.enableGlobalSearch=function(a){WMSUI.globalsearchenabled=!0,a!=undefined&&(WMSUI.hidegsicon=a)},WebMessanger.enablePhoneBridge=function(a){WMSUI.phonebridgeenabled=!0,WMSUI.phonebridgeconfig=a},WebMessanger.getPhoneBridgeConfig=function(){return WMSUI.phonebridgeconfig},WebMessanger.getPhoneBridgeContainer=function(){return document.getElementById("wmsphonebridge")},WebMessanger.setDateFormat=function(a){var b=/^((dd|MM|y{2,4})( {0,1})\/( {0,1})(dd|MM)( {0,1})\/( {0,1})(dd|MM|y{2,4}))$/;b.test(a)&&$WC.Config.set({dateformat:a})},WebMessanger.getUserName=function(){return this.uname},WebMessanger.getNickName=function(){return this.nname},WebMessanger.setNickName=function(a){this.nname=a},WebMessanger.getUserId=function(){return this.uid},WebMessanger.getPrd=function(){return this.prd},WebMessanger.getSid=function(){return this.sid},WebMessanger.setSid=function(a){this.sid=a},WebMessanger.getRawSid=function(){return this.rawsid},WebMessanger.getRebrand=function(){return this.rebrand},WebMessanger.getUnreadFeeds=function(){$WC.Ajax.requestToChat("unreadzmsg.do")},WebMessanger.getPinnedChats=function(){if(!silent){var a="pinned=true&joined=true",b=function(){var a=this.response&&JSON.parse(this.response);$WC.RecentChats.updatePinnedChatList(a)};$WC.Ajax.requestToChat("v1/chats",a,b)}},WebMessanger.sendMailTranscript=function(a,b){var c="chid="+a+"&mailid="+encodeURIComponent(b);$WC.Ajax.postRequestToChat("sendtranscriptasmail.do",c)},WebMessanger.setStatus=function(a,b){if(a>4&&a<0)return;$WC.I18N("Available")==b?b="Available":$WC.I18N("Busy")==b?b="Busy":a==2?b="Invisible":a==7&&(b="Away");var c="smsg="+encodeURIComponent(b)+"&scode="+a;$WC.Ajax.postRequestToChat("setstatus.do",c)},WebMessanger.getStatusMessage=function(){$WC.Ajax.requestToChat("getdefaultstatus.do")},WebMessanger.syncStatusMessage=function(){function b(){this.responseText!==""&&(a=JSON.parse(this.responseText)[0].objString)}var a=null;return $WC.Ajax.requestToChat("getdefaultstatus.do",null,b,null,null,!1),a},WebMessanger.getAllStatusMessage=function(){var a=function(){var a=JSON.parse(this.response);a[0].objString.ERRCODE==9005&&WMSUI.showErrorMsg($WC.I18N("status.change.notallowed"))},b={"X-XHR-exception":"true"};$WC.Ajax.requestToChat("getcstatus.do",null,null,a,null,null,b)},WebMessanger.getBarChatSettings=function(a){$WC.Ajax.requestToChat("getwmssettings.do","property="+encodeURIComponent(a))},WebMessanger.UpdateWmsSettings=function(a,b,c,d,e,f,g){var h="property="+encodeURIComponent(a)+"&key="+b+"&value="+c;h+=d?"&prd="+d:"",h+=e?"&opr="+e:"",$WC.Ajax.postRequestToChat("updwmssettings.do",h,f,g)},WebMessanger.updateSettings=function(a,b,c){var d={"X-XHR-exception":"true"};$WC.Ajax.postRequestToChat("updbsettings.do",a,b,c,null,null,d)},WebMessanger.clearCustomStatus=function(){$WC.Ajax.postRequestToChat("clearcstatus.do")},WebMessanger.clearReminder=function(a){var b="calid="+encodeURIComponent(a);$WC.Ajax.postRequest("clearreminder"+dext,b)},WebMessanger.getEditMsgHistory=function(a,b){var c=function(){var a=JSON.parse(this.response).transcript;Message.updateEditMsgHistory(a)},d={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};$WC.Ajax.requestToChat("v2/chats/"+a+"/transcript/"+b,null,c,null,null,null,d)},WebMessanger.getChatTranscript=function(a){var b=a?a:(new Date).getTime(),c="limit="+ZMSG_CHATCOUNT+"&totime="+b;c+=ZMSG_SEARCHVALUE&&"&content="+ZMSG_SEARCHVALUE,c+=ZMSG_USERID&&"&recipient="+ZMSG_USERID;var d={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()},e=function(){if(!silent){var a=JSON.parse(this.response).data;a.chats&&a.chats.length==0&&(ZMSG_CHATPGNO="End");var b=document.getElementById("chathistorywin");ZMSG_transContent.querySelector("[errormsg=true]")&&$WC.Util.removeElement(ZMSG_transContent.querySelector("[errormsg=true]")),a.chats[0]&&b.querySelector('[cid="'+a.chats[0].chatid+'"]')&&ZMSG_CHATPGNO!=1&&a.chats.shift(),ZMSG_CHATS=a.chats,ZMSGUI.populate(a.chats)}},f=function(){ZMSG_transmoreloader&&ZMSG_transmoreloader.parentNode&&$WC.Util.removeElement(ZMSG_transmoreloader),ZMSGUI.showErrorMessage()};WebMessanger.isCliqUser()?$WC.Ajax.requestToChat("v1/history",c,e,f,null,null,d):$WC.Ajax.requestToChat("v1/chats",c,e,f,null,null,d)},WebMessanger.deleteSelectedChats=function(a){$WC.Ajax.postRequestToChat("deleteselectedchat.do","chid="+a)},WebMessanger.deleteChat=function(a){$WC.Ajax.postRequestToChat("deletechat.do","chid="+a)},WebMessanger.continueChat=function(a){if(WebMessanger.isChatPaused()||silent){WebMessanger.checkAndEnableChatBar("",a,!0);return}if(Chat.isExists(a)){WMSUI.handleChatExist(a);return}WmsMainUI.scheduleAutoFocus(a);if(WebMessanger.prefetch_channels&&$WC.Util.isChannelChid(a)&&$WC.Channels.getLastFetchedTime()===null){$WC.Channels.initChannels(),WmsMainUI.scheduleAutoJoin(a);return}var b=!0,c=!1,d="chid="+a+"&btf="+b+"&autojoin="+c+"&sid="+encodeURIComponent(WebMessanger.getSid());$WC.Ajax.postRequestToChat("continuechat.do",d)},WebMessanger.disable=function(){this.disablewms=!0,this.abortBind(),this.clearWMSFrameMonitor()},WebMessanger.isOnline=function(a){$WC.Ajax.postRequest("isonline"+dext,"ulist="+encodeURIComponent(a))},WebMessanger.isdisablewms=function(){return this.disablewms},WebMessanger.setRebrand=function(a){if(a==="baihui")return;this.rebrand=a},WebMessanger.setJsStaticDomain=function(a){this.jsstaticdomain=a},WebMessanger.setCssStaticDomain=function(a){this.cssstaticdomain=a},WebMessanger.useSameDomain=function(){_WMS_SAMEDOMAIN=!0},WebMessanger.setWmsContext=function(a){_WMSCONT=a,$WC.Config.set({WMSCONT:_WMSCONT})},WebMessanger.forceDomainChange=function(){_WMS_FORCEDOMAIN=!0},WebMessanger.setNoDomainChange=function(){_WMS_NODOMAINCHANGE=!0},WebMessanger.silentOverriddenForAnnouncement=!1,WebMessanger.overrideSilentForAnnouncement=function(){WebMessanger.silentOverriddenForAnnouncement=!0},WebMessanger.setLocale=function(a,b){var c=new Array("en","zh","ta","ja","de","ca","cs","da","el","es","et","fi","fr","hr","hu","it","ko","lt","nb","nl","pl","pt","ro","ru","sk","sv","th","tr","uk","vi"),d=-1;for(var e=0;e<c.length;e++)if(c[e]==a){d=e;break}d>-1?(this.language=a,this.countrycode=b):(this.language="en",this.countrycode="US")},WebMessanger.disableMeeting=function(){this.meeting=!1},WebMessanger.setMeetingUrl=function(a){wmsmeetingurl=window.location.protocol+"//"+a},WebMessanger.setAppAccountId=function(a){_WMSAPPACCOUNTID=a},WebMessanger.isCliqUser=function(){return _WMSAPPACCOUNTID?!0:!1},WebMessanger.reload=function(){try{var a=newurl=window.location.href;a.indexOf("#")>-1&&(newurl=window.location.href.substring(0,window.location.href.indexOf("#"))),setTimeout(function(){return window.location.href=newurl,!0},3e3)}catch(b){setTimeout(function(){return window.location.href=WebMessanger.locationurl,!0},3e3)}},WebMessanger.setMaxChatWindow=function(a){WebMessanger.forceMaxWin=a},WebMessanger.isAutoJoinAllowed=function(a,b){var c=WindowHandler.exist.filter(function(a){if(a!="empty")return!0}).length;return c>=WindowHandler.getMaxWin()?!1:WebMessanger.scode==3||WebMessanger.orgid=="456089"&&(a=="Estancia Bot"||a=="Jeeves Bot"||b==="CT_2243174094947259583_64396901")?!1:!0},WebMessanger.push=function(a){if(a.mtype==WM_RECONNECT){var b=a.msg||{},c;if(b&&b.instruction){var d=b.instruction.split("-");c=d[0]}c===undefined&&WebMessanger.reconnect(CT_JOIN,"psdown",!0),silent||WmsMainUI.resetAllUnreadCount()}else if(a.mtype==WM_NFY_LOGOUT||a.mtype==WM_AUTH_FAILED){WebMessanger.disable();var b=a.msg;setTimeout(function(){if(a.mtype==WM_NFY_LOGOUT){WebMessanger.clearTicket(b.ticket);var c=WmsImplHandler.invokeSynchronously(Collaboration.handleLogout,b&&b.reason);c!==!0&&WebMessanger.reload()}else WmsImplHandler.invoke(Collaboration.handleWmsDisable,b&&b.reason),WmsImplHandler.invoke(Collaboration.handleAuthFailure),WebMessanger.postDebugInfoToServer(null,"AuthFailed")},1),$WC.WmsSessionStorage.removeItem("wms_openchats")}else if(a.mtype==PS_REG_ACK)iswmsframeloaded=!0,WebMessanger.clearWMSFrameMonitor();else if(a.mtype==WM_INVALID_AUTH_PARAMS||a.mtype==WM_INVALID_TOKEN){iswmsframeloaded=!1,WebMessanger.scheduleWMSFrameMonitor();var e=a.mtype==WM_INVALID_AUTH_PARAMS?"InvalidAuthParam":"InvalidToken";WmsImplHandler.invoke(Collaboration.handleAuthFailure),WebMessanger.postDebugInfoToServer(null,e)}else if(a.mtype==WM_SERVER_UP)silent||(WmsMainUI.resetAllUnreadCount(),$WC.HybridSearch.populateRecentChats(),Commands.sync=!0,$WC.Channels.sync=!0,$WC.RecentChats.setPinnedChatsLastFetchedTime(null),WindowHandler.syncChatWindowTranscripts(),WindowHandler.restoreChats(),!WebMessanger.registerAnnonUser&&!WebMessanger.isCliqUser()&&WebMessanger.getUnreadFeeds(),_WMSWINFOCUS?(WebMessanger.syncAdminSettings(),WindowHandler.getPinMsgForOpenedChats(),$WC.Bots.initBots(!0)):(WebMessanger.sync_adminsettings_onfocus=!0,WebMessanger.get_pinmsg_onfocus=!0,$WC.Bots.syncFromServerAfterFocus())),WmsChatCache.removeAll(),Message.deletedMessages.removeAll(),typeof AcsApi!="undefined"&&WmsImplHandler.invoke(AcsApi.handleServerUP),WmsImplHandler.invoke(Collaboration.serverup);else if(a.mtype==WM_NFY_ATTACH){var f=a.msg;this.uid=f.uid,f.nname!=""&&(this.nname=f.nname),this.sid=f.sid,this.rawsid=f.rsid,myMsgObj.sender=f.uname,myMsgObj.zuid=f.zuid,this.zuid=f.zuid,WebMessanger.clearWMSFrameMonitor(!0),iswmsframeloaded=!0,silent||WmsContacts.updateFromMDParent(WmsContacts.getZohoContacts()),setTimeout(function(){WebMessanger.serverup(a.msg)},100),WmsImplHandler.invoke(WmsContactImpl.handleGetContacts)}else if(a.mtype==WM_NFY_DETACH)setTimeout(function(){WebMessanger.serverdown()},100);else if(a.mtype==-7)WmsImplHandler.invoke(Collaboration.handleServiceMessage,a.msg);else if(a.mtype==NFY_USER_IDLE){var b=a.msg,g=$WC.Util.splitWmsFormattedString(b.oc,4);b.chid=g[0],b.zuid=g[2],b.sender=b.zuid,b.dname=$WC.Util.getContactName(b.zuid,g[3]);var h=b.chid,i=WindowHandler.getWinObjById(h);i&&!$WC.Util.isLocalUser(b.zuid)&&i.clearTypingStatus(),b.msg="",silent||Self.status.update(b),WmsImplHandler.invoke(WmsChatUIImpl.handleUserIdle,b.dname,h)}else if(a.mtype==NFY_USER_ENTERED){var b=a.msg,g=$WC.Util.splitWmsFormattedString(b.oc,4);b.chid=g[0],b.zuid=g[2],b.sender=b.zuid,b.dname=$WC.Util.getContactName(b.zuid,g[3]);var h=b.chid,i=WindowHandler.getWinObjById(h);i&&!$WC.Util.isLocalUser(b.zuid)&&i.clearTypingStatus(),b.msg="",silent||Self.status.update(b),WmsImplHandler.invoke(WmsChatUIImpl.handleUserEnteredText,b.dname,h)}else if(a.mtype==NFY_USER_TYPING){var b=a.msg,g=$WC.Util.splitWmsFormattedString(b.oc,4);b.chid=g[0],b.zuid=g[2],b.sender=b.zuid,b.dname=$WC.Util.getContactName(b.zuid,g[3],!0),b.mtype=NFY_USER_TYPING;var h=b.chid,i=WindowHandler.getWinObjById(h),j;i&&!$WC.Util.isLocalUser(b.zuid)&&(j=i.typingstatusnode,j.innerHTML="",$WC.Util.removeClass(j,"wms_cw_typingstatus_animate"),$WC.Util.isImageLazyLoaded(b.zuid)?j.innerHTML='<img class="wms_cw_userphoto" data-zcprofileid="'+b.zuid+'" src="'+WmsContacts.getUserPhoto(b.zuid)+'" title="'+$WC.Util.getContactName(b.zuid,b.dname,!0)+'">':j.innerHTML='<div class="wms_menu_item_img wms_typingstatus_img" data-imgid="'+b.zuid+'" data-originalsrc="'+WmsContacts.getUserPhoto(b.zuid)+'" title="'+$WC.Util.getContactName(b.zuid,b.dname,!0)+'"></div>',j.innerHTML+='<div class="wms_usertyping_status"><span></span><span></span><span></span></div>',j.setAttribute("data-typingstatus",!0),$WC.Util.isImageLazyLoaded(b.zuid)||$WC.Util.loadOriginalImage(j,!0,!0));if(!silent){Self.status.update(b);var k=b.chid+"."+b.sender,l=b.sender;Self.Timer[k]=setTimeout(function(){Self.status.clear(h,l);var a=WindowHandler.getWinObjById(h);a&&!$WC.Util.isLocalUser(b.zuid)&&a.clearTypingStatus()},15e3)}WmsImplHandler.invoke(WmsChatUIImpl.handleUserTyping,b.dname,h)}else if(a.mtype==WM_ACK_CONNECT){var f=a.msg;this.uid=f.uid,f.nname!=""&&(this.nname=f.nname),this.sid=f.sid,this.rawsid=f.rsid,this.uname=f.uname,this.orgid=f.orgid,myMsgObj.sender=f.uname,myMsgObj.zuid=f.zuid,this.zuid=f.zuid,this.retry=0,this.reconnecting=!1,this.registered=!0,silent||WebMessanger.isOrgUser()||WmsMainUI.removeChannelMenu(),WmsImplHandler.invoke(Collaboration.onConnect),WebMessanger.clearWMSFrameMonitor(!0),iswmsframeloaded=!0,WebMessanger.serverup(a.msg),WindowHandler.restoreChats(!0),!WebMessanger.registerAnnonUser&&!WebMessanger.isCliqUser()&&WebMessanger.getUnreadFeeds(),$WC.Config.set({orgid:WebMessanger.orgid,dname:WebMessanger.nname,sid:WebMessanger.sid}),$WC.WmsLocalStorage.getItem("wms_firstloaded")==null&&$WC.WmsLocalStorage.setItem("wms_firstloaded",(new Date).getTime()),(WebMessanger.orgid=="456089"||navigator.userAgent.indexOf("Electron")!==-1)&&WmsAVChat.videoChatImplHandler(),WebMessanger.ismediacallnewwindow=WebMessanger.ismediacallnewwindow||WebMessanger.isMediaCallNewWindow(),!_WMSEMPTYBAR&&!this.registerAnnonUser&&silent===!1&&this.loadAVjscss(),ChatTour.checkAndScheduleNotifier($WC.WmsLocalStorage.getItem("wms_firstloaded"))}else if(a.mtype==WM_CLEAR_NOTI){var f=a.msg;if(f.opr=="clearunreadcount")silent||ZMSGUI.clearAllUnreadChats();else if(f.opr=="clearallnotifications"){if(!silent)try{ZMSG_CLKUNREAD=!1,$WC.RecentChats.setUnreadFeedsCount(0),WmsMainUI.updateUnreadChatsCount(),$WC.HybridSearch.populateRecentChats()}catch(m){}}else if(f.opr=="clearreminder"){var n=f.data;n.reminder!=null&&(silent||WMSUI.removeNotificationHolder("reminder"+n.reminder,!1))}else if(f.opr=="updateunreadcount"){var n=f.data;n.chatcount!=undefined&&!!silent}else if(f.opr=="notifyunreadcount"){var n=f.data;if(n.chatcount!=undefined){if(silent)return;WmsMainUI.resetUnreadCount(n.chid),WmsMainUI.updateUnreadCountInUI(n.chid),WmsMainUI.updateUnreadChatsCount()}}else f.opr!="clearlivenotifications"}else if(a.mtype==CT_NFY_ACTCHATADD){var f=a.msg.ac;a.msg.uc&&$WC.RecentChats.updateUnReadChats(a.msg.uc);for(var o in f){var i=WindowHandler.getWinObjById(o);i&&i.title!=f[o].title&&i.updateChatTitle(f[o].title)}$WC.RecentChats.updateFromActiveChats(f),$WC.Util.pubsub.publish("/recentchats/updatechatslistui")}else if(a.mtype==CT_NFY_ACTCHATDELETE)var f=a.msg;else if(a.mtype==CT_NFY_MSG){var f=a.msg;WmsImplHandler.invoke(Collaboration.handleChatNotifyMessage,f.chid,f.sender,f.msg)}else if(a.mtype==CT_INF_MSG){var f=a.msg;if(f.h)return;var h=f.chid,i=WindowHandler.getWinObjById(h);if(i&&i.ctype=="8"&&(f.msg.mode==="USER ADDED"||f.msg.mode==="USER DELETED")){var p=[],q=f.msg.userslist;for(var r in q)p.push({zuid:r,uname:r,dname:q[r]});WindowHandler.addParticipantsByID(h,p)}f.sender="CT_INF_MSG",f.msg=$WC.MsgUtil.getInfoMsgString(f.msg),i&&i.updateInfoMessage(f.msg,f.time)}else if(a.mtype==WM_INFO)try{var f=a.msg;!silent&&(!WebMessanger.isCliqUser()||!$WC.SecurityManager.hasPermission("taz"))&&($WC.RecentChats.incrementUnreadFeedsCount(),ZMSG_MSGOBJ.push(f),WmsMainUI.updateUnreadChatsCount(),$WC.HybridSearch.populateRecentChats()),WmsImplHandler.invoke(Collaboration.handleZohoMessage,a.prd,f.MSG,f.URL,f.URLSTRING,f.CATEGORY,f.SENDER,f.ATTACHMENTS,f.PARAMS,f.ID,f.DNAME,f.ORGS,f.GROUPS)}catch(s){}else if(a.mtype==WM_CUSTOM)a.msg.ACTION==="COMMAND_CREATED"?Commands.updateList(a.msg.data):a.msg.ACTION==="COMMAND_DELETED"&&Commands.deleteObj(a.msg.data),WmsImplHandler.invoke(Collaboration.handleCustomMessage,a.msg);else if(a.mtype==WM_CROSSPRODUCT){if(a.prd=="CL"){var f=a.msg;f.operation=="EVENT REMINDER"&&(silent||WMSUI.showRemainder(f.data))}WmsImplHandler.invoke(Collaboration.handleCrossProductMessage,a.prd,a.msg)}else if(a.mtype==ACS_MSG){var t=a.msg;typeof AcsApi!="undefined"&&WmsImplHandler.invoke(AcsApi.handlePush,t.type,t.data)}else if(a.mtype==WM_PRESENCE)var f=a.msg;else if(a.mtype==WM_ZTI_FAIL_MSG){var f=a.msg;ZTI.handleFailure(f.reason,f)}else if(a.mtype==CT_JOIN){var f=a.msg,u=f.title,h=f.chid,v=f.ctype,w=f.salesiqchat||!1;if(f.users)for(var x=0;x<f.users.length;x++){var g=$WC.Util.splitWmsFormattedString(f.users[x].s,3);f.users[x].zuid=g[0],f.users[x].uname=g[0],f.users[x].dname=g[2],WmsContacts.updateUserStatus(f.users[x].zuid,f.users[x].scode,f.users[x].st,f.users[x].smsg)}WebMessanger.liveChats.push(h),v==1&&WmsImplHandler.invoke(WmsChatUIImpl.handleNewChat,f);if(v==10){var y=f.cbdata&&JSON.parse(f.cbdata);try{ChatletImpl.handleUserList(f.entityid,f.users,y)}catch(m){}}if((v==1||v==5||v==8||v==9||v==10||v==4&&w)&&!silent){if(v!=5||!CustomChat.isActive(h,f.addinfo)){if(WmsChatUIImpl.isActive(h))return;try{if(f.silent=="true")return}catch(z){}setTimeout(function(){WmsContacts.verifyUserStatus(f.users)},1),v==8?($WC.Channels.get(f.chid)&&$WC.Channels.get(f.chid).oc_id?$WC.Channels.updateChannel(f.chid,"joined",1):$WC.Channels.setChannelsSync(!0),_WMSWINFOCUS?$WC.Channels.getChannels():$WC.Channels.setChannelsFocussed()):v==9&&(_WMSWINFOCUS?$WC.Bots.initBots():$WC.Bots.getFromServerAfterFocus()),v==="5"&&(f.prd=a.prd),f.pcount=+f.pcount,WebMessanger.mapChat(f),Chat.isExists(h)?WmsMainUI.isAutoFocusScheduled(f.chid)?WmsMainUI.removeAutoFocusSchedule(f.chid):f.pcount===2&&f.users[0]&&WmsMainUI.isAutoFocusScheduled(f.users[0].zuid)&&WmsMainUI.removeAutoFocusSchedule(f.users[0].zuid):WMSUI.createNewChatWindow(f);var A=WindowHandler.getWinObjById(h);if(f.pcount==2&&(!f.customgroup||f.customgroup=="false")){var B=f.users[0].uname;WebMessanger.storeUserInfoAndUpdateTitle(B,f.chid)}f.mutedinterval&&(A.updateMuteInfo(f.mutedinterval),WmsMainUI.setMuteStatus(h,!0)),v!=8&&v!=9&&A.updateParticipantsFromJoin(f.users),v==8&&(A.updatePartCount(f.pcount),A.updateChannelImage()),v==10&&(A.updateWebUrl(f.context),A.updateInfoMsgTemplate(f.cbdata));if(v==9){var C=f.bots&&f.bots[0];A.updateBotImage(C),A.getActions(C)}f.attached==="1"&&A.updateAttachInfo(!0)}}else v==2&&WmsImplHandler.invoke(Collaboration.handleUserList,h,f.users);(v==4||v==5)&&CustomChat.handleUserList(h,f),v==="6"&&WmsImplHandler.invoke(Presence.handleUserList,h,f),WindowHandler.checkAndHighlightChat(h)}else if(a.mtype==WM_PUB_SUB){var D=a.msg,E=D.opr;E=="pubsub.ulist"?(WmsImplHandler.invoke(PubSubApi.addUsers,D.pskey,D.psid,D.ulist),WmsImplHandler.invoke(PubSubImpl.handleUserList,D.pskey,D.ulist)):E=="pubsub.usersubscribed"?(WmsImplHandler.invoke(PubSubApi.addUsers,D.pskey,D.psid,D.ulist),WmsImplHandler.invoke(PubSubImpl.handleUserIn,D.pskey,D.ulist)):E=="pubsub.userunsubscribed"?(WmsImplHandler.invoke(PubSubApi.removeUsers,D.pskey,D.psid,D.ulist),WmsImplHandler.invoke(PubSubImpl.handleUserOut,D.pskey,D.ulist)):E=="pubsub.message"&&WmsImplHandler.invoke(PubSubImpl.handleMessage,D.pskey,D.msg)}else if(a.mtype==CT_ATT_MSG){var b=a.msg,v=b.ctype,h=b.chid,w=b.salesiqchat||!1;if((v==1||v==5||v==8||v==9||v==10||v==4&&w)&&!silent&&(w||Message.isSameBrowser(b.sid)||!b.sid&&$WC.FormFileShare.getLastUploadStatus()||!$WC.Util.isLocalUser(b.uname))&&(b.mod==="att"||b.mod==="contact"||b.mod==="location"||b.mod==="event")){$WC.FormFileShare.getLastUploadStatus()&&$WC.FormFileShare.resetLastUploadStatus();if(v!=5||!CustomChat.isActive(h,b.addinfo)){if(WmsChatUIImpl.isActive(h))return;$WC.Util.isLocalUser(b.uname)===!1&&WmsMainUI.incrementUnreadCount(h),b.m?WmsMainUI.setMuteStatus(h,!0):WmsMainUI.setMuteStatus(h,!1);if(!Chat.isExists(h)&&!b.m&&!b.h){b.pcount=+b.pcount,v==="5"&&(b.prd=a.prd);if(typeof WmsUIImpl!="undefined"&&WmsUIImpl.preventChatWindowOpen)var F=WmsImplHandler.invokeSynchronously(WmsUIImpl.preventChatWindowOpen,v,h);if(WebMessanger.isAutoJoinAllowed(b.title,b.chid)&&!F){if($WC.Util.isLocalUser(b.sender)&&b.pcount===2){var G=JSON.parse(b.t121t);delete G[b.sender];var r=Object.keys(G)[0];b.title=WmsContacts.getDisplayName(r)||G[r]}WebMessanger.prefetch_channels&&$WC.Util.isChannelChid(h)&&$WC.Channels.getLastFetchedTime()===null?($WC.Channels.initChannels(),WmsMainUI.scheduleAutoJoin(h)):v=="10"?WebMessanger.join(h):(v==="8"&&(_WMSWINFOCUS?$WC.Channels.getChannels():$WC.Channels.setChannelsFocussed()),WMSUI.createNewChatWindow(b),WindowHandler.getWinObjById(h).updateMessage(b))}Self.Idle=!0;var H=b.a==="1"?!0:!1;WmsNotification.notifyNewMessage(b,"newchat",H)}else{var i=WindowHandler.getWinObjById(h);if(i){a.msg.msgackid=a.msg.msgid,WmsFileUploadHandler.handleAckReceived(h,a.msg.msgackid),a.msg.msgid&&i.msgdisp.querySelector('[data-msgackid="'+a.msg.msgid+'"],[data-msgtime="'+a.msg.time+'"]')?i.updateMessageFragment(a.msg):i.updateMessage(a.msg);if(!b.m){var H=b.a==="1"?!0:!1;Self.Idle=!0,WmsNotification.notifyNewMessage(b,"chatmsg",H)}}}w===!1&&$WC.RecentChats.updateLastMsgInfo({chid:h,sender:b.sender,dname:b.dname,msg:b.msg,lmtime:b.time,module:b.mod});if(WmsMainUI.getUnreadCount(h)==1){$WC.RecentChats.updateLastSeenTime(h,b.time);var i=i||WindowHandler.getWinObjById(h);i&&i.showUnreadMsgs()}}}(v==4||v==5)&&!b.h&&CustomChat.handleAttachmentMessage(b)}else if(a.mtype==CT_TXT_MSG){var f=a.msg,v=f.ctype,h=f.chid,i=WindowHandler.getWinObjById(h),w=f.salesiqchat||!1;v==1&&WmsImplHandler.invoke(WmsChatUIImpl.handleChatMessage,f);if((v==1||v==5||v==8||v==9||v==10||v==4&&w)&&!silent){if(v!=5||!CustomChat.isActive(h,f.addinfo)){if(WmsChatUIImpl.isActive(h))return;if(w||Message.isSameBrowser(f.sid)&&Message.isSentFromApi(f.temp_info)||$WC.Util.isLocalUser(f.uname)===!1||v==10||v==9||Message.isBotMsg(f)||Message.isCustomMsg(f)){(i&&!i.isMsgAlreadyUpdated(f,i.ctrlcomp)||!i)&&$WC.Util.isLocalUser(f.uname)===!1&&w===!1&&WmsMainUI.incrementUnreadCount(h),f.m?WmsMainUI.setMuteStatus(h,!0):WmsMainUI.setMuteStatus(h,!1);if(!Chat.isExists(h)&&!f.m&&!f.h){if(f.sender!=="CT_INF_MSG"){f.pcount=+f.pcount,v==="5"&&(f.prd=a.prd);if(typeof WmsUIImpl!="undefined"&&WmsUIImpl.preventChatWindowOpen)var F=WmsImplHandler.invokeSynchronously(WmsUIImpl.preventChatWindowOpen,v,h);WebMessanger.isAutoJoinAllowed(f.title,f.chid)&&!F&&(WebMessanger.prefetch_channels&&$WC.Util.isChannelChid(h)&&$WC.Channels.getLastFetchedTime()===null?($WC.Channels.initChannels(),WmsMainUI.scheduleAutoJoin(h)):v=="10"?WebMessanger.join(h):(v==="8"&&(_WMSWINFOCUS?$WC.Channels.getChannels():$WC.Channels.setChannelsFocussed()),WMSUI.createNewChatWindow(f),WindowHandler.getWinObjById(h).updateMessage(f))),Self.Idle=!0;var H=f.a==="1"?!0:!1;WmsNotification.notifyNewMessage(f,"newchat",H);var i=WindowHandler.getWinObjById(h);v==="1"&&i&&i.partcount===2&&WebMessanger.storeUserInfoAndUpdateTitle(f.sender,h)}}else{Self.Idle=!0;if(i&&!i.isMsgAlreadyUpdated(f,i.ctrlcomp)){i.updateMessage(f),Message.isBotMsg(f)&&f.temp_info&&i.showBotSuggestions(f),Self.status.clear(h,f.sender);if(!f.m&&$WC.Util.isLocalUser(f.uname)===!1){var H=f.a==="1"?!0:!1;WmsNotification.notifyNewMessage(f,"chatmsg",H)}}else i&&i.updateMessageFragment(f)}}else WmsMainUI.resetUnreadCount(h),WmsMainUI.updateUnreadCountInUI(h),WmsMainUI.updateUnreadChatsCount(),i&&((f.msgid&&$WC.Util.isLocalUser(f.uname)===!1||!i.isMsgAlreadyUpdated(f,i.ctrlcomp))&&i.updateMessage(f),i.updateMessageFragment(f)),f.sid&&(w||!Message.isSameBrowser(f.sid))&&(WebMessanger.removeLiveChat(h),WindowHandler.removeWinById(h),ChatBlink.stopRepeat());w===!1&&$WC.RecentChats.updateLastMsgInfo({chid:h,sender:f.sender,dname:f.dname,msg:f,lmtime:f.time,addinfo:f.lmsgaddinfo}),WmsMainUI.getUnreadCount(f.chid)==1&&($WC.RecentChats.updateLastSeenTime(f.chid,f.time),i=i||WindowHandler.getWinObjById(f.chid),i&&i.showUnreadMsgs())}}else v==2&&WmsImplHandler.invoke(Collaboration.handleMessage,h,f.sender,f.zuid,f.dname,f.msg);(v==4||v==5)&&!f.h&&CustomChat.handleMessage(f)}else if(a.mtype==CT_CLOSE_WIN){var f=a.msg,v=f.ctype;if(v==1||v==4||v==5||v==8||v==9||v==10){var h=f.chid;WmsMainUI.resetUnreadCount(h),WmsMainUI.updateUnreadCountInUI(h),WmsMainUI.updateUnreadChatsCount(),$WC.RecentChats.updateLastSeenTime(h),WebMessanger.removeLiveChat(h),WindowHandler.removeWinById(h),ChatBlink.stopRepeat(),WmsChatCache.remove(h),Message.deletedMessages.remove(h),(v==4||v==5)&&CustomChat.handleCloseWin(h)}}else if(a.mtype==WM_AV_MSG)a.msg.ACTION=="CHAT_REQUEST"&&typeof VideoCallReceiver!="undefined"&&VideoCallReceiver.setNewWindow(WebMessanger.ismediacallnewwindow),WMSTP.handleAVMessage(a.msg);else if(a.mtype==CT_NFY_USERSTATUS){var f=a.msg,v=f.ctype,h=f.chid;if(v!=1&&v!=5||!!silent)v==2&&WmsImplHandler.invoke(Collaboration.handlePresence,h,f.uname,f.zuid,f.dname,f.status);else if(v!=5||!CustomChat.isActive(h,f.addinfo))if(f.status==0)if($WC.Util.isLocalUser(f.uname)){WebMessanger.removeLiveChat(h);try{f.close!=null&&f.close=="true"&&(WindowHandler.removeWinById(h),ChatBlink.stopRepeat())}catch(m){}}else if(WindowHandler.getWinObjById(h)){var i=WindowHandler.getWinObjById(h),I=i.partcount;i.clearTypingStatus(),i.typingindicatornode.style.display="none",f.msg="&nbsp;",silent||I==1&&Self.status.update(f)}(v==4||v==5)&&WmsImplHandler.invoke(CustomChat.handlePresence,h,f.uname,f.zuid,f.dname,f.status),v==="6"&&WmsImplHandler.invoke(Presence.handlePresence,h,f.uname,f.zuid,f.dname,f.status)}else if(a.mtype==CT_NFY_USERADD){var f=a.msg,v=f.ctype,h=f.chid;for(var x=0;x<f.users.length;x++){var g=$WC.Util.splitWmsFormattedString(f.users[x].s,3);f.users[x].uname=g[0],f.users[x].cstatus=g[1],f.users[x].dname=g[2]}v!=1&&v!=5&&v!=10||!!silent?v==2&&WmsImplHandler.invoke(Collaboration.handleUserAdd,h,f.users):(v!=5||!CustomChat.isActive(h,f.addinfo))&&WindowHandler.addParticipantsByID(h,f.users),(v==4||v==5)&&WmsImplHandler.invoke(CustomChat.handleUserAdded,h,f.users,f.pcount),v==="6"&&WmsImplHandler.invoke(Presence.handleUserAdded,h,f.users)}else if(a.mtype==CT_NFY_USERDELETE){var f=a.msg,v=f.ctype,h=f.chid;for(var x=0;x<f.users.length;x++){var g=$WC.Util.splitWmsFormattedString(f.users[x].s,3);f.users[x].uname=g[0],f.users[x].cstatus=g[1],f.users[x].dname=g[2]}v!=1&&v!=5&&v!=10||!!silent?v==2&&WmsImplHandler.invoke(Collaboration.handleUserDeleted,h,f.users):(v!=5||!CustomChat.isActive(h,f.addinfo))&&WindowHandler.deleteParticipantsByID(h,f.users),(v==4||v==5)&&WmsImplHandler.invoke(CustomChat.handleUserDeleted,h,f.users,f.pcount),v==="6"&&WmsImplHandler.invoke(Presence.handleUserDeleted,h,f.users)}else if(a.mtype==WM_NFY_COLLABADD){var f=a.msg,g=$WC.Util.splitWmsFormattedString(f.s,5);f.uname=g[0],f.zuid=g[0],f.chid=g[1],f.ctype=g[2],f.time=g[3],f.dname=g[4];var b=WindowHandler.getWinObjById(f.chid);if(b){var J=function(a){var b=a.composer;b.removeAttribute("placeholder"),b.style.cursor="",b.removeAttribute("disabled");if(a.attachmentnode){var c=a.attachmentnode.querySelector('[id="wms-file"]');c.style.cursor="",c.removeAttribute("disabled")}var d=a.smileyinvoker;d.style.cursor="",d.removeAttribute("disabled"),d.className="wms-smileyinvoker wms-valign-mid-block";if(a.actionbutton){var e=a.actionbutton;e.style.cursor="",e.removeAttribute("disabled")}};J(b),b.permdenied=!1,b.clearChatContent();var K=$WC.Util.createElement("div");K.style="display:none",K.setAttribute("data-latestchunk","true"),b.msgdisp.appendChild(K),Message.loadSpecificTranscript(h,b.msgdisp,K)}WmsImplHandler.invoke(Collaboration.handleCollabAdd,f.uname,f.dname,f.zuid,f.time,f.chid),f.ctype==="6"&&WmsImplHandler.invoke(Presence.handleUserAdd,a.msg),f.ctype==="8"&&($WC.Channels.updateChannel(f.chid,"joined",1),$WC.Channels.get(f.chid)||WebMessanger.joinChannel(f.chid)),!$WC.Util.isLocalUser(f.zuid)&&(f.ctype==="1"||f.ctype==="8"||f.ctype==="9"||f.ctype==="10")&&(WmsChatCache.remove(f.chid),Message.deletedMessages.remove(f.chid),WebMessanger.join(f.chid))}else if(a.mtype==WM_NFY_COLLABDELETE){var f=a.msg,g=$WC.Util.splitWmsFormattedString(f.s,5);f.uname=g[0],f.zuid=g[0],f.chid=g[1],f.ctype=g[2],f.time=g[3],f.dname=g[4],WmsImplHandler.invoke(Collaboration.handleCollabDelete,f.uname,f.dname,f.zuid,f.time,f.chid);var i=WindowHandler.getWinObjById(f.chid);f.ctype==="6"&&WmsImplHandler.invoke(Presence.handleUserDelete,a.msg),f.ctype==="8"&&($WC.Channels.updateChannel(f.chid,"joined",0),i&&i.close(),$WC.RecentChats.removeFromRecentChats(f.chid));if(i){i.permdenied=!0,i.disableActions();var L=$WC.Util.isLocalUser(f.zuid)?"chat.userleft":"chat.notamember";i.disableComposerOptions($WC.I18N(L))}}else if(a.mtype==CT_NFY_SETTITLE){var b=a.msg;if(b!=undefined){var M=b.msg,h=M.chid,u=M.title,i=WindowHandler.getWinObjById(h);if(!u){var N,O;if(i){var P=i.partinfo;for(var Q in P)i.partcount==2&&(N=P[Q].zuid,O=P[Q].dname)}else $WC.RecentChats.get().forEach(function(a){a.CHATID==h&&a.PARTICIPANTSCOUNT==2&&a.PARTICIPANTS.forEach(function(a){a.zuid!==WebMessanger.zuid&&(N=a.zuid,O=a.dname)})});u=$WC.Util.getContactName(N,O)}i&&WindowHandler.setTitle(h,u),$WC.RecentChats.updateTitle(h,u)}}else if(a.mtype==WM_NFY_CSTATUSCHANGE){var f=a.msg,R=WebMessanger.scode,S=f.scode,T=f.smsg;WebMessanger.scode=S,WebMessanger.smsg=T,silent||(setTimeout(function(){WmsMainUI.updateUserStatusIcon(),WmsMainUI.updateUserStatusMsg()},1),WMSUI.changedsmsg=T,WMSUI.changedscode=S,WmsChatCache.removeAll(),Message.deletedMessages.removeAll())}else if(a.mtype==WM_NFY_STATUS){if($WC.Util.checkSessionConfig("PRESENCE_PERSONAL")){var f=a.msg,U=$WC.Util.splitWmsFormattedString(f.s,5);f.zuid=U[0],f.scode=U[1],f.dname=$WC.Util.getContactName(f.zuid),f.email=U[2],f.st=U[3],f.smsg=U[4]||WmsContacts.defaultstatusmsg[f.scode],WmsImplHandler.invoke(WmsContactImpl.handlePresence,f.zuid,f.zuid,f.dname,f.scode,f.smsg);var V=WmsContacts.status(f.zuid)!==!1&&+WmsContacts.status(f.zuid);WmsContacts.updateStatus(f),WmsHybridSearch.updatePresence(f.zuid),WindowHandler.updateUserStatus(f.zuid,f.scode,f.smsg,f.st),silent||f.m||WMSUI.checkAndNotifyStatus(f,V)}}else if(a.mtype==CONTACT_INFO){var f=a.msg,W=a.meta&&a.meta.count;WmsContacts.updateContacts(f);if(!_WMSEMPTYBAR&&!silent){WmsMainUI.updateChatInvitationCount();var X=WmsContacts.getInitializedValue();WmsContacts.initialize(!0);var Y=$WC.Util.getObjectLength(WmsContacts.getContactsList());$WC.Config.get("customContacts")||setTimeout(function(){WmsHybridSearch.populateContactListInMainUI(!0);if(W<10&&W==Y){var a={};a.suggestions="show_suggestions",!_WMSEMPTYBAR&&!silent&&!$WC.Config.get("customContacts")&&WmsHybridSearch.populateContactListInMainUI(!0,a)}},1)}WmsImplHandler.invoke(WmsContactImpl.handleGetContacts)}else if(a.mtype==WM_NFY_USERIMGCHANGE)!!silent;else if(a.mtype==CT_NFY_APPROVAL){var f=a.msg,Z=!0;WmsContacts.updateContact(f),f.status==$WC.WmsConstants.CONTACTSTATUS.ACCEPT?(f.status=f.scode,WmsImplHandler.invoke(WmsContactImpl.handleAccept,f.zuid,f.uname,f.dname,f.scode,f.smsg),WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),silent||setTimeout(function(){var a={};a.suggestions="show_suggestions",WmsHybridSearch.populateContactListInMainUI(!0,a)},1)):f.status==WMS_ONLINE?($WC.Util.removeElementFromArray(WmsContacts.getInvitedContactsList(),f.zuid),WmsImplHandler.invoke(WmsContactImpl.notifyAccept,f.zuid,f.uname,f.dname,f.scode,f.smsg),f.status=f.scode,WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),silent||setTimeout(function(){WmsHybridSearch.clearInvite(f)},1)):f.status==$WC.WmsConstants.CONTACTSTATUS.REQACC?(WmsImplHandler.invoke(WmsContactImpl.handleInvite,f.zuid,f.uname,f.dname,f.scode,f.smsg),WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),silent||setTimeout(function(){WmsHybridSearch.showInvite(f)},1),Z=!1):f.status==$WC.WmsConstants.CONTACTSTATUS.UNAPRD?(WmsImplHandler.invoke(WmsContactImpl.notifyInvite,f.zuid,f.uname,f.dname,f.scode,f.smsg),WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),silent||setTimeout(function(){WmsHybridSearch.clearInvite(f)},1)):f.status==$WC.WmsConstants.CONTACTSTATUS.REJECT?(WmsImplHandler.invoke(WmsContactImpl.handleReject,f.zuid,f.uname,f.dname,f.scode,f.smsg),WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),Z=!1):f.status==$WC.WmsConstants.CONTACTSTATUS.NOCHAT?($WC.Util.removeElementFromArray(WmsContacts.getInvitedContactsList(),f.zuid),f.status=f.scode,WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),silent||setTimeout(function(){WmsHybridSearch.clearInvite(f)},1)):f.status==$WC.WmsConstants.CONTACTSTATUS.REMOVE?(WmsContacts.deletecontact(f.zuid),WmsImplHandler.invoke(WmsContactImpl.notifyRemove,f.zuid,f.uname,f.dname,f.scode,f.smsg),WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),silent||setTimeout(function(){WmsHybridSearch.clearInvite(f)},1)):f.status==$WC.WmsConstants.CONTACTSTATUS.DELETE&&(WmsImplHandler.invoke(WmsContactImpl.handleDelete,f.zuid,f.uname,f.dname,f.scode,f.smsg),WindowHandler.updateUserStatus(f.zuid,f.scode,WmsContacts.getStatusMsg(f.zuid),f.st),silent||(WmsMainUI.removeFromContactList(f.zuid),$WC.Util.removeElementFromArray(WmsContacts.getInvitedContactsList(),f.zuid),WmsMainUI.updateChatInvitationCount(),WmsContacts.deletecontact(f.zuid))),f.scode=f.status,f.dname=$WC.Util.getContactName(f.zuid,f.dname),WmsMainUI.updateChatInvitationCount(),WmsImplHandler.invoke(WmsContactImpl.handlePresence,f.zuid,f.uname,f.dname,f.status,f.smsg)}else if(a.mtype==CT_GUEST_REQ){if(!silent){var f=a.msg,$="creator="+myMsgObj.sender+"&ulist="+f.guid+"&title="+f.title+"&type=guestim";$=$+"&sid="+encodeURIComponent(WebMessanger.getSid()),$WC.Ajax.postRequest("createchat"+dext,$)}}else if(a.mtype==WM_USER_LANG_CHANGE){var f=a.msg;setTimeout(function(){WebMessanger.clearTicket(),WmsImplHandler.invoke(Collaboration.handleLanguageChange,f)},1)}else if(a.mtype==WM_SYSTEM_MSG){var f=a.msg;if(f.module=="feeddelete")ZohoFeedImpl.handleFeedDelete(f),ZMSGUI.deleteFeed();else if(f.module=="updatewmssettings")silent||WmsSettings.handleUpdateWmsSettings(f.data);else if(f.module==="cw_opr"){if(!silent){var h=f.data.chid,E=f.data.action,i=WindowHandler.getWinObjById(h);E==="pin"?WebMessanger.makeChatPinned(h):E==="unpin"&&WebMessanger.makeChatUnPinned(h),i?E==="min"?(i.minimize(),ChatBlink.stopRepeat()):E==="seen"?(i.makeNormal(),ChatBlink.stopRepeat()):E==="close"&&i.close():(WmsMainUI.resetUnreadCount(h),WmsMainUI.updateUnreadChatsCount(),WmsMainUI.updateUnreadCountInUI(h));if(E=="seen"||E=="close")$WC.RecentChats.updateLastSeenTime(h),$WC.HybridSearch.isUnreadFilterOpen()&&WmsMainUI.filterUnreadChats()}}else if(f.module==="system_msg")f.data.key==="closeticketann"&&!silent&&WMSUI.closeTicketAnnouncement();else if(f.module==="toursettings")WmsSettings.handleTourSettings(f.data.settings);else if(f.ACTION==="MODULE_STATUS_CHANGE")$WC.SecurityManager.update(f.data);else if(f.module==="custom_info"){var a=f.data;if(a.opr==="add_chatdraft"){var _={msg:a.msg,meta:a.meta,mtype:a.mtype,time:a.time,replied_to:a.replied_to,chid:a.chid};$WC.Drafts.update(a.chid,_),$WC.Drafts.updateInLocalStorage(_,!1)}else if(a.opr==="delete_chatdraft"){var ba=a.chatids;for(var x=0;x<ba.length;x++)$WC.Drafts.deleteDraft(ba[x])}}else if(f.module==="user_deactivated")WebMessanger.chatdisabled=!0,WmsSettings.adminsettings.cliqaccess=!1,WebMessanger.turnOffChat(),WMSUI.populateDeactivatedChatUI();else if(f.module==="bot"){var a=f.data,bb=a.data.data;if(a.ACTION==="BOT_SUBSCRIBED")bb.active=!0,$WC.Bots.updateBotContacts([bb]);else if(a.ACTION==="BOT_UNSUBSCRIBED")$WC.Bots.removeFromSubscribedList(bb.id);else if(a.ACTION==="BOT_UPDATED"){var bc=$WC.Bots.get(bb.id)&&$WC.Bots.get(bb.id).original_info,bd=$WC.Util.extend(!0,{},bc,bb);$WC.Bots.updateBotContacts([bd]),$WC.Util.pubsub.publish("/bots/updateui")}}else if(f.module==="COMMAND"||f.module==="command"){var a=f.data,be=a.data.data;a.ACTION==="COMMAND_CREATED"||a.ACTION==="COMMAND_EDITED"?Commands.updateList([be]):a.ACTION==="COMMAND_DELETED"&&Commands.deleteObj([be.id])}else if(f.module==="linkpreview_status_update")$WC.Config.set({zoholinks_auth:f.data.authentication_consent}),WmsMainUI.setLinkPreviewSettings();else if(f.module==="ADD_STICKY"||f.module==="DELETE_STICKY"){var bf=f.data.chat_id,bg=WindowHandler.getWinObjById(bf);bg&&(f.module==="DELETE_STICKY"?bg.clearPinnedMsg():bg.showPinnedMsg(f))}}else if(a.mtype==SHOW_INFO)wmsUserConfig.infomsgid=a.msg.id,wmsUserConfig.infomsgprd=a.prd,WMSUI.processAnnMsg(a.msg.msg,a.msg.type);else if(+a.mtype===CT_MSG_STORAGE){var bh=a.msg.opruser,i=WindowHandler.getWinObjById(a.msg.chid);bh.dname=bh.zuid===myMsgObj.zuid?$WC.I18N("chat.you"):$WC.Util.escapeHTML(bh.dname),a.msg.history==="0"?key="history.notsaved.user":key="history.saved.user",i.updateInfoMessage($WC.I18N(key,bh.dname),a.msg.time),i.updateSaveHistory(a.msg.history),i.updateSaveHistoryInUI()}else if(+a.mtype===CT_ATTACH){var h=a.msg.chid,i=WindowHandler.getWinObjById(h);i&&i.updateAttachInfo(!0)}else if(+a.mtype===WM_TICKET_MSG)WMSUI.showTicketAnnouncement(a.msg);else if(+a.mtype===PR_MSG)WmsImplHandler.invoke(Presence.handleMessage,a.msg);else if(+a.mtype===WM_DEF_STATUS){a.msg.scode==0&&(a.msg.scode=2,a.msg.smsg="Invisible"),WebMessanger.smsg=a.msg.smsg,WebMessanger.scode=a.msg.scode;if(!_WMSEMPTYBAR&&!silent)try{WmsMainUI.updateUserStatusIcon(),WmsMainUI.updateUserStatusMsg()}catch(m){}WmsImplHandler.invoke(WmsContactImpl.handleStatusMessage,a.msg.scode,a.msg.smsg)}else if(+a.mtype===CT_NFY_MUTECHAT){var i=WindowHandler.getWinObjById(a.msg.chid);i&&i.updateMuteInfo(a.msg.muteinterval),a.msg.muteinterval?WmsMainUI.setMuteStatus(a.msg.chid,!0):WmsMainUI.setMuteStatus(a.msg.chid,!1)}else if(+a.mtype===CT_BOT_LIST)var f=a.msg;else if(+a.mtype===CT_BOT_OPR){var f=a.msg,bi=f.data,C=bi.id.indexOf("b-")!=-1?bi.id.split("-")[1]:bi.id;if(f.operation==="add")bi.active=!0,bi.id=C,$WC.Bots.updateBotContacts([bi]);else if(f.operation==="remove"){var h=$WC.Bots.get(C)&&$WC.Bots.get(C).CHID;WebMessanger.makeChatUnPinned(h),$WC.Bots.removeFromSubscribedList(C)}if(!_WMSEMPTYBAR&&!silent&&!$WC.Config.get("customContacts")){var bj={};bj.suggestions="show_suggestions",WmsHybridSearch.populateContactListInMainUI(!0,bj),$WC.HybridSearch.populateRecentChats(),$WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&WmsHybridSearch.populateFrequentContactsInSmartChat()}}else if(+a.mtype===WM_ZTI_CROSSPRODUCT)WmsImplHandler.invoke(ZTI.handleCrossProductMessage,a.msg);else if(+a.mtype===CT_DELETED_MSG){var f=a.msg,bk=f.origin_time,bl=f.sender,bm=bl+"_"+bk,bn=Message.getDeletedMsgInfo(f.time),i=WindowHandler.getWinObjById(f.chid);if(i){var bo=i.ctrlcomp.querySelector('[data-msgid="'+bm+'"]');f.meta&&f.meta.prev_msg_info.attpath&&$WC.VideoPlayerFactory.removeExternalVideoPlayers(f.msguid),bo&&(f.info_visiblity==1?(bo.innerHTML=bn,bo.setAttribute("data-type",Message.types.DELETEDMSG),bo.nextSibling.className==="wms-msgtime"&&bo.nextSibling.removeAttribute("data-edited")):i.checkAndRemoveMsg(bo)),Message.deletedMessages.insert(f.chid,bk),i.clearPinnedMsg(f.chid)}else WmsChatCache.remove(f.chid),Message.deletedMessages.remove(f.chid);if(f.info_visiblity==0){$WC.DesktopNotification.close(bm);var bp=$WC.RecentChats.getLastSeenTime(f.chid);WmsMainUI.getUnreadCount(f.chid)!=0&&bp!=0&&bp<=f.origin_time&&(WmsMainUI.decrementUnreadCount(f.chid),i?i.updateBarMsgcount():WmsMainUI.updateUnreadCountInUI(f.chid),WmsMainUI.getUnreadCount(f.chid)==0&&i&&i.makeNormal())}$WC.RecentChats.get(f.chid).LMTIME==f.origin_time&&$WC.RecentChats.updateLastMsgInfo({chid:f.chid,sender:f.sender,dname:f.dname,msg:"",lmtime:f.origin_time,info_visiblity:f.info_visiblity,mtype:a.mtype})}else if(+a.mtype===CT_EDITED_MSG){var f=a.msg,bk=f.msg[0].msg.origin_time,bl=f.msg[0].msg.sender,bm=bl+"_"+bk,i=WindowHandler.getWinObjById(f.chid);i?(i.updateMessageFragment(f.msg[0],bm),i.pinmsgdetails.info.msgtime===bk&&i.updatePinnedMsg(f.msg[0]),f.msg[1]&&(f.msg[1].msg.mtype=f.msg[1].mtype,Message.constructAndAppendChatContent([f.msg[1].msg],i.msgdisp,f.chid),i.scrollDisplay())):(WmsChatCache.remove(f.chid),Message.deletedMessages.remove(f.chid)),f.msg[0].islastmsgid&&$WC.RecentChats.updateLastMsgInfo({chid:f.chid,sender:f.sender,dname:f.dname,msg:f,lmtime:bk})}else if(+a.mtype===CT_MSG_ADDL){var f=a.msg;if(f.addldatatype==="302"){var i=WindowHandler.getWinObjById(f.chid);i&&i.updatePlatformMsg(f)}if(f.addldatatype==="301"){var i=WindowHandler.getWinObjById(f.chid);if(i){var bq=f.msg,br=JSON.parse(bq.addldata);i.updateReactionData(bq.msguid,br),i.updateReactionFragment(bq.msguid),$WC.CustomMsg.msgobj[f.chid]&&$WC.CustomMsg.msgobj[f.chid][f.msguid.split("%")[0]]&&($WC.CustomMsg.msgobj[f.chid][f.msguid.split("%")[0]].reactions=JSON.parse(f.msg.addldata))}}}else if(+a.mtype===WM_WEBRTC_MSG){var f=a.msg;WmsImplHandler.invoke(Collaboration.handleWebRTCMessage,f)}},WebMessanger.mapChat=function(a){try{if(a.ctype==="5")return;var b=a.users,c=a.chid;if(a.pcount==2)var d=b[0].zuid;else var d=a.addinfo.split(":")[3];if(WebMessanger.chatmap[c]!=null&&!d&&d!=WebMessanger.chatmap[c]){delete WebMessanger.ucmap[WebMessanger.chatmap[c]],delete WebMessanger.chatmap[c];return}d&&c&&(WebMessanger.ucmap[d]=c,WebMessanger.chatmap[c]=d,WebMessanger.waitchats[d]="JOIN")}catch(e){}},WebMessanger.callClearNotification=function(){$WC.Ajax.postRequestToChat("clearnotifications.do")},WebMessanger.ClearNotificationById=function(a){var b="nid="+encodeURIComponent(a);$WC.Ajax.postRequest("clearlivenotifications"+dext,b)},WebMessanger.getChatForUser=function(a){return WebMessanger.ucmap[a]},WebMessanger.loadTranscript=function(a,b,c,d,e,f,g){Message.constructAndInsertChatContent(a,d,b,e,f,g),Message.toggleLiveZomoji(Message.getScrollableParent(d))},WebMessanger.wmsAjaxDispatcher=function(a,b,c){function q(a){var b=a.ctype,c=a.chid;if((b==="1"||b==="5"||b==="8"||b==="9"||b==="10"&&a.entityid)&&!silent)if(b!=="5"||!CustomChat.isActive(c,a.addinfo)){if(WmsChatUIImpl.isActive(c)||a.silent==="true")return;a.pcount=+a.pcount;if(a.pcount===2){var d=a.recipants.split(",");d.splice(d.indexOf(myMsgObj.zuid),1),a.sender=d[0];if(!WmsContacts.getDisplayName(a.sender))return}Chat.isExists(c)||WMSUI.createNewChatWindow(a);var e=WindowHandler.getWinObjById(c);e&&(e.showPinnedMsg(a),(b!="1"||a.customgroup=="true")&&a.recipants&&(e.recipant=a.recipants));if(b==="8"&&a.users){var f=typeof a.users=="string"?JSON.parse(a.users):a.users;e.updateParticipantsFromJoin(f)}}}if(a=="unreadmessage"){if(!WebMessanger.isCliqUser()&&c!=="NODATA"){var d=c.tableToRowList&&c.tableToRowList.ZohoMessages;$WC.RecentChats.setUnreadFeedsCount(d?d.length:0),$WC.HybridSearch.populateRecentChats(),WmsMainUI.updateUnreadChatsCount()}}else if(a=="zohomessage")ZMSGUI.fillHistory(c.tableToRowList);else if(a=="zohomsgcount"){var e=c==="NODATA"?$WC.RecentChats.getUnreadFeedsCount():JSON.parse(c);ZMSGUI.fillNavigation(e)}else if(a=="zohomessageapi")ZohoFeedImpl.handleFeedHistory(c.tableToRowList);else if(a=="zohomsgcountapi")ZohoFeedImpl.handleFeedHistoryCount(JSON.parse(c));else if(a=="zohofeedsinrange")ZohoFeedImpl.handleFeedsInRange(c.tableToRowList);else if(a=="unreadmessageapi")ZohoFeedImpl.handleUnreadFeeds(c.tableToRowList);else if(a=="onlinestatus")WmsImplHandler.invoke(Collaboration.handleIsOnline,c);else if(a=="getdefaultstatus")WebMessanger.smsg=c.smsg,WebMessanger.scode=c.scode,WmsImplHandler.invoke(WmsContactImpl.handleStatusMessage,c.scode,c.smsg);else if(a=="getcustomstatus")silent||WMSUI.populateCustomStatus(c.getRowsForTable("UserStatus")),WmsImplHandler.invoke(WmsContactImpl.handeAllStatusMessages,c.getRowsForTable("UserStatus"));else if(a!="clearcustomstatus")if(a=="addcontact"){if(!silent){if(b=="errorList"){var f="",g="",h="";for(var i in c)f=i,g=c[f];var j=WmsContacts.getDisplayName(f);!j&&typeof WmsProfileInfo!="undefined"&&(j=WmsProfileInfo.details[f]&&WmsProfileInfo.details[f].dname),g=="Same user"?h=$WC.I18N("contact.invite.sameuser",f):g=="Contact already exists"?h=j?$WC.I18N("contact.invite.exists",j):$WC.I18N("contact.invite.userexists"):j&&(h=$WC.I18N("invite.invalid.id",j));var k='<div class="wms-dialog-txtcont">'+h+"</div>",l='<div class="wms-dialog-imgouter"><div class="wms-dialog-imginner"><div class="wms-dialog-img"></div></div></div>',m={imghtml:l,bodyhtml:k,focusbutton:1,operations:[{name:$WC.I18N("OK")}]};WmsDialog.showModal(m)}if(!_WMSEMPTYBAR&&!silent&&!$WC.Config.get("customContacts")){var n={};n.suggestions="show_suggestions",WmsHybridSearch.populateContactListInMainUI(!0,n)}}}else if(a=="reinvitecontactbyemailid")silent||c&&(WMSUI.statusbar.innerHTML=$WC.I18N("Contact_successfully_reinvited"));else if(a=="gettranscript")silent||ZMSGUI.populate(c);else if(a=="deletechat")silent||ZMSGUI.handleDeleteChat();else if(a=="deleteselectedchat")silent||ZMSGUI.handleDeleteChat();else if(a=="addmember")silent||c.errorMessage=="Error adding member"&&alert($WC.I18N("The_email_address_you_entered_is_invaild"));else if(a==="createim"||a==="joinchat"||a==="attachsession")q(c);else if(a==="wmsupdsettings"||a==="updsettings")silent||WmsSettings.handleUpdateWmsSettings(c);else if(a==="joinchannel"&&!silent){if($WC.Channels.get(c.CHAT.chid))$WC.Channels.updateChannel(c.CHAT.chid,"joined",1);else{var o={joined:[c.CHANNEL]};$WC.Channels.updateList({data:o})}q(c.CHAT);var p=WindowHandler.getWinObjById(c.CHAT.chid);p.updateChannelInfo(c.CHANNEL),p.updateParticipantsFromJoin(c.CHAT.users)}},WebMessanger.presenceDispatcher=function(a,b,c){},WebMessanger.clearWaitChat=function(a){try{WebMessanger.waitchats[a]=="WAIT"&&(WebMessanger.waitchats[a]="CLEARED")}catch(b){}},WebMessanger.openUserChat=function(a,b,c,d,e){var f="autojoin=true&attach=true";f=b?f+"&type=nim":f+"&type=im",f+="&userList="+a,c&&(f+="&title="+encodeURIComponent(c)),d&&(f+="&msg="+encodeURIComponent(d)),silent||(f+="&sid="+encodeURIComponent(WebMessanger.getSid())),e&&(f+="&src="+e),$WC.Ajax.postRequestToChat("createim.do",f)},WebMessanger.chat=function(a,b){var c=WebMessanger.ucmap[a];if(WebMessanger.isChatPaused()||silent){WebMessanger.checkAndEnableChatBar(a,"",!0);return}c&&Chat.isExists(c)&&WMSUI.handleChatExist(c),WmsMainUI.scheduleAutoFocus(a);try{if(WebMessanger.waitchats[a]=="WAIT")return}catch(d){}WebMessanger.waitchats[a]="WAIT",setTimeout(WebMessanger.clearWaitChat.bind(this,a),5e3),ChatBlink.stopRepeat();var e=WebMessanger.ucmap[a];if(e!=undefined)WebMessanger.attachSession(e,b);else{var f="type=im&autojoin=true&userList="+a;silent||(f=f+"&sid="+encodeURIComponent(WebMessanger.getSid())),b&&(f+="&src="+b),$WC.Ajax.postRequestToChat("createim.do",f)}},WebMessanger.joinCollab=function(a){if(isNaN(a)||a.trim()=="")return;setTimeout(function(){var b="uname="+myMsgObj.sender+"&chid="+a;b=b+"&sid="+encodeURIComponent(WebMessanger.getSid()),$WC.Ajax.postRequest("joinchat"+dext,b)},100)},WebMessanger.attachSession=function(a,b){var c="";silent||(c="&sid="+encodeURIComponent(WebMessanger.getSid()));var d="chid="+a+c,e=function(){WMSUI.showErrorMsg($WC.I18N("message.error.openchatwindow"))};$WC.Ajax.postRequestToChat("attachsession.do",d,null,e)},WebMessanger.join=function(a){var b="",c="";silent||(b="&sid="+encodeURIComponent(WebMessanger.getSid())),c="uname="+myMsgObj.sender+"&chid="+a+b,$WC.Ajax.postRequest("joinchat"+dext,c)},WebMessanger.joinChannel=function(a){var b="",c="";silent||(b="&sid="+encodeURIComponent(WebMessanger.getSid()));var c="chid="+a+b;c+="&attach=true",$WC.Ajax.postRequestToChat("joinchannel.do",c)},WebMessanger.approveChannel=function(a){var b=function(){WMSUI.showInfoMsg($WC.I18N("channel.approved",[this.response.data.cn]))},c=function(){WMSUI.showErrorMSg($WC.I18N("event.status.update.error"))};$WC.Ajax.postRequestToChat("v1/channels/"+a+"/approve",null,b,c)},WebMessanger.rejectChannel=function(a){var b=function(){WMSUI.showInfoMsg($WC.I18N("channel.rejected",[this.response.data.cn]))},c=function(){WMSUI.showErrorMSg($WC.I18N("event.status.update.error"))};$WC.Ajax.postRequestToChat("v1/channels/"+a+"/reject",null,b,c)},WebMessanger.handleCalendarEvents=function(a){var b="api="+a,c=function(){var a=this.response?JSON.parse(this.response)[0].objString:"";a.message?WMSUI.showInfoMsg(a.message):a.errorMessage&&WMSUI.showErrorMsg(a.errorMessage)},d=function(){WMSUI.showErrorMsg($WC.I18N("event.status.update.error"))};$WC.Ajax.postRequestToChat("executesystemfunction.do",b,c,d)},WebMessanger.fetchAndShowChannelMembers=function(a,b){var c=function(){var c=this.response?JSON.parse(this.response).data.users:"",d=WindowHandler.getWinObjById(a);c&&(c.length!=1||c[0].zuid!=WebMessanger.zuid)&&(d&&d.updateParticipantsFromJoin(c),b?WMSUI.updateParticipantsList(a,c):d.autocompletediv&&(Commands.hideLoadingIcon(a),WMSUI.atMentions.init(a,d.composer)))};$WC.Ajax.requestToChat("v1/chats/"+a+"/participants",null,c)},WebMessanger.fetchTeamChannelMembers=function(a){var b=$WC.Channels.get(a),c=[];b.scid.forEach(function(a){$WC.Channels.getTeamMembersList(a)||c.push(a)});if(c.length){var d="groupid="+c.join(","),e=function(){var b=JSON.parse(this.response)[0].objString;for(var c in b)$WC.Channels.insertTeamMemberslist(c,b[c]);var d=WindowHandler.getWinObjById(a);d&&(Commands.hideLoadingIcon(a),WMSUI.atMentions.init(a,d.composer))};$WC.Ajax.requestToChat("getgroupmembers.do",d,e)}},WebMessanger.joinChannelWithUID=function(a,b){var c="v1/channels/"+a+"/join",d;b&&(d="attach=true&sid="+encodeURIComponent(WebMessanger.getSid()));var e=function(){var a=JSON.parse(this.response);WebMessanger.wmsAjaxDispatcher("joinchannel","object",a.data)};$WC.Ajax.postRequestToChat(c,d,e)},WebMessanger.quit=function(a){if(isNaN(a)||a.trim()=="")return;$WC.Ajax.postRequest("quitchat"+dext,"close=true&uname="+myMsgObj.sender+"&sid="+encodeURIComponent(WebMessanger.getSid())+"&chid="+a)},WebMessanger.verifyUserStatus=function(a,b){var c="czuid="+a+"&ccode="+b;$WC.Ajax.postRequest("verifystatus"+dext,c)},WebMessanger.setIdle=function(){function d(){var f=setTimeout(function(){$WC.Ajax.postRequest(b,c,e,d)},5e3);a++,a===3&&clearTimeout(f)}function e(){if(WebMessanger.scode==undefined&&WebMessanger.smsg==undefined){var a=WebMessanger.syncStatusMessage();a!=null?(WebMessanger.scode=a.scode,WebMessanger.smsg=a.smsg):(WebMessanger.scode=1,WebMessanger.smsg=WebMessanger.statusarr[WebMessanger.scode])}else WebMessanger.smsg==undefined&&WebMessanger.scode!=undefined&&(WebMessanger.smsg=WebMessanger.statusarr[WebMessanger.scode]);WMSUI.changedscode=WebMessanger.scode,WMSUI.changedsmsg=WebMessanger.smsg,WebMessanger.scode=4;if(WebMessanger.smsg=="Available"||WebMessanger.smsg=="Busy"){var b="Idle";WebMessanger.smsg=b}WebMessanger.isIdle=!0,WebMessanger.setIdleStatusInClient(WebMessanger.isIdle)}WmsImplHandler.invoke(WmsUIImpl.handleDocumentIdle);var a=0,b="useridle"+dext,c="sid="+encodeURIComponent(WebMessanger.getSid());$WC.Ajax.postRequest(b,c,e,d)},WebMessanger.setActive=function(){function d(){var f=setTimeout(function(){$WC.Ajax.postRequest(b,c,e,d)},5e3);a++,a===3&&clearTimeout(f)}function e(){WMSUI.changedscode!=undefined&&WMSUI.changedsmsg!=undefined?(WebMessanger.scode=WMSUI.changedscode,WebMessanger.smsg=WMSUI.changedsmsg):(WMSUI.changedscode=1,WebMessanger.scode=1),WebMessanger.smsg==undefined&&(WebMessanger.smsg=WebMessanger.statusarr[WebMessanger.scode]),WebMessanger.isIdle=!1,WebMessanger.setIdleStatusInClient(WebMessanger.isIdle)}var a=0,b="useractive"+dext,c="sid="+encodeURIComponent(WebMessanger.getSid());$WC.Ajax.postRequest(b,c,e,d)},WebMessanger.setTimeZoneOffset=function(a){_TZOFFSET=a},WebMessanger.getTranscript=function(a,b,c,d){function r(a){var c=Message.getScrollHeight(b),d=Message.getScrollTop(b);Message.restoreScrollPosition(b,c,d),a=a||this.responseText&&this.responseText.slice(0,-1),a=JSON.parse("["+a+"]");if(a.length>0){if(i||l=="insert"){if(i){if(g||h){var f=g-1,j=h,k=a.some(function(a){return a.time==f}),n=a.some(function(a){return a.time==j});if(k){var p=[];a[0].mode==="more"&&a.shift(),a.forEach(function(a){(a.mode==="more"||a.time>g)&&p.push(a)}),a=p}n&&(a=a.filter(function(a){return a.time<h}))}l==="insert"&&o!==o.parentNode.firstChild&&a[0].mode==="more"&&a.shift()}var q=a[a.length-1];q.mode==="more"&&(q=a[a.length-2]);if(h===+q.time||(CT_DELETED_MSG===+q.mtype||CT_EDITED_MSG===+q.mtype)&&h===+q.origin_time){var r=a.indexOf(q),s=b.querySelector('[data-msgid][data-msgtime="'+h+'"]');if(a[r-1]&&a[r-1].sender==q.sender||s&&s.previousSibling.getAttribute("data-senderzuid")||i&&i.split("|").length!==2||q.mtype==="16"){var t=a.pop();t.mode==="more"&&a.pop()}}if(a.length!=1&&a[a.length-1]&&a[a.length-1].mode==="more"){var u=a[a.length-1];u.mode="morebutton"}}WebMessanger.loadTranscript(a,e,l,b,o,g,h);var v=WindowHandler.getWinObjById(e);if(v){v.restoreDraftedMsg();var w=$WC.Drafts.get(e);if(w&&w.replied_to){var x=w.replied_to.split("_")[1],y=e+"|"+x;if(y===i)var z=!0}}var A=$WC.RecentChats.getLastSeenTime(e);if(A){var v=WindowHandler.getWinObjById(e);if(v){var B=v.win.querySelector('[data-msgtime="'+A+'"]'),C=v.win.querySelector("[data-unread]");if(B&&!C){var D=h?!1:!0;v.showUnreadMsgs(D)}}}if(i&&!A&&!z||i&&b.id==="wmschshtransmsg"&&ZMSG_SEARCHVALUE!=""){var E=decodeURIComponent(i).split("|")[2];i.split("|").length===2&&(E=decodeURIComponent(i).split("|")[1],Message.getScrollableParent(b).scrollTop=0,b.setAttribute("data-glowtime",E)),Message.glowBubble(E,Message.getScrollableParent(b),e)}}o&&$WC.Util.removeElement(o),m&&Message.sendmsg(e,m)}function s(){if(m){Message.sendmsg(e,m);return}g-=1;if(!i&&!g&&!h)var a="true";var c=[{messagetype:Message.types.TRANSERR,msg:{prevtime:g,nexttime:h,mentionmsgid:i,latestchunk:a}}];WebMessanger.loadTranscript(c,e,l,b,o),o&&$WC.Util.removeElement(o)}var e=a.chid,f=a.partial,g=a.fromtime,h=a.totime,i=a.mentionmsgid,j=a.salesiqchat,k=a.unreadchat,l=a.type,m=a.msgarr,n=a.lineslimit||50;if(i)var o=b.querySelector('[data-marker="'+i+'"]');else g?o=b.querySelector('[data-marker="'+(g-1)+'"]'):h?o=b.querySelector('[data-marker="'+h+'"]'):b.querySelector('[data-marker="latestchunk"]')&&(o=b.querySelector('[data-marker="latestchunk"]'));var p="gettranscriptfromrsasjson.do",q={"X-Reader-Version":1};a="chid="+e+"&tzoffset="+_TZOFFSET+"&lang="+WebMessanger.language+"&ccode="+WebMessanger.countrycode,c?(p="gettranscriptasjsonforweb.do",a="chid="+e+"&tzoffset="+_TZOFFSET,i&&(a+="&mentionmsgid="+encodeURIComponent(i)),k&&(a+="&makeread=true")):typeof f=="boolean"&&(a+="&partial="+f),$WC.Config.get("dateformat")!==undefined&&(a+="&dateformat="+encodeURIComponent($WC.Config.get("dateformat"))),d!==!0&&(a+="&lineslimit="+n),g&&(a+="&fromtime="+g),h&&(a+="&totime="+h);if(!j)return $WC.Ajax.requestToChat(p,a,r,s,null,null,q);typeof WmsUIImpl!="undefined"&&(a={chatid:e,fromtime:g,totime:h},WmsImplHandler.invoke(WmsUIImpl.getTranscript,a,r,s))},WebMessanger.renderTranscript=function(a,b,c){ZMSGUI.viewChatTranscript(b,a,null,c)},WebMessanger.clearTranscript=function(a,b){a.innerHTML="",$WC.VideoPlayerFactory.removeAllComponents(b)},WebMessanger.sendMessage=function(a,b,c){var d="chid="+a+"&sender="+myMsgObj.sender+"&msg="+encodeURIComponent(b)+"&dname="+encodeURIComponent(WebMessanger.getNickName())+"&sid="+encodeURIComponent(WebMessanger.getSid());try{c!=undefined&&c!=""&&(d+="&style="+encodeURIComponent(c))}catch(e){}$WC.Ajax.postRequest("sendmessage"+dext,d),$WC.Util.consoleWarn("WebMessanger.sendMessage javascript method is deprecated and it will be removed in upcoming release. Use WebMessanger.sendMessage java api instead")},WebMessanger.sendFormattedMessage=function(a,b,c,d,e,f,g,h,i,j){function o(a){_WMS_REQLOG.indexOf(a)!==-1&&_WMS_REQLOG.splice(_WMS_REQLOG.indexOf(a),1)}var k,l=WindowHandler.getWinObjById(a),m="chid="+a+"&msg="+encodeURIComponent(b)+"&dname="+encodeURIComponent(WebMessanger.getNickName())+"&sid="+encodeURIComponent(WebMessanger.getSid())+"&msgid="+c+"&unfurl="+l.unfurlmsg,n={"x-consents-version":"1","X-XHR-exception":!0,"X-ZCSRF-TOKEN":$WC.Util.getCSRF()};h&&(m+="&repliedmsguid="+encodeURIComponent(h)),i&&(m+="&msguid="+encodeURIComponent(i)+"&notifyedit="+j),l.unfurldata_cache_id&&(m+="&unfurl_cache_id="+l.unfurldata_cache_id,l.unfurldata_cache_id=""),_WMS_REQLOG.push(c),WMSUI.atMentions.isLocationAllowedForMentionedBots(a)&&(k=!0),Commands.getCommandId(b)&&Commands.isCommandMsg(b)&&(e=Commands.getCommandId(b),f=f?f:"&commandid="+e,g=!0,Commands.isLocationAllowedForExecution(e)&&(k=!0));var p=function(){o(c);var b=JSON.parse(this.response)[0].objString;if(b.dreResponse){var d=WindowHandler.getWinObjById(a);if(b.dreResponse.output&&b.dreResponse.output.msg)d.updateMessage(b.dreResponse.output);else if(b.dreResponse.status==="Consent"||b.dreResponse.status==="Failure"&&!$WC.Util.isEmpty(b.dreResponse.resumeUrl)){var e=new $WC.Consents;e.mountComponent(a,b.dreResponse,null,d.composer)}}if(b.mtype==CT_TXT_MSG){d=WindowHandler.getWinObjById(b.chid);if(d){var f=d.ctrlcomp.querySelector('[data-msgtime="'+b.msgid+'"]');f&&f.nextSibling&&f.nextSibling.getAttribute("data-timefrag")&&(f.nextSibling.outerHTML=Message.constructTimeFragment(b.msgid))}}};if(d&&d.length)var p=function(){o(c),Message.sendmsg(a,d)};var q=function(){o(c);var b=WebMessanger.zuid+"_"+c,e=WindowHandler.getWinObjById(a),f=e.ctrlcomp;WMSUI.handleMessageFailure(f,b),e.scrollDisplay(!0,f),d&&d.length&&Message.sendmsg(a,d)};if(g)var p=function(){o(c);var b=JSON.parse(this.response)[0].objString;if(b.dreResponse.status==="Consent"){Commands.removeProgressBar(a);var d=new $WC.Consents;d.mountComponent(a,b.dreResponse,Commands.consentsCallback,l.composer)}else b.dreResponse.output&&(b.dreResponse.output.isTempResponse=!0),Commands.showResponse(a,e,b.dreResponse)},q=function(){o(c),Commands.removeProgressBar(a)};f&&(m+=f),k?$WC.Ajax.postRequestToChatWithLocation("sendofficechatmessage.do",m,p,q,null,null,n):$WC.Ajax.postRequestToChat("sendofficechatmessage.do",m,p,q,null,null,n)},WebMessanger.muteChat=function(a,b,c){var d="chatid="+a+"&mute="+c;b!==null&&(d+="&time="+b);var e=function(){var b=WindowHandler.getWinObjById(a);b&&(b.showErrorMsg($WC.I18N("chat.mute.failed")),b.updateMuteInfo(!c))};$WC.Ajax.postRequestToChat("mutechat.do",d,"",e)},WebMessanger.serverup=function(a){WebMessanger.hideBanner(),typeof AcsApi!="undefined"&&WmsImplHandler.invoke(AcsApi.handleServerUP),WmsImplHandler.invoke(Collaboration.serverup,a),WebMessanger.systemdown=!1,!_WMSEMPTYBAR&&!silent&&(WmsChatCache.removeAll(),Message.deletedMessages.removeAll(),WmsMainUI.updateUserName(),Commands.sync=!0,WmsMainUI.updateChatInvitationCount()),WmsAVChat.setWMSConnectionStatus(!0)},WebMessanger.serverdown=function(a,b){WebMessanger.systemdown=!0,WmsImplHandler.invoke(Collaboration.serverdown),a?(clearTimeout(retryregistertimer),WebMessanger.showBanner(a,b)):iswmsframemonitorrunning||WebMessanger.showBanner(),WindowHandler.resetAllTypingStatus(),WmsContacts.removeInvitations(),WmsAVChat.setWMSConnectionStatus(!1)},WebMessanger.feedhistory=function(){ZMSGUI.launchHistory()},WebMessanger.enableSST=function(){},WebMessanger.enableTokenPairAuth=function(){this.tokenpairauth=!0,this.authtype=10},WebMessanger.documentready=function(){WmsContacts.init(),WindowHandler.init()},WebMessanger.setCSRFParamName=function(a){_WMSCFPARAMNAME=a,$WC.WmsConstants.WMSCFPARAMNAME=a,$WC.Config.set({WMSCFPARAMNAME:_WMSCFPARAMNAME})},WebMessanger.setCSRFTokenCookieName=function(a){_WMSCFCOOKIENAME=a,$WC.WmsConstants.WMSCFCOOKIENAME=a,$WC.Config.set({WMSCFCOOKIENAME:_WMSCFCOOKIENAME})},WebMessanger.setChatCSRFCookieName=function(a){_CHATCFTOKEN=a,$WC.WmsConstants.CHATCFCOOKIENAME=a,$WC.Config.set({CHATCFCOOKIENAME:_CHATCFTOKEN})},WebMessanger.setChatCSRFParamName=function(a){_CHATCFPARAMNAME=a,$WC.Config.set({CHATCFPARAMNAME:_CHATCFPARAMNAME})},WebMessanger.setBarSettingsValue=function(a){for(var b in a){if(b==undefined&&a[b]==undefined)continue;for(var c in WmsSettings.bsettings)b==c&&(WmsSettings.bsettings[c]=a[b])}var d=$WC.Util.createElement("script");d.type="text/javascript";var e=this.rebrand?this.rebrand+"_":"";if(this.loadlocalfiles){var f="",g=document.querySelector('script[src*="wms.js"]');if(g){var h=g.src.split("/");f=h[0]+"//"+h[2]}$WC.Config.set({builddomain:f}),d.src=f+"/"+_WMSCONT+"/javascript/resource/"+e+WebMessanger.language+".js"}else{var i=window.location.protocol,j=i==="https:"?wmsjsversion+"_https":wmsjsversion,k=this.jsstaticdomain+"/ichat/"+j+"/js/resource/"+e+WebMessanger.language+".js";WebMessanger.fp_hash&&(k=this.jsstaticdomain+"/ichat/js/"+WebMessanger.fp_hash["resource/"+e+WebMessanger.language+".js"]),d.src=i+"//"+k}EventsUtil.attachonload.call(d,function(){Smiley=new $WC.Zomoji({default_size:"24",animation:{default_size:"24"}}),Smiley.init=function(){},Smiley.extrasmiley_lookup=Smiley.symbol_lookup,Smiley.defaultsmiley_lookup=Smiley.symbol_lookup,Message.reactions=new $WC.Zomoji({default_size:"24",animation:{default_size:"24"}}),WmsSettings.populate()}),document.body.appendChild(d)};var wmsUserConfig={};WebMessanger.setUserConfig=function(a){wmsUserConfig=a},WebMessanger.appendGlobalSearch=function(){if(!_isGSearchAppended&&WMSUI.globalsearchenabled){var a=$WC.Util.createElement("script");a.defer=!0,a.type="text/javascript",EventsUtil.attachonload.call(a,function(){var b={onZSReady:function(){WMSUI.hidegsicon==0&&(document.getElementById("wmsglobalsearch").style.display="block"),_isGSearchAppended=!0}};zgssearch.initZGSHandler(b)}),a.src=window.location.protocol+"//"+WebMessanger.jsstaticdomain+"/zohosearch/h1/js/gshandler.js?_T="+(new Date).getTime();var b=document.getElementsByTagName("head");if(!b||b.length==0)b=[$WC.Util.createElement("head")],document.insertBefore(document.body,b[0]);b[0].appendChild(a)}},WebMessanger.appendPhoneBridge=function(){var a=document.getElementsByTagName("head");if(!a||a.length==0)a=[],a[0]=$WC.Util.createElement("head"),document.insertBefore(doc.body,a[0]);if(WMSUI.phonebridgeenabled&&wmsUserConfig.phonebridgejsurl!=undefined){var b=$WC.Util.createElement("script");b.defer=!0,b.type="text/javascript",b.src=wmsUserConfig.phonebridgejsurl,a[0].appendChild(b)}},WebMessanger.setReminder=function(a){var b=WindowHandler.getWinObjById(a.chat_id),c=function(){b.showInfoMsg($WC.I18N("reminders.add.success"))},d=function(){b.showErrorMsg($WC.I18N("reminders.add.failed"))},e={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};$WC.Ajax.postRequestToChat("v2/reminders",a,c,d,null,null,e)},WebMessanger.markReminderAsComplete=function(a,b){var c=WindowHandler.getWinObjById(b.chid),d=function(){c.showInfoMsg($WC.I18N("reminders.complete.success"))},e={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};$WC.Ajax.putRequestToChat("v2/reminders/"+a+"/complete",null,d,null,null,null,e)},WebMessanger.snoozeReminder=function(a,b,c){var d=WindowHandler.getWinObjById(c.chid),e=function(){d.showInfoMsg($WC.I18N("reminders.snooze.success"))},f={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()},g={time:b};$WC.Ajax.putRequestToChat("v2/reminders/"+a+"/snooze",g,e,null,null,null,f)},WebMessanger.parseReminderTime=function(a,b){var c=a.closest("[data-msgtime]").getAttribute("data-msgtime");if(!WebMessanger.getReminderInfo(c)){var d="time="+c,e={time:c},f=function(){var a=JSON.parse(this.response).data.time,b=this.opts.callbackargs.time,c={};c[b]=a,WebMessanger.updateReminderInfo(c),Message.updateReminderInfo(c)},g={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};$WC.Ajax.requestToChat("v1/chats/"+b+"/parsetime",d,f,null,e,null,g)}},WebMessanger.fork=function(a,b){var c={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()},d=function(){WMSUI.showErrorMsg($WC.I18N("fork.chat.failed"))};$WC.Ajax.postRequestToChat("v1/chats/"+a+"/fork",b,null,d,null,null,c)},WebMessanger.setChatTitle=function(a,b,c){var d="chid="+a+"&uname="+WebMessanger.zuid;b&&(d+="&title="+encodeURIComponent(b));var e=function(){var b=JSON.parse(this.response)[0].objString,c=b.cntid,d=b.title;b.module==="contact_rename"?WmsContacts.getContactsList(c).DNAME=d:b.module==="user_rename"&&(WmsOrgContacts.getOrgContactsList(c).DNAME=d);var e=WindowHandler.getWinObjById(a);e.setTitle(d),$WC.RecentChats.updateTitle(a,d)},f=function(){var b=WindowHandler.getWinObjById(a),d=b.partcount>2?"chat.settitle.error":"contact.rename.errormsg";b.showErrorMsg($WC.I18N(d)),b.setTitle(c)};$WC.Ajax.postRequestToChat("settitle.do",d,e,f)},WebMessanger.inviteToChannel=function(a,b){var c=$WC.Channels.get(a).oc_id,d="ulist="+encodeURIComponent(b);$WC.Ajax.postRequestToChat("v1/channels/"+c+"/invite",d)},WebMessanger.addMember=function(a,b,c){var d=c,e=b.split(",");for(var f=0,g=c.length-1;f<g;f++)b.indexOf(WmsContacts.getEmailId(d[f]))==-1&&c.splice(f,1);var h=[];for(var f=0,i=c.length-1;f<=i;f++)h.push(c[f]);var j=function(){var a=JSON.parse(this.response);a[0].objString.ERRCODE==2005&&WMSUI.showErrorMsg($WC.I18N("useradd.not.groupadmin"))};if(h.length!=0){var k="chid="+a+"&ulist="+encodeURIComponent(h),l={"X-XHR-exception":"true"};$WC.Ajax.postRequestToChat("addmember.do",k,null,j,null,null,l)}},WebMessanger.deleteMember=function(a,b){var c="chid="+a+"&ulist="+encodeURIComponent(b),d={"X-XHR-exception":"true"},e=function(){var a=JSON.parse(this.response);a[0].objString.ERRCODE==2005&&WMSUI.showErrorMsg($WC.I18N("userdelete.not.groupadmin"))};if($WC.Util.isChannelChid(a)){var f=$WC.Channels.get(a),g=f.oc_id;c="ulist="+encodeURIComponent(b),d={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()},$WC.Ajax.postRequestToChat("v1/channels/"+g+"/deletemember",c,null,null,null,null,d)}else $WC.Ajax.postRequestToChat("deletemember.do",c,null,e,null,null,d)},WebMessanger.setZIndex=function(a){var b=Math.pow(2,31)-5;a>b&&(a=b),this.setzindex=a;var c=isNaN(a)?a:+a+1;$WC.Config.set({zindex:c})},WebMessanger.getZIndex=function(){return this.setzindex},WebMessanger.disableWMSStatus=function(){this.wmsservicestatus=!1},WebMessanger.isServiceStatus=function(){return this.wmsservicestatus},WebMessanger.setServiceStatus=function(a){WMSUI.setServiceStatus(a)},WebMessanger.disableNetworkDownBanner=function(){this.disablenetworkdownbanner=!0},WebMessanger.clearTicket=function(a){var b;a!=undefined&&(b="lgtticket="+a),$WC.Ajax.request("cleariamcache"+dext,b)},WebMessanger.isPresenceEnabled=function(){return getWmsConfig()&!0||getWmsConfig()&!0?!0:!1},WebMessanger.makeChatPinned=function(a){var b=WindowHandler.getWinObjById(a);b&&b.updatePinnedInfo(!0),$WC.RecentChats.updatePinnedChat(a,!0),$WC.HybridSearch.populateRecentChats()},WebMessanger.makeChatUnPinned=function(a){var b=WindowHandler.getWinObjById(a);b&&b.updatePinnedInfo(!1),$WC.RecentChats.updatePinnedChat(a,!1),$WC.HybridSearch.populateRecentChats()},WebMessanger.removeLiveChat=function(a){var b=$WC.Util.indexOf(WebMessanger.liveChats,a);b!=-1&&WebMessanger.liveChats.splice(b,1)},WebMessanger.setHistoryStorage=function(a,b){var c="option="+a+"&chid="+b;$WC.Ajax.postRequest("sethistorystorage.do",c)},WebMessanger.pinChat=function(a,b){b?$WC.Ajax.postRequestToChat("v1/chats/"+a+"/pin"):$WC.Ajax.postRequestToChat("v1/chats/"+a+"/unpin")},WebMessanger.leaveChannel=function(a){var b=$WC.Channels.get(a).oc_id;$WC.Ajax.postRequestToChat("v1/channels/"+b+"/leave")},WebMessanger.makeChannelRead=function(a){var b="chid="+a;$WC.Ajax.postRequestToChat("makechannelread.do",b)},WebMessanger.closeTicketAnnouncement=function(){var a="sendsystemmsg.do?key=closeann";$WC.Ajax.request(a),WMSUI.closeTicketAnnouncement()},WebMessanger.turnOffChat=function(){$WC.Util.checkSessionConfig("CHAT")&&(_WMSCONFIG&=~WMSSessionConfig.CHAT,_isGSearchAppended=!1,WmsChatCache.removeAll(),Message.deletedMessages.removeAll(),$WC.WmsSessionStorage.removeItem("wms_openchats"),WindowHandler.exist=[],WebMessanger.sid=null,WebMessanger.chatdisabled===!1&&WebMessanger.allprdchatdeactivated===!1&&WebMessanger.chatdeactivated===!1&&WmsSettings.updateWmsSettings("bchatsettings","deact",null,"add"),WebMessanger.clearAndRegister())},WebMessanger.turnOnChat=function(a,b){$WC.Util.checkSessionConfig("CHAT")||(_WMSCONFIG|=WMSSessionConfig.CHAT,_isGSearchAppended=!1,WebMessanger.sid=null,WebMessanger.allprdchatdeactivated===!0?WmsSettings.updateWmsSettings("bchatsettings","deact","ALL","rem",a,b):WebMessanger.chatdeactivated===!0&&WmsSettings.updateWmsSettings("bchatsettings","deact",null,"rem",a,b),WebMessanger.clearAndRegister())},WebMessanger.unPauseChat=function(a,b){var c=function(){var b=JSON.parse(this.responseText)[0].objString;WmsSettings.handleUpdateWmsSettings(b);if(WebMessanger.chatdeactivated===!0){var c=function(){var b=JSON.parse(this.responseText)[0].objString;WmsSettings.handleUpdateWmsSettings(b),WmsImplHandler.invoke(a)};WebMessanger.turnOnChat(c,d)}else WmsImplHandler.invoke(a)},d=function(){WmsImplHandler.invoke(b)};WebMessanger.turnOnChat(c,d)},WebMessanger.isOrgUser=function(){return WebMessanger.orgid&&WebMessanger.orgid!=="-1"?!0:!1},WebMessanger.isMediaCallEnabled=function(a){var b={voice:WMSTP.isAudioEnabled,video:WMSTP.isVideoEnabled,screen:WMSTP.isScreenShareEnabled},c=a==="voice"?"audio_call":a==="video"?"video_call":"";return WmsImplHandler.invokeSynchronously(b[a])&&$WC.SecurityManager.hasPermission(c)||!1},WebMessanger.isMessageDeletionEnabled=function(){return WmsSettings.adminsettings.features&&WmsSettings.adminsettings.features.DeleteMessage&&WmsSettings.adminsettings.features.DeleteMessage.enabled},WebMessanger.getDeleteMessageTimeFrame=function(){return WmsSettings.adminsettings.features&&WmsSettings.adminsettings.features.DeleteMessage&&WmsSettings.adminsettings.features.DeleteMessage.properties&&WmsSettings.adminsettings.features.DeleteMessage.properties.timeframe},WebMessanger.isMessageEditingEnabled=function(){return WmsSettings.adminsettings.features&&WmsSettings.adminsettings.features.EditMessage&&WmsSettings.adminsettings.features.EditMessage.enabled},WebMessanger.getEditMessageTimeFrame=function(){return WmsSettings.adminsettings.features&&WmsSettings.adminsettings.features.EditMessage&&WmsSettings.adminsettings.features.EditMessage.properties&&WmsSettings.adminsettings.features.EditMessage.properties.timeframe},WebMessanger.isSpecialMentionEnabled=function(){return WmsSettings.adminsettings.features&&WmsSettings.adminsettings.features.specialmention&&WmsSettings.adminsettings.features.specialmention.enabled},WebMessanger.isReactionsEnabled=function(){return WmsSettings.adminsettings.features&&WmsSettings.adminsettings.features.reactions&&WmsSettings.adminsettings.features.reactions.enabled},WebMessanger.isUDSUploadEnabled=function(){return _UPLOADSERVERURL?!0:!1},WebMessanger.isUDSDownloadEnabled=function(){return _DOWNLOADSERVERURL?!0:!1},WebMessanger.isRegistered=function(){return WebMessanger.registered},WebMessanger.systemApiHandler=function(a,b){var c=a.split("/"),d=c[0],e=c.slice(1);switch(d){case"joinchannel":var f=e[0];$WC.Channels.isJoinedChannel(f)===!1&&WebMessanger.joinChannel(f);break;case"startchat":var g=e[0],h=WindowHandler.getWinObjById(g);h?h.highlight():WebMessanger.openUserChat(g,null,null,null,"systemapi");break;case"audiocall":var g=e[0];WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VOICE,g);break;case"videocall":var g=e[0];WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VIDEO,g);break;case"videobroadcast":var i=e[0];b.sender!==WebMessanger.zuid&&window.open(_WMSCHATURL+"joinprimetime.do?key="+encodeURIComponent(i));break;case"invite":var g=e[0];WMSUI.inviteMember(g);break;case"approvechannel":var f=e[0];WebMessanger.approveChannel(f);break;case"rejectchannel":var f=e[0];WebMessanger.rejectChannel(f);break;case"acceptevent":WebMessanger.handleCalendarEvents(a);break;case"declineevent":WebMessanger.handleCalendarEvents(a);break;case"locationpermission":var j=$WC.Config.get("LOCATION_INFO").PERMISSIONSTATE;if(j==="granted")WMSUI.showInfoMsg($WC.I18N("functions.location.granted"));else{if(typeof navigator!="undefined"&&navigator.geolocation!==undefined){var k=function(a){navigator.permissions.query({name:"geolocation"}).then(function(a){$WC.Config.get("LOCATION_INFO").PERMISSIONSTATE=a.state,a.state==="granted"?WMSUI.showInfoMsg($WC.I18N("functions.location.allowed")):WMSUI.showInfoMsg($WC.I18N("functions.location.allowed.once"))})},l=function(a){WMSUI.showErrorMsg($WC.I18N("functions.location.denied.now")),j===undefined&&($WC.Config.get("LOCATION_INFO").PERMISSIONSTATE="denied")};navigator.geolocation.getCurrentPosition(k,l)}j==="denied"&&WMSUI.showErrorMsg($WC.I18N("functions.location.denied"))}break;case"markreminderascomplete":WebMessanger.markReminderAsComplete(e[0],b);break;case"snoozereminder":WebMessanger.snoozeReminder(e[0],e[1],b);break;default:var m="api="+a+"&chid="+b.chid,k=function(){var a=this.response?JSON.parse(this.response)[0].objString:"",c=WindowHandler.getWinObjById(b.chid);a.type==="message"&&a.info&&(a.info.isTempMsg=!0,Message.constructAndAppendChatContent([a.info],c.msgdisp,b.chid))},n=function(){WMSUI.showErrorMsg($WC.I18N("event.status.update.error"))};$WC.Ajax.postRequestToChat("executesystemaction.do",m,k)}},WebMessanger.executeButtonResponseHandler=function(){var a={renderResponse:function(a,b){if(a.info)if(a.info.widget){var c=JSON.parse(a.info.widget);$WC.Widgets.construct(c)}else if(a.type==="message"){var d=WindowHandler.getWinObjById(b.chid);a.info.isTempMsg=!0,Message.constructAndAppendChatContent([a.info],d.msgdisp,b.chid),d.scrollDisplay()}},handleSystemResponse:function(a,b){if(a.type==="banner"){var c=a.info.type==="failure"?"error":"info";WMSUI.showErrorMsg(Smiley.replace(a.info.text),c)}}};return function(b,c,d){typeof a[b]=="function"&&a[b](c,d)}}(),WebMessanger.disableSmartChatKeyboardShortcut=function(){WebMessanger.smartchatshortcutdisabled=!0},WebMessanger.enableSmartChatKeyboardShortcut=function(){WebMessanger.smartchatshortcutdisabled=!1},WebMessanger.replaceChatWindowHeaderHTML=function(a,b){var c=WindowHandler.getWinObjById(a);c&&(c.headernode.innerHTML=b)},WebMessanger.closeAnnBanner=function(){WMSUI.clearBannerAndUpdate()},WebMessanger.setFrameOrigin=function(a){WebMessanger.frameorigin=a||window.location.origin},WebMessanger.updateTourSettings=function(a,b){var c="settings="+a+"&exitdetails="+b;$WC.Ajax.postRequestToChat("updatetoursettings.do",c)},WebMessanger.useLongPolling=function(){_WMS_LP="true"},WebMessanger.startAudioCall=function(a,b){b=typeof b=="boolean"?b:WebMessanger.ismediacallnewwindow,WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VOICE,a,b)},WebMessanger.startVideoCall=function(a,b){b=typeof b=="boolean"?b:WebMessanger.ismediacallnewwindow,WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VIDEO,a,b)},WebMessanger.rePopulateCustomContacts=function(){WmsHybridSearch.populateCustomContactListInMainUI()},WebMessanger.localPush=push,WebMessanger.updateContactMenuCount=function(a){WmsMainUI.updateChatInvitationCount(a)},WebMessanger.deleteMessage=function(a,b){var c=a.getAttribute("data-msguid"),d=a.getAttribute("data-msgtime"),e={msgack_key:d,sid:WebMessanger.sid},f={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF(),"Content-Type":"application/json"};$WC.Ajax.deleteRequestToChat("v2/chats/"+b+"/messages/"+c,e,null,null,null,null,f)},WebMessanger.updateReaction=function(a,b,c,d){function f(){var e=WindowHandler.getWinObjById(a);e.showErrorMsg($WC.I18N("reactions.failureinfo")),e.updateMyReactionData(b,c,!d)}var e={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};d?$WC.Ajax.deleteRequestToChat("v2/chats/"+a+"/messages/"+b+"/reactions",{emoji_code:c},null,f,null,null,e):$WC.Ajax.postRequestToChat("v2/chats/"+a+"/messages/"+b+"/reactions",{emoji_code:c},null,f,null,null,e)},WebMessanger.syncAdminSettings=function(){var a=function(a){var b=a&&a.features;b.chatdraft_lmtime&&WmsSettings.adminsettings.features.chatdrafts&&$WC.Drafts.checkAndUpdateLMTime(b.chatdraft_lmtime),WebMessanger.sync_adminsettings_onfocus=!1,$WC.Drafts.getFromServer()};$WC.Ajax.requestToChat("chatbarsync.do",null,a)},WebMessanger.markAsUnread=function(a,b,c){function e(){WMSUI.showErrorMsg($WC.I18N("message.error.markasunread"))}var d={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};$WC.Ajax.putRequestToChat("v2/chats/"+a+"/unread",{message_id:b,time:c},null,e,null,null,d)},WebMessanger.getPinnedMsg=function(a,b){var c=function(){var b=WindowHandler.getWinObjById(a);b&&b.showPinnedMsg(JSON.parse(this.response))};$WC.Ajax.requestToChat("v2/chats/"+a+"/stickymessage",null,c)},WebMessanger.pinMsg=function(a,b,c,d){var e=WindowHandler.getWinObjById(a),f=function(){e.showErrorMsg($WC.I18N("msg.pin.error"))};d=d||!1,c=c||"-1",c=parseInt(c);var g={"Content-Type":"application/json","X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF(),"x-consents-version":1},h={id:b,expiry_time:c,notify:d};$WC.Ajax.postRequestToChat("v2/chats/"+a+"/stickymessage",h,null,f,null,null,g)},WebMessanger.unpinMsg=function(a){var b=WindowHandler.getWinObjById(a),c=function(){b.showInfoMsg($WC.I18N("msg.unpin.success"))},d=function(){b.showErrorMsg($WC.I18N("msg.unpin.error"))},e={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};$WC.Ajax.deleteRequestToChat("v2/chats/"+a+"/stickymessage",null,c,d,null,null,e)},WebMessanger.disableCreateChannelLink=function(){WebMessanger.is_create_channel_link_disabled=!0},WebMessanger.disableCopyMessageLink=function(){WebMessanger.is_copy_message_link_disabled=!0},WebMessanger.disableSetReminderOption=function(){WebMessanger.is_set_reminder_option_disabled=!0},WebMessanger.preFetchChannels=function(){WebMessanger.prefetch_channels=!0},WebMessanger.disableZohoLinksSettings=function(){WebMessanger.is_zoho_links_settings_disabled=!0},WebMessanger.disableCliqFeatures=function(){WebMessanger.disableCreateChannelLink(),WebMessanger.disableCopyMessageLink(),WebMessanger.disableZohoLinksSettings()},WebMessanger.disableMsgPinOption=function(){WebMessanger.is_msgpin_option_disabled=!0},WebMessanger.storeUserInfoAndUpdateTitle=function(a,b){var c=WindowHandler.getWinObjById(b);c&&$WC.Users.getInfo(a)&&$WC.Users.getInfo(a).dname!==c.title&&WindowHandler.updateChatTitle(b,$WC.Users.getInfo(a).dname)},WebMessanger.showChatsListDialog=function(a,b,c,d,e,f){$WC.Util.isEmptyObject($WC.Channels.get())&&$WC.Channels.initChannels();var g=[{text:c,onclick:function(a){var b=[];a.forEach(function(a){var c={id:a};WmsMainUI.scheduleAutoFocus(a),WmsContacts.getContactsList(a)||WmsOrgContacts.getOrgContactsList(a)?(c.type="user",e&&WebMessanger.openUserChat(a)):$WC.Util.isChannelChid(a)?(c.type="channel",e&&WebMessanger.attachSession(a)):(c.type="chat",e&&WebMessanger.attachSession(a)),b.push(c)}),d(b)}}],h=function(){WMSUI.showErrorMsg($WC.I18N("chats.selection.limit"))},i=[$WC.WmsConstants.HYBRIDSEARCH.ORGCONTACT,$WC.WmsConstants.HYBRIDSEARCH.JOINEDCHANNEL,$WC.WmsConstants.HYBRIDSEARCH.CHAT];$WC.Participants.showChatsList(null,a,b,g,i,f,h)};var wmsjsversion="Mar_30_2020_3";(function(){function f(a,b,c){var d=b=="blur"||b=="focus";a.element.addEventListener(b,c,d)}function g(a){a.preventDefault(),a.stopPropagation()}function h(b){return a?a:b.matches?(a=b.matches,a):b.webkitMatchesSelector?(a=b.webkitMatchesSelector,a):b.mozMatchesSelector?(a=b.mozMatchesSelector,a):b.msMatchesSelector?(a=b.msMatchesSelector,a):b.oMatchesSelector?(a=b.oMatchesSelector,a):(a=n.matchesSelector,a)}function i(a,c,d){if(c=="_root")return d;if(a===d)return;if(h(a).call(a,c))return a;if(a.parentNode)return b++,i(a.parentNode,c,d)}function j(a,b,c,e,f){d[a.id]||(d[a.id]={}),d[a.id][b]||(d[a.id][b]={}),d[a.id][b][c]||(d[a.id][b][c]=[]),d[a.id][b].globalcallback||(d[a.id][b].globalcallback=f),d[a.id][b][c].push(e)}function k(a,b,c,f){if(!d[a.id])return;if(!b){for(var g in d[a.id])d[a.id].hasOwnProperty(g)&&(e[a.id].element.removeEventListener(g,d[a.id][g].globalcallback),d[a.id][g]={});delete e[a.id];return}if(!f&&!c){d[a.id][b]={},e[a.id].element.removeEventListener(b,d[a.id][g].globalcallback);return}if(!f){delete d[a.id][b][c];return}if(!d[a.id][b][c])return;for(var h=0;h<d[a.id][b][c].length;h++)if(d[a.id][b][c][h]===f){d[a.id][b][c].splice(h,1);break}}function l(a,c,f){if(!d[a][f])return;var g=c.target||c.srcElement,h,j,k={},l=0,m=0;b=0;for(h in d[a][f])d[a][f].hasOwnProperty(h)&&(j=i(g,h,e[a].element),j&&n.matchesEvent(f,e[a].element,j,h=="_root",c)&&(b++,d[a][f][h].match=j,k[b]=d[a][f][h]));c.stopPropagation=function(){c.cancelBubble=!0};for(l=0;l<=b;l++)if(k[l])for(m=0;m<k[l].length;m++){if(k[l][m].call(k[l].match,c)===!1){n.cancel(c);return}if(c.cancelBubble)return}}function m(a,b,c,e){function h(a){return function(b){l(f,b,a)}}if(!this.element)return;a instanceof Array||(a=[a]),!c&&typeof b=="function"&&(c=b,b="_root");var f=this.id,g;for(g=0;g<a.length;g++){if(e){k(this,a[g],b,c);continue}(!d[f]||!d[f][a[g]])&&n.addEvent(this,a[g],h(a[g])),j(this,a[g],b,c)}return this}function n(a,b){if(!(this instanceof n)){for(var d in e)if(e[d].element===a)return e[d];return c++,e[c]=new n(a,c),e[c]}this.element=a,this.id=b}var a,b=0,c=0,d={},e={};n.prototype.on=function(a,b,c){return m.call(this,a,b,c)},n.prototype.off=function(a,b,c){return m.call(this,a,b,c,!0)},n.matchesSelector=function(){},n.cancel=g,n.addEvent=f,n.matchesEvent=function(){return!0},typeof module!="undefined"&&module.exports&&(module.exports=n),window.Gator=n})();var WmsMainUI={};WmsMainUI._populatestatus={contactlist:!0,grouplist:!0,chatlist:!0},WmsMainUI.populate=function(){function a(){WindowHandler.chatbar=document.getElementById("wms-chatwindowcontainer"),WmsMainUI.maincontainer=document.getElementById("wmstoolbar"),WmsMainUI.menucontainer=document.getElementById("wms-menucontainer"),WmsMainUI.menubar=document.getElementById("wms_menubar"),WmsMainUI.menusearchcontainer=document.getElementById("wms_menu_searchcontainer"),WmsMainUI.statuscontainer=document.getElementById("wms_cstatus"),WmsMainUI.settingsdropdown=document.getElementById("wms_menu_settingsdropdown"),WmsMainUI.settingsdropdownicon=document.getElementById("wms_settings_dropdownicon"),WmsMainUI.settingscontainer=document.getElementById("wms_settingscontainer"),WmsMainUI.menulistcontainer=document.getElementById("wms_menu_listcontainer"),WmsMainUI.settingsnavigator=document.getElementById("wms_settingsnavigator"),WmsMainUI.menu=document.getElementById("wms_menu"),WmsMainUI.menuheader=document.getElementById("wms_menu_header"),WmsMainUI.searchdiv=document.getElementById("wms_menu_search"),WmsMainUI.usernamediv=document.getElementById("wms_menu_username"),WmsMainUI.statusmsgdiv=document.getElementById("wms_menu_userstatus"),WmsMainUI.statusiconwrapper=document.getElementById("wms_menu_userstatusiconwrapper"),WmsMainUI.chatlist=document.getElementById("wms_menu_chatlist"),WmsMainUI.defaultcontactlist=document.getElementById("wms_menu_contactlist_def"),WmsMainUI.searchrescontactlist=document.getElementById("wms_menu_contactlist_searchres"),WmsMainUI.defaultchatlist=document.getElementById("wms_menu_chatlist_def"),WmsMainUI.searchreschatlist=document.getElementById("wms_menu_chatlist_searchres"),WmsMainUI.defaultgrouplist=document.getElementById("wms_menu_grouplist_def"),WmsMainUI.searchresgrouplist=document.getElementById("wms_menu_grouplist_searchres"),WmsMainUI.unreadchatcntdiv=document.getElementById("wms_menu_unreadchats_cnt"),WmsMainUI.invitationscntdiv=document.getElementById("wms_menu_invitations_cnt"),WmsMainUI.customcontactscntdiv=document.getElementById("wms_menu_customcontacts_cnt"),WmsMainUI.servicestatusdiv=document.getElementById("wmsstatusbar"),WmsMainUI.contactdetailsdiv=document.getElementById("wms_contactdetails"),WmsMainUI.notificationholder=document.getElementById("wmsnotificationholder")}function b(){Gator(WmsMainUI.menubar).on("click","[data-menuname]",function(a){if(this.getAttribute("data-menuname")=="chat"&&ChatTour.isTourNotificationShown()){var b={welcome:{title:"",elemid:'id="wms_menubar"',align:"horizontal",content:"tourinfo.intro",position:"fixed",icon:"wms_chattour_icon"},contacts:{title:"Contacts",elemid:'data-title="Contacts"',align:"horizontal",content:"contacts.welcomemessage",position:"fixed",icon:"wms_contacts_icon"},channels:{title:"menuname.channelsandgroups",elemid:'data-title="Channels"',align:"horizontal",content:"tourinfo.channels",position:"fixed",icon:"wms_channels_icon"},chats:{title:"menuname.chats",elemid:'data-title="Chats"',align:"horizontal",content:"tourinfo.chats",icon:"wms_chats_icon"},cliq:{pointer:"none",align:"center",sethtml:'<div class="wms-hysearch wms-hvalign wms_chattour_container"><div data-operation="close" class="wms_chattour_close"></div><img src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/chatbar_onboard.png" class="wms_chattour_img"><div class="wms_chattour_info">{{CONTENT}}</div><div><button class="wms_chattour_button" data-operation="visitcliq">{{TEXT}}</button></div></div>',replacetext:{CONTENT:"tourinfo.onboarding",TEXT:"visit.cliq"}}},c=$WC.RecentChats.getRecentChatTime(),d=!1,e=WebMessanger.isCliqUser(),f;if(c){var g=432e6,h=(new Date).getTime()-g;c>h&&(d=!0)}if(e===!1&&d===!1){f=[b.welcome,b.contacts,b.channels,b.chats,b.cliq];if(WebMessanger.isOrgUser()===!1||$WC.Config.get("channels")=="disable")f=[b.welcome,b.contacts,b.chats,b.cliq]}e===!0&&d===!1&&(f=[b.welcome,b.contacts,b.channels,b.chats]),e===!1&&d===!0&&(f=[b.cliq]);if(f){ChatTour.init(f,document.getElementById("wmstoolbar"));return}}WmsMainUI.toggleMenu(this.getAttribute("data-menuname"),a),WmsMainUI.updateUnreadChatsCount()}),WmsMainUI.bindRecentChatEvents(),Gator(WmsMainUI.menubar).on("mouseenter",function(){$WC.RecentChats.getPinnedChatsLastFetchedTime()===null&&WebMessanger.getPinnedChats()}),Gator(WmsMainUI.settingscontainer).on("click","[data-navigator]",function(){WmsMainUI.settingsdropdownicon.setAttribute("data-settings","false"),WmsMainUI.settingsdropdown.style.display="block",WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings_close"),WmsMainUI.toggleSettings()}),Gator(WmsMainUI.settingsdropdown).on("click","[data-operation]",function(){var a=this.getAttribute("data-operation");a==="wms_menu_settings"?(WmsMainUI.settingsdropdown.style.display="none",WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings_close"),WmsMainUI.toggleSettings(),WebMessanger.is_zoho_links_settings_disabled||WmsMainUI.setLinkPreviewSettings()):a==="wms_menu_status"?(WmsMainUI.settingsdropdown.style.display="none",WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings_close"),WmsMainUI.toggleStatus()):a==="wms_menu_chathistory"?(WmsMainUI.settingsdropdown.style.display="none",WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings"),WmsMainUI.settingsdropdownicon.setAttribute("data-settings","true"),$WC.Channels.initChannels(),ZMSGUI.showChatHistory()):a==="wms_menu_feedhistory"?(WmsMainUI.settingsdropdown.style.display="none",WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings"),WmsMainUI.settingsdropdownicon.setAttribute("data-settings","true"),ZMSGUI.launchHistory()):a==="wms_menu_pendinginvitations"&&(WmsMainUI.settingsdropdown.style.display="none",WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings"),WmsMainUI.settingsdropdownicon.setAttribute("data-settings","true"),WmsMainUI.showPendingInvitations())}),Gator(WmsMainUI.searchdiv).on("keydown",function(a){if(a.keyCode===$WC.WmsConstants.KEYCODES.ESCAPE)WmsMainUI.hideMenu();else{if(a.keyCode===$WC.WmsConstants.KEYCODES.TAB&&a.shiftKey)return WindowHandler.moveFocus("",!0),!1;if(a.keyCode===$WC.WmsConstants.KEYCODES.TAB)return WindowHandler.moveFocus(),!1;WmsHybridSearch.handleEvent(a)}}),Gator(WmsMainUI.searchdiv).on("keyup",function(a){WmsHybridSearch.handleKeyUp(a),$WC.Util.loadOriginalImage($WC.HybridSearch.getNode("searchresultdiv",$WC.HybridSearch.getCurrentModule()))}),Gator(WmsMainUI.searchdiv).on("focus",function(){WindowHandler.lastViewed=-1}),Gator(WmsMainUI.maincontainer,WindowHandler.chatbar).on("click","[data-zcprofileid]",function(a){WmsMainUI.handleProfileClick(this,a)}),Gator(document).on("click","[custom_message]",function(a){$WC.CustomMsgUI.handleMoreMessage(a)}),Gator(WmsMainUI.contactdetailsdiv).on("click","[data-operation]",function(){WmsMainUI.handleProfileActions(this)}),Gator(WmsMainUI.contactdetailsdiv).on("mouseout",function(a){WmsMainUI.handleProfileMouseOut(this,a)}),Gator(WmsMainUI.menuheader).on("click","[data-minimize]",function(){WmsMainUI.hideMenu()}),Gator(WmsMainUI.menuheader).on("click","[data-settings]",function(){if(this.getAttribute("data-settings")==="true"){this.setAttribute("data-settings","false");var a='<div id="wms_menu_chathistory" data-operation="wms_menu_chathistory" class="wms_menu_settingsdropdown_item"><span class="wms_menu_userstatusiconwrapper"><div class="wms_chathistory_icon"></div></span><div class="wms_menu_settingsname wms-hvalign">'+$WC.I18N("Chat_History")+"</div>"+"</div>";WebMessanger.isCliqUser()&&(a='<div id="wms_menu_chathistory" data-operation="wms_menu_chathistory" class="wms_menu_settingsdropdown_item"><span class="wms_menu_userstatusiconwrapper"><div class="wms_chathistory_icon"></div></span><div class="wms_menu_settingsname wms-hvalign">'+$WC.I18N("chat.message.search")+"</div>"+"</div>");var b=a+'<div id="wms_menu_status" data-operation="wms_menu_status" class="wms_menu_settingsdropdown_item">'+'<span class="wms_menu_userstatusiconwrapper">'+'<div class="wms_statuschange_icon"></div>'+"</span>"+'<div class="wms_menu_settingsname wms-hvalign">'+$WC.I18N("user.status.change")+"</div>"+"</div>"+'<div id="wms_menu_settings" data-operation="wms_menu_settings" class="wms_menu_settingsdropdown_item">'+'<span class="wms_menu_userstatusiconwrapper">'+'<div class="wms_settings_icon"></div>'+"</span>"+'<div class="wms_menu_settingsname wms-hvalign">'+$WC.I18N("Settings")+"</div>"+"</div>";if(!WebMessanger.isCliqUser()||!$WC.SecurityManager.hasPermission("taz"))b+='<div id="wms_menu_feedhistory" data-operation="wms_menu_feedhistory" class="wms_menu_settingsdropdown_item"><span class="wms_menu_userstatusiconwrapper"><div class="wms_feedhistory_icon"></div></span><div class="wms_menu_settingsname wms-hvalign">'+$WC.I18N("Feed_History")+"</div>"+"</div>";WmsContacts.getPendingInvitedContactsList().length&&(b+='<div id="wms_menu_pendinginvitations" data-operation="wms_menu_pendinginvitations" class="wms_menu_settingsdropdown_item"><span class="wms_menu_userstatusiconwrapper"><div class="wms_pendinginv_icon"></div></span><div class="wms_menu_settingsname wms-hvalign">'+$WC.I18N("chat.pending.invitations")+"</div>"+"</div>"),WmsMainUI.settingsdropdown.innerHTML=b,WmsMainUI.settingsdropdown.style.display="block",this.setAttribute("class","wms_settings_close")}else this.setAttribute("data-settings","true"),WmsMainUI.settingsdropdown.style.display="none",this.setAttribute("class","wms_settings"),WmsMainUI.hideStatus();WmsMainUI.hideSettings()}),Gator(WmsMainUI.menuheader).on("click","[data-statuseditor='false']",function(){WmsMainUI.showStatusEditor()}),Gator(WmsMainUI.menuheader).on("blur","[data-statuseditor]",function(){WmsMainUI.statusmsgdiv.setAttribute("data-statuseditor","false"),$WC.$CUtil.setInnerText(WmsMainUI.statusmsgdiv,$WC.Util.unescapeHTML(WebMessanger.smsg))}),Gator(WmsMainUI.settingscontainer).on("change","input[type=checkbox]",function(a){WmsMainUI.updateSettings(a)}),Gator(WmsMainUI.settingscontainer).on("change","select[data-select]",function(a){WmsMainUI.updateSettings(a)}),Gator(WmsMainUI.usernamediv).on("click",function(){var a=0;return function(){a++,a>=3&&(WebMessanger.postDebugInfoToServer(!0),a=0),setTimeout(function(){a=0},3e3)}}()),document.getElementById("wmsglobalsearch")&&Gator(document.getElementById("wmsglobalsearch")).on("click",function(){zgssearch.toggleGlobalsearch()}),_WMSEMPTYBAR||($WC.Util.addEvent(WmsMainUI.defaultchatlist,"scroll",$WC.Util.debounce(WmsHybridSearch.checkScrollAndloadMoreChatlist,null,300)),$WC.Util.addEvent(WmsMainUI.defaultcontactlist,"scroll",$WC.Util.loadImageWithDebounce(WmsMainUI.defaultcontactlist)),$WC.Util.addEvent(WmsMainUI.searchrescontactlist,"scroll",$WC.Util.loadImageWithDebounce(WmsMainUI.searchrescontactlist)),$WC.Util.addEvent(WmsMainUI.defaultgrouplist,"scroll",$WC.Util.loadImageWithDebounce(WmsMainUI.defaultgrouplist)),$WC.Util.addEvent(WmsMainUI.searchresgrouplist,"scroll",$WC.Util.loadImageWithDebounce(WmsMainUI.searchresgrouplist)),$WC.Util.addEvent(WmsMainUI.defaultchatlist,"scroll",$WC.Util.loadImageWithDebounce(WmsMainUI.defaultchatlist)),$WC.Util.addEvent(WmsMainUI.searchreschatlist,"scroll",$WC.Util.loadImageWithDebounce(WmsMainUI.searchreschatlist)))}document.getElementById("wmstoolbar")&&$WC.Util.removeElement(document.getElementById("wmstoolbar"));var c='<div id="wms_menubar" class="wms_menubar"><span data-menuname="chat" class="wms-menubutton wms_chatsicon" data-title="'+$WC.I18N("menuname.chats")+'" title="'+$WC.I18N("menuname.chats")+'"><span id="wms_menu_unreadchats_cnt" class="wms_menu_chat_unreadcnt"></span></span>'+'<span data-menuname="channel" class="wms-menubutton wms_groupicon" data-title="'+$WC.I18N("menuname.channelsandgroups")+'" title="'+$WC.I18N("menuname.channelsandgroups")+'"></span>'+'<span data-menuname="contact" class="wms-menubutton wms_contacticon" data-title="'+$WC.I18N("Contacts")+'" title="'+$WC.I18N("Contacts")+'"><span id="wms_menu_invitations_cnt" class="wms_menu_chat_unreadcnt"></span></span>'+"</div>",d='<span class="wms_bar_movablehint" id="wmsbarmovablehint">'+$WC.I18N("hint.smartchat")+"</span>",e='<div class="wms-chatwindowcontainer" id="wms-chatwindowcontainer">'+d+"</div>",f='<div id="wms_menu_header" class="wms_menuheader"><span id="wms_menu_userstatusiconwrapper" class="wms_menu_userstatusiconwrapper"><img src="'+_WMSPHOTOSERVER+"/file?fs=thumb"+$WC.Util.nocachefix(!0)+'"/></span><div id="wms_menu_username" class="wms_menu_username wms-truncate-ellipsis"></div><span data-minimize=true class="wms_minimizeicon wms_menu_minimize"></span><div id="wms_menu_userstatus" data-statuseditor="false" class="wms_menu_userstatus wms-truncate-ellipsis"></div><span id="wms_settings_dropdownicon" class="wms_settings" data-settings="true"></span></div>',g='<div id="wms_menu_settingsdropdown" data-settingsdropdown="true" class="wms_menu_settingsdropdown"></div>',h='<div id="wms_cstatus" data-showstatus="false" class="wmspd1" style="display:none; overflow-x: hidden;"></div>',i='<div id="wms_menu_searchcontainer" class="wms_menu_searchcontainer"><span class="wms_menu_searchicon wms_searchicon"></span><input id="wms_menu_search" type="text" class="wms_menu_searchinput" autocomplete="off" placeholder="'+$WC.I18N("search.commontitle")+'">'+"</div>",j='<div id="zoho_links_privacy" class="wms_settings_general"><span>'+$WC.I18N("urlconsent.zoholinkprivacy")+"</span>"+'<div id="wms_zoholinks_settings" class="wms_zoholinks_settings"><div id="zoholinks_loading_div" class="wms_loading_div"></div></div></div>';WebMessanger.is_zoho_links_settings_disabled&&(j="");var k='<div id="wms_settingscontainer" style="display:none" data-showsettings="false"><div id="wms_settings_header" class="wms_settings_header"><span id="wms_settingsnavigator" data-navigator="settings" class="wms_settingsnavigator wms_menu_floatl"></span><span class="wms_settings_menu">'+$WC.I18N("Settings")+"</span></div>"+'<div id="wms_settings_general" class="wms_settings_general"><span>'+$WC.I18N("settings.general")+"</span>"+'<div class="wms_settings_chckbx"><span data-type="custom" class="wms_settings_customcheckbox"></span><input id="wms_settings_pausechat" type="checkbox" class="wms_settings_checkbox"/><label class="wms_settings_label" for="wms_settings_pausechat">'+$WC.I18N("chat.pause")+"</label></div>"+"</div>"+'<div id="wms_settings_soundnotification" class="wms_settings_general"><span>'+$WC.I18N("notification.sound")+"</span>"+'<div class="wms_settings_chckbx"><span data-type="custom" class="{{SOUNDSETTING}}"></span><input {{SOUNDCHECK}} id="wms_settings_sound" data-setting="sound" type="checkbox" class="wms_settings_checkbox"/><label class="wms_settings_label" for="wms_settings_sound">'+$WC.I18N("notification.message.new")+"</label></div>"+"</div>"+'<div id="wms_settings_visualnotification" class="wms_settings_general"><span>'+$WC.I18N("notification.desktop")+"</span>"+'<div class="wms_settings_chckbx"><span data-type="custom" class="{{VMYMESSAGE}}"></span><input {{VMYMESSAGECHECK}} id="wms_settings_visual_mymsg" data-setting="vmymessage" type="checkbox" class="wms_settings_checkbox"/><label class="wms_settings_label" for="wms_settings_visual_mymsg">'+$WC.I18N("notification.mymsg")+"</label></div>"+'<div class="wms_settings_chckbx"><span data-type="custom" class="{{VMENTION}}"></span><input {{VMENTIONCHECK}} id="wms_settings_mention_msg" data-setting="vmention" type="checkbox" class="wms_settings_checkbox"/><label class="wms_settings_label" for="wms_settings_mention_msg">'+$WC.I18N("notification.mentionmsg")+"</label></div>"+'<div class="wms_settings_chckbx"><span data-type="custom" class="{{GROUPMESSAGE}}"></span><input {{GROUPMSGCHECK}} id="wms_settings_group_msg" data-setting="groupmessage_visual_notify" type="checkbox" class="wms_settings_checkbox"/><label class="wms_settings_label" for="wms_settings_group_msg">'+$WC.I18N("notification.groupmsg")+"</label></div>"+'<div class="wms_settings_chckbx"><span data-type="custom" class="{{BOTMESSAGE}}"></span><input {{BOTMSGCHECK}} id="wms_settings_bot_msg" data-setting="botmessage_visual_notify" type="checkbox" class="wms_settings_checkbox"/><label class="wms_settings_label" for="wms_settings_bot_msg">'+$WC.I18N("notification.botmsg")+"</label></div>"+'<div class="wms_settings_chckbx"><span data-type="custom" class="{{VUSTATUS}}"></span><input {{VUSTATUSCHECK}} id="wms_settings_visual_statuschange" data-setting="vustatus" type="checkbox" class="wms_settings_checkbox"/><label class="wms_settings_label" for="wms_settings_visual_statuschange">'+$WC.I18N("notification.status.change")+"</label></div>"+"</div>"+j+"</div>";k=$WC.template.replace(k,{SOUNDSETTING:WmsSettings.sound==="1"?"wms_settings_customcheckboxsel":"wms_settings_customcheckbox",VMYMESSAGE:WmsSettings.vmymessage==="1"?"wms_settings_customcheckboxsel":"wms_settings_customcheckbox",VMENTION:WmsSettings.vmention==="1"?"wms_settings_customcheckboxsel":"wms_settings_customcheckbox",GROUPMESSAGE:WmsSettings.groupmessage_visual_notify==="1"?"wms_settings_customcheckboxsel":"wms_settings_customcheckbox",BOTMESSAGE:WmsSettings.botmessage_visual_notify==="1"?"wms_settings_customcheckboxsel":"wms_settings_customcheckbox",VUSTATUS:WmsSettings.vustatus==="1"?"wms_settings_customcheckboxsel":"wms_settings_customcheckbox",SOUNDCHECK:WmsSettings.sound==="1"?"checked":"",VMYMESSAGECHECK:WmsSettings.vmymessage==="1"?"checked":"",VMENTIONCHECK:WmsSettings.vmention==="1"?"checked":"",GROUPMSGCHECK:WmsSettings.groupmessage_visual_notify==="1"?"checked":"",BOTMSGCHECK:WmsSettings.botmessage_visual_notify==="1"?"checked":"",VUSTATUSCHECK:WmsSettings.vustatus==="1"?"checked":""});var l='<div id="wms-pasteCapture" class="wms-pastediv" contenteditable="true"></div>',m=$WC.Config.get("customContacts")&&$WC.Config.get("customContacts").welcomemsg?$WC.Config.get("customContacts").welcomemsg:$WC.I18N("contacts.welcomemessage"),n=WebMessanger.is_create_channel_link_disabled?$WC.I18N("channel.create.new"):'<a class="wms_welcome_msg_href" target="blank" href="'+_WMSCHATURL+'officechat/index.do#createchannel">'+$WC.I18N("channel.create.new")+"</a>",o='<div id="wms_menu" class="wms-menu">'+f+g+h+i+k+'<div id="wms_menu_listcontainer" class="wms_menu_listcontainer">'+'<div data-menuname="chat" id="wms_menu_chatlist"><div id="wms_menu_chatlist_def" class="wms_menu_chatlist_def"><div id="wms_welcome_recentchatsmsg"><div class="wms-welcome-img wms-welcome-recentchatsimg wms-halign"></div><div class="wms-welcome-msg wms-halign">'+$WC.I18N("recentchats.welcomemessage",['<span data-menuredirect="contact">'+$WC.I18N("chat.contact")+"</span>",'<span data-menuredirect="channel">'+$WC.I18N("chat.channel")+"</span>"])+'</div></div></div><div id="wms_menu_chatlist_searchres" class="wms_menu_chatlist_searchres"></div></div>'+'<div data-menuname="channel" id="wms_menu_grouplist"><div id="wms_menu_grouplist_def" class="wms_menu_grouplist_def"><div class="wms-welcome-img wms-welcome-channelsimg wms-halign"></div><div class="wms-welcome-msg wms-halign">'+$WC.I18N("channels.welcomemessage",n)+'</div></div><div id="wms_menu_grouplist_searchres" class="wms_menu_grouplist_searchres"></div></div>'+'<div data-menuname="contact" id="wms_menu_contactlist"><div id="wms_menu_contactlist_def" class="wms_menu_contactlist_def"><div class="wms-welcome-img wms-welcome-contactsimg wms-halign"></div><div class="wms-welcome-msg wms-halign">'+$WC.I18N("contacts.welcomemessage")+'</div></div><div id="wms_menu_contactlist_searchres" class="wms_menu_contactlist_searchres"></div></div>'+'<div data-menuname="customcontact" id="wms_menu_customcontactlist"><div id="wms_menu_customcontactlist_def" class="wms_menu_customcontactlist_def"><div class="wms-welcome-img wms-welcome-contactsimg wms-halign"></div><div class="wms-welcome-msg wms-halign">'+m+'</div></div><div id="wms_menu_customcontactlist_searchres" class="wms_menu_customcontactlist_searchres"></div></div>'+"</div></div>",p='<div class="wms-turnoffinfo" id="chatturnoffinfo" style="display: none;">'+$WC.I18N("chat.paused")+' <a style="cursor: pointer;" data-unpausechat="true" >'+$WC.I18N("chat.unpause")+"</a></div>",q='<div id="wms_incomingcall"class="wms_incomingcall"><div id="wms_caller_container" class="wms_caller_container"><img id="wms_callerimg" class="wms_caller_img"></img><span id="wms_calltype" class="wms_calltype wms-halign"></span><span id="wms_callername" class="wms_callername wms-halign"></span><div class="wms_videocall_buttons_list wms_incomingcall_buttons"><div id="wms_answercall_button"class="wms_videocall_button wms_answercall_button" call-action="acceptcall" title="'+$WC.I18N("mediacall.incoming.accept")+'"></div>'+'<div class="wms_videocall_button wms_replymsg_button" call-action="replycall" style="display: none;"></div>'+'<div id="wms_rejectcall_button" class="wms_videocall_button wms_rejectcall_button" call-action="rejectcall" title="'+$WC.I18N("mediacall.incoming.reject")+'"></div></div></div>'+"</div>",r='<div id="wmsglobalsearch" title="'+$WC.I18N("GS_Search_across_zoho")+'" class="wms-gssearch"><span class="wms_searchicon"></span></div>',s='<div id="wmsphonebridge" class="wms_phonebridgecontainer"></div>',t='<div id="wmsnotificationholder" class="wms-nh"></div>',u='<div id="wmsstatusbar" class="wmsstatusbar"></div>',v='<div id="wms_contactdetails" class="wms_contactdetails"></div>',w=l+'<div id="wms-menucontainer" class="wms-menucontainer">'+o+c+"</div>";_WMSEMPTYBAR&&(w=l+'<div id="wms-menucontainer" class="wms-menucontainer" style="width:0px;"></div>',e='<div class="wms-chatwindowcontainer" id="wms-chatwindowcontainer"></div>'),w+=t,WMSUI.globalsearchenabled&&(w+=r),WMSUI.phonebridgeenabled&&(w+=s),w+=u,w+=p,w+=q,w+=e;var x=$WC.Util.createElement("div","wmstoolbar","wms-mainui");x.style.zIndex=WebMessanger.setzindex,x.innerHTML=$WC.template.replace(w),document.body.appendChild(x);var y=document.getElementById("wms_contactdetails");y&&$WC.Util.removeElement(y),document.body.insertAdjacentHTML("beforeend",v),WmsMainUI.applyChatBarOptions(),a(),b(),$WC.Config.get("channels")=="disable"&&WmsMainUI.removeChannelMenu();if($WC.Config.get("customContacts")&&!$WC.Config.get("customContacts").separatePane){var z=$WC.Config.get("customContacts"),A=WmsMainUI.menubar.querySelector('[data-menuname="contact"]');z.title&&A.setAttribute("data-title",z.title)}WmsMainUI.contactdetailsdiv.style.zIndex=isNaN(WebMessanger.setzindex)?"1":+WebMessanger.setzindex+3,!_WMSEMPTYBAR&&!WebMessanger.registerAnnonUser&&setTimeout(function(){WebMessanger.appendGlobalSearch()},1),$WC.Util.isEmpty(WmsSettings.adminsettings.moduleconfig)&&WmsSettings.initModulesPermissions(),WmsMainUI.updateUserName(),typeof WmsUIImpl!="undefined"&&WmsUIImpl.UIReady()},WmsMainUI.applyChatBarOptions=function(){var a=WmsImplHandler.invokeSynchronously(WmsUIImpl.getChatBarOptions),b={};b.customContacts=WmsImplHandler.invokeSynchronously(WmsUIImpl.customContactsConfig),$WC.Config.set(a),$WC.Config.set(b);if($WC.Config.get("customContacts")&&$WC.Config.get("customContacts").separatePane&&WmsMainUI.menubar.querySelector('[data-menuname="customcontact"]')===null){var c=$WC.Config.get("customContacts").title?$WC.Config.get("customContacts").title:$WC.I18N("Contacts");WmsMainUI.menubar.insertAdjacentHTML("beforeend",'<span data-menuname="customcontact" class="wms-menubutton wms_contacticon '+$WC.Config.get("customContacts").customContactsIconClassName+'" data-title="'+c+'" title="'+c+'"><span id="wms_menu_customcontacts_cnt" class="wms_menu_chat_unreadcnt"></span></span>')}},WmsMainUI.handleSettings=function(a,b){var c=b.parentNode.querySelector('[data-type="custom"]');b&&a=="1"?c.setAttribute("class","wms_settings_customcheckboxsel"):c.setAttribute("class","wms_settings_customcheckbox")},WmsMainUI.showStatusEditor=function(){var a=$WC.Util.getInnerText(WmsMainUI.statusmsgdiv);WmsMainUI.statusmsgdiv.innerHTML='<textarea data-editor="true" id="wms_menu_statuseditor" class="wms_menu_userstatus_textarea"></textarea>',document.getElementById("wms_menu_statuseditor").value=a,document.getElementById("wms_menu_statuseditor").focus(),Gator(WmsMainUI.menuheader).on("keydown","[data-editor='true']",function(a){if(a.keyCode===$WC.WmsConstants.KEYCODES.ENTER||a.keyCode===$WC.WmsConstants.KEYCODES.ESCAPE){WmsMainUI.statusmsgdiv.setAttribute("data-statuseditor","false");var b=a.target.value;a.keyCode===$WC.WmsConstants.KEYCODES.ESCAPE||!b?$WC.$CUtil.setInnerText(WmsMainUI.statusmsgdiv,$WC.Util.unescapeHTML(WebMessanger.smsg)):WebMessanger.smsg!==b?WMSUI.handleStatusChange(b,a):$WC.$CUtil.setInnerText(WmsMainUI.statusmsgdiv,$WC.Util.unescapeHTML(b))}}),WmsMainUI.statusmsgdiv.setAttribute("data-statuseditor","true")},WmsMainUI.updateSettings=function(a){var b=$WC.Util.getEventTarget(a),c=b.getAttribute("id");if(c==="wms_settings_pausechat")WebMessanger.chatdeactivated?WebMessanger.turnOnChat():WebMessanger.turnOffChat();else if(c==="wms_settings_sound")WMSUI.toggleSound();else if(c.indexOf("wms_settings_visual")!=="-1"){var d=b.getAttribute("data-setting");WMSUI.reqNotificationPermAndToggle(d)}else c==="zoholinkspermission"&&$WC.updateLinkPreviewSettings(b.selectedOptions[0].value)},WmsMainUI.updateUserName=function(){WmsMainUI.usernamediv&&WebMessanger.nname&&(WmsMainUI.usernamediv.setAttribute("title",WebMessanger.nname),$WC.$CUtil.setInnerText(WmsMainUI.usernamediv,WebMessanger.nname))},WmsMainUI.updateUserStatusIcon=function(){var a={0:"offline",1:"available",2:"offline",3:"busy",4:"idle",7:"away"},b=WebMessanger.scode;if(b){var c=a[b];WmsMainUI.statusiconwrapper.className="wms_menu_userstatusiconwrapper wms_badge_statusicon_"+c}},WmsMainUI.updateUserStatusMsg=function(){WmsMainUI.statusmsgdiv.setAttribute("title",$WC.Util.unescapeHTML(WebMessanger.smsg)),$WC.$CUtil.setInnerText(WmsMainUI.statusmsgdiv,$WC.Util.unescapeHTML(WebMessanger.smsg))},WmsMainUI.updateContactHTML=function(a,b){var c=a.USERID,d=WmsMainUI.defaultcontactlist.querySelector('[data-id="'+c+'"]')||WmsMainUI.searchrescontactlist.querySelector('[data-id="'+c+'"]');if(d){var e=d.previousSibling,f=d.parentNode;$WC.Util.removeElement(d);var g=$WC.HybridSearch.generateContactHtml(a.USERID,a.DNAME,a.STATUSMSG,"",b);e?e.insertAdjacentHTML("afterend",g):f.insertAdjacentHTML("afterbegin",g)}},WmsMainUI.updateChatHTML=function(a){var b=WmsMainUI.chatlist.querySelector('[data-userid="'+a+'"]')||WmsMainUI.searchreschatlist.querySelector('[data-userid="'+a+'"]');if(b){var c=b.getAttribute("data-id"),d=$WC.RecentChats.get(c),e=$WC.HybridSearch.generateImageHtml(c,$WC.WmsConstants.HYBRIDSEARCH.CHAT,d);$WC.Util.removeElement(b.firstChild),b.insertAdjacentHTML("afterbegin",e)}},WmsMainUI.toggleMenu=function(a){var b=WmsMainUI.menubar.querySelector("[data-menuname="+a+"]");b.getAttribute("data-selected")==="true"?WmsMainUI.hideMenu():WmsMainUI.showMenu(a)},WmsMainUI.hideMenu=function(){if(WmsMainUI.menubar){var a=WmsMainUI.menubar.querySelector("[data-selected=true]");a&&a.setAttribute("data-selected","false"),WmsMainUI.menu.style.display="none",WmsMainUI.settingsdropdown.style.display="none",WmsMainUI.updateUnreadChatsCount()}},WmsMainUI.removeChannelMenu=function(){if(WmsMainUI.menubar){var a=WmsMainUI.menubar.querySelector('[data-menuname="channel"]');a&&WmsMainUI.menubar.removeChild(a)}},WmsMainUI.toggleSettings=function(){var a=WmsMainUI.settingscontainer.getAttribute("data-showsettings");a==="true"?WmsMainUI.hideSettings():(WmsMainUI.menusearchcontainer.style.display="none",WmsMainUI.menulistcontainer.style.display="none",WmsMainUI.settingscontainer.style.display="block",WmsMainUI.settingscontainer.setAttribute("data-showsettings","true"))},WmsMainUI.toggleStatus=function(){var a=WmsMainUI.statuscontainer.getAttribute("data-showstatus");a==="true"?WmsMainUI.hideStatus():(WebMessanger.getAllStatusMessage(),WmsMainUI.statuscontainer.style.display="block",WmsMainUI.statuscontainer.setAttribute("data-showstatus","true"))},WmsMainUI.hideSettings=function(){WmsMainUI.menusearchcontainer.style.display="block",WmsMainUI.menulistcontainer.style.display="block",WmsMainUI.settingscontainer.style.display="none",WmsMainUI.settingscontainer.setAttribute("data-showsettings","false")},WmsMainUI.hideStatus=function(){WmsMainUI.statuscontainer.style.display="none",WmsMainUI.statuscontainer.setAttribute("data-showstatus","false"),WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings"),WmsMainUI.settingsdropdownicon.setAttribute("data-settings","true")},WmsMainUI.filterUnreadChats=function(a,b){var c=document.getElementById("wms_menu_chatlist_recentchats"),d=$WC.RecentChats.getUnreadChatList("unmuted");d.sort($WC.Util.sortBy("LMTIME",!0));var e=$WC.RecentChats.getUnreadChatList("muted");e.sort($WC.Util.sortBy("LMTIME",!0));var f=d.concat(e),g="unreadchats";if(a||f.length===0)f=$WC.RecentChats.getChats(),g="recentchats";c.className.indexOf("wms_menu_dynamic_pos")===-1&&($WC.Util.convertToArray(c.childNodes).forEach(function(a,b){a.style.transition="initial",a.style.transform="translateY("+b*54+"px)"}),c.offsetTop,$WC.Util.addClass(c,"wms_menu_dynamic_pos")),$WC.Util.convertToArray(c.childNodes).forEach(function(a){a.style.transition="initial";var b=f.length?(f.length-1)*54:0;a.style.transform="translateY("+b+"px)",a.style.opacity="0",a.style.zIndex="-1"}),f.map(function(a){return a.CHATID}).forEach(function(a,d){var e=c.querySelector('[data-id="'+a+'"]');b&&(e.style.transition="transform 300ms, opacity 300ms"),e.style.transform="translateY("+d*54+"px)",e.style.opacity="1",e.style.zIndex=""});var h=document.getElementById("wms_menu_heading_recentchats");h.setAttribute("data-heading",g),h.querySelector(".wms_menu_filter_icon").title=$WC.I18N(g+".filtertitle"),$WC.$CUtil.setInnerText(h.firstChild,$WC.I18N(g+".title"));var i=c.querySelector("#wms-chat-loadstatus");i&&(a?(i.style.display="block",i.style.opacity=1,i.style.transform="translateY("+f.length*54+"px)"):i.style.display="none"),setTimeout(function(){$WC.Util.loadOriginalImage(WmsMainUI.defaultchatlist)},300),WmsMainUI.updateCountDependentUI()},WmsMainUI.showMenu=function(a){function b(a,b){var c=a.querySelector("[data-menuname="+b+"]");c.setAttribute("data-selected","true"),$WC.Util.convertToArray(a.children).forEach(function(a){a!==c&&a.setAttribute("data-selected","false")})}WmsMainUI.hideSettings(),WmsMainUI.settingsdropdownicon.setAttribute("class","wms_settings"),WmsMainUI.settingsdropdownicon.setAttribute("data-settings","true"),WmsMainUI.settingsdropdown.style.display="none",WmsMainUI.resetToDefaultUI(),WmsMainUI.menu.style.display="block",b(WmsMainUI.menubar,a),b(WmsMainUI.menulistcontainer,a),a==="contact"?($WC.Bots.initBots(),$WC.Config.get("customContacts")?WmsMainUI.searchdiv.setAttribute("placeholder",$WC.Config.get("customContacts").searchTitle?$WC.Config.get("customContacts").searchTitle:$WC.I18N("Search_Contacts")):WmsMainUI.searchdiv.setAttribute("placeholder",$WC.I18N("Search_Contacts")),setTimeout(function(){$WC.Config.get("customContacts")&&!$WC.Config.get("customContacts").separatePane?WmsHybridSearch.populateCustomContactListInMainUI():WmsHybridSearch.populateContactListInMainUI(),$WC.Util.loadOriginalImage(WmsMainUI.defaultcontactlist)},1)):a==="channel"?(WmsMainUI.searchdiv.setAttribute("placeholder",$WC.I18N("search.channelsandgroups")),setTimeout(function(){$WC.Config.get("isOrgUser")()&&$WC.Config.get("channels")!="disable"&&$WC.Channels.initChannels(),WmsHybridSearch.populateGroupResultInMainUI(),$WC.Util.loadOriginalImage(WmsMainUI.defaultgrouplist)},1)):a==="chat"?(WmsMainUI.getUnreadChatsCount()&&WmsMainUI.filterUnreadChats(),$WC.RecentChats.initRecentChats(),$WC.Config.get("isOrgUser")()&&$WC.Config.get("channels")!="disable"&&$WC.Channels.initChannels(),$WC.Bots.initBots(),!$WC.Config.get("isOrgUser")()||$WC.Config.get("channels")=="disable"?WmsMainUI.searchdiv.setAttribute("placeholder",$WC.I18N("search.contactsandchats")):WmsMainUI.searchdiv.setAttribute("placeholder",$WC.I18N("search.commontitle")),$WC.Util.loadOriginalImage(WmsMainUI.defaultchatlist)):a==="customcontact"&&($WC.Config.get("customContacts")&&WmsMainUI.searchdiv.setAttribute("placeholder",$WC.Config.get("customContacts").searchTitle?$WC.Config.get("customContacts").searchTitle:$WC.I18N("Search_Contacts")),WmsHybridSearch.populateCustomContactListInMainUI()),WmsMainUI.searchdiv.value="",WmsMainUI.searchdiv.focus()},WmsMainUI.updateLoadingForPinnedChats=function(a){var b=document.getElementById("wms_menu_chatlist_def"),c=document.getElementById("wms_menu_chatlist_searchres"),d=c&&c.style.display=="block"?!0:!1,e=document.getElementById("wms_menu_chatlist_loading");if(a)!e&&!d&&(b.insertAdjacentHTML("afterend",'<div id="wms_menu_chatlist_loading" class="wms_menu_chatlist_def" style="display: block;"></div>'),b.style.display="none",$WC.HybridSearch.updateLoadingStatus(document.getElementById("wms_menu_chatlist_loading"),$WC.WmsConstants.REQSTATUS.SUCCESS,"chat"),$WC.HybridSearch.updateLoadingStatus(document.getElementById("wms_menu_chatlist_loading"),$WC.WmsConstants.REQSTATUS.LOADING,"chat"));else if(e){$WC.Util.removeElement(e),d||(b.style.display="block");var f=b.scrollHeight>b.clientHeight;f&&$WC.HybridSearch.updateLoadingStatus($WC.HybridSearch.getNode("defaultresultdiv",3),$WC.WmsConstants.REQSTATUS.LOADING,"chat")}},WmsMainUI.resetToDefaultUI=function(){WmsMainUI.searchdiv.value="",WmsMainUI.searchrescontactlist.style.display="none",WmsMainUI.searchreschatlist.style.display="none",WmsMainUI.searchresgrouplist.style.display="none",WmsMainUI.defaultcontactlist.style.display="block",WmsMainUI.defaultchatlist.style.display="block",WmsMainUI.defaultgrouplist.style.display="block",$WC.HybridSearch.resetHover()},WmsMainUI.setRePopulateStatus=function(a,b){WmsMainUI._populatestatus[a]=b},WmsMainUI.decideRepopulate=function(a){return WmsMainUI._populatestatus[a]},function(){var a={},b={};WmsMainUI.incrementUnreadCount=function(b){a[b]||(a[b]={count:0}),a[b].count||(a[b].count=0),a[b].count++},WmsMainUI.decrementUnreadCount=function(b){a[b]&&a[b].count!=0&&a[b].count--},WmsMainUI.resetUnreadCount=function(c,d){var e=d?b:a;e[c]?e[c].count=0:e[c]={count:0}},WmsMainUI.getUnreadCount=function(c,d){var e=d?b:a;return e[c]?e[c].count||0:0},WmsMainUI.getUnreadChatsCount=function(c){var d=0,e=c?b:a;for(var f in e)e[f].count&&e[f].mutestatus!==!0&&d++;return d},WmsMainUI.setUnreadCount=function(c,d,e){var f=e?b:a;f[c]?f[c].count=d:f[c]={count:d}},WmsMainUI.resetAllUnreadCount=function(){a={}},WmsMainUI.setMuteStatus=function(b,c){a[b]?a[b].mutestatus=c:a[b]={mutestatus:c}},WmsMainUI.getMuteStatus=function(b){return a[b]&&a[b].mutestatus?!0:!1},WmsMainUI.setZuidForPrivateChat=function(b,c){a[b]?a[b].privatechatzuid=c:a[b]={privatechatzuid:c}},WmsMainUI.getZuidForPrivateChat=function(b){if(a[b]&&a[b].privatechatzuid)return a[b].privatechatzuid}}(),WmsMainUI.updateUnreadCountInUI=function(a){var b=WmsMainUI.getUnreadCount(a)||"",c=WmsMainUI.getMuteStatus(a),d=[WmsMainUI.defaultchatlist,WmsMainUI.searchreschatlist,document.getElementById("wms-hysearch-rchats"),document.getElementById("wms-hysearch-searchres")];for(var e=0;e<d.length;e++)if(d[e]){var f=d[e].querySelector('[data-id="'+a+'"]>[data-unreadcount]');if(f){b=b>99?"99+":b,$WC.$CUtil.setInnerText(f,b),b?f.style.display="block":f.style.display="none";if(c){var g=d[e].querySelector('[data-id="'+a+'"]');g.setAttribute("data-muted","true")}}}},WmsMainUI.updateUnreadChatsCount=function(){if(!_WMSEMPTYBAR&&!silent){WmsMainUI.updateCountDependentUI();var a=$WC.RecentChats.getUnreadFeedsCount()+WmsMainUI.getUnreadChatsCount();a?(ChatTour.removeTourNotifier(),$WC.$CUtil.setInnerText(WmsMainUI.unreadchatcntdiv,a),WmsMainUI.unreadchatcntdiv.style.display="block"):($WC.$CUtil.setInnerText(WmsMainUI.unreadchatcntdiv,""),WmsMainUI.unreadchatcntdiv.style.display="none")}},WmsMainUI.updateCountDependentUI=function(){var a="",b=WmsMainUI.getUnreadChatsCount();b?$WC.RecentChats.getUnreadChatList("unmuted").length&&(a="unmuted"):$WC.RecentChats.getUnreadChatList("muted").length&&(a="muted");var c=WmsMainUI.defaultchatlist.querySelector('[data-heading="recentchats"]'),d=WmsMainUI.defaultchatlist.querySelector('[data-heading="unreadchats"]');a?($WC.Util.setAttribute(c,"data-uctype",a),$WC.Util.setAttribute(d,"data-uctype",a)):(c&&c.removeAttribute("data-uctype"),d&&d.removeAttribute("data-uctype"));var e=WmsMainUI.menubar.querySelector('[data-menuname="chat"]'),f,g=!1;b?(f=$WC.I18N("unreadchats.title"),g=!0):f=$WC.I18N("menuname.chats"),$WC.Util.setAttribute(e,"title",f),$WC.Util.setAttribute(e,"data-title",f),$WC.Util.setAttribute(e,"data-uc",g)},WmsMainUI.getUnreadCountForMenu=function(a,b){var c=0;return a.forEach(function(a){WmsMainUI.getUnreadCount(a.CHATID)&&!WmsMainUI.getMuteStatus(a.CHATID)&&b.indexOf(a.CHATID)==-1&&(c+=1)}),c},WmsMainUI.updateChatInvitationCount=function(a){var b=$WC.Config.get("customContacts"),c=b?document.getElementById("wms_menu_customcontacts_cnt"):WmsMainUI.invitationscntdiv;b||(a=$WC.Util.getObjectLength(WmsContacts.getInvitedContactsList())),c&&($WC.$CUtil.setInnerText(c,a||""),c.style.display=a?"block":"none")},WmsMainUI.showPendingInvitations=function(){ZMSGUI.createOverlay();var a='<div class="wms_pendinginv_header">'+$WC.I18N("chat.pending.invitations")+'<span data-operation="close" class="wms_invitations_close"></span></div><div class="wms_pendinginv_container">';if(WmsContacts.getPendingInvitedContactsList().length)for(var b=0;b<WmsContacts.getPendingInvitedContactsList().length;b++){var c=WmsContacts.getPendingInvitedContactsList()[b];a+='<div data-id="'+c+'" class="wms_pendinginv_content"><input data-operation="reject" type="button" value="Reject" class="wms_pendinginv_rejctbtn"><input data-operation="accept" type="button" value="Accept" class="wms_pendinginv_acptbtn"><span class="wms_pendinginv_img wms-valign-mid-block"><img src="'+WmsContacts.getUserPhoto(c)+'"></span><div class="wms_pendinginv_name wms-truncate-ellipsis wms-valign-mid-block">'+$WC.Util.getContactName(c,"",!0)+"</div></div>"}else a+='<div class="wms_pendinginv_infocontent"><div class="wms_pendinginv_infotxt">'+$WC.I18N("chat.pendinginv.infotxt")+"</div></div>";a+="</div>";var d=$WC.Util.createElement("div","wms_pendinginv_container","wms-hvalign",null,a);d.style.zIndex=$WC.Config.get("zindex"),d.style.display="block",document.body.appendChild(d),Gator(d).on("click","[data-operation]",function(a){var b=$WC.Util.getEventTarget(a),d=b.getAttribute("data-operation");d==="close"?ZMSGUI.hidependinginv():d==="reject"?(WMSUI.rejectContact(c,c,"inv"),WmsMainUI.hidePendingInvitations(b.parentNode),$WC.Util.removeElementFromArray(WmsContacts.getPendingInvitedContactsList(),c)):d==="accept"&&(WmsContacts.accept("zoho",c,$WC.Config.get("zuid")),WmsMainUI.hidePendingInvitations(b.parentNode),$WC.Util.removeElementFromArray(WmsContacts.getPendingInvitedContactsList(),c))})},WmsMainUI.hidePendingInvitations=function(a){WmsContacts.getPendingInvitedContactsList().length===1?ZMSGUI.hidependinginv():$WC.Util.removeElement(a)},WmsMainUI.removeFromContactList=function(a){var b=WmsMainUI.defaultcontactlist.querySelector('[data-id="'+a+'"]'),c=WmsMainUI.searchrescontactlist.querySelector('[data-id="'+a+'"]');$WC.Util.removeElement(b),$WC.Util.removeElement(c)},WmsMainUI.handleProfileActions=function(a){var b=a.getAttribute("data-operation"),c=a.closest("[data-id]"),d=c.getAttribute("data-id"),e=WmsContacts.getDisplayName(d)||WmsProfileInfo.details[d].dname;if(b=="delete"){var f=$WC.I18N("chat.contact.deleteinfo",[e]),g=new $WC.ConfirmationDialog,h=[{text:$WC.I18N("Delete"),onclick:function(){WmsContacts.remove("zoho",d),g.unmountComponent()},buttonstyle:"destructive_button"}],i={actions:h,heading:f,bodytitle:$WC.I18N("dialogue.info.header"),headerimgsrc:$WC.WmsContacts.getUserPhoto(d,"38"),content:[$WC.I18N("info.contact.delete.info1"),$WC.I18N("info.contact.delete.info2.external")]};g.mountComponent(i)}else if(b=="startchat")WmsHybridSearch.parseAndOpenChat(a),WmsMainUI.removeListComponent();else if(b=="invite")d?WMSUI.inviteMember(d,e):WMSUI.inviteMember(e,e);else if(b=="accept")WmsContacts.accept("zoho",d,$WC.Config.get("zuid")),$WC.Util.removeElementFromArray(WmsContacts.getPendingInvitedContactsList(),d);else if(b=="contactimg"){WMSUI.imgPreview.createOverlay();var j=document.getElementById("wms-imgpreviewcontainer"),k='<div id="wms_profileinfo_img" class="wms-hvalign"><img src="'+a.src+'"></div>'+WmsProfileInfo.getHtml(d)+'<span class="wms-imgpreviewclose" data-purpose="close"></span>';k=$WC.template.replace(k,{IMGSRC:a.src}),j.insertAdjacentHTML("beforeend",k),WMSUI.imgPreview.bindevents()}WmsProfileInfo.hide()},WmsMainUI.handleProfileClick=function(a){var b=a.getAttribute("data-zcprofileid");b&&(WmsMainUI.contactdetailsdiv.style.display!==""||b!==WmsMainUI.contactdetailsdiv.getAttribute("data-id"))&&!a.closest('[data-pc="true"]')&&!a.closest('[id="wms_contactdetails"]')&&!a.closest('[data-baravatar="true"]')&&!a.closest('[class~="wms_menu_item_msg"]')&&(WmsMainUI.contactdetailsdiv.removeAttribute("data-id"),WmsProfileInfo.hide(),WmsMainUI.contactdetailsdiv.setAttribute("data-id",b),WmsProfileInfo.get(a))},WmsMainUI.handleProfileMouseOut=function(a,b){var c=b.relatedTarget&&b.relatedTarget.closest('[id="wms_contactdetails"]');if(a===c)return;WmsProfileInfo.hide()},$WC.Util.pubsub.subscribe("/orgcontacts/listview",function(a,b){var c;if(b.stat===$WC.WmsConstants.REQSTATUS.FAILED&&!b.callbackargs.silentload)c=b&&b.chid,Commands.hideLoadingIcon(c);else if(b&&b.callbackargs){var d=b.callbackargs.params;c=b.callbackargs.chid,d&&WmsOrgContacts.isEmptyResultReq(d.split("=")[2])&&!b.callbackargs.silentload?Commands.hideLoadingIcon(b.callbackargs.chid):c&&WindowHandler.getWinObjById(c)&&(b.callbackargs.silentload||Commands.hideLoadingIcon(c),WMSUI.atMentions.init(c,WindowHandler.getWinObjById(c).composer,b))}}),$WC.Util.pubsub.subscribe("/orgcontacts/userslistview",function(a,b){var c=WebMessanger.userslist||WebMessanger.forkedlist;c.showList(b)}),function(){var a={};WmsMainUI.scheduleAutoFocus=function(b){a[b]=!0},WmsMainUI.isAutoFocusScheduled=function(b){return a[b]?!0:!1},WmsMainUI.removeAutoFocusSchedule=function(b){delete a[b]}}(),function(){var a={};WmsMainUI.scheduleAutoJoin=function(b){a[b]=!0},WmsMainUI.joinScheduledChannels=function(){for(var b in a)WebMessanger.join(b),delete a[b]}}(),ie?(document.onfocusout=function(){_WMSWINFOCUS=!1},document.onfocusin=function(){_WMSWINFOCUS=!0}):(window.addEventListener("blur",function(){_WMSWINFOCUS=!1}),window.addEventListener("focus",function(){_WMSWINFOCUS=!0,$WC.Channels.getChannelsIfFocussed()&&$WC.Channels.getChannels(),WebMessanger.sync_adminsettings_onfocus&&WebMessanger.syncAdminSettings(),WebMessanger.get_pinmsg_onfocus&&WindowHandler.getPinMsgForOpenedChats(),$WC.Drafts.getFromServerIfFocussed(),$WC.Bots.getFromServerIfFocussed()})),WmsMainUI.bindRecentChatEvents=function(){Gator(WmsMainUI.menulistcontainer).off(),Gator(WmsMainUI.menulistcontainer).on("click","[data-id],[data-operation],[data-menuredirect],[data-retry],[data-heading]",function(a){var b=$WC.Util.getEventTarget(a);if(b.getAttribute("data-customoperation")&&$WC.Config.get("customContacts")&&$WC.Config.get("customContacts").invitationActions){var c=b.getAttribute("data-customoperation"),d=b.getAttribute("title"),e=$WC.Config.get("customContacts").invitationActions,f=this;e.forEach(function(a){(a.label===c||a.label===d)&&a.action(f)})}else if(this.getAttribute("data-operation"))WmsContacts.handleInviteOperation(this);else if(this.getAttribute("data-retry"))WmsOrgContacts.fetchFromServer({searchtext:"",topicname:"suggestionui"},"");else if(this.getAttribute("data-menuredirect")){var g=this.getAttribute("data-menuredirect");(g!="channel"||!!WebMessanger.isOrgUser())&&WmsMainUI.showMenu(g)}else if(this.getAttribute("data-heading")==="recentchats"||this.getAttribute("data-heading")==="unreadchats"){if(this.getAttribute("data-uctype")){var h=this.getAttribute("data-heading");if(h==="unreadchats")var i=!0;WmsMainUI.filterUnreadChats(i,!0)}}else if(this.getAttribute("data-heading")==="pinnedchats"){var j=WmsMainUI.defaultchatlist.querySelector('[data-menu="pinnedchats"]');if($WC.RecentChats.getPinnedChats().length>6)if(j.getAttribute("data-expanded")==="true")j.lastChild.style.height="50px",j.setAttribute("data-expanded","false"),j.querySelector(".wms_menu_filter_icon").title=$WC.I18N("pinnedchats.shrinked.filtertitle");else{var k=Math.ceil($WC.RecentChats.getPinnedChats().length/6);j.lastChild.style.height=k*50+"px",j.setAttribute("data-expanded","true"),j.querySelector(".wms_menu_filter_icon").title=$WC.I18N("pinnedchats.expanded.filtertitle")}}else if(this.getAttribute("data-heading")!=="suggestions"){var l=$WC.Util.getEventTarget(a);if(l.getAttribute("data-zcprofileid")&&!this.getAttribute("data-pc")&&!l.closest('[class~="wms_menu_item_msg"]'))return;WmsHybridSearch.handleSelection(this),$WC.Util.removeElement(this.querySelector("[data-unreadcnt]"))}WmsProfileInfo.hide()})},WmsMainUI.updateStatusInCustomContactMenu=function(a,b){var c=$WC.HybridSearch.getNode("defaultresultdiv",$WC.WmsConstants.HYBRIDSEARCH.modules.CUSTOMCONTACTMENU),d=c.querySelector('[data-id="'+a+'"]');$WC.$CUtil.setInnerText(d.querySelector("[data-smsg]"),b)},WmsMainUI.removeListComponent=function(){var a=WindowHandler.openedChats;for(var b in a)$WC.ListFactory.removeComponent(b)},WmsMainUI.setLinkPreviewSettings=function(){var a='<div class="wms_urlconsent_parent"><select class="wms_settings_select" id="zoholinkspermission" data-select="zoholinkspermission" ><option  id="wms_settings_allowlinks" value="1" data-value="1"  name="zoholinks" data-setting="allow_links">'+$WC.I18N("urlconsent.always")+"</option>"+'<option id="wms_settings_askeverytime"  name="zoholinks" data-setting="ask_askeverytime" value="0" data-value="0">'+$WC.I18N("urlconsent.askeverytime")+"</options>"+'<option id="wms_settings_restrictlinks" value="-1" data-value="-1" name="zoholinks" data-setting="restrict_links" class="wms_settings_label" >'+$WC.I18N("urlconsent.restrict")+'</option> </select><span class="wms_settings_openicon"></span></div>',b=function(){c.removeChild(c.childNodes[0]),c.innerHTML=a,c.querySelector("#zoholinkspermission").value=$WC.Config.get("zoholinks_auth")},c=WmsMainUI.settingscontainer.querySelector("#wms_zoholinks_settings");if(!isNaN($WC.Config.get("zoholinks_auth")))b();else{var d=function(a){var c=a.authentication_consent||0;$WC.Config.set({zoholinks_auth:c}),b()};$WC.Ajax.requestToChat("getlinkpreviewsettings.do",null,d)}};var WmsProfileInfo={};WmsProfileInfo.details={},WmsProfileInfo.CONTAINER={WIDTH:283,HEIGHT:200},WmsProfileInfo.get=function(a){var b=a.getAttribute("data-zcprofileid"),c=a.getAttribute("data-zcmsgsource");if(!WmsProfileInfo.isExistInCache(b)){var d=function(){var c=JSON.parse(this.response);WmsProfileInfo.update(b,c.data),WmsProfileInfo.show(a)},e=function(){if(this.response){var b=JSON.parse(this.response),c=b.code;WmsProfileInfo.show(a,c)}};c!=="command"&&!$WC.Bots.isBotId(b)&&!$WC.Config.get("customContacts")&&$WC.Ajax.requestToChat("v2/users/"+b,"fields="+encodeURIComponent("all,checkin_status"),d,e),WmsProfileInfo.update(b)}WmsProfileInfo.show(a)},WmsProfileInfo.update=function(a,b){WmsProfileInfo.details[a]||(WmsProfileInfo.details[a]={}),$WC.Bots.isBotId(a)?(WmsProfileInfo.details[a].dname=$WC.Bots.get(a).DNAME,WmsProfileInfo.details[a].emailid=$WC.Bots.get(a).STATUSMSG):b?(WmsProfileInfo.details[a].dname=a===WebMessanger.zuid?$WC.I18N("chat.you"):$WC.Util.unescapeHTML($WC.Util.getContactName(a,b.display_name)),WmsProfileInfo.details[a].emailid=b.email_id,WmsProfileInfo.details[a].designation=b.designation&&b.designation.name,WmsProfileInfo.details[a].department=b.department&&b.department.name,WmsProfileInfo.details[a].mobile=b.mobile,WmsProfileInfo.details[a].extn=b.extension,WmsProfileInfo.details[a].country=b.country,WmsProfileInfo.details[a].timezone=b.timezone,WmsProfileInfo.details[a].timeoffset=b.timeoffset,WmsProfileInfo.details[a].orgid=b.zoid,WmsProfileInfo.details[a].checkin_status=b.checkin_status,WmsProfileInfo.details[a].checkin_status&&(WmsProfileInfo.details[a].requesttime=(new Date).getTime()),WmsProfileInfo.details[a].moreinfo=!0):WmsProfileInfo.isUserExist(a)&&(WmsProfileInfo.details[a].dname=a===WebMessanger.zuid?$WC.I18N("chat.you"):WmsContacts.getDisplayName(a),WmsProfileInfo.details[a].emailid=WmsContacts.getEmailId(a),WmsProfileInfo.details[a].moreinfo=!1),b&&(WmsProfileInfo.details[a].dname=a===WebMessanger.zuid?$WC.I18N("chat.you"):$WC.Util.unescapeHTML(b.display_name),$WC.Users.storeInfo(a,{dname:b.display_name}))},WmsProfileInfo.isExistInCache=function(a){return WmsProfileInfo.details[a]&&WmsProfileInfo.details[a].requesttime?(new Date).getTime()-WmsProfileInfo.details[a].requesttime>18e4?!1:!0:WmsProfileInfo.details[a]&&WmsProfileInfo.details[a].moreinfo?!0:!1},WmsProfileInfo.show=function(a,b){var c=a.getAttribute("data-zcprofileid"),d=a.getAttribute("data-zcmsgsource"),e=a.innerText.substring(a.innerText.indexOf("@")+1);if(WmsMainUI.contactdetailsdiv.getAttribute("data-id")!==c)return;var f=document.getElementById("wms_contactdetails_container"),g;b==="operation_failed"?g="contact.profileinfo.notfound":b==="operation_not_allowed"&&(g="contact.profileinfo.notallowed"),f?(document.getElementById("wms_contactdetails_infocontainer").innerHTML=WmsProfileInfo.getBasicInfoHtml(c,g,e,d),document.getElementById("wms_contactdetails_addinfo").innerHTML=WmsProfileInfo.getDetailedInfoHtml(c,g,d),g&&$WC.Util.removeElement(document.getElementById("wms_contact_operations"))):WmsMainUI.contactdetailsdiv.innerHTML='<div id="wms_contactdetails_container" class="wms_contactdetails_container">'+WmsProfileInfo.generateUI(c,g,e,d)+"</div>";var h=document.getElementById("wms_contacthover_img"),i=document.getElementById("wms_contactdetails_loadingdiv");$WC.Util.addEvent(h,"load",function(){if(WmsMainUI.contactdetailsdiv.getAttribute("data-id")!==h.getAttribute("data-userid"))return;WmsProfileInfo.setImageAspectRatio(h,h.width,h.height),h.style.display="block",h.className+=" wms-fadeIn",i&&(i.style.display="none",i.className+=" wms-fadeOut")}),WmsMainUI.contactdetailsdiv.style.display="block",$WC.Util.positionElement(a,WmsMainUI.contactdetailsdiv)},WmsProfileInfo.handleDocumentClick=function(a){if(silent)return;var b=$WC.Util.getEventTarget(a),c=b.getAttribute("data-zcprofileid");if(b.closest('[id="wms_contactdetails"]')||WmsMainUI.contactdetailsdiv&&c===WmsMainUI.contactdetailsdiv.getAttribute("data-id"))return;WmsMainUI.contactdetailsdiv&&(WmsMainUI.contactdetailsdiv.removeAttribute("data-id"),WmsProfileInfo.hide())},WmsProfileInfo.setImageAspectRatio=function(a,b,c){var d=c/WmsProfileInfo.CONTAINER.HEIGHT>=b/WmsProfileInfo.CONTAINER.WIDTH;d?(a.style.width="auto",a.style.height="100%"):(a.style.width="100%",a.style.height="auto"),WmsProfileInfo.setImagePosition(a,b,c)},WmsProfileInfo.setImagePosition=function(a,b,c){var d=WmsProfileInfo.CONTAINER.WIDTH,e=WmsProfileInfo.CONTAINER.HEIGHT,f=WmsProfileInfo.getAspectRatioFit(a.width,a.height,d,e,!0);b>d&&c>e-40&&(a.style.width=f.width+"px",a.style.height=f.height+"px"),b<d&&c<e-40&&(a.style=""),b>d&&c<e-40&&(a.style.width=f.width+"px",a.style.height=f.height+"px"),b<d&&c>e-40&&(a.style="",a.style.width=f.width+"px",a.style.height=f.height+"px"),WmsProfileInfo.populateBlurBgImage(a,"",f)},WmsProfileInfo.getAspectRatioFit=function(a,b,c,d,e){var f=[c/a,d/b];return f=Math.min(f[0],f[1]),!e&&f>1?{width:a,height:b}:{width:a*f,height:b*f,ratio:f}},WmsProfileInfo.populateBlurBgImage=function(a,b,c){var d=WmsProfileInfo.CONTAINER.WIDTH-c.width,e=WmsProfileInfo.CONTAINER.HEIGHT-c.height;if(d==0&&e==0)return;var f=document.getElementById("wms_contacthoverblurimg"),g=c.width/c.ratio,h=c.height/c.ratio;if(d>0&&f){var i=d/10;f.getContext("2d").drawImage(a,0,0,i,h,0,0,d/2,WmsProfileInfo.CONTAINER.WIDTH),f.getContext("2d").drawImage(a,d/2,0,c.width,WmsProfileInfo.CONTAINER.HEIGHT),f.getContext("2d").drawImage(a,g-i,0,i,h,c.width+d/2,0,d/2,WmsProfileInfo.CONTAINER.HEIGHT)}else if(e>0&&f){var j=e/10;f.getContext("2d").drawImage(a,0,0,g,j,0,0,WmsProfileInfo.CONTAINER.WIDTH,e/2),f.getContext("2d").drawImage(a,0,e/2,WmsProfileInfo.CONTAINER.WIDTH,c.height),f.getContext("2d").drawImage(a,0,h-j,g,j,0,c.height+e/2,WmsProfileInfo.CONTAINER.WIDTH,e/2)}},WmsProfileInfo.hide=function(){$WC.Util.removeElement(WmsMainUI.contactdetailsdiv.firstChild),WmsMainUI.contactdetailsdiv.style.display="none",WmsMainUI.contactdetailsdiv.style.top="",WmsMainUI.contactdetailsdiv.style.left=""},WmsProfileInfo.generateUI=function(a,b,c,d){var e='<div id="wms_contactdetails_imgcontainer"><div id="wms_contactdetails_img" class="wms_contactdetails_img">'+WmsProfileInfo.generateImageHTML(a,d)+'<span id="wms_contactdetails_loadingdiv" class="wms-hvalign wms_loading_div"></span>'+"</div>"+'<div class="wms_contactdetails_infowrapper">'+'<div id="wms_contactdetails_info" class="wms_contactdetails_info">'+WmsProfileInfo.getBasicInfoHtml(a,b,c,d)+"</div>"+'<div id="wms_contactdetails_addinfo" class="wms_contactdetails_addinfocontainer">'+WmsProfileInfo.getDetailedInfoHtml(a,b,d)+"</div>";return!$WC.Config.get("customContacts")&&!$WC.Config.get("profileinfo")&&!b&&d!=="command"&&(e+='<div id="wms_contact_operations">'+WmsProfileInfo.getContactOperationsHtml(a)+"</div>"),e+="</div></div>",e},WmsProfileInfo.generateImageHTML=function(a,b){var c="",d='<canvas width="'+WmsProfileInfo.CONTAINER.WIDTH+'" height="'+WmsProfileInfo.CONTAINER.HEIGHT+'" id="wms_contacthoverblurimg" imgsrc="{{IMGSRC}}" class="wms_profileinfo_blur"></canvas><img id="wms_contacthover_img" class="wms-hvalign wms_contacthover_img" data-userid="{{ID}}" data-operation="contactimg" src="{{IMGSRC}}" style="display:none;">';return $WC.Bots.isBotId(a)&&$WC.Bots.get(a)?c=$WC.Bots.getPhoto(a):b==="command"?c=Commands.getImgUrl(a):c=_WMSPHOTOSERVER+"/file?ID="+a+"&exp=6000&t=user&fs=original",$WC.template.replace(d,{IMGSRC:c,ID:a})},WmsProfileInfo.getBasicInfoHtml=function(a,b,c,d){if(b)return'<div id="wms_contactdetails_infocontainer" class="wms_contactdetails_infocontainer">'+$WC.Util.safeHTML(c)+"</div>";if(d==="command")var e=Commands.getObject(a),f=e.name,g=e.description;var h='<div id="wms_contactdetails_infocontainer" class="wms_contactdetails_infocontainer"><div class="wms_profilestatus">';$WC.Bots.isBotId(a)?h+='<span class="wms_contactdetails_status wms_boticon"></span>':d===""&&(h+='<span class="wms_contactdetails_status '+$WC.BadgeImage.getStatusClass(a,!0)+'"></span>'),h+='<div title="{{DNAME}}" class=" wms_contactdetails_name wms-truncate-ellipsis">{{DNAME}}</div>',WmsProfileInfo.isPeopleInfoAvailable(a)&&(WmsProfileInfo.details[a].checkin_status===!0?h+='<div class="wms_contact_checkinstatusin">'+$WC.I18N("status.in")+"</div>":h+='<div class="wms_contact_checkinstatusout">'+$WC.I18N("status.out")+"</div>"),h+="</div>",h+='<div id="wms_contactdetails_id" class="wms_contactdetails_id">{{EMAILID}}</div>',d!=="command"&&a!=WebMessanger.zuid&&!$WC.Config.get("customContacts")&&!$WC.Config.get("profileinfo")&&(h+='<div class="wms_contactdetails_startchat" data-type="'+($WC.Bots.isBotId(a)?$WC.WmsConstants.HYBRIDSEARCH.BOT:$WC.WmsConstants.HYBRIDSEARCH.CONTACT)+'" data-id="{{USERID}}" data-operation="startchat"></div>'),h+="</div>";if($WC.Config.get("customContacts")&&!WmsProfileInfo.isUserExist(a)){var i=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").customContactsInfo,a),j=$WC.Config.get("customContacts").getStatusClass,k="";return i&&i.statusClass?k=i.statusClass:j&&(k=WmsImplHandler.invokeSynchronously(j,a)),$WC.template.replace(h,{USERID:a,DNAME:i&&i.name?i.name:"",EMAILID:i&&i.mailId?i.mailId:"",STATUS:k})}var l=WmsProfileInfo.details[a].dname?WmsProfileInfo.details[a].dname:"",m=WmsProfileInfo.details[a].emailid?WmsProfileInfo.details[a].emailid:"";return $WC.template.replace(h,{USERID:a,DNAME:f||l,EMAILID:g||m,STATUS:$WC.BadgeImage.getStatusClass(a,!0)})},WmsProfileInfo.getDetailedInfoHtml=function(a,b,c){var d=$WC.Config.get("profileinfo");if(typeof d=="function"){var e=WmsImplHandler.invokeSynchronously(d,a);if(e)return e}if(b)return'<div class="wms_contactdetails_errorinfo">'+$WC.I18N(b)+"</div>";var f='<div class="wms_contactdetails_addinfo">';if($WC.Bots.isBotId(a)){var g=$WC.Bots.get(a);g.original_info.extension?f+='<div><div class="wms_custombot_info">'+$WC.I18N("bot.extension.info",$WC.Util.escapeHTML(g.original_info.extension.name))+"</div><span>"+$WC.Util.escapeHTML(g.original_info.extension.description)+"</span></div>":f+='<div><div class="wms_custombot_info">'+$WC.I18N("bot.custom.info")+"</div><span>/api/v1/bots/"+$WC.Util.escapeHTML(g.UNIQUENAME)+"/message</span></div>"}else if(c==="command"){var h=Commands.getObject(a);h.appdetails?f+='<div><span class="wms_contactdetails_deptinfo">Extension</span><div class="wms_contactdetails_moreinfo">{{EXTENSIONNAME}}</div></div><div><span class="wms_contactdetails_deptinfo">Installed by</span><div class="wms_contactdetails_moreinfo">{{DEVELOPER}}</div></div>':f+='<div><span class="wms_contactdetails_deptinfo">Developed by</span><div class="wms_contactdetails_moreinfo">{{DEVELOPER}}</div></div>'}else if(WmsProfileInfo.isPeopleInfoAvailable(a))f+=' <div><span class="wms_contactdetails_moreinfo">{{DESIGNATION}}</span><div class="wms_contactdetails_deptinfo">{{DEPARTMENTNAME}}</div></div><div class="wms_contactdetails_contactinfo">'+(WmsProfileInfo.details[a].mobile?'<span class="wms_contactdetails_mob">'+$WC.I18N("contact.profileinfo.mobile")+": </span><span>{{MOBILE}}</span>":"")+(WmsProfileInfo.details[a].extn?'<span class="wms_contactdetails_extn">'+$WC.I18N("contact.profileinfo.extn")+": </span><span>{{EXTENSION}}</span>":"")+"</div>";else if(WmsProfileInfo.isUserExist(a)||WmsProfileInfo.details[a])if(WmsProfileInfo.details[a].timezone){var i=WmsProfileInfo.details[a].country,j=$WC.DateUtil.getOtherZoneTime(WmsProfileInfo.details[a].timezone,WmsProfileInfo.details[a].timeoffset);f+='<div><span class="wms_contactdetails_moreinfo wms_contactdetails_mob">'+$WC.I18N("contact.profileinfo.localtime")+': </span><span>{{LOCALTIME}}</span></div><div class="wms_contactdetails_contactinfo"><span class="wms_contactdetails_mob">'+$WC.I18N("contact.profileinfo.country")+": </span><span>{{COUNTRY}}</span></div>"}else f+="";return f+="</div>",$WC.template.replace(f,{DESIGNATION:WmsProfileInfo.details[a].designation||"",DEPARTMENTNAME:WmsProfileInfo.details[a].department||"",MOBILE:WmsProfileInfo.details[a].mobile||"",EXTENSION:WmsProfileInfo.details[a].extn||"",LOCALTIME:j||"",COUNTRY:i||"",EXTENSIONNAME:h&&h.appdetails?h.appdetails.name:"",DEVELOPER:h&&h.creator?$WC.Util.getContactName(h.creator.id,h.creator.name,!0):""})},WmsProfileInfo.getContactOperationsHtml=function(a){var b="";return a==WebMessanger.zuid||$WC.Bots.isBotId(a)?b+="":WmsContacts.status(a)==$WC.WmsConstants.CONTACTSTATUS.REMOVE||!WmsContacts.get(a)?b+='<div data-operation="invite" data-id="'+a+'" class="wms-halign wms_contactdetails_delete"><span>'+$WC.I18N("contact.profileinfo.invite")+"</span></div>":WmsContacts.status(a)==$WC.WmsConstants.CONTACTSTATUS.REQACC||WmsContacts.status(a)==$WC.WmsConstants.CONTACTSTATUS.NOCHAT||!WmsContacts.get(a)?b+='<div data-operation="accept" data-id="'+a+'" class="wms-halign wms_contactdetails_delete"><span>'+$WC.I18N("contact.profileinfo.accept")+"</span></div>":WmsContacts.status(a)==$WC.WmsConstants.CONTACTSTATUS.UNAPRD||!WmsContacts.get(a)?b+='<div data-operation="invite" data-id="'+a+'" class="wms_contactdetails_reinvite"><span>'+$WC.I18N("contact.profileinfo.reinvite")+'</span></div><div data-operation="delete" data-id="'+a+'" class="wms_contactdetails_delete"><span>'+$WC.I18N("contact.profileinfo.delete")+"</span></div>":WmsContacts.status(a)!=$WC.WmsConstants.CONTACTSTATUS.REQACC&&WmsContacts.status(a)!=$WC.WmsConstants.CONTACTSTATUS.UNAPRD&&WmsContacts.status(a)!=$WC.WmsConstants.CONTACTSTATUS.REMOVE&&WmsContacts.get(a)&&(b+='<div data-operation="delete" data-id="'+a+'" class="wms-halign wms_contactdetails_delete"><span>'+$WC.I18N("contact.profileinfo.delete")+"</span></div>"),b},WmsProfileInfo.isPeopleInfoAvailable=function(a){return WmsProfileInfo.details[a]&&WmsProfileInfo.details[a].checkin_status!=undefined?!0:!1},WmsProfileInfo.isUserExist=function(a){return WmsContacts.getContactsList(a)||WmsOrgContacts.getOrgContactsList(a)},WmsProfileInfo.handleEscape=function(a){typeof WmsMainUI!="undefined"&&WmsMainUI.contactdetailsdiv&&WmsMainUI.contactdetailsdiv.hasChildNodes()&&(WmsProfileInfo.hide(),WindowHandler.lastViewed!==-1?WindowHandler.exist[WindowHandler.lastViewed].composer.focus():WmsMainUI.searchdiv.focus(),a.stopPropagation())},WmsProfileInfo.getHtml=function(a){var b='<div class="wms_profileinfo"><div class="wms_profileinfo_details"><span>{{DNAME}}</span>';return WmsProfileInfo.isPeopleInfoAvailable(a)&&(WmsProfileInfo.details[a].designation&&(b+='<span class="wms_profileinfo_divider">|</span><span>{{DESIGNATION}}</span>'),WmsProfileInfo.details[a].department&&(b+='<span class="wms_profileinfo_divider">|</span><span>{{DEPARTMENT}}</span>'),WmsProfileInfo.details[a].mobile&&(b+='<span class="wms_profileinfo_divider">|</span><span class="wms_profileinfo_mob"></span><span>{{MOB}}</span>'),WmsProfileInfo.details[a].extn&&(b+='<span class="wms_profileinfo_divider">|</span><span class="wms_profileinfo_extn"></span><span>{{EXTN}}</span>')),b+='</div><div class="wms_profileinfo_wrapper" data-userid="'+a+'">'+'<span style="{{DOWNLOADICON}}" title="'+$WC.I18N("chat.download")+'"><a target="_blank" class="wms_profileinfo_dwnld" href={{IMGSRC}} download="photo"></a></span>'+'<span class="wms_profileinfo_chat" data-purpose="startchat" data-id="'+a+'" data-type="'+$WC.WmsConstants.HYBRIDSEARCH.CONTACT+'" title="'+$WC.I18N("chat.msg.direct")+'"></span>'+"</div>"+"</div>",$WC.template.replace(b,{DNAME:WmsProfileInfo.details[a].dname||"",DESIGNATION:WmsProfileInfo.details[a].designation,DEPARTMENT:WmsProfileInfo.details[a].department,MOB:WmsProfileInfo.details[a].mobile,EXTN:WmsProfileInfo.details[a].extn})};var myMsgObj={};myMsgObj.sender="",WMSUI.triggers=["@",":","+","-","/"],WMSUI.curtrigger="",WMSUI.hidegsicon=!1,WMSUI.errormsgtimer=null,WMSUI.loadedimg={},WMSUI.isLoadedImg=function(a){return WMSUI.loadedimg[a]===!0},WMSUI.loadImages=function(a){var b=a.getBoundingClientRect().top,c=a.querySelectorAll("img[originalsrc]");for(var d=0;d<c.length;d++){var e=c[d],f=e.parentNode.getBoundingClientRect().top,g=f+e.parentNode.offsetHeight;(f>b||g>b)&&WMSUI.loadOriginalImgSrc(e)}},WMSUI.loadOriginalImgSrc=function(a){var b=a.getAttribute("originalsrc");a.removeAttribute("originalsrc"),a.nextSibling!==null&&$WC.Util.removeElement(a.nextSibling);var c=a.cloneNode();c.removeAttribute("src"),c.src=b,c.className="",a.parentNode.insertBefore(c,a.nextSibling),c.onload=function(){this.style.display="",$WC.Util.removeElement(a),WMSUI.loadedimg[b]=!0},c.onerror=function(){a.setAttribute("originalsrc",b),this.style.display="none"}},WMSUI.handleMessageFailure=function(a,b){var c=a.querySelector('[data-msgid="'+b+'"]');c.setAttribute("data-msgfailure","true"),c.nextSibling&&c.nextSibling.getAttribute("data-timefrag")&&(c.nextSibling.innerText=$WC.I18N("message.status.failed"))},WMSUI.getStype=function(a){if((a&WmsContacts.userstatus.MOB_LOGIN)===WmsContacts.userstatus.MOB_LOGIN)return WmsContacts.userstatus.MOB_LOGIN;if((a&WmsContacts.userstatus.WEB_LOGIN)===WmsContacts.userstatus.WEB_LOGIN)return WmsContacts.userstatus.WEB_LOGIN},WMSUI.generateUI=function(){var a='<span id="wms_cw_videoinfo" class="wms_cw_videoinfo" data-videoinfo=true ><div id="wms_videoinfo_dropdown" class="wms_videoinfo_dropdown" data-videodropdown=true><div class="wms_cw_toolbar_actionitem" data-audioicon=true  style="display: none;">'+$WC.I18N("chat.audio.call")+"</div>"+'<div class="wms_cw_toolbar_actionitem" data-videoicon=true  style="display: none;">'+$WC.I18N("chat.video.call")+"</div>"+'<div class="wms_cw_toolbar_actionitem" data-shareicon=true  style="display: none;">'+$WC.I18N("chat.screen.share")+"</div>"+"</div>"+"</span>"+'<span class="wms_cw_minimizeicon" data-minimizeicon="true" title="'+$WC.I18N("chat.minimize")+'"></span>'+'<span class="wms_cw_enlargeicon" data-enlargeicon="true" title="'+$WC.I18N("chat.enlarge")+'"></span>'+'<span class="wms_cw_closeicon" data-closeicon="true" title="'+$WC.I18N("Close")+'"></span>',b='<div class="wms_cw_header" data-header="true"><div class="wms_cw_header_avatar" data-avatar="true"></div><div class="wms_cw_header_main wms-truncate-ellipsis" data-titlecontainer="true"  data-main="true"><div><div data-title="true" class="wms_cw_header_name"></div><span data-edittitleicon="true" class="wms_cw_settitle"></span><span data-channelrestricted=false class="wms_cw_channellock" title="'+$WC.I18N("channel.inviteonly")+'"></span></span>'+"</div>"+'<div class="wms_cw_statusmsg" data-statusmsg="true" title="Offline">Offline</div>'+"</div>"+'<div class="wms_cw_header_actions" data-actions="true">'+a+"</div>"+"</div>",c='<div id="{{chid}}" class="wms_cw_cont wms_chatwindow wms_bubbletheme"><div data-main=true class="wms_cw" >'+b+'<div class="wms_mediacall_space" data-videospace=true media-action="maximize">'+'<span class="wms_callstatus_text wms-halign"></span>'+'<div class="wms_mediacall_container">'+'<div class="wms_outgoing_call_text wms-halign"></div>'+'<div class="wms_screenshare_container"><video class="wms_sharedscreen" media-action="switchvideo"></video></div>'+'<div class="wms_remotevideo_container"><video class="wms_remotestream" media-action="switchvideo"></video><div class="wms_remoteuserimg wms-hvalign"><img></img></div><div class="wms_mediaoff_notify"></div></div>'+'<div class="wms_localvideo_container" media-action="switchvideo" title="'+$WC.I18N("mediacall.switchvideo")+'"><video class="wms_localstream" autoplay="autoplay"></video><div class="wms_localuserimg"><img></img></div></div>'+"</div>"+'<div class="wms_videocall_button wms_options_button" media-action="options" title="'+$WC.I18N("mediacall.options")+'">'+'<div class="wms_options_container">'+"</div>"+"</div>"+'<div class="wms_videocall_button wms_minimize_button" media-action="minimize" title="'+$WC.I18N("minimize")+'"></div>'+'<div class="wms_videocall_button wms_fullscreen_button" media-action="togglefullscreen" title="'+$WC.I18N("mediacall.fullscreen")+'"></div>'+'<div class="wms_mediacall_timer"></div>'+'<div class="wms_videocall_buttons_list">'+'<div class="wms_videocall_button wms_togglemic_button" media-action="togglemic" title="'+$WC.I18N("mediacall.mic.off")+'"></div>'+'<div class="wms_videocall_button wms_endcall_button" media-action="endcall" title="'+$WC.I18N("mediacall.end")+'"></div>'+'<div class="wms_videocall_button wms_togglevideo_button" media-action="togglecam" title="'+$WC.I18N("mediacall.cam.off")+'"></div>'+"</div>"+"</div>"+'<div data-ctrlcomp="true" class="wms_cw_main_parent">'+'<div class="wms_cw_main" id="ctrlcomp" data-msgdisp="true"></div>'+"</div>"+'<div class="wms_cw_floating_containers">'+'<div data-errormsg=true class="wms_cw_errormsg wms-halign"></div>'+'<div data-pinmsg=true class="wms_pinmsg_column" data-show-options="true">'+'<div class="wms_pinmsg_icon"></div>'+'<div class="wms_pinmsg_content"></div>'+'<div class="wms_pinmsg_options" data-pinmsg-options="false">'+'<div id="wms_pinmsg_dropdown" class="wms_pinmsg_dropdown" data-pindropdown="false">'+'<div class="wms_cw_toolbar_actionitem" data-msg-unpin="true">'+$WC.I18N("pinmsg.unpin")+"</div>"+'<div class="wms_cw_toolbar_actionitem" data-pinoption-duration="true">'+$WC.I18N("pinmsg.timeleft",[$WC.I18N("chat.forever")])+"</div>"+"</div>"+"</div>"+"</div>"+'<div data-progressbar=true class="wms-loadingmn">'+'<div class="wms_cw_progressbar_basic" data-progressbar-basic=false></div>'+'<div class="wms_cw_progressbar_advanced">'+'<div class="wms_cw_progressholder" data-progressholder="true">'+'<div class="wms-loading-sub" data-progressindicator="true"></div>'+"</div>"+'<div class="wms_fileuploaddetails" data-purpose="filecontainer">'+'<div class="wms_fileuploadcnt">'+'<span id="wmsloadingtxt" class="wms-loading-text" data-progresstext="true">'+$WC.I18N("Sharing_$1_of_$2")+"</span>"+'<span class="wms_file_errorinfo"></span>'+'<span class="wms_file_failurecount" id="wms_failcountbar"></span>'+"</div>"+'<div class="wms_fileuploadopts">'+'<span id="retryall" data-purpose="retryall" class="wms_fileupld_resend"></span>'+'<span id="wms_fileexpandicon" data-purpose="expand" class="wms_fileupld_expand"></span>'+'<span data-purpose="uploadcancel" class="wms_fileupld_close"></span>'+"</div>"+"</div>"+"</div>"+'<div id="wms_expandfilescontainer" class="wms_filescontainer"></div>'+"</div>"+'<div data-newmsgbanner="false" class="wms_unread_banner wms-halign"><span class="wms_unread_banner_text">'+$WC.I18N("chat.newmessages")+"</span></div>"+'<div data-datecomp="true" class="wms_datehint wms-halign"></div>'+"</div>"+'<div data-dragcomp="true" class="wms_cw_drag" style="display:none">'+"<span>"+$WC.I18N("chat.file.drop")+"</span>"+"</div>"+'<div class="wms_cw_toolbar" data-toolbar=true>'+'<span class="wms_cw_typingstatus wms-truncate-ellipsis" data-typingstatusnode=true data-typingstatus=false></span>'+'<button class="wms_cw_toolbar_actionbutton" data-action=true >'+$WC.I18N("Actions")+"</button>"+'<div data-scrolldown="true" class="wms_scrolldown_button" title="'+$WC.I18N("chat.scroll.bottom")+'"></div>'+'<div class="wms_cw_toolbar_actionlist" data-actionlist=true>'+"</div>"+"</div>"+'<div class="wms-smileycontainer" data-smileycontainer=true></div>'+'<div class="wms-urlpreviewcontainer" data-urlpreviewcontainer=true></div>'+'<div class="wms_cw_footer" data-footer=true>'+'<div class="wms_editorreply" data-editorreply=true></div>'+'<div id="wms-autocomplete" class="wms-autocomplete" data-autocomplete=true style="display:none"></div>'+'<div data-footercont=true class="wms_cw_footer_cont">'+'<div class="wms_composer_restriction_info"><span class="wms_composer_restriction_text" data-restriction-text=true></span></div>'+'<div data-attachment=true class="wms_cw_footer_att">';return c+='<form type="html5" name="uploads{{chid}}" enctype="multipart/form-data" class="wms_cw_actualfile" chid="{{chid}}" id="formsend" title="'+$WC.I18N("share.file")+'">'+'<input name="file1" id="wms-file" type="file" multiple size="30"/>'+"</form>",c+='</div><div id="wms-wrapperdiv" class="wms-wrapperdiv"><div id="wms-editorscrolldiv" class="wms-invisiblediv wms_cw_footer_editor"></div><div id="wms-invisiblediv" class="wms-invisiblediv wms_cw_footer_editor" data-invisiblediv=true></div><textarea  class="wms_cw_footer_editor" data-composer=true chid={{chid}} ></textarea></div><div id="wms-smileyinvoker" class="wms-smileyinvoker wms-valign-mid-block" "></div></div>',c+='<div class="wms_cw_footer_cont wms_cw_msgopr" data-msgoperation="true"><div data-fwdclose="true" class="wms_msgopr_close"></div><div class="wms-valign-mid-block wms_fwdmsg"><span data-msgselectcnt="true">'+$WC.I18N("msg.select.fwdcnt",[1])+"</span>"+"</div>"+'<div data-fwdmsg="true" class="wms_msgforward wms-valign-mid-block"></div>'+"</div>"+"</div>",c+='<div class="wms-resendoverlay" data-resendoverlay="true"><div class="wms-resendmsgoptsdiv wms-hvalign"><div data-operation="wms-resend" class="wms-resendmsgopts"><span>'+$WC.I18N("chat.msg.resend")+"</span>"+"</div>"+'<div data-operation="wms-resendall" class="wms-resendmsgopts">'+"<span></span>"+"</div>"+'<div data-operation="wms-resenddel" class="wms-resendmsgopts">'+"<span>"+$WC.I18N("Delete")+"</span>"+"</div>"+'<span data-operation="wms-resendcancel" class="wms_cw_overlay_close"></span>'+"</div>"+"</div>"+"</div>"+'<div class="wms_cw_bar " data-bar="true">'+'<div class="wms_cw_bar_photo" data-baravatar=true /></div>'+'<span class="wms_cw_bar_msgcount" data-barmsgcount=true></span>'+'<span class="wms_cw_bar_typing_indicator wms_cw_bar_typing_online" data-typingsymbol="true"></span>'+'<span class="wms_cw_bar_name wms-truncate-ellipsis" data-bartitle=true>{{title}}</span>'+'<span class="wms_minimized_close wms_cw_opr_close" data-barclose="true"></span>'+"</div>"+"</div>",c},WMSUI.handleSync=function(a){var b=a.parentNode.querySelector('[id="wms-invisiblediv"]');b.scrollTop=a.scrollTop},WMSUI.isBarVisible=function(){return getComputedStyle(WmsMainUI.maincontainer).display=="block"},WMSUI.handleKeyMovement=function(a,b,c){var d=a.getElementsByClassName(c),e=null;b===40?e=d[0].nextSibling||a.firstChild:b===38&&(e=d[0].previousSibling||a.lastChild),d[0]&&$WC.Util.removeClass(d[0],c),$WC.Util.addClass(e,c)},WMSUI.createNewChatWindow=function(a){function b(a){if(a.temp_info&&a.t121t){var b=JSON.parse(a.t121t);for(var c in b)if(c!==$WC.Config.get("zuid"))var d=c;return WmsContacts.getDisplayName(d)||b[d]}return WmsContacts.getDisplayName(a.sender)||a.dname}function c(c,d,e,f){if($WC.Util.isChannelChid(f))return $WC.Channels.getChannelName(f)||e;if($WC.Util.isBotChid(f))return $WC.Bots.getBotName($WC.Bots.getBotId(f))||e;if(e)return e;if(d===2)return b(a);if(d>2)return $WC.I18N("Group_Chat")}function d(a,b){return b<=2?WmsContacts.status(a):""}function e(a,b){return b<=2?WmsContacts.getStatusType(a):""}function f(a,b){return b<=2?WmsContacts.getStatusMsg(a):""}function g(b,c){if(c<=2)return typeof b=="string"?(b=b.split(","),b[0]===WebMessanger.zuid?b[1]:b[0]):b&&b[0]?b[0].uname:a.sender;if(c>2&&typeof b=="string")return b=b.split(","),b.indexOf(WebMessanger.zuid)!=-1&&b.splice(b.indexOf(WebMessanger.zuid),1),b}!a.sender&&a.users&&a.users[0]&&(a.sender=a.users[0].uname);var h=c(a.sender,a.pcount,a.title,a.chid),i=a.chid,j=a.pcount,k=a.sender,l=a.recipants?g(a.recipants,j):g(a.users,j),m=d(k,j),n=e(k,j),o=f(k,j),p=a.ctype,q=a.salesiqchat||!1,r=$WC.WmsSessionStorage.getChatInfo(i,"state");r=r===null||q===!1?"min":r;if(WmsMainUI.isAutoFocusScheduled(a.chid)||j==2&&WmsMainUI.isAutoFocusScheduled(l)||q&&a.usertriggered)r="max";var s=$WC.WmsSessionStorage.getChatInfo(i,"text"),t=a.a==="1"?!0:!1,u=a.prd,v=a.addinfo,w=a.context?JSON.parse(a.context).weburl:"",x=a.entityid,y={addinfo:v,recipant:l,divId:i,title:h,scode:m,stype:n,smsg:o,ctype:p,winstate:r,composertext:s,historystorage:a.history,entityweburl:w,entityid:x,lastmsgtime:+a.time,attached:t,pcount:j,prdcode:u,mutedinterval:a.mutedinterval,salesiqchat:q,stickymessage:a.stickymessage,customgroup:a.customgroup};Factory.createDialog(WMSUI.generateUI(),y)},WMSUI.rejectContact=function(a,b){try{WmsContacts.reject("zoho",b,WebMessanger.uname)}catch(c){}},WMSUI.setServiceStatus=function(a){WebMessanger.isServiceStatus()===!1&&(WmsMainUI.servicestatusdiv.innerHTML=a)},WMSUI.populateMainBar=function(){typeof WMSUI.smartchatenabled=="undefined"&&(WMSUI.smartchatenabled=!0),WebMessanger.registerAnnonUser||(wmsnotifyowner=new $WC.NotificationOwner("chat",!0)),WmsMainUI.populate(),document.getElementById("wmsbarmovablehint").onclick=WmsHybridSearch.toggleUI;return},WMSUI.populate=function(){var a=document.createDocumentFragment(),b=$WC.Util.createElement("DIV","annmsgstrip","zread_strip");b.onclick=function(){WMSUI.annShowAnimate("wmsannmsg")};var c='<span id="annmsg"></span><div id="hideinfo" class="zchdr_arw"></div><a id="clearannmsg" style="text-decoration:underline; float:right; font-size: 11px; margin: 2px 25px 0px 0px">Do not show again</a>',d=$WC.Util.createElement("DIV","wmsannmsg","zread_olymn",null,c);d.style.display="none",d.onclick=function(a){var b=$WC.Util.getEventTarget(a);b&&b.tagName!=="A"?WMSUI.hideAnnMsg(a):typeof a.stopPropagation=="function"?a.stopPropagation():a.cancelBubble=!0},d.style.zIndex=WebMessanger.setzindex,b.style.zIndex=WebMessanger.setzindex,b.appendChild(d),a.appendChild(b),document.body.appendChild(a),$WC.Util.addEvent(document.getElementById("hideinfo"),"click",WMSUI.hideAnnMsg),$WC.Util.addEvent(document.getElementById("clearannmsg"),"click",WMSUI.clearBannerAndUpdate)},WMSUI.clearBannerAndUpdate=function(){WMSUI.clearAnnBanner(),WmsSettings.updateWmsSettings("bchatsettings","disann");var a=document.location.hostname.split("."),b=a[a.length-2]+"."+a[a.length-1];$WC.Cookie.set(wmsUserConfig.infomsgid,"true",2592e6,b)},WMSUI.clearAnnBanner=function(){var a=document.getElementById("annmsgstrip");a&&(a.style.display="none")},WMSUI.addIndocClickcallbackQue=function(a,b,c,d){ie&&(WMSUI.handleDocumentClick(d),WMSKeyHandler.skipeventlistener=!0);var e={};e.htmlObj=b,e.cbfunction=c,WMSUI.docClickcallbackQue[a]=e},WMSUI.handleDocumentClick=function(a){try{var b=WMSUI.getEventSrc(a),c=WMSUI.docClickcallbackQue;for(var d in c){var e=c[d],f=e.cbfunction(b.id);f||delete WMSUI.docClickcallbackQue[d]}}catch(g){}},WMSUI.deleteParticipant=function(a,b,c,d){if(WMSUI.showErrorIfPermDenied(a))return;var e=$WC.I18N("info.chat.participant.remove",[c]),f=new $WC.ConfirmationDialog,g=[{text:$WC.I18N("chat.member.remove"),onclick:function(){WebMessanger.deleteMember(a,b),d(),f.unmountComponent()},buttonstyle:"destructive_button"}],h={actions:g,heading:e,bodytitle:$WC.I18N("dialogue.info.header"),headerimgsrc:$WC.WmsContacts.getUserPhoto(b,"38"),content:[$WC.I18N("info.participant.remove.info1"),$WC.I18N("info.participant.remove.info2"),$WC.I18N("info.participant.remove.info3")]};f.mountComponent(h)},WMSUI.startMeeting=function(a){try{a==undefined&&(a=WMSUI.currentId);var b=WmsContacts.getEmailId(a),c=wmsmeetingurl+"/login/MeetNow.jsp?participants="+b+"&source=chatbar";window.open(c)}catch(d){}},WMSUI.makeMediaCall=function(a,b,c,d,e){if(WebMessanger.isMediaCallEnabled(a)&&WmsSettings.getAdminSetting("isMediacallAllowed")){b==undefined&&(b=WMSUI.currentId),VideoCallReceiver.setNewWindow(c);if(WebMessanger.orgid!="456089"&&navigator.userAgent.indexOf("Electron")===-1||!!c)a==="voice"?WMSTP.handleNewAudioWHivi(getZuid(),b):a==="video"?WMSTP.handleNewVideo(getZuid(),b):a==="screen"&&WMSTP.handleNewScreenCall(getZuid(),b);else{if(!d){var f=WebMessanger.ucmap[b];d=WindowHandler.getWinObjById(f)}d&&(d.iscallongoing=!0),WmsAVChat.startCall(b,a,WmsAVChat.CALL_MODE_OUTGOING,d,e)}}},WMSUI.regenerateStatus=function(){WebMessanger.getAllStatusMessage()},WMSUI.clearCustomStatus=function(){WmsMainUI.statuscontainer.style.display="none",WebMessanger.clearCustomStatus(),WebMessanger.scode="1",WebMessanger.smsg="Available",$WC.Util.removeClass(WmsMainUI.settingsdropdownicon,"wms_settings_close"),$WC.Util.addClass(WmsMainUI.settingsdropdownicon,"wms_settings"),WmsMainUI.settingsdropdownicon.setAttribute("data-settings","true")},WMSUI.updateStatus=function(a,b){WebMessanger.scode=a,WebMessanger.smsg=b,WebMessanger.registerAnnonUser||setTimeout(function(){WMSUI.regenerateStatus()},500)},WMSUI.initI18NUserStatus=function(){WMSUI.i18Nuserstatus={Available:$WC.I18N("Available"),Invisible:$WC.I18N("Invisible"),Busy:$WC.I18N("Busy"),Away:$WC.I18N("userstatus.away"),Idle:$WC.I18N("Idle")}},WMSUI.geti18NUserStatus=function(a,b){var c={};return b=b.trim(),WMSUI.i18Nuserstatus==null&&WMSUI.initI18NUserStatus(),b==WMSUI.i18Nuserstatus.Available||b.length==0?(b="Available",a=1):b==WMSUI.i18Nuserstatus.Busy?(b="Busy",a=3):b==WMSUI.i18Nuserstatus.Away?(b="Away",a=7):b==WMSUI.i18Nuserstatus.Idle?(b="Idle",a=4):b==WMSUI.i18Nuserstatus.Invisible&&(b="Invisible",a=2),c.scode=a,c.smsg=b,c},WMSUI.setStatus=function(a,b,c){try{var d=WMSUI.geti18NUserStatus(a,b);b=d.smsg,c&&(b=unescape(b),b=$WC.Util.unescapeHTML(b));if(WebMessanger.smsg!=b||WebMessanger.scode!=a)WebMessanger.scode=a,WebMessanger.smsg=b,WmsMainUI.statuscontainer.style.display="none",WmsMainUI.statuscontainer.setAttribute("data-showstatus","false"),WebMessanger.setStatus(a,b);$WC.Util.removeClass(WmsMainUI.settingsdropdownicon,"wms_settings_close"),$WC.Util.addClass(WmsMainUI.settingsdropdownicon,"wms_settings"),WmsMainUI.settingsdropdownicon.setAttribute("data-settings","true")}catch(e){}return!1},WMSUI.inviteMember=function(a,b){var c=$WC.Config.get("inviteaction");if(typeof c=="function")WmsImplHandler.invoke(c,a);else{var d=new $WC.ConfirmationDialog,e=[{text:$WC.I18N("chat.contact.add"),onclick:function(){WmsContacts.add("zoho",a,WebMessanger.uname),d.unmountComponent()},buttonstyle:"confirmation_button"}],f={actions:e,heading:b?$WC.I18N("chat.contact.addinfo",[b]):$WC.I18N("chat.contact.inviteinfo")};a!==b&&(f.headerimgsrc=$WC.WmsContacts.getUserPhoto(a,"38")),d.mountComponent(f)}},WMSUI.getEventSrc=function(a){var b;return a||(a=window.event),a.target?b=a.target:a.srcElement&&(b=a.srcElement),b.nodeType==3&&(b=b.parentNode),b},WMSUI.handleStatusChange=function(a,b){b||(b=window.event);var c=window.event?b.keyCode:b.which;if(c==13){mz&&b.preventDefault(),ie&&(b.cancelBubble=!0,b.returnValue=!1);var d=a.trim();WebMessanger.smsg!=d&&WMSUI.setStatus(WebMessanger.scode,d,!1)}else c==27&&(mz&&b.preventDefault(),ie&&(b.cancelBubble=!0,b.returnValue=!1))},WMSUI.populateCustomStatus=function(a){if(a==null)return;var b=a.length;if(b<=0)return;var c=document.createDocumentFragment(),d=document.createDocumentFragment(),e=document.createDocumentFragment(),f=document.createDocumentFragment(),g=function(a,b,c){c=c==="Available"||c==="Busy"||c==="Invisible"?WMSUI.i18Nuserstatus[c]:c;var d;b==1?d="available":b==3?d="busy":b==7?d="away":d="offline";var e='<span data-staticon class="wms_cstatusicon wms-valign-mid-block wms-statusicon-'+d+'"></span><span data-statmsg class="wms-stat wms-truncate-ellipsis" title="'+$WC.Util.escapeHTML(c)+'"></span>',f=$WC.Util.createElement("p",null,"wms-stp",{"data-smsg":c},e);$WC.Util.addEvent(f,"click",function(){WMSUI.setStatus(b,this.getAttribute("data-smsg"))}),a.appendChild(f),$WC.$CUtil.setInnerText(f.querySelector("[data-statmsg]"),c)};for(var h=0;h<b;h++){var i=$WC.Util.unescapeHTML(a[h].ENC_STATUSMSG||a[h].STATUSMSG);(WMSUI.i18Nuserstatus==null||WMSUI.i18Nuserstatus==undefined)&&WMSUI.initI18NUserStatus(),(a[h].SYSTEM!=1||i=="Available")&&g(c,1,i),(a[h].SYSTEM!=1||i=="Busy")&&g(d,3,i),(a[h].SYSTEM!=1||i=="Away")&&g(e,7,i),a[h].SYSTEM==1&&i=="Invisible"&&g(f,2,i)}var j=$WC.Util.createElement("p",null,null,null,'<p class="wms-stp" ><img src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/spacer.gif"/><span class="wms-stat">'+$WC.I18N("Clear_status_message")+"</span></p>");j.onclick=WMSUI.clearCustomStatus;var k=WmsMainUI.statuscontainer;k.innerHTML="",k.appendChild(c),k.appendChild(d),k.appendChild(f),k.appendChild(j)},WMSUI.updateInvitations=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=WmsContacts.get(c);if(d==null)continue;var e={};e.zuid=d.USERID,e.dname=d.DNAME,e.uname=d.USERID,e.email=d.EMAILID,WmsHybridSearch.showInvite(e)}};var naKeyCodes=new Array("33","34","36","37","39","45","144","145","16","17","18","91");WMSUI.handleStatus=function(a,b,c,d){var e=WindowHandler.getWinObjById(c);if(e.salesiqchat)return!0;a.keyCode!==27&&$WC.WmsSessionStorage.setChatInfo({chid:c,text:b.value});if(a.keyCode==27||a.keyCode==37||a.keyCode==39||a.keyCode==38||a.keyCode==40||a.keyCode==13)return;var f=b.selectionStart,g=b.value,h=e.invisiblediv,i=e.autocompletediv;g==""&&(h.innerHTML="",b.removeAttribute("data-command"),i.style.display="none"),g=g.substring(0,f);var j=0,k=h.innerHTML,l=Message.getMsgCategory(k),m=l==="command"?Commands.getAllowedTriggers(b):Message.getCurtriggers(l),n=WindowHandler.getWinObjById(c);for(var o=0;o<m.length;o++){var p=g.lastIndexOf(" "+m[o])+1;p==0&&(p=g.lastIndexOf("\n"+m[o])+1),p===0&&g.indexOf(m[o])!==0&&(p=-1),p!==-1&&p>=j&&(j=p,WMSUI.curtrigger=m[o])}n.composer.scrollHeight>56&&n.changeFooterHeight();if(WMSUI.curtrigger==="-"&&g.indexOf("/")!=-1)return Commands.show(c,!0),!0;if(WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ATMENTION&&n.ctype!=="5"||WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ADDMEM&&n.ctype!=="10"&&(n.ctype!=="1"||n.partcount!=2))WMSUI.atMentions.init(c,b);else if(WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.SMILEY)WMSUI.autoComplete.init(c,b);else{if(n.salesiqchat!==!0&&WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.SLASH&&g.startsWith($WC.WmsConstants.TRIGGERS.SLASH))return Commands.show(c),!0;a.type==="input"&&a.inputType==="deleteContentBackward"&&(clearTimeout(this.timeout),this.timeout=setTimeout(function(){n.hideUrlPreview()},500))}n.checkAndDeleteDraft();if(g.indexOf("https://")>-1||g.indexOf("http://")>-1)n.mainwin.querySelector("[data-editmsg]")||n.showUrlPreview();if(a.keyCode>=112&&a.keyCode<=123)return!0;for(o=0;o<naKeyCodes.length;o++)if(a.keyCode==naKeyCodes[o])return!0;typeof d=="undefined"&&b.getAttribute("data-command")==null&&Self.status.active(c)},WMSUI.showErrorIfPermDenied=function(a){var b=WindowHandler.getWinObjById(a);return b&&b.permdenied?(alert($WC.I18N("Permission_Denied_You_are_no_longer_member_of_this_chat")),!0):!1},WMSUI.handleEvent=function(a,b,c){var d=WindowHandler.getWinObjById(c);if(d.salesiqchat)return!0;try{try{if(a.keyCode==13&&a.shiftKey)return!0}catch(e){}if(a.keyCode>=112&&a.keyCode<=123)return!0;if(a.keyCode==27)try{return ChatBlink.stopRepeat(),WMSUI.handleChatWindowEscape(a,c)?!1:(WindowHandler.closeWinById(c),WMSKeyHandler.cancelEvent(a),!1)}catch(f){}if(a.keyCode==9&&!a.ctrlKey&&!a.shiftKey)return WindowHandler.moveFocus(c),!1;if(a.keyCode==9&&a.shiftKey)return WindowHandler.moveFocus(c,!0),!1;var g=document.getElementById(c);if(a.keyCode==86&&(a.ctrlKey||a.metaKey)&&d.ctype!="5"&&d.editorreplydiv.getAttribute("data-editmsg")!=="true"&&navigator.userAgent.indexOf("Firefox")!=-1){var h=a.target,i=h.selectionStart,j=h.value.substring(0,i),k=h.value.substring(i),l=document.getElementById("wms-pasteCapture");l.focus(),l.innerHTML="",setTimeout(function(){var d;if(l.childNodes[0]&&l.childNodes[0].nodeName=="IMG"){var e=l.childNodes[0].getAttribute("src");if(e.match(/^data:image/)){var f=atob(e.split(",")[1]),g=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(f.length),m=new Uint8Array(i);for(d=0;d<f.length;d++)m[d]=f.charCodeAt(d);var n=new Blob([m],{type:g});WmsFileUploadUI.handlePreview(h.getAttribute("chid"),[n]),document.getElementById("wms-fileupldcmt").focus()}}else if(l.childNodes){var o=l.querySelectorAll("br");for(d=0;d<o.length;d++)o[d].parentNode.replaceChild(document.createTextNode("\n"),o[d]);j+=$WC.Util.getInnerText(l),h.value=j+k,$WC.Util.moveCaretPosition(h,j.length,j.length),WMSUI.handleStatus(a,b,c)}},10),a.stopPropagation()}var m=d.autocompletediv,n=d.invisiblediv,o=d.atmentions;Message.trim(b.value)==""&&(n.innerHTML="",WMSUI.curtrigger="");if(a.keyCode==38&&Message.trim(b.value)==""){var p=d.msgdisp.querySelectorAll(".wms-msgfrag[data-msguid]"),q=Array.prototype.slice.call(p),r=p[p.length-1];while(r&&Message.isEditable(r)===!1)q.pop(),r=q[q.length-1];return d.showReplyPreview(r,!0),!1}if(a.keyCode==13){var s=!0;if(m.style.display=="block"&&WMSUI.triggers.indexOf(WMSUI.curtrigger)!==-1){a.preventDefault();return}mz&&a.preventDefault();var t=b.value;if(d.isDoubleEnter())d.setLastEnterKeyPressTime(-1),t="---";else{if(Message.trim(b.value)=="")return d.setLastEnterKeyPressTime((new Date).getTime()),b.value="",!1;d.setLastEnterKeyPressTime(-1)}o&&(t=$WC.Util.unescapeHTML(WMSUI.atMentions.formatAtMentions(t,o,c,!0)));if(Message.getMsgCategory(n.innerHTML)==="addmem")s=WMSUI.confirmAndAddMember(c,t);else if(Message.getMsgCategory(n.innerHTML)==="command"){var u=b.value.substring(0,b.value.indexOf(" "));s=Commands.handle(u,b,c)}else{var v=d.editorreplydiv.querySelector("[data-msguid]"),w=v&&v.getAttribute("data-msguid");if(d.editorreplydiv.style.display=="block"&&w)if(d.editorreplydiv.getAttribute("data-originalmsg")===t)d.showInfoMsg($WC.I18N("message.editprompt.nochange")),s=!1;else{var x=d.editorreplydiv.querySelector("#wms_notifyeditmsg").checked;s=Message.send(c,t,null,null,null,null,null,w,!0,x)}else{var y=d.getReplyMessageId();s=Message.send(c,t,null,null,null,null,y,null,!0)}m.style.display=="block"&&(m.style.display="none")}d=WindowHandler.getWinObjById(c),d.showAddUserPrompt(),d.atmentions="",$WC.WmsSessionStorage.setChatInfo({chid:c,atmentions:d.atmentions});var z=WindowHandler.getWinObjById(c).ctrlcomp;return z.scrollTop=z.scrollHeight-z.clientHeight,s&&(b.value="",n.innerHTML="",d.changeFooterHeight(),b.removeAttribute("data-command"),d.checkAndDeleteDraft()),WMSUI.handleStatus(a,b,c),!1}}catch(A){}},WMSUI.confirmAndAddMember=function(a,b,c){var d=WindowHandler.getWinObjById(a),e=c,f,g=[],h=[],i=d.atmentions||c;d.atmentions&&(e=d.atmentions.slice(0,-1).split(",")),e.length===1?(g.push(WmsContacts.get(e[0],!0).DNAME),f=$WC.I18N("chat.addmembersconfirm",[g])):(e.forEach(function(a){g.push(WmsContacts.get(a,!0).DNAME)}),g=g.join(", "),f=$WC.I18N("chat.addmembersconfirm",[g]));if(d.ctype=="8")WMSUI.inviteToChannel(a,e),WMSUI.handleMemberModificationCommand(a,i,b,!1);else{var j='<div class="wms-dialog-txtcont">'+$WC.Util.escapeHTML(f)+"</div>",k='<div class="wms-dialog-imgouter"><div class="wms-dialog-imginner"><div class="wms-dialog-img"></div></div></div>',l={imghtml:k,bodyhtml:j,focusbutton:1,operations:[{name:$WC.I18N("Add"),action:function(){WMSUI.addMem(a,e),WMSUI.handleMemberModificationCommand(a,i,b,!1)}},{name:$WC.I18N("chat.new"),action:function(){var c=WindowHandler.getWinObjById(a).partinfo;for(var d in c)e.push(d),h.push({zuid:d,dname:$WC.Util.getContactName(d)||c[d].dname});var f=WmsHybridSearch.createChatTitle(h);WmsMainUI.scheduleAutoFocus(a),WMSUI.handleMemberModificationCommand(a,i,b,!0,e,f)}}]};WmsDialog.showModal(l,a)}return!0},WMSUI.handleMemberModificationCommand=function(a,b,c,d,e,f){$WC.Util.isArray(b)||(b=b.split(","));var g="";for(var h=0;h<b.length-1;h++){var i=$WC.Util.getContactName(b[h]);WMSUI.curtrigger==="+"&&(g+="{addchatmember:"+b[h]+":1:"+i+":addchatmember} ")}return g=g.trim(),d?c&&c.trim()===g?WebMessanger.openUserChat(e.join(","),"true",f):WebMessanger.openUserChat(e.join(","),"true",f,c):c&&c.trim()!==g&&Message.send(a,c),!0},WMSUI.inviteToChannel=function(a,b){WebMessanger.inviteToChannel(a,b)},WMSUI.addMem=function(a,b){var c="";b.forEach(function(a){if(a){var b=WmsContacts.get(a,!0).EMAILID;c+=b.concat(",")}}),WebMessanger.addMember(a,c,b)},WMSUI.init=function(){typeof WMSUI.hidden=="undefined"&&(WMSUI.hidden=!1),WMSUI.docClickcallbackQue={},WMSUI.i18Nuserstatus=null,WMSUI.scode=1;try{WmsSound.init(),WmsMediaPlayer.initSupportedAudioFormats(),WmsMediaPlayer.initSupportedVideoFormats(),WmsMediaPlayer.bindFullScreenEvent(),WMSUI.openChatWindowDropUp=function(a,b,c){var d=WindowHandler.getWinObjById(b),e=d.autocompletediv,f=d.listcommon;c=c||{},f.showUI(a,c.defaultselect,c.sethtml,null,!0),e.style.display="block"},WMSUI.closeChatWindowDropUp=function(a){var b=WindowHandler.getWinObjById(a),c=b.autocompletediv,d=b.listcommon;d.showUI(""),c.style.display="none"},WMSUI.disableComposerOptions=function(a,b){var c=WindowHandler.getWinObjById(a);c.permdenied=!0,c.disableComposerOptions(b)},WMSUI.closeChatWindow=function(a){var b=WindowHandler.getWinObjById(a);b.close(!0)},WMSUI.updateMessageInComposer=function(a,b){var c=WindowHandler.getWinObjById(a);c.composer.value+=b,c.focus()},$WC.Functions.isTempResponse=function(a,b,c){var d=document.getElementById(b),e=d&&d.querySelector('[data-msgtime="'+c+'"]'),f=a.closest('[class^="wms-msg"]')||e&&e.querySelector('[class^="wms-msg"]');return f?f.querySelectorAll('[class="wms-cmdvisiblediv"]').length>0:!1},$WC.Functions.init(),$WC.Functions.showResponse=function(a,b){if(a.type==="banner")a.status==="success"?WMSUI.showInfoMsg(a.text):a.status==="failure"&&WMSUI.showErrorMsg(a.text);else{var c=WindowHandler.getWinObjById(b),d=[];a.sender=WebMessanger.zuid,a.meta||(a.meta={}),a.meta.isTempResponse=!0;if(!a.msg)return;d.push(a),c.updateMessage(d)}},$WC.Functions.showErrorResponse=function(a,b){if(a.type==="banner")a.status==="success"?WMSUI.showInfoMsg(a.text):a.status==="failure"&&WMSUI.showErrorMsg(a.text);else{var c=WindowHandler.getWinObjById(b),d=[];a.meta&&a.meta.message_source&&a.meta.message_source.type?a.sender=a.meta.message_source.id:(a.sender=WebMessanger.zuid,a.meta={}),a.time=(new Date).getTime(),a.meta.shareIntegrationResponse=!0,d.push(a),c.updateMessage(d)}}}catch(a){}WMSUI.populate(),WMSUI.inviteObj=[],$WC.template.setResource(WmsResource);var b=isNaN(WebMessanger.setzindex)?WebMessanger.setzindex:+WebMessanger.setzindex+1;$WC.Config.set({WMSCONT:_WMSCONT,CHATCONT:_CHATCONT,PUREJS:!0,Resource:WmsResource,AjaxDispatcher:WebMessanger.wmsAjaxDispatcher,zuid:WebMessanger.zuid,zindex:b,photoserver:_WMSPHOTOSERVER,isOrgUser:WebMessanger.isOrgUser,isCliqUser:WebMessanger.isCliqUser,isRegistered:WebMessanger.isRegistered,SystemApiHandler:WebMessanger.systemApiHandler,ExecuteButtonResponseHandler:WebMessanger.executeButtonResponseHandler,LOCATION_INFO:{},getSilentUserMention:WMSUI.atMentions.getSilentMentionHtml}),$WC.$CUtil.checkAndUpdateLocationPermissionStatus();var c=$WC.Util.createElement("style");c.type="text/css",c.innerHTML="#wmstoolbar *::-webkit-scrollbar, #zchhis *::-webkit-scrollbar, #wms_fork_container *::-webkit-scrollbar{ height:8px; width:8px } #wmstoolbar *::-webkit-scrollbar-thumb, #zchhis *::-webkit-scrollbar-thumb, #wms_fork_container *::-webkit-scrollbar-thumb{ background-color: #dcdcdc }",navigator.userAgent.indexOf("Mac")!==-1&&(c.innerHTML="#wmstoolbar *::-webkit-scrollbar, #zchhis *::-webkit-scrollbar, #wms_fork_container *::-webkit-scrollbar{ height:5px; width: 5px } #wmstoolbar *::-webkit-scrollbar-thumb, #zchhis *::-webkit-scrollbar-thumb, #wms_fork_container *::-webkit-scrollbar-thumb{ background-color: #dcdcdc }"),document.body.appendChild(c)},WMSUI.reminderClose=function(a,b){WMSUI.removeNotificationHolder("reminder"+a,b),Gator(document.getElementById("reminder"+a)).off(),WebMessanger.clearReminder(a)},WMSUI.removeNotificationHolder=function(a){WmsSound.stop(),ChatBlink.stopRepeat();var b=document.getElementById(a);$WC.Util.removeElement(b)},WMSUI.reminderSubmit=function(a,b,c){c.submit(),WMSUI.reminderClose(a,!0)},WMSUI.showRemainder=function(a){if(_WMSCALENDARSERVER=="")return;var b=a.ALRM,c=$WC.Util.safeHTML(a.LOC),d=a.SD!=undefined&&a.SD!=""?a.SD:$WC.DateUtil.formatDTTime(a.ST),e='<img src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/spacer.gif" class="wms-cb" data-closerem="true" title="'+$WC.I18N("Close")+'" ><span class="wms-ri"></span><b class="wms-mo">'+$WC.Util.safeHTML(a.SUM)+'</b><span class="wms-ms">',f;c.length>0?f='<span class="wms-hd">'+$WC.I18N("Location")+"</span><span>:</span><b>"+c+"</b>":f='<span class="wms-hd"></span>',WMSUI.initWmsIframe();var g='<span class="wms-ms"><span class="wms-hd"> '+$WC.I18N("Time")+"</span><b><span>:</span>"+d+' </span><form name="form'+b+'" target="wmsiframe" action="'+_WMSCALENDARSERVER+'/ApiAct.do" method="post"><div class="wms-bo"><select name="remt" id="remindtime"><option value="300000" > 5 '+$WC.I18N("min")+' </option><option value="600000" >10 '+$WC.I18N("min")+' </option><option value="900000" > 15 '+$WC.I18N("min")+' </option><option value="1200000" > 20 '+$WC.I18N("min")+' </option></select><input type="hidden" name="view" value="snzrem"><input type="hidden" name="aid" value="'+a.ALRM+'"><input type="button" class="wms-bn" data-snoozerem="true" value="'+$WC.I18N("Snooze")+'"/><input type="button" class="wms-bc" data-cancelrem="true" value="'+$WC.I18N("Cancel")+'" /></div></form></span>',h=$WC.Util.createElement("DIV","reminder"+b,"wms-rd",{"data-divid":b},e+f+g);WMSUI.bindReminderEvents(h),WmsMainUI.notificationholder.appendChild(h)},WMSUI.initWmsIframe=function(){var a=document.getElementById("wmsiframe");if(a==undefined){var b='<IFRAME name="wmsiframe" style="display:none" id="wmsiframe" src="/'+_WMSCONT+'/html/blank.html"></IFRAME>',c=$WC.Util.createElement("DIV",null,null,null,b);c.style.display="none",document.body.appendChild(c)}},WMSUI.bindReminderEvents=function(a){var b=a.getAttribute("data-divid");Gator(a).on("mouseover","[class^=wms-cb]",function(){this.className="wms-cbh"}),Gator(a).on("mouseout","[class^=wms-cb]",function(){this.className="wms-cb"}),Gator(a).on("click","[data-closerem=true]",function(){WMSUI.reminderClose(b,!1)}),Gator(a).on("click","[data-cancelrem=true]",function(){WMSUI.reminderClose(b,!0)}),Gator(a).on("click","[data-snoozerem=true]",function(){WMSUI.reminderSubmit(b,b,this.form)})},WMSUI.attachSession=function(a){if(WMSUI.handleChatExist(a))return;WmsMainUI.scheduleAutoFocus(a),WebMessanger.attachSession(a),ZMSGUI.hidechathis()},WMSUI.handleChatExist=function(a){if(Chat.isExists(a)){var b=WindowHandler.getWinObjById(a);b.isMinimized()?b.maximize():b.unread&&b.scrollToUnread(!0),b.titleGlow()}return!1},WMSUI.handleChatWindowEscape=function(a,b){var c=WindowHandler.getWinObjById(b),d=c.autocompletediv,e=c.invisiblediv;return WmsMainUI.contactdetailsdiv.firstChild?(WmsProfileInfo.handleEscape(a),!0):d.style.display!="none"?(c.listcommon.showUI(""),d.style.display="none",c.footernode.style.borderRadius="5px",a.stopPropagation(),!0):c.editorreplydiv.style.display&&c.editorreplydiv.style.display!="none"?(c.closeReplyPreview(),a.stopPropagation(),!0):!1},WMSUI.handleDocumentEscape=function(a){WmsProfileInfo.handleEscape(a);if(WebMessanger.userslist)return ZMSGUI.removeReminderDialog();ZMSGUI.removeOverlay();var b=document.getElementById("zfdshis"),c=document.getElementById("zchhis"),d=document.getElementById("wms-hysearch"),e=document.getElementById("wms-custmmsgcontainer"),f=document.getElementById("wms-dialog"),g=document.getElementById("wms_fork_container"),h=document.getElementById("wms_pendinginv_container"),i=document.getElementById("wms_msghistdiv"),j=$WC.Util.getEventTarget(a),k=j.getAttribute("chid"),l=document.getElementById(k);if(!$WC.$Win.handleEscape()){if(b!=null&&b.style.display=="block"){try{ZMSGUI.hidehis()}catch(m){}return!0}if(c!=null)return ZMSGUI.hidechathis(),!0;if(h!=null&&h.style.display=="block")return ZMSGUI.hidependinginv(),!0;if(e!=null)return ZMSGUI.hidecustmmsg(),!0;if(d!==null)return WmsHybridSearch.hideUI(),!0;if(f!==null)return WmsDialog.removeModal(),!0;if(i!==null)return $WC.Util.removeElement(i),!0;l!=null?WMSUI.handleChatWindowEscape(a,k):g!=null&&ZMSGUI.removeForkDialog()}},WMSUI.submitFile=function(a){var b=document.getElementsByName("uploads"+a)[0],c=WindowHandler.getObjectInObject(b,"wms-file","input").files;WmsFileUploadUI.handlePreview(a,c)},WMSUI.iframeUpload=function(a){var b=WindowHandler.getWinObjById(a),c=b.getInnerObject("formsend","form");if(isNaN(a)){var d=$WC.Util.createElement("input");d.name="type",d.value=8,d.type="hidden",c.appendChild(d)}var e=c.sid,f=c.sender;e.value=WebMessanger.getSid(),f.value=WebMessanger.getUserName();var g=$WC.Util.createElement("input");g.name=_CHATCFPARAMNAME,g.value=$WC.Cookie.get(_CHATCFTOKEN),g.type="hidden",c.appendChild(g),c.submit(),document.getElementById("actiondiv").style.display="none",document.getElementById("formsend").className="wms-rigp",c.reset(),WMSUI.imgPreview.removeOverlay()},WMSUI.reinviteContByEmail=function(a){var b=WmsContacts.get(a),c=b.DNAME,d=b.EMAILID;WmsContacts.reinvite("zoho",d,c,WebMessanger.uname)},WMSUI.showBanner=function(a){if(WebMessanger.disablenetworkdownbanner||WebMessanger.isReuseSession())return;var b='<span id="wmsbannertext" class="wmsbannertext">'+$WC.I18N("connectionerror.netfail")+'</span><span id="recntime"></span><span id="wms-retrybtn" class="wms-retrybutton"  title="'+$WC.I18N("Try_Now")+'"></span>',c=$WC.Util.createElement("DIV","wms-netdownbanner","wms-statesmsg",null,b);c.style.zIndex=WebMessanger.setzindex<=9999?9999:WebMessanger.setzindex;if(this.isBannerShown("wms-netdownbanner")){var d=document.getElementById("wms-netdownbanner");d.parentNode.removeChild(d)}document.body.appendChild(c),document.getElementById("wms-retrybtn").onclick=a},WMSUI.showInfoMsg=function(a){WMSUI.showErrorMsg(a,"info")},WMSUI.showErrorMsg=function(a,b){a=Smiley.replace(a);var c="<span>"+a+'</span><span  data-hidemsg="true" class="wms_cw_opr_close wms-errormsgcls"></span>',d="wms-errormsg";b==="info"&&(d="wms-errormsg wms-infomsg");var e=$WC.Util.createElement("DIV","wms-errormsg",d,null,c);e.querySelector("[data-hidemsg=true]").onclick=WMSUI.hideErrorMsg.bind(this),e.style.zIndex=WebMessanger.setzindex<=9999?9999:WebMessanger.setzindex,WMSUI.hideErrorMsg(),document.body.appendChild(e),WMSUI.errormsgtimer=setTimeout(function(){WMSUI.hideErrorMsg()},1e4)},WMSUI.hideErrorMsg=function(){if(this.isBannerShown("wms-errormsg")){clearTimeout(WMSUI.errormsgtimer);var a=document.getElementById("wms-errormsg");a.parentNode.removeChild(a)}},WMSUI.updateTextInBanner=function(a){var b,c;if(a>60){var d=Math.floor(a/60);b=a%60,b<10&&(b="0"+b),c=d+":"+b}else b=a<10?"0"+a:a,c=b;this.isBannerShown("wms-netdownbanner")&&(a===0?document.getElementById("recntime").innerHTML=$WC.I18N("connectionerror.reconnect"):document.getElementById("recntime").innerHTML=$WC.I18N("connectionerror.reconnecttime",""+c))};var wmsCountDownTimer;WMSUI.showCountDownInBanner=function(a,b){function c(){WMSUI.updateTextInBanner(a);if(a===0){clearTimeout(wmsCountDownTimer),b();return}a--,wmsCountDownTimer=setTimeout(c,1e3)}clearTimeout(wmsCountDownTimer),c()},WMSUI.isBannerShown=function(a){return document.getElementById(a)!=null?!0:!1},WMSUI.hideBanner=function(){clearTimeout(wmsCountDownTimer);if(this.isBannerShown("wms-netdownbanner")){var a=document.getElementById("wms-netdownbanner");a.parentNode.removeChild(a)}},WMSUI.runIdleTimer=function(){if(WebMessanger.registerAnnonUser)return;clearTimeout(WMSUI.idletimer),WMSUI.idletimer=setTimeout(function(){WMSUI.handleDocumentIdle()},9e5)},WMSUI.handleDocumentIdle=function(){if(WebMessanger.registerAnnonUser)return;if(WebMessanger.scode==2)return;!WebMessanger.isIdle&&!WebMessanger.offline&&WebMessanger.setIdle()},WMSUI.checkDocumentActive=function(){ie?(document.attachEvent("onkeydown",WMSUI.handleDocumentActive),document.attachEvent("onclick",WMSUI.handleDocumentActive),document.attachEvent("onkeypress",WMSUI.handleDocumentActive),document.attachEvent("onmouseout",WMSUI.handleDocumentActive),document.attachEvent("onmouseenter",WMSUI.handleDocumentActive)):(document.addEventListener("keydown",WMSUI.handleDocumentActive,!0),document.addEventListener("keypress",WMSUI.handleDocumentActive,!0),document.addEventListener("mouseout",WMSUI.handleDocumentActive,!0),document.addEventListener("mouseenter",WMSUI.handleDocumentActive,!0),document.addEventListener("click",WMSUI.handleDocumentActive,!0))},WMSUI.handleDocumentActive=$WC.Util.throttle(function(){if(WebMessanger.registerAnnonUser)return;clearTimeout(WMSUI.idletimer),WMSUI.idletimer=setTimeout(function(){WMSUI.handleDocumentIdle()},9e5),WebMessanger.isIdle&&!WebMessanger.offline&&WebMessanger.setActive()},null,1e4),WMSUI.toggleSound=function(){WmsSettings.sound==1?WmsSettings.updateWmsSettings("bchatsettings","sound",0):WmsSettings.updateWmsSettings("bchatsettings","sound",1)},WMSUI.reqNotificationPermAndToggle=function(a){$WC.DesktopNotification.requestPermission(),WmsSettings[a]==1?$WC.Ajax.postRequestToChat("updbsettings.do",a+"=0"):$WC.Ajax.postRequestToChat("updbsettings.do",a+"=1")},WMSUI.checkAndNotifyStatus=function(a,b){if(_WMSWINFOCUS||WmsSettings.vustatus==0||$WC.Util.isLocalUser(a.zuid))return;var c=+a.scode;c===2&&(c=0);if(c===0&&b>0||c>0&&b===0){var d=c?$WC.I18N("Available"):$WC.I18N("Offline");WMSUI.desktopNotify(d,"status",a)}},WMSUI.checkAndNotifyMsg=function(a){if(_WMSWINFOCUS||$WC.Util.isLocalUser(a.zuid))return;var b=a.ctype;if(WmsSettings.vmention=="1"&&WMSUI.atMentions.isLocalUserMentioned(a)||b==="1"&&a.pcount==="2"&&WmsSettings.vmymessage=="1"||a.pcount>"2"&&WmsSettings.groupmessage_visual_notify=="1"||b==="8"&&WmsSettings.groupmessage_visual_notify=="1"||b==="9"&&WmsSettings.botmessage_visual_notify=="1"){var c=a.meta&&a.meta.mentions?WMSUI.atMentions.format(a,!0):a.msg;a.mod=="att"?c=$WC.I18N("chat.file.share"):a.mod=="contact"?c=$WC.I18N("chat.contact.share"):a.mod=="location"?c=$WC.I18N("chat.location.share"):a.mod=="event"&&(c=$WC.I18N("chat.event.share"));var d=a.sender+"_"+a.time;WMSUI.desktopNotify(c,d,a)}},WMSUI.desktopNotify=function(a,b,c){function d(a){var b=function(b,c){b==="silentmention"?a=$WC.Config.get("getSilentUserMention")(a):a=$WC.Matcher.replace(b,a,function(a,b,d){var e=Message.getDnameFromMetaDataFormat(d);return c+""+e})};return b("atmention_for_transcript","@"),b("addmember_for_transcript","+"),b("silentmention"),a}function e(a,b,c){return typeof c=="undefined"?"":$WC.Matcher.replace("removehtmltag",c,e)}if(WebMessanger.scode==="3")return;a=Message.isMentionMsg(a)||Message.isAddMsg(a)?d(a):a,a=$WC.Matcher.replace("removehtmltag",a,e);var f=c.sender||c.zuid,g="";$WC.Bots.isBotId(f)?g=$WC.Bots.getPhoto(f):g=_WMSPHOTOSERVER+"/file?ID="+f+"&t=user&height=50&width=50",$WC.DesktopNotification.show({title:$WC.Util.unescapeHTML(WMSUI.getNotificationTitle(c)),body:$WC.Util.unescapeHTML(a),icon:g,checkownership:c.a?!1:wmsnotifyowner,duration:"5000",id:b})},WMSUI.getNotificationTitle=function(a){var b=$WC.Util.getContactName(a.zuid,a.dname);if(a.chid){var c=WindowHandler.getWinObjById(a.chid),d=c?c.partcount:a.pcount,e=c?c.getTitle():a.title;if(d>2||e&&e!==b){var f=e.startsWith("@")?" ":" @";return b+f+e}}return b},WMSUI.RestartTimers=function(){WMSUI.runIdleTimer()},WMSUI.processAnnMsg=function(a,b){if(WebMessanger.silentOverriddenForAnnouncement===!1&&silent)return;var c=document.getElementById("wmsannmsg"),d=document.getElementById("annmsgstrip");b=b||"warn",c.style.display="none",d.style.display="none",c.className="zread_olymn",d.className="zread_strip";if(a===""||WMSUI.isAnnBlocked())return;if(typeof WmsUIImpl!="undefined"&&WmsUIImpl.handleAnnouncement&&WmsUIImpl.handleAnnouncement(a,b))return;$WC.Util.addClass(d,"wmsann"+b+"_strip"),$WC.Util.addClass(c,"wmsann"+b+"_bg"),d.style.display="block",document.getElementById("annmsg").innerHTML=a,WMSUI.annShowAnimate("wmsannmsg")},WMSUI.isAnnBlocked=function(){var a=WmsSettings.disann,b=wmsUserConfig.infomsgid;return $WC.Cookie.get(b)?!0:a&&(a[WebMessanger.prd]||a.All)&&b?a[WebMessanger.prd]===b||a.All===b:!1},WMSUI.showAnnMsg=function(){var a=document.getElementById("showinfo");a.setAttribute("class","zread_olymn1"),WMSUI.annHideAnimate("showinfo")},WMSUI.annHideAnimate=function(a){a=document.getElementById(a);var b=setInterval(function(){var c=a.offsetTop;a.style.top=c-1+"px",-c>=a.offsetHeight&&(clearInterval(b),a.style.display="none",a.style.top="0px")},8)},WMSUI.annShowAnimate=function(a){a=document.getElementById(a),a.style.display="block";var b=-a.offsetHeight;a.style.top=b+"px";var c=setInterval(function(){a.style.top=(b+=1)+"px",b>=3&&clearInterval(c)},8)},WMSUI.hideAnnMsg=function(a){typeof a.stopPropagation=="function"?a.stopPropagation():a.cancelBubble=!0,WMSUI.annHideAnimate("wmsannmsg")},WMSUI.showTicketAnnouncement=function(a){var b=document.getElementById("wmsiamann");b||(b=$WC.Util.createElement("div","wmsiamann","wmsiamann"),WmsMainUI.maincontainer.appendChild(b)),b.innerHTML=a},WMSUI.closeTicketAnnouncement=function(){var a=document.getElementById("wmsiamann");a&&a.parentNode.removeChild(a)},WMSUI.selectGS=function(){},WMSUI.unselectGS=function(){},WMSUI.populateDeactivatedChatUI=function(){WmsMainUI.maincontainer&&WmsMainUI.maincontainer.parentNode.removeChild(WmsMainUI.maincontainer),WmsChatCache.removeAll(),Message.deletedMessages.removeAll(),WmsMainUI.populate(),WmsMainUI.hideMenu(),WmsMainUI.menucontainer.style.display="none",wmsnotifyowner&&wmsnotifyowner.clearOwnerSync();var a=document.getElementById("chatturnoffinfo");a.style.display="block";if(WebMessanger.chatdisabled===!0){var b=WmsSettings.adminsettings.licenseduser===!1?"unlicensed":"nonappaccount";a.innerHTML=$WC.I18N("chat.disabled."+b)+"</div>"}else WebMessanger.allprdchatdeactivated===!0&&(a.innerHTML=$WC.I18N("chat.disabled.all")+' <a style="cursor:pointer;" data-unpausechat="true"> '+$WC.I18N("chat.enable.click")+"</a></div>");a.querySelector("[data-unpausechat]")&&(a.querySelector("[data-unpausechat]").onclick=WebMessanger.turnOnChat)},WMSUI.populateEmptyBar=function(){if(document.getElementById("wmstoolbar")&&_WMSCHATHIDDEN)return;WmsMainUI.maincontainer&&WmsMainUI.maincontainer.parentNode.removeChild(WmsMainUI.maincontainer),WMSUI.smartchatenabled=!1,WmsChatCache.removeAll(),WMSUI.populateMainBar()},WMSUI.showLoadingIcon=function(a,b,c){var d='<div class="wms_loading_container"><div></div><div></div><div></div></div>';c&&(d=$WC.I18N("Loading")+" "+d);var e=$WC.Util.createElement("div",null,"wms-loadingicon",{"data-loading":"true"},d);return b==="append"?a.appendChild(e):b==="prepend"?a.insertBefore(e,a.firstChild):b==="insert"?(a.parentNode.replaceChild(e,a),e):a.appendChild(e)},WMSUI.fetchParticipantsOptions=function(a){var b=WindowHandler.getWinObjById(a);if(b&&b.partcount>2&&b.ctype!=8&&b.ctype!=10)return[{operation:"remove",name:$WC.I18N("chat.participants.remove")}]},WMSUI.showParticipantsList=function(a,b){var c=!1,d=[],e=WindowHandler.getWinObjById(a),f=e==null?!0:e.fetchparticipants;f?(WebMessanger.fetchAndShowChannelMembers(a,!0),e&&(e.fetchparticipants=!1),c=!0):d=Object.keys(e.partinfo).map(function(a){return e.partinfo[a]});var g=function(a,b){var c=$WC.HybridSearch.filter("title",a,b,null,null,"desc");return c.map(function(a){return a.id})},h=function(b,c){var d=c.getAttribute("data-operation");d==="remove"?WMSUI.deleteParticipant(a,b.id,b.title,function(){var c=WindowHandler.getWinObjById(a),d=c.partinfo;delete d[b.id],d=Object.keys(d).map(function(a){return d[a]}),WMSUI.updateParticipantsList(a,d)}):c.getAttribute("data-zcprofileid")&&WmsMainUI.handleProfileClick(c)};$WC.Participants.showList(a,b,d,g,h,!1,c,WMSUI.fetchParticipantsOptions)},WMSUI.updateParticipantsList=function(a,b){$WC.Participants.updateList(a,b,WMSUI.fetchParticipantsOptions)};var ZMSG_CURRPAGE=1,ZMSG_MSGPERPAGE=10,ZMSG_HIS=!1,ZMSG_SEARCH=!1,ZMSG_SEARCHURL="",ZMSG_MSGCNT=0,ZMSG_DATAOBJ={},ZMSG_CHATCOUNT=15,ZMSG_SEARCHVALUE="",ZMSG_CHATPGNO=1,ZMSG_CHATS=[],ZMSG_CHATTOTALOBJ=0,ZMSG_chhis=null,ZMSG_USERID="",ZMSG_NO_MORE_CHATS=!1,ZMSG_translistloader,ZMSG_transmoreloader,ZMSG_MSGOBJ=[];ZMSGUI.showFeedSearchCategory=function(a){var b=a.querySelector('[id="zmsgsearch"]');b.style.display==="none"||b.style.display===""?(a.style.borderBottomRightRadius="0px",a.style.borderBottomLeftRadius="0px",b.style.display="block"):(a.style.borderRadius="5px",b.style.display="none")},ZMSGUI.selectFeedSearchCategory=function(a){var b=$WC.Util.getEventTarget(a),c=b.parentNode.previousSibling;if(c.id==="wms-selfeedcat"){var d=$WC.Util.getInnerText(b);$WC.$CUtil.setInnerText(c,d)}},ZMSGUI.generateHistoryUI=function(){return'<div id="wms-feedsheader" class="wms-feedsheader"><span class="wms-feedhiscontent wms-valign-mid-block">'+$WC.I18N("Feed_History")+"</span>"+'<span class="wms-feedsclose"></span>'+"</div>"+'<div class="wms-feedsearch">'+'<form data-feedhisform="true">'+'<div class="wms-feedsearchcat">'+'<span id="wms-selfeedcat">'+$WC.I18N("All")+"</span>"+'<ul class="wms-feedhisselct" id="zmsgsearch">'+'<li value="all">'+$WC.I18N("All")+"</li>"+'<li value="searchstr">'+$WC.I18N("Message")+"</li>"+'<li value="sender">'+$WC.I18N("Sender")+"</li>"+"</ul>"+"</div>"+'<input id="zmsgsearchtxt" type="text" placeholder="'+$WC.I18N("feeds.search")+'"  class="wmsoptiontext wms-feedsearchtxt">'+'<input type="button" value="'+$WC.I18N("Go")+'" class="wmsbtn wms-feedsearchbtn" data-gobtn="true">'+"</form>"+"</div>"+'<div  id="zfdshis_cont" class="wms-feedhiscont">'+"</div>"+'<div class="wms-feedhisnav" id="zmsghisnav">'+"</div>"+"</div>"},ZMSGUI.fillNavigation=function(a){ZMSG_CURRPAGE=parseInt(ZMSG_CURRPAGE);var b="",c=1,d=ZMSG_CURRPAGE-1,e=ZMSG_CURRPAGE+1,f=a%ZMSG_MSGPERPAGE!=0?(a-a%ZMSG_MSGPERPAGE)/ZMSG_MSGPERPAGE+1:(a-a%ZMSG_MSGPERPAGE)/ZMSG_MSGPERPAGE,g=ZMSG_CURRPAGE*ZMSG_MSGPERPAGE>a?a:ZMSG_CURRPAGE*ZMSG_MSGPERPAGE;ZMSG_CURRPAGE<=1?b='<input class="wmsleftashtext" type="button" value="'+$WC.I18N("First")+'">':b='<input class="wmsleftashtext" type="button" data-pgno="'+c+'" value="'+$WC.I18N("First")+'"><input type="button" data-pgno='+d+' value="'+$WC.I18N("Previous")+'" class="wmsleftashtext">',ZMSG_CURRPAGE*ZMSG_MSGPERPAGE>=a?b+='<input type="button" value="'+$WC.I18N("Last")+'" class="wmsrightashtext" style="margin-right: 10px;">':b+='<input type="button" value="'+$WC.I18N("Last")+'" class="wmsrightashtext" data-pgno="'+f+'" style="margin-right: 10px;"><input type="button" value="'+$WC.I18N("Next")+'" class="wmsrightashtext" data-pgno='+e+" >",b+='<span class="wms-hvalign">'+$WC.I18N("feeds.count.show",[(ZMSG_CURRPAGE-1)*ZMSG_MSGPERPAGE+1,g,a])+"</span>",document.getElementById("zmsghisnav").innerHTML=b},ZMSGUI.getHisNav=function(){if(ZMSG_SEARCH)var a=ZMSG_SEARCHURL;$WC.Ajax.requestToChat("zmsgcount.do",a)},ZMSGUI.HisMsgUIobj=function(a,b){if(a==null)return;try{a.ATTACHMENTS=JSON.parse(a.ATTACHMENTS)}catch(c){a.ATTACHMENTS=null}ZMSG_DATAOBJ[b]=a,a=ZMSGUI.formatMSG(a);var d='<div class="wms-feedhiswrapper"><div class="wms-feedhisrow"><div class="wms-feedmsgwrapper"><span class="wms-feedmsgtime">'+a.TIME+"</span>";return b<$WC.RecentChats.getUnreadFeedsCount()?d+='<span class="wms-feedmsg" style="font-weight:bold">'+a.MSG+"</span>":d+='<span class="wms-feedmsg">'+a.MSG+"</span>",d+="</div>",ZMSGUI.trim(a.URL)!=""&&ZMSGUI.trim(a.URLSTRING)!=""?d+='<div class="wms-feedurl"><a data-msgno="'+b+'" href="'+a.URL+'" target="_blank" data-feedlink="true">'+a.URLSTRING+"</a></div>":ZMSGUI.trim(a.URL)!=""?d+='<div class="wms-feedurl"><a data-msgno="'+b+'" href="'+a.URL+'" target="_blank" data-feedlink="true">'+a.URL+"</a></div>":ZMSGUI.trim(a.URLSTRING)!=""&&(d+='<div class="wms-feedurl">'+a.URLSTRING+"</div>"),d+="</div></div>",d},ZMSGUI.openfeed=function(a,b){var c=ZMSG_DATAOBJ[a];try{b=="push"&&ZMSG_MSGCNT==1&&ZMSGUI.hidenew()}catch(d){}try{return Collaboration.openURL(c.URL,c.URLSTRING,c.ATTACHMENTS,c.PRODID)}catch(d){return!0}},ZMSGUI.formatMSG=function(a){var b="",c;try{b=a.SENDER;if(b!=null&&b!=""){try{c=a.DNAME}catch(d){}isNaN(b)?c=c!=undefined&&c!=""?c:b:c=$WC.Util.getContactName(b,c)}}catch(d){}if(a.PARAMS!="")a.MSG=c!=undefined&&c!=""?WmsResource.getRealData(a.MSG,a.PARAMS)+"<span id='wmsfeedsender' class='wmsfeedsender'><span> - </span><a href='javascript:;' data-feedsender=\""+b+'">'+$WC.Util.safeHTML(c)+"</a></span>":WmsResource.getRealData(a.MSG,a.PARAMS);else{var e=new RegExp(b+" ","i");a.MSG=a.MSG.search(e)==0?a.MSG.replace(e,""):a.MSG,a.MSG=c!=undefined&&c!=""?WmsResource.getRealData(a.MSG)+"<span id='wmsfeedsender' class='wmsfeedsender'><span> - </span><a href='javascript:;' data-feedsender=\""+b+'" >'+$WC.Util.safeHTML(c)+"</a></span>":WmsResource.getRealData(a.MSG)}return a.TIME=$WC.DateUtil.formatDTTime(a.TIME),a},ZMSGUI.launchHistory=function(){try{if(ZohoFeedImpl.handleFeedHistoryUI())return}catch(a){}document.getElementById("zchhis")!=null&&ZMSGUI.hidechathis();try{ZMSGUI.hidenew()}catch(a){}ZMSG_CURRPAGE=1,ZMSG_HIS||(ozfdshis=$WC.Util.createElement("div","zfdshis","wms-feedshis wms-hvalign"),ozfdshis.style.display="none",document.body.appendChild(ozfdshis)),ozfdshis.innerHTML=ZMSGUI.generateHistoryUI(),ZMSGUI.createOverlay(),ZMSG_HIS=!0,ZMSG_SEARCH=!1,ZMSG_SEARCHURL="",document.getElementById("zmsgsearch").selectedIndex=0,document.getElementById("zmsgsearchtxt").value="",ZMSGUI.bindFeedEvents(),ZMSGUI.refreshHis()},ZMSGUI.fillHistory=function(a){var b=document.getElementById("zfdshis_cont");b.innerHTML="",ZMSG_SEARCH&&(b.innerHTML="",document.getElementById("zmsghisnav").innerHTML="");if(a==null){b.innerHTML='<div class="wmsfdsempty">'+$WC.I18N("No_feeds_found")+"</div>";if(ZMSG_SEARCH){var c=document.getElementById("zmsgsearchtxt").value;b.innerHTML='<div class="wmsfdsempty">'+$WC.I18N("No_results_match_for_your_search")+' "'+$WC.Util.safeHTML(c)+'"</div>'}ZMSGUI.showhis();return}var d=a.ZohoMessages;if(typeof d=="undefined"){b.innerHTML='<div class="wmsfdsempty">'+$WC.I18N("No_feeds_found")+"</div>",ZMSG_SEARCH&&(c=document.getElementById("zmsgsearchtxt").value,b.innerHTML='<div class="wmsfdsempty">'+$WC.I18N("No_results_match_for_your_search")+' "'+$WC.Util.safeHTML(c)+'"</div>'),ZMSGUI.showhis();return}var e=d.length;if(e<=0){b.innerHTML='<div class="wmsfdsempty">'+$WC.I18N("No_feeds_found")+"</div>",ZMSG_SEARCH&&(c=document.getElementById("zmsgsearchtxt").value,b.innerHTML='<div class="wmsfdsempty">'+$WC.I18N("No_results_match_for_your_search")+' "'+$WC.Util.safeHTML(c)+'"</div>'),ZMSGUI.showhis();return}ZMSGUI.getHisNav();for(var f=0;f<e;f++)b.insertAdjacentHTML("beforeend",ZMSGUI.HisMsgUIobj(d[f],f));ZMSGUI.showhis()},ZMSGUI.refreshHis=function(){var a="pageno="+ZMSG_CURRPAGE+"&limit="+ZMSG_MSGPERPAGE;ZMSG_SEARCH&&(a+="&"+ZMSG_SEARCHURL);var b=function(a){WebMessanger.callClearNotification();if($WC.RecentChats.getUnreadFeedsCount()&&a==="NODATA"){var b={ZohoMessages:ZMSG_MSGOBJ};ZMSGUI.fillHistory(b),ZMSG_MSGOBJ=[]}else ZMSGUI.fillHistory(a.tableToRowList)};$WC.Ajax.requestToChat("zmsg.do",a,b)},ZMSGUI.clearSearch=function(){ZMSG_SEARCH=!1,ZMSG_SEARCHURL="",ZMSG_CURRPAGE=1,document.getElementById("zmsgsearch").selectedIndex=0,document.getElementById("zmsgsearchtxt").value="",ZMSGUI.refreshHis()},ZMSGUI.searchHis=function(){ZMSG_CURRPAGE=1;var a="pageno="+ZMSG_CURRPAGE+"&limit="+ZMSG_MSGPERPAGE,b=document.getElementById("wms-selfeedcat").innerHTML,c=document.getElementById("zmsgsearchtxt").value;if(ZMSGUI.trim(c)=="")return ZMSG_SEARCH=!1,ZMSG_SEARCHURL="",$WC.Ajax.requestToChat("zmsg.do",a),!1;var d=encodeURIComponent(c),e="";switch(b){case"Message":e=e+"searchstr="+d;break;case"category":e=e+"category="+d;break;case"Sender":e=e+"sender="+d;break;case"All":e=e+"searchstr="+d,e=e+"&category="+d,e=e+"&sender="+d}return ZMSG_SEARCH=!0,ZMSG_SEARCHURL=e,$WC.Ajax.requestToChat("zmsg.do",ZMSG_SEARCHURL),!1},ZMSGUI.gotoPage=function(a){ZMSG_CURRPAGE=a,ZMSGUI.refreshHis()},ZMSGUI.hidenew=function(){ZMSGUI.removeOverlay(),ozfdsnewcont.innerHTML="",document.getElementById("zfdscnt").innerHTML=0,ZMSG_MSGCNT=0,ozfdsnew.style.display="none"},ZMSGUI.showhis=function(){WmsImplHandler.invoke(WmsUIImpl.handleFeedHistory);var a=document.getElementById("zfdshis");try{a.style.zIndex=$WC.Config.get("zindex")}catch(b){}a.style.display="block"},ZMSGUI.hidehis=function(){ZMSGUI.removeOverlay(),document.getElementById("zfdshis").style.display="none"},ZMSGUI.trim=function(a){while(a.substring(0,1)==" "||a.substring(0,1)=="\n")a=a.substring(1,a.length);while(a.substring(a.length-1,a.length)==" "||a.substring(a.length-1,a.length)=="\n")a=a.substring(0,a.length-1);return a},ZMSGUI.markAllRead=function(){try{var a=ozfdsunreadcont.getElementsByTagName("LI");for(var b=0;b<a.length;b++)a[b].getElementsByTagName("A")[0].className="sel"}catch(c){}},ZMSGUI.showChatHistory=function(a){if(document.getElementById("zchhis")!=null)return;document.getElementById("zfdshis")!=null&&ZMSGUI.hidehis(),a&&(ZMSG_USERID=a),ZMSGUI.createOverlay(),ZMSG_chhis=$WC.Util.createElement("div","zchhis","wms-hvalign"),ZMSG_chhis.style.width="780px",ZMSG_chhis.style.zIndex=$WC.Config.get("zindex"),ZMSG_CHATPGNO=1,ZMSG_NO_MORE_CHATS=!1,document.body.appendChild(ZMSG_chhis),$WC.Util.removeElement(WmsMainUI.contactdetailsdiv),WmsMainUI.contactdetailsdiv=$WC.Util.createElement("div","wms_contactdetails","wms_contactdetails"),document.body.appendChild(WmsMainUI.contactdetailsdiv),WmsMainUI.contactdetailsdiv.style.zIndex=isNaN(WebMessanger.setzindex)?"1":+WebMessanger.setzindex+3,Gator(WmsMainUI.contactdetailsdiv).on("click","[data-operation]",function(){WmsMainUI.handleProfileActions(this)}),Gator(WmsMainUI.contactdetailsdiv).on("mouseout",function(a){WmsMainUI.handleProfileMouseOut(this,a)});var b='<div class="wmsouterdiv wmscomstl"><table cellpadding="0" cellspacing="0" width="100%" class="wmsoutertbl"><thead><th>';ZMSG_USERID?b+='<div id="wms-recentchattitle" class="wms-recentchattitle"><span class="wmscloseicon" data-historyclose="true" title="'+$WC.I18N("Close")+'"></span><span class="wmsheading wmscomstl">{{RECENTCHATTITLE}}':WebMessanger.isCliqUser()?b+='<div id="wms-histitle" class="wms-histitle"><span class="wmscloseicon" data-historyclose="true" title="'+$WC.I18N("Close")+'" ></span><span class="wmsheading wmscomstl">'+$WC.I18N("chat.message.search"):b+='<div id="wms-histitle" class="wms-histitle"><span class="wmscloseicon" data-historyclose="true" title="'+$WC.I18N("Close")+'" ></span><span class="wmsheading wmscomstl">'+$WC.I18N("Chat_History"),b+='</span></div><div id="wms-hismultisel" class="wms-hisdel"><input type="checkbox"  id="wmschhisselectcheckbox" style="margin: 7px 0 0px 6px;"><button  class="wms-chdel">'+$WC.I18N("Delete")+'</button><button class="wms-chcan">'+$WC.I18N("Cancel")+"</button></div></th></thead>"+'<tbody><tr><td ><div style="width:100%;height:39px; position:relative; display:inline-block;"><div class="wms-histrymn"><input id="zchathistorytxt" type="text" class="wms-bdrrhtn" placeholder="'+$WC.I18N("Search")+'" autocomplete="off"/><img src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/spacer.gif" class="wms-zmsgsearchico"></div><div class="wms-toprhtprt"  id="wmschatcontinue" ><div><a class="wmscontinuechatlink" href="javascript:;">'+$WC.I18N("Continue_Chat")+'</a></div></td></tr><tr><td><div class="wmsoffflowingdiv wmscomstl"  style="height:540px; overflow: hidden; padding-top:0" id="zchhis_cont"><div id="chathistorywin" class="wmsoffflowingdiv wmscomstl wmschatwin" style="height:537px" ><div id="translist" style="clear:both"></div></div><div id="wmschtranscontainer" style="width: 439px;overflow: auto;height: 100%;"><div style="margin-top:55%;text-align:center;color: #BCBCBC;font-size: 14px;">'+$WC.I18N("chat.trans.select")+"</div></div></div></div></td></tr></tbody>"+"</table>"+"</div>",b=$WC.template.replace(b,{RECENTCHATTITLE:$WC.Util.unescapeHTML($WC.I18N("recent.chats.user",[WmsContacts.getDisplayName(ZMSG_USERID)]))}),ZMSG_chhis.innerHTML=b,WebMessanger.getChatTranscript(),ZMSGUI.bindHistoryEvents(),document.getElementById("zchathistorytxt").focus(),$WC.Util.addEvent(document.getElementById("chathistorywin"),"scroll",$WC.Util.debounce(function(){if(ZMSG_NO_MORE_CHATS===!0)return;var a=document.getElementById("chathistorywin");a.scrollTop+a.clientHeight>Math.floor(a.scrollHeight*.75)&&ZMSGUI.getNextPage()},null,250)),ZMSG_transContent=document.getElementById("translist"),ZMSG_translistloader=ZMSGUI.showLoadingPage(ZMSG_transContent,!0),$WC.Util.addEvent(document.getElementById("wmschatcontinue"),"click",function(){var a=ZMSG_transContent.getElementsByClassName("wms-readdiv-select");if(a&&a.length===1){var b=a[0].getAttribute("cid");WMSUI.attachSession(b)}})},ZMSGUI.showLoadingPage=function(a,b){var c=$WC.I18N("chat.loading")+'<div class="wms_loading_container"><div></div><div></div><div></div></div>',d=$WC.Util.createElement("div",null,"wms-transloading wms-zmsginfo",null,c);if(b){$WC.Util.addClass(d,"wms-zmsg-lmiddle");while(a.lastChild)a.removeChild(a.lastChild)}return a.appendChild(d)},ZMSGUI.createOverlay=function(){if(document.getElementById("wms-overlay")==null){var a=$WC.Util.createElement("div","wms-overlay","wms-overlay");a.onclick=WMSUI.handleDocumentEscape,a.style.zIndex=$WC.Config.get("zindex"),document.body.insertBefore(a,document.getElementById("wmstoolbar").nextSibling)}},ZMSGUI.removeOverlay=function(){var a=document.getElementById("wms-overlay");a&&a.parentNode.removeChild(a)},ZMSGUI.handleEvent=function(a){a||(a=window.event);var b=window.event?a.keyCode:a.which;b==40||b==38?ZMSGUI.checkChatHistory()&&(mz&&(a.preventDefault(),a.stopPropagation()),ie&&(a.cancelBubble=!0,a.returnValue=!1),ZMSGUI.handleKeyEvent(b)):b==27&&ZMSG_chhis&&(ZMSGUI.hidechathis(),WMSKeyHandler.cancelEvent(a))},ZMSGUI.checkCheckBox=function(a){a.className="wmsselecthstryinput",a.checked?ZMSGUI.selectChatDelete("all"):ZMSGUI.selectChatDelete("none")},ZMSGUI.hidechathis=function(){ZMSG_chhis&&(document.body.removeChild(ZMSG_chhis),ZMSGUI.removeOverlay(),ZMSG_chhis=null,ZMSG_SEARCHVALUE="",ZMSG_USERID="",ZMSG_CHATS=[])},ZMSGUI.hidecustmmsg=function(){var a=document.getElementById("wms-custmmsgcontainer");a&&(document.body.removeChild(a),ZMSGUI.removeOverlay())},ZMSGUI.hidependinginv=function(){var a=document.getElementById("wms_pendinginv_container");a&&(document.body.removeChild(a),ZMSGUI.removeOverlay())},ZMSGUI.removeReminderDialog=function(a){var b=document.getElementById("wms_reminderdiv"),c=document.getElementById("wms_remmemberslist");return c&&c.style.display==="block"&&!a?c.style.display="none":b&&(delete WebMessanger.userslist,b.datepicker.unmountComponent(),$WC.Util.removeElement(b),ZMSGUI.removeOverlay()),!0},ZMSGUI.removeForkDialog=function(){var a=document.getElementById("wms_fork_container");a&&(delete WebMessanger.forkedlist,$WC.Util.removeElement(a),ZMSGUI.removeOverlay())},ZMSGUI.populate=function(a){var b=a,c=0;if(b)while(c<b.length)b[c]&&b[c].lastmsginfo&&(b[c].LASTMSGINFO=JSON.parse(b[c].lastmsginfo),b[c].LASTMSGINFO.msg=typeof Message!="undefined"?Message.formatLastMsgInfo(b[c].LASTMSGINFO.msg):b[c].LASTMSGINFO.msg),b[c]&&b[c].recipants&&(b[c].PARTICIPANTS=JSON.parse(b[c].recipants)),c++;var d=ZMSG_CHATCOUNT,e=ZMSG_SEARCHVALUE,f,g="";ZMSG_transContent.querySelector("[data-historyend]")||(g="<div valign='middle' style='margin-top: 223px;margin-left: 30px;margin-right: 30px;' data-historyend='true' class='wms-zmsginfo wms-zmsg-lmiddle' >"+$WC.I18N("Chat_History_archives_all_your_chat_transcripts.You_can_search_history_for_past_chats")+"</div>"),e!=""&&!ZMSG_transContent.querySelector("[data-noresult]")&&(g='<div valign="middle" data-noresult="true" class="wms-zmsginfo wms-zmsg-lmiddle">'+$WC.I18N("No_results_match_for_your_search")+"</div>");var h=ZMSG_chhis.getElementsByTagName("INPUT");for(var i in h){if(h[i]==undefined)continue;if(h[i].id=="wmschhisselectcheckbox"){f=h[i];break}}f&&f.checked&&(f.checked=!1),ZMSG_translistloader&&(ZMSG_translistloader.parentNode.removeChild(ZMSG_translistloader),ZMSG_translistloader=null);if(b)for(i=0;i<b.length;i++){if(i==d)continue;if(b[i].pcount=="2"&&!$WC.SecurityManager.hasPermission("direct_message"))continue;var j=b[i];ZMSG_CHATTOTALOBJ=i+1;var k="",l="trans_"+j.chatid,m=typeof j.isunread!="undefined"&&j.isunread!==-1;m?k="wms-unreaddiv":k="wms-readdiv",j.CUSTOMGROUP=j.customgroup,j.TITLE=$WC.Util.unescapeHTML(j.title),j.ADDINFO=j.addinfo,j.PARTICIPANTSCOUNT=j.pcount,j.PARTICIPANTS=j.PARTICIPANTS||[];var n='<div id="'+l+'" lmtime="'+j.lmtime+'" tid="'+j.ctime+'" cid="'+j.chatid+'" class="'+k+'" purpose="chattrans"><input type="checkbox" id="input_'+j.chatid+'" data-checkbox="true" />IMAGES<div id="namedivCID" class="wms-namediv">'+$WC.Util.escapeHTML(j.title)+'</div><span class="wms-chhis-date">TRANSTIME</span><div class="wms-lastmsginfo">LASTMSGINFO</div></div>';n=n.replace(/LASTMSGINFO/g,$WC.HybridSearch.createLastMsgInfoHtml(j)),j.chat_type=="8"||j.ctype=="8"?n=n.replace(/IMAGES/g,$WC.Channels.getChannelImageHTML(j.chatid)):n=n.replace(/IMAGES/g,$WC.HybridSearch.createImageCollageHtml(j));try{n=n.replace(/TRANSTIME/g,$WC.DateUtil.formatDateWithWords(j.lmtime))}catch(o){}i>0?g+=n:g=n}else ZMSG_transContent.hasChildNodes()&&(ZMSG_NO_MORE_CHATS=!0,document.getElementById("wms-chtransnomore")===null&&(g='<div id="wms-chtransnomore" style="text-align: center;margin: 21px;">'+$WC.I18N("No more chats")+"</div>"));ZMSG_transmoreloader&&ZMSG_transmoreloader.parentNode&&ZMSG_transmoreloader.parentNode.removeChild(ZMSG_transmoreloader),ZMSG_CHATPGNO===1?ZMSG_transContent.innerHTML=g:ZMSG_transContent.innerHTML+=g,b&&b.length>=15&&(ZMSG_transmoreloader=ZMSGUI.showLoadingPage(ZMSG_transContent,!1)),$WC.Util.loadOriginalImage(ZMSG_transContent)},ZMSGUI.selectMainChkbox=function(){var a,b=0,c=ZMSG_transContent.getElementsByTagName("INPUT");for(var d in c){if(c[d]==undefined)continue;c[d].type=="checkbox"&&c[d].checked&&b++}var e=ZMSG_chhis.getElementsByTagName("INPUT");for(d=0;d<e.length;d++){if(e[d]==undefined)continue;if(e[d].id=="wmschhisselectcheckbox"){a=e[d];break}}b>=1?(a.checked=!0,b==ZMSG_CHATTOTALOBJ?a.className="wmschhischeckboxopacityhigh":a.className="wmschhischeckboxopacitylow",document.getElementById("wms-histitle")&&(document.getElementById("wms-histitle").style.opacity="0"),document.getElementById("wms-recentchattitle")&&(document.getElementById("wms-recentchattitle").style.opacity="0"),document.getElementById("wms-hismultisel").style.opacity="1",document.getElementById("wms-hismultisel").style.visibility="visible"):(a.checked=!1,ZMSGUI.hideDeleteMenu())},ZMSGUI.resetTranscriptUI=function(){document.getElementById("wmschtranscontainer").innerHTML='<div style="margin-top:55%;text-align:center;color: #BCBCBC;font-size: 14px;">'+$WC.I18N("chat.trans.select")+"</div>",document.getElementById("wmschatcontinue").style.display="none"},ZMSGUI.handleDelCancel=function(){ZMSGUI.hideDeleteMenu(),ZMSGUI.selectChatDelete("none")},ZMSGUI.hideDeleteMenu=function(){document.getElementById("wms-histitle")&&(document.getElementById("wms-histitle").style.opacity="1"),document.getElementById("wms-recentchattitle")&&(document.getElementById("wms-recentchattitle").style.opacity="1"),document.getElementById("wms-hismultisel").style.opacity="0",document.getElementById("wms-hismultisel").style.visibility="hidden"},ZMSGUI.showchhisDelete=function(a){a.getElementsByTagName("input")[0].style.visibility="visible"},ZMSGUI.hidechhisDelete=function(a){var b=a.getElementsByTagName("input")[0];b.checked||(b.style.visibility="hidden")},ZMSGUI.handleEvents=function(a,b,c,d){var e=$WC.Util.getEventTarget(a);e.id!="transdel"&&e.type!="checkbox"&&ZMSGUI.selectChat(b,c,d)},ZMSGUI.selectChat=function(a,b,c){try{document.getElementById("wmschatcontinue").style.display="block";var d=b.parentNode.getElementsByClassName("wms-readdiv-select");d[0]&&$WC.VideoPlayerFactory.removeAllComponents(d[0].getAttribute("cid"));if(d[0]&&d[0]==b&&ZMSG_SEARCHVALUE!=""){Message.glowBubble(b.getAttribute("lmtime"),document.getElementById("wmschtranscontainer"),a);return}d.length!==0&&(d[0].className="wms-readdiv"),b.className="wms-readdiv-select";if(ZMSG_SEARCHVALUE!=""&&WebMessanger.isCliqUser())var e=b.getAttribute("lmtime");ZMSGUI.viewChatTranscript(a,document.getElementById("wmschtranscontainer"),c,e)}catch(f){}},ZMSGUI.viewChatTranscript=function(a,b,c,d){b.innerHTML="";var e=$WC.Util.createElement("div","wmschshtransmsg","wmsoffflowingdiv wmscomstl",{"data-chid":a,"data-fromchat":!0,"data-unread":c});b.appendChild(e);var f=$WC.Util.createElement("div",null,null,{"data-latestchunk":"true"});d&&(f=$WC.Util.createElement("div",null,null,{"data-mentionmsgid":a+"|"+d}),b.setAttribute("data-scrolldown",!0)),f.style="display:none",e.appendChild(f),Message.loadSpecificTranscript(a,e,f),Message.addEventListenersForTranscript(e,a),Gator(e).on("click","[data-zcprofileid]",function(){WmsMainUI.handleProfileClick(this)})},ZMSGUI.deleteChat=function(a){confirm($WC.I18N("Are_you_sure_you_wish_to_delete_this_chat"))&&WebMessanger.deleteChat(a)},ZMSGUI.handleDeleteChat=function(){WebMessanger.getChatTranscript()},ZMSGUI.searchChatHistory=$WC.Util.debounce(function(a){var b=document.getElementById("zchathistorytxt");if(b.value&&ZMSG_SEARCHVALUE!==b.value||b.value==""&&a.keyCode==8){ZMSG_SEARCHVALUE=b.value,ZMSG_CHATPGNO=1,ZMSG_NO_MORE_CHATS=!1,ZMSG_APPEND_CONTENT=!1,ZMSG_translistloader=ZMSGUI.showLoadingPage(ZMSG_transContent,!0),ZMSGUI.resetTranscriptUI();if(b.value=="")WebMessanger.getChatTranscript();else if(ZMSG_USERID){var c="title="+ZMSG_SEARCHVALUE+"&recipient="+ZMSG_USERID,d={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()};$WC.Ajax.requestToChat("v1/chats",c,ZMSGUI.searchSuccessCallback,ZMSGUI.searchFailureCallback,null,null,d)}else WebMessanger.isCliqUser()?ZMSGUI.searchMessage():WebMessanger.getChatTranscript();return document.getElementById("zchathistorytxt").focus(),!1}},null,300),ZMSGUI.getNextPage=function(){if(ZMSG_CHATPGNO=="End")return;ZMSG_CHATPGNO+=1;var a=ZMSG_transContent.lastChild&&ZMSG_transContent.lastChild.previousSibling,b=a&&parseInt(a.getAttribute("lmtime"))-1;ZMSG_transmoreloader&&!ZMSG_chhis.querySelector("[class^=wms-transloading]")&&ZMSG_transContent.appendChild(ZMSG_transmoreloader),ZMSG_SEARCHVALUE==""&&b?WebMessanger.getChatTranscript(b):WebMessanger.isCliqUser()?ZMSGUI.searchMessage():b&&WebMessanger.getChatTranscript(b)},ZMSGUI.selectChatDelete=function(a){var b=ZMSG_transContent,c=b.getElementsByTagName("input");for(e in c)c[e].checked=!1,c[e].style&&(c[e].style.visibility="hidden");if(c.length==0){var d="<div valign='middle' class='cntemptymsg' style='margin-top:50%' >"+Resource.getRealValue("No_Chat_History_available")+"</div>";b.innerHTML(d);return}if(a=="all")for(var e in c)c[e].checked="true",c[e].style&&(c[e].style.visibility="visible");else if(a=="read"){var f=!1,g,h=0,i=ZMSG_chhis.getElementsByTagName("INPUT");for(e in c){var j=c[e].parentNode;if(j==null||j==undefined)continue;if(j.className=="wms-readdiv"||j.className=="wms-readdiv-select")c[e].checked=!0,f=!0,h+=1}for(e in i)if(i[e].id=="wmschhisselectcheckbox"){g=i[e];break}f==1&&(g.checked=!0,h==ZMSG_CHATTOTALOBJ?g.className="wmschhischeckboxopacityhigh":g.className="wmschhischeckboxopacitylow"),f==0&&g.checked&&(g.checked=!1)}else if(a=="unread"){f=!1,g;var k=0;i=ZMSG_chhis.getElementsByTagName("INPUT");for(e in c){var l=c[e].parentNode;if(l==null||l==undefined)continue;l.className=="wms-unreaddiv"&&(c[e].checked=!0,f=!0,k+=1)}for(e in i)if(i[e].id=="wmschhisselectcheckbox"){g=i[e];break}f==1&&(g.checked=!0,k==ZMSG_CHATTOTALOBJ?g.style.opacity=1:g.style.opacity=.5),f==0&&g.checked&&(g.checked=!1)}},ZMSGUI.selectedChatIds=function(){var a={};ZMSG_selectedids=new Array;var b=ZMSG_transContent,c=b.getElementsByTagName("input");for(var d=0;d<c.length;d++)if(c[d].checked){a[d]=c[d].id;if(a[d]==null||a[d]==undefined)continue;a[d]=a[d].replace(/input_/g,""),ZMSG_selectedids.push(a[d])}if(ZMSG_selectedids.length==1){confirm($WC.I18N("Are_you_sure_want_to_delete_a_chat"))&&WebMessanger.deleteSelectedChats(ZMSG_selectedids);var e=document.getElementById("trans_"+ZMSG_selectedids);e.parentNode.removeChild(e)}else{if(!(ZMSG_selectedids.length>1)){alert($WC.I18N("please_select_a_chat"));return}confirm($WC.I18N("Are_you_sure_want_to_delete_the_chats"))&&WebMessanger.deleteSelectedChats(ZMSG_selectedids);for(var f in ZMSG_selectedids)e=document.getElementById("trans_"+ZMSG_selectedids[f]),e.parentNode.removeChild(e)}ZMSGUI.resetTranscriptUI(),ZMSGUI.hideDeleteMenu()},ZMSGUI.clearAllUnreadChats=function(){zfdsunread.style.display=="block"?ZMSGUI.markAllRead():ZMSG_chhis.style.display=="block"&&ZMSGUI.UpdateAllUnreadChatsInHistory()},ZMSGUI.UpdateAllUnreadChatsInHistory=function(){try{var a=ZMSG_chhis.getElementsByTagName("DIV");for(var b=0;b<a.length;b++)a[b].id.indexOf("trans_")!=-1&&(a[b].className="wms-readdiv")}catch(c){}},ZMSGUI.deleteFeed=function(){try{var a=document.getElementById("zfdshis");a.style.display=="block"&&ZMSGUI.refreshHis()}catch(b){}},ZMSGUI.handleKeyEvent=$WC.Util.throttle(function(a){function c(a,b){var c=a.getAttribute("cid"),d=!1;a.className==="wms-unreaddiv"&&(d=!0),a.className="wms-readdiv-select",b&&ZMSGUI.selectChat(c,a,d)}var b=ZMSG_transContent.getElementsByClassName("wms-readdiv-select");if(b.length===1){b=Array.prototype.slice.call(b)[0];if(a==40){if(!b.nextSibling||!b.nextSibling.getAttribute("cid")){c(b,!1);return}c(b.nextSibling,!0)}else if(a==38){if(!b.previousSibling){c(b,!1);return}c(b.previousSibling,!0)}b.className="wms-readdiv"}else c(ZMSG_transContent.firstChild,!0)},null,200),ZMSGUI.checkChatHistory=function(){return ZMSG_chhis!=undefined?!0:!1},ZMSGUI.bindHistoryEvents=function(){var a=document.getElementById("zchhis");Gator(a).on("click","[data-historyclose=true]",ZMSGUI.hidechathis),Gator(a).on("click","[data-checkbox=true]",ZMSGUI.selectMainChkbox),Gator(a).on("click","[class^=wms-readdiv]",function(a){ZMSGUI.handleEvents(a,this.getAttribute("cid"),this)}),Gator(a).on("click","#wmschhisselectcheckbox",function(a){ZMSGUI.checkCheckBox(this)}),Gator(a).on("click","[class=wms-unreaddiv]",function(a){ZMSGUI.handleEvents(a,this.getAttribute("cid"),this,!0)}),Gator(a).on("mouseover","[purpose=chattrans]",function(a){ZMSGUI.showchhisDelete(this)}),Gator(a).on("mouseout","[purpose=chattrans]",function(a){ZMSGUI.hidechhisDelete(this)}),Gator(a).on("keyup","#zchathistorytxt",ZMSGUI.searchChatHistory),Gator(a).on("click","[class=wms-chdel]",ZMSGUI.selectedChatIds),Gator(a).on("click","[class=wms-chcan]",ZMSGUI.handleDelCancel)},ZMSGUI.bindFeedEvents=function(){var a=document.getElementById("zfdshis");Gator(a).on("click","[class=wms-feedsclose]",ZMSGUI.hidehis),Gator(a).on("click","#zfdshis_cont",ZMSGUI.showhis),Gator(a).on("click","#zmsgsearch",ZMSGUI.selectFeedSearchCategory),Gator(a).on("click","[class=wms-feedsearchcat]",function(){ZMSGUI.showFeedSearchCategory(this)}),Gator(a).on("click","[data-feedsender]",function(){WebMessanger.chat(this.getAttribute("data-feedsender"))}),Gator(a).on("click","[data-pgno]",function(){ZMSGUI.gotoPage(this.getAttribute("data-pgno"))}),Gator(a).on("submit","[data-feedhisform=true]",ZMSGUI.searchHis),Gator(a).on("submit","[data-gobtn=true]",ZMSGUI.searchHis),Gator(a).on("click","[data-feedlink]",function(){return ZMSGUI.openfeed(this.getAttribute("data-msgno"),"history")})},ZMSGUI.searchMessage=function(){var a=ZMSG_SEARCHVALUE,b=function(a){var b=[],a=JSON.parse(a);if(!a.data.messages&&a.data.message_tokens[0]){ZMSG_CHATS=[],ZMSGUI.populate([]),ZMSG_CHATPGNO="End";return}var c=a.data.messages;for(var d=0;d<c.length;d++){var e=c[d];e.lastmsginfo=JSON.stringify({msg:e.message||e.fcomment||e.fname,sender:e.sender,dname:e.sendername}),e.recipants=e.recipientssumm,e.lmtime=e.time,e.chatid=e.chid,e.title=e.ctitle,b.push(e)}ZMSG_CHATS=b,ZMSGUI.populate(b)},c=function(){ZMSG_CHATS=[],ZMSG_transmoreloader&&ZMSG_transmoreloader.parentNode&&$WC.Util.removeElement(ZMSG_transmoreloader),ZMSGUI.showErrorMessage()},d="message="+a+"&lim="+ZMSG_CHATCOUNT+"&pno="+ZMSG_CHATPGNO+"&raw_search_input="+a;$WC.Ajax.requestToChat("v1/messagesearch",d,b,c)},ZMSGUI.showErrorMessage=function(){var a='<div valign="middle" class="wms-zmsginfo wms-zmsg-lmiddle" errormsg="true">'+$WC.I18N("message.search.error")+"</div>";if(ZMSG_CHATPGNO==1)ZMSG_transContent.innerHTML=a;else if(!ZMSG_transContent.querySelector("[errormsg=true]")){var b=$WC.Util.createElement("div",null,"wms-zmsginfo wms-search-errormsg",{valign:"middle",errormsg:"true"});b.innerText=$WC.I18N("message.search.error"),ZMSG_transContent.appendChild(b)}},$WC.Util.pubsub.subscribe("/channels/updateui",function(){ZMSG_chhis&&ZMSGUI.populate(ZMSG_CHATS)}),ChatWindow.prototype.create=function(a,b){var c="chatwin",d="wms-cw",e;c=b.divId,this.recipant=b.recipant,this.title=b.title,this.scode=b.scode,this.stype=b.stype,this.smsg=$WC.Util.unescapeHTML(b.smsg),this.ctype=b.ctype,this.savehistory=b.historystorage,this.attached=b.attached,this.partcount=b.pcount,this.prdcode=b.prdcode,this.mutedinterval=b.mutedinterval,this.entityweburl=b.entityweburl,this.entityid=b.entityid,this.salesiqchat=b.salesiqchat,this.smileyinstance=new $WC.ZomojiComponent,this.smileyvisible=!1,this.urlpreviewvisible=!1;var f=b.winstate||"max",g=b.composertext,h=b.lastmsgtime;this.updateAddInfo(b.addinfo),this.fetchparticipants=!0,this.messageactionsinstance=new $WC.MessageActions,this.customgroup=b.customgroup,this.pinmsg_duration_selector_instance=new $WC.DurationSelector;if(document.getElementById(c)!=null){document.getElementById(c).style.display="block";var k=WindowHandler.getWinObjById(c);(WmsMainUI.isAutoFocusScheduled(this.objId)||this.partcount===2&&WmsMainUI.isAutoFocusScheduled(this.recipant))&&k.getMeFront(),WmsMainUI.isAutoFocusScheduled(this.objId)?WmsMainUI.removeAutoFocusSchedule(this.objId):this.partcount===2&&WmsMainUI.isAutoFocusScheduled(this.recipant)&&WmsMainUI.removeAutoFocusSchedule(this.recipant);return}e=$WC.Util.createElement("DIV",c),this.setObjId(c),$WC.Util.addEvent(e,"click",function(){this.makeNormalAndPropagate()}.bind(this));var i;typeof WmsUIImpl!="undefined"&&(i=WmsImplHandler.invokeSynchronously(WmsUIImpl.getChatWindowContainer,this.objId,this.ctype,this.getChannelUID(),this.getChannelServiceCode(),this.getChannelSOID(),this.entityid)),i?(this.maximized=!0,this.detached=!0,i.appendChild(e)):WindowHandler.chatbar.insertBefore(e,document.getElementById("wmsbarmovablehint"));if($WC.Util.isBotChid(this.objId))var j=$WC.Bots.getBotId(this.objId);e.outerHTML=$WC.template.replace(a,{chid:this.objId,title:this.title,photo:this.imgurl,statusmsg:this.smsg||"",winindex:this.winIndex,style:this.recipant||j?"style=cursor:pointer":""});var l=$WC.RecentChats.getFromPinnedChatList(this.objId);l?this.ispinned=!0:this.ispinned=!1,e.className=d,this.win=document.getElementById(this.objId),this.mainwin=this.win.querySelector("[data-main]"),this.barwin=this.win.querySelector("[data-bar]"),this.msgdisp=this.win.querySelector("[data-msgdisp]"),this.statusmsgnode=this.win.querySelector("[data-statusmsg]"),this.avatarnode=this.win.querySelector("[data-avatar]"),this.composer=this.win.querySelector("[data-composer]"),this.listcommon=new ListCommon(this.composer,this.getInnerObject("wms-autocomplete","div")),this.ctrlcomp=this.win.querySelector("[data-ctrlcomp]"),this.datehintnode=this.win.querySelector("[data-datecomp]"),this.newmsgbanner=this.win.querySelector("[data-newmsgbanner]"),this.scrolldownbutton=this.win.querySelector("[data-scrolldown]"),this.errormsgnode=this.win.querySelector("[data-errormsg]"),this.dragcomp=this.win.querySelector("[data-dragcomp]"),this.photo=this.win.querySelector("[data-photo]"),this.baravatarnode=this.win.querySelector("[data-baravatar]"),this.headernode=this.win.querySelector("[data-header]"),this.titlenode=this.win.querySelector("[data-titlecontainer]"),this.bartitlenode=this.win.querySelector("[data-bartitle]"),this.smileycontainer=this.win.querySelector("[data-smileycontainer]"),this.urlpreviewcontainer=this.win.querySelector("[data-urlpreviewcontainer]"),this.smileyinvoker=this.getInnerObject("wms-smileyinvoker","DIV"),this.msgdisp.setAttribute("data-chid",this.objId),this.progressbarnode=this.win.querySelector("[data-progressbar]"),this.pinmsgnode=this.win.querySelector("[data-pinmsg]"),this.pinmsgduration=this.win.querySelector("[data-pinoption-duration]"),this.actionlistnode=this.win.querySelector("[data-actionlist]"),this.actionbutton=this.win.querySelector("[data-action]"),this.typingstatusnode=this.win.querySelector("[data-typingstatusnode]"),this.typingindicatornode=this.win.querySelector("[data-typingsymbol]"),this.barmsgcountnode=this.win.querySelector("[data-barmsgcount]"),this.videoinfonode=this.win.querySelector("[data-videoinfo]"),this.videoiconnode=this.win.querySelector("[data-videoicon]"),this.videodropdownnode=this.win.querySelector("[data-videodropdown]"),this.videocontainer=this.win.querySelector("[data-videospace]"),this.audioiconnode=this.win.querySelector("[data-audioicon]"),this.shareiconnode=this.win.querySelector("[data-shareicon]"),this.attachmentnode=this.win.querySelector("[data-attachment]"),this.footernode=this.win.querySelector("[data-footercont]"),this.edittitleiconnode=this.win.querySelector("[data-edittitleicon]"),this.addmemberhiddeninputnode=this.win.querySelector("[data-addmemberhiddeninput]"),this.populateActionList(),this.recentchatsnode=this.win.querySelector("[data-recentchats]"),this.redirectnode=this.win.querySelector("[data-redirect]"),this.meetingnode=this.win.querySelector("[data-meeting]"),this.pinactionnode=this.win.querySelector("[data-pinchat]"),this.addmembernode=this.win.querySelector("[data-addparticipant]"),this.historyoffnode=this.win.querySelector("[data-historyoff]"),this.leavechannelnode=this.win.querySelector("[data-leavechannel]"),this.reverttitlenode=this.win.querySelector("[data-reverttitle]"),this.mutechatnode=this.win.querySelector('[data-mute="true"]'),this.minimizeiconnode=this.win.querySelector("[data-minimizeicon]"),this.resendoverlay=this.win.querySelector("[data-resendoverlay]"),this.resendallnode=this.win.querySelector('[data-operation="wms-resendall"]'),this.editorreplydiv=this.win.querySelector("[data-editorreply]"),this.autocompletediv=this.win.querySelector("[data-autocomplete]"),this.invisiblediv=this.win.querySelector("[data-invisiblediv]"),this.showmembersnode=this.win.querySelector("[data-showmembers]"),this.enlargeicon=this.win.querySelector("[data-enlargeicon]"),this.unsubscribebotnode=this.win.querySelector("[data-unsubscribe]"),this.msgoprnode=this.win.querySelector("[data-msgoperation]"),this.msgselectcntnode=this.win.querySelector("[data-msgselectcnt]"),this.updatePinnedInfo(this.ispinned),this.setTitle(this.title),this.avatarnode.innerHTML=$WC.HybridSearch.generateImageHtml("",$WC.WmsConstants.HYBRIDSEARCH.CONTACT),this.baravatarnode.innerHTML=$WC.HybridSearch.generateImageHtml("",$WC.WmsConstants.HYBRIDSEARCH.CONTACT),this.updateAvatar(),this.ctype==="8"||this.ctype==="1"&&this.customgroup==="true"?this.updatePartCount(this.partcount):this.updateUserStatus(this.scode,this.smsg,this.stype),navigator.userAgent.indexOf("Firefox")==-1&&(this.composer.onpaste=function(a){var b=this.getAttribute("chid"),c=WindowHandler.getWinObjById(b);c.ctype!="5"&&c.editorreplydiv.getAttribute("data-editmsg")!=="true"&&!c.permdenied&&WmsFileUploadUI.handlePaste(a),a.stopPropagation()});if(g){this.composer.focus(),this.atmentions=$WC.WmsSessionStorage.getChatInfo(this.objId,"atmentions"),this.composer.value=g;if(this.atmentions){var m=WMSUI.atMentions.formatAtMentions(g,this.atmentions,this.objId);this.invisiblediv.innerHTML=m}}this.ctype==="4"&&this.salesiqchat&&(this.edittitleiconnode.style.display="none",this.videoinfonode.style.display="none");if(this.ctype==="8"){this.meetingnode.style.display="none",$WC.Channels.isUserHasPermission(this.objId,$WC.WmsConstants.USERPERMISSIONS.ADD_MEMBER)===!1&&(this.addmembernode.style.display="none"),$WC.Channels.isUserHasPermission(this.objId,$WC.WmsConstants.USERPERMISSIONS.STICKY_MESSAGE)==0&&(this.pinmsgdetails.action_enabled=!1),this.reverttitlenode.style.display="none",this.historyoffnode.style.display="none";if(!$WC.Channels.get(this.objId)||$WC.Channels.get(this.objId).leave_allowed!=0)this.leavechannelnode.style.display="block";this.edittitleiconnode.style.display="none",this.titlenode.style.cursor="default",this.statusmsgnode.style.cursor="pointer"}this.ctype==="9"&&(this.edittitleiconnode.style.display="none",this.titlenode.style.cursor="default",this.actionbutton.style.display="block",this.recentchatsnode.style.display="none",this.meetingnode.style.display="none",this.addmembernode.style.display="none",this.historyoffnode.style.display="none",this.leavechannelnode.style.display="none",this.reverttitlenode.style.display="none",$WC.Util.isCustomBot(this.objId)&&(this.unsubscribebotnode.style.display="block")),this.ctype==="5"&&(this.removeSendFile(),this.reverttitlenode.style.display="none",this.historyoffnode.style.display="none",this.addmembernode.style.display="none",this.edittitleiconnode.style.display="none",this.titlenode.style.cursor="default"),this.ctype==="10"&&(this.meetingnode.style.display="none",this.addmembernode.style.display="none",this.reverttitlenode.style.display="none",this.edittitleiconnode.style.display="none",this.recentchatsnode.style.display="none",this.titlenode.style.cursor="default",this.statusmsgnode.style.cursor="pointer",this.showmembersnode.style.display="block"),this.ctype==="1"&&(WmsSettings.getAdminSetting("isDisableHistoryAllowed")||(this.historyoffnode.style.display="none"),this.partcount===2&&(this.edittitleiconnode.style.display="none",this.addmembernode.style.display="none")),_WMSOPENINCLIQ&&(WebMessanger.isCliqUser()||WebMessanger.isOrgUser())&&(this.redirectnode.style.display="block");if(typeof WmsUIImpl!="undefined"){var n=WmsImplHandler.invokeSynchronously(WmsUIImpl.getHeaderHTML,this.objId,this.ctype,this.getChannelUID(),this.getChannelServiceCode(),this.getChannelSOID(),this.entityid);n&&(this.headernode.innerHTML=n);var o=WmsImplHandler.invokeSynchronously(WmsUIImpl.getStatusHTML,this.objId,this.ctype,this.getChannelUID(),this.getChannelServiceCode(),this.getChannelSOID());o&&(this.statuslinenode.innerHTML=o)}if(typeof WmsUIImpl!="undefined"){var p=WmsImplHandler.invokeSynchronously(WmsUIImpl.getChatWindowOptions,this.objId,this.ctype,this.getChannelUID(),this.getChannelServiceCode(),this.getChannelSOID(),this.entityid);p&&this.applyCustomCWOptions(p)}WindowHandler.count++;if(WmsMainUI.isAutoFocusScheduled(this.objId)||this.partcount===2&&WmsMainUI.isAutoFocusScheduled(this.recipant))this.getMeFront(),this.focus();WmsMainUI.isAutoFocusScheduled(this.objId)==0&&f==="min"?(WindowHandler.openedChats[this.objId]="min",this.minimize()):(this.maximized=!0,WindowHandler.openedChats[this.objId]="max"),this.storeWindowState(f),_WMSWINFOCUS?($WC.Drafts.getFromServer(),$WC.Bots.initBots()):($WC.Drafts.getFromServerAfterFocus(),$WC.Bots.getFromServerAfterFocus()),WmsMainUI.isAutoFocusScheduled(this.objId)?WmsMainUI.removeAutoFocusSchedule(this.objId):this.partcount===2&&WmsMainUI.isAutoFocusScheduled(this.recipant)&&WmsMainUI.removeAutoFocusSchedule(this.recipant);if(WmsChatCache.isAvailable(this.objId))this.msgdisp.innerHTML=WmsChatCache.get(this.objId),this.scrollDisplay();else{var q=$WC.Util.createElement("div"),r=$WC.RecentChats.get(this.objId);h?q.setAttribute("data-nexttime",h):r&&r.LASTSEEN?(q.setAttribute("data-mentionmsgid",this.objId+"|"+r.LASTSEEN),this.ctrlcomp.setAttribute("data-scrolldown",!0)):Message.mentionMsgInfo[this.objId]&&(q.setAttribute("data-mentionmsgid",Message.mentionMsgInfo[this.objId]),this.ctrlcomp.setAttribute("data-scrolldown",!0),delete Message.mentionMsgInfo[this.objId]),q.setAttribute("data-latestchunk","true"),q.style="display:none",this.msgdisp.appendChild(q),this.partcount<=100&&_WMSWINFOCUS||this.maximized?Message.loadSpecificTranscript(this.objId,this.msgdisp,q):this.lazyload_transcript=q}WmsMainUI.getUnreadCount(this.objId)&&this.highlight(),this.updateSaveHistoryInUI();var s={chid:this.objId,removed:"false"};this.salesiqchat&&(s.salesiqchat="true"),$WC.WmsSessionStorage.setChatInfo(s);var t=$WC.Util.indexOf(WindowHandler.removed,this.getObjId());return t!==-1&&WindowHandler.removed.splice(t,1),WindowHandler.removeExcessChat(this.getObjId()),this.registerEvent(),this.showVideoDropdown(),WmsAVChat.notifyChatwinOpen(this),this.showRestrictedChannelIcon(),$WC.Channels.get(this.objId)&&$WC.Channels.isUserHasPermission(this.objId,$WC.WmsConstants.USERPERMISSIONS.SEND_MESSAGE)==0&&(this.permdenied=!0,this.disableComposerOptions($WC.I18N("channels.announcementonly"))),$WC.Util.addEvent(this.statusmsgnode,"click",function(a){if(this.salesiqchat)window.open(this.smsg,"_blank");else{if(a.target.id==="wms-muteinfoicon"||a.target.closest("[data-mute]")||a.target.id==="wms_cw_videoinfo"||a.target.closest("[data-videodropdown]"))return;if(this.isZohoGroupChat()||this.partcount>2&&this.ctype==="1"||this.ctype==="5"||this.ctype==="8")this.disablemembercontrol||(this.populateGroupMembers(),a.stopPropagation());else if(this.ctype==="10")if(this.entityweburl){var b=ChatletImpl.handleURLInvocation(this.entityid,this.smsg);b||window.open(this.smsg,"_blank")}else this.populateGroupMembers(),a.stopPropagation();else this.ctype==="1"&&(this.partcount==2&&this.scode=="-5"||!WmsContacts.get(this.recipant)?WMSUI.inviteMember(this.recipant,this.title):this.partcount==2&&(this.scode=="-3"||this.scode=="-6")&&WmsContacts.accept("zoho",this.recipant,$WC.Config.get("zuid")))}}.bind(this)),$WC.Util.addEvent(this.ctrlcomp,"scroll",$WC.Util.throttle(function(){this.showDateHint(),this.toggleUnreadBanner();var a=this.ctrlcomp.scrollHeight-this.ctrlcomp.clientHeight<=this.ctrlcomp.scrollTop+20?!0:!1;this.scrolldownbutton.style.display=a?"none":"inline-block"},this,50,{leading:!0,trailing:!0})),$WC.Util.addEvent(this.newmsgbanner,"click",this.scrollToUnread.bind(this,!0)),$WC.Util.addEvent(this.scrolldownbutton,"click",this.scrollToLastMsg.bind(this)),$WC.Util.addEvent(this.pinmsgnode,"click",function(a){if(a.target.getAttribute("data-pinmsg-options"))WindowHandler.checkAndHidePinmsgOptions(this.objId),this.togglePinMsgOptions();else if(a.target.getAttribute("data-msg-unpin"))WebMessanger.unpinMsg(this.objId),this.togglePinMsgOptions();else if(a.target===this.pinmsgduration)if(!this.pinmsgdetails.info.duration_shown){this.pinmsgdetails.info.duration_shown=!0;var b=function(a){var b=this.pinmsgdetails.info.msgid;WebMessanger.pinMsg(this.objId,b,a,!1),this.togglePinMsgOptions()}.bind(this),c=this.pinmsgnode.getBoundingClientRect().left+this.pinmsgnode.clientWidth+380+10,d=window.innerWidth>=c?"wms_pinmsg_duration_position_right":"wms_pinmsg_duration_position_left";this.pinmsg_duration_selector_instance.mountComponent(this.pinmsgduration,b,d)}else this.pinmsgdetails.info.duration_shown&&(this.pinmsgdetails.info.duration_shown=!1,this.pinmsg_duration_selector_instance.unmountComponent());else a.target.closest("[data-pindropdown]")||this.highlightPinnedMsg()}.bind(this)),c},ChatWindow.prototype.showBotSuggestions=function(a){if(a.temp_info&&a.temp_info.suggestions){var b=a.temp_info.suggestions,c='<div data-list=true class="wms-autocompleteheader wms-truncate-ellipsis wms-commandlist" title="'+a.msg+'">'+a.msg+"</div>";b.forEach(function(a){var b=$WC.Util.safeHTML(a.text);c+='<div class="wms-commandlist" data-list=true data-botsuggestion=true data-suggestiontext="'+b+'"><span class="wms-botsuggestion  wms-truncate-ellipsis" title="'+b+'">'+b+"</span></div>"}),this.listcommon.showUI(c,!0,!0),this.autocompletediv.style.display="block",this.footernode.style.borderRadius="0px 0px 5px 5px"}},ChatWindow.prototype.showAddUserPrompt=function(){if(this.atmentions&&WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ATMENTION){if(this.ctype==="8"&&$WC.Channels.isUserHasPermission(this.objId,$WC.WmsConstants.USERPERMISSIONS.ADD_MEMBER)===!1||this.ctype==="1"&&this.partcount==2)return;var a=this.atmentions.slice(0,-1).split(","),b=[],c=[],d=this.partinfo;a.forEach(function(a){d[a]===undefined&&WMSUI.atMentions.specialmentions.keys.indexOf(a)===-1&&(b.push(a),c.push('<span data-zcprofileid="'+a+'">'+$WC.Util.safeHTML($WC.Util.getContactName(a)||this.partinfo[a].dname)+"</span>"))});if(b.length){var e=$WC.I18N("chat.infomsg.adduser",[c.join(", "),'<div class="wms_addusertext">'+$WC.I18N("chat.infomsg.addtext")+"</div>"]);e+='<div class="wms_adduser"><span data-id="'+b.join(",")+'" data-operation="addmem">'+$WC.I18N("chat.infomsg.addmem")+'</span> <span data-operation="removepromptmsg">'+$WC.I18N("common.cancel")+"</span></div>",this.updateInfoMessage(e,null,"promptinfo")}}},ChatWindow.prototype.removePromptMsg=function(){var a=this.msgdisp.querySelector('[data-infotype="promptinfo"]');a&&a.parentNode&&$WC.Util.removeElement(a.parentNode)},ChatWindow.prototype.setLastEnterKeyPressTime=function(a){this.lastEnterKeyTime=a},ChatWindow.prototype.isDoubleEnter=function(){var a=(new Date).getTime()-this.lastEnterKeyTime;return a<500},ChatWindow.prototype.createChatwindowOverlay=function(){this.resendoverlay.style.display="block";var a=""+this.msgdisp.querySelectorAll("[data-msgfailure]").length;a>1&&(this.resendallnode.style.display="block",$WC.$CUtil.setInnerText(this.resendallnode,$WC.I18N("chat.msg.resendall",[a])))},ChatWindow.prototype.showDateHint=function(){var a=this.ctrlcomp.getBoundingClientRect().top,b=this.ctrlcomp.getElementsByClassName("wms-msgdate");this.datehintnode.style.display="block";for(var c=0;c<b.length;c++){var d=b[c],e=d.getBoundingClientRect().top,f=e-d.firstChild.offsetHeight;if(f>a)if(b[c-1]){var g=b[c-1].textContent;this.datehintnode.textContent!=g&&(this.datehintnode.textContent=g),c=b.length}else this.datehintnode.textContent=d.textContent;else b[c+1]==undefined&&this.datehintnode.textContent!=d.textContent&&(this.datehintnode.textContent=d.textContent)}var h=this.ctrlcomp.scrollHeight-this.ctrlcomp.clientHeight<=this.ctrlcomp.scrollTop+20?!0:!1;h||(this.datehintnode.style.display="block"),clearTimeout(this.datehint_timer_hide),this.datehint_timer_hide=setTimeout(function(a){clearTimeout(a.datehint_display_timer),a.datehint_display_timer=setTimeout(function(a){a.datehintnode.style.display=""},400,a)},1e3,this)},ChatWindow.prototype.applyCustomCWOptions=function(a){a.customClassName&&($WC.Util.addClass(this.mainwin,a.customClassName),$WC.Util.addClass(this.barwin,a.customClassName)),a.customActions&&a.customActions.length>0&&this.generateCustomActionList(a.customActions),a.redirecttocliq==="disable"&&(this.redirectnode&&(this.redirectnode.style.display="none"),this.disableredirecttocliq=!0),a.membercontrol==="disable"&&(this.addmembernode&&(this.addmembernode.style.display="none"),this.disablemembercontrol=!0),a.recentchats_option==="disable"&&(this.recentchatsnode&&(this.recentchatsnode.style.display="none"),this.disablerecentchatsoption=!0),a.screenshare==="disable"&&(this.meetingnode&&(this.meetingnode.style.display="none"),this.disablescreenshare=!0),a.store_chathistory==="disable"&&(this.historyoffnode&&(this.historyoffnode.style.display="none"),this.disablehistory=!0),a.pinaction==="disable"&&(this.pinactionnode&&(this.pinactionnode.style.display="none"),this.disablepinaction=!0),a.minimize==="disable"&&(this.minimizeiconnode&&(this.minimizeiconnode.style.display="none"),this.disableminimize=!0),a.enlarge==="disable"&&this.enlargeicon&&(this.enlargeicon.style.display="none"),a.mutechat==="disable"&&(this.mutechatnode&&(this.mutechatnode.style.display="none"),this.disablemuteaction=!0),a.transcript_view_height&&(this.ctrlcomp.style.height=a.transcript_view_height),a.chatwindow_width&&(this.mainwin.style.width=a.chatwindow_width),a.file_upload==="disable"&&(this.attachmentnode&&(this.attachmentnode.style.display="none",this.attachmentnode.setAttribute("data-attachment","false")),this.restrict_file_upload=!0),a.actions==="disable"&&this.actionbutton&&(this.actionbutton.style.display="none")},ChatWindow.prototype.populateActionList=function(){var a=[{label:"chats.cliq.open",dataAttr:"redirect",dataVal:"true",style:"display: none;"},{label:"chats.common",dataAttr:"recentchats",dataVal:"true",actionCallback:this.getRecentChats},{label:"Share_Desktop",dataAttr:"meeting",dataVal:"true",actionCallback:this.startMeeting},{label:"chat.title.revert",dataAttr:"reverttitle",dataVal:"true",actionCallback:this.revertTitle},{label:"chat.action.addparticipant",dataAttr:"addparticipant",dataVal:"true",actionCallback:this.insertAddParticipant},{label:"history.off",dataAttr:"historyoff",dataVal:"true",actionCallback:this.setHistoryStorage},{label:"common.shortcut.description.leave",dataAttr:"leaveChannel",dataVal:"true",actionCallback:this.leaveChannel},{label:"common.shortcut.description.pin",className:"wms_cw_pinchat",dataAttr:"pinchat",dataVal:"true",actionCallback:this.pinChat,style:"display: block;"},{label:"chat.members.show",className:"wms_cw_showmem",dataAttr:"showmembers",dataVal:"true",actionCallback:this.populateGroupMembers,style:"display:none;"},{label:"common.shortcut.description.mute",className:"wms_cw_muteaction",dataAttr:"mute",dataVal:"true",actionCallback:this.muteChat},{label:"bot.action.unsubscribe",className:"wms_cw_unsubscribe",dataAttr:"unsubscribe",dataVal:"true",actionCallback:this.unsubscribeBot,style:"display:none;"}];a.forEach(function(a){a.label&&(a.className=a.className?"wms_cw_toolbar_actionitem "+a.className:"wms_cw_toolbar_actionitem",a.style=a.style?a.style:"",this.actionlistnode.insertAdjacentHTML("beforeend",this.generateCWActionHtml(a)),a.actionCallback&&this.actionlistnode.querySelector("[data-"+a.dataAttr+"]").addEventListener("click",a.actionCallback.bind(this)))}.bind(this))},ChatWindow.prototype.generateCWActionHtml=function(a){var b="";return a.dataAttr=="mute"&&a.className.indexOf("wms_cw_muteaction")>-1?b='<div class="{{className}}" data-{{dataAttr}}="{{dataVal}}" style="{{style}}"><span data-mutetitle>'+$WC.I18N(a.label)+"</span>"+'<ul class="wms-muteinterval" >'+'<li data-duration="3600">'+$WC.I18N("chat.hour","1")+"</li>"+'<li data-duration="28800">'+$WC.I18N("chat.hours","8")+"</li>"+'<li data-duration="86400">'+$WC.I18N("chat.day","1")+"</li>"+'<li data-duration="604800">'+$WC.I18N("chat.week","1")+"</li>"+'<li data-duration="-1">'+$WC.I18N("chat.forever")+"</li>"+"</ul>"+"</div>":a.dataAttr=="redirect"?b='<a href="'+_WMSCHATURL+"chats/"+this.objId+'" target="_blank" rel="noopener"><div class="{{className}}" data-{{dataAttr}}="{{dataVal}}" style="{{style}}">'+$WC.I18N(a.label)+"</div></a>":a.dataAttr&&a.dataVal?b='<div class="{{className}}" data-{{dataAttr}}="{{dataVal}}"  style="{{style}}">'+$WC.I18N(a.label)+"</div>":a.data_customAction&&(b='<div class="{{className}}" data-customAction="{{data_customAction}}"> {{label}} </div>'),$WC.template.replace(b,{className:a.className,dataAttr:a.dataAttr,dataVal:a.dataVal,actionCallback:a.actionCallback,label:a.label,style:a.style,data_customAction:a.data_customAction})},ChatWindow.prototype.generateCustomActionList=function(a,b){b=b||this.actionlistnode,a.forEach(function(a){b.querySelector('[data-customAction="'+a.data_customAction+'"]')===null&&(a.label&&a.actionCallback&&a.data_customAction&&(a.className=a.className?"wms_cw_toolbar_actionitem "+a.className:"wms_cw_toolbar_actionitem",b.insertAdjacentHTML("beforeend",this.generateCWActionHtml(a)),b.querySelector('[data-customAction="'+a.data_customAction+'"]').addEventListener("click",function(){a.actionCallback(this.objId),this.hideActions()}.bind(this))),a.submenu&&(b.querySelector('[data-customAction="'+a.data_customAction+'"]').insertAdjacentHTML("beforeend",'<div class="wms_cw_toolbar_actionwrapper"></div>'),this.generateCustomActionList(a.submenu,b.querySelector('[class="wms_cw_toolbar_actionwrapper"]'))))}.bind(this))},ChatWindow.prototype.registerEvent=function(){var a=this,b=this.objId;if(_WMSDRAGDROP&&!a.restrict_file_upload){var c=!1,d=null;this.win.addEventListener("dragstart",function(a){WmsDragDrop.dragged_file=a.target,a.dataTransfer.setData("isdragfromcwin","true")},!0),this.win.addEventListener("dragover",function(a){a.preventDefault()},!0),this.win.addEventListener("drop",function(d){d.preventDefault();if(d.dataTransfer.getData("isdragfromcwin"))WmsDragDrop.onDropEvent(b,d,!0,!0),WmsDragDrop.dragged_file="";else if(typeof zmUtil!="undefined"&&typeof zmUtil.processDroppedFile=="function"&&d.dataTransfer.getData("dragAttrs"))try{zmUtil.processDroppedFile(d.dataTransfer.getData("dragAttrs"),b)}catch(d){}else WmsDragDrop.onDropEvent(b,d,!0);a.ctrlcomp.style.display="block",a.dragcomp.style.display="none",c=!1,d.stopPropagation()},!0),this.win.addEventListener("dragenter",function(b){b.preventDefault(),d=b.target,!c&&WmsDragDrop.isFileSharable()&&a.editorreplydiv.getAttribute("data-editmsg")!=="true"&&!a.permdenied&&(a.ctrlcomp.style.display="none",a.dragcomp.style.display="flex",c=!0)},!0),this.win.addEventListener("dragleave",function(b){b.preventDefault(),d==b.target&&(a.ctrlcomp.style.display="block",a.dragcomp.style.display="none",c=!1)},!0)}var e=$WC.Util.getCssAnimEndListener();$WC.Util.addEvent(this.headernode,e,function(){this.classList.remove("wms-titleglow")},!0),$WC.Util.addEvent(this.barwin,e,function(){this.classList.remove("wms-titleglow")},!0),Message.addEventListenersForTranscript(this.msgdisp,b),Gator(this.videocontainer).on("click","[media-action]",function(){var a=this.getAttribute("media-action");WmsAVChat.handleAction(a)}),Gator(a.resendoverlay).on("click","[data-operation]",function(){var b=this.getAttribute("data-operation");b==="wms-resend"?Message.resend(a.msgdisp,a.clickedfailurenode,!1):b==="wms-resendall"?Message.resend(a.msgdisp,a.clickedfailurenode,!0):b==="wms-resenddel"&&Message.removeFailedMessages(a.clickedfailurenode),a.resendoverlay.style.display="none",a.resendallnode.style.display="none"}),Gator(this.actionlistnode).on("click",'[data-purpose="wms_botactions"]',function(){a.hideActions(),Commands.showLoadingIcon(a.autocompletediv,a.objId);var b,c,d={};d.exec_id=this.getAttribute("data-exec_id");var e=$WC.Bots.getBotId(a.objId),f=$WC.Bots.get(e);if(f.actionhandles)for(var g=0;g<f.actionhandles.length;g++)if(f.actionhandles[g].id===d.exec_id){c=f.actionhandles[g].location,b=f.actionhandles[g].display_props.name;break}var h="v1/bots/"+e+"/executeaction",i={"x-consents-version":"1","Content-Type":"application/json","X-ZCSRF-TOKEN":$WC.Util.getCSRF()},j=function(){function g(b,c,e){d=c.data.dreResponse;if(d.status==="Consent"||d.status==="Failure"&&!$WC.Util.isEmpty(d.resumeUrl)){var g=new $WC.Consents;g.mountComponent(b,d,e)}else if(d.status==="Success"&&d.output){if(d.output.msg)f.push(d.output);else{$WC.Channels.initChannels();var h=new $WC.Forms;h.mountComponent(d,Commands.showResponse,function(){a&&a.composer.focus()})}f.length&&a.updateMessage(f)}}Commands.hideLoadingIcon(a.objId);var c=JSON.parse(this.response),d=c.data.dreResponse,f=[];d.output||(d.output={}),d.output.sender=e,d.output.isTempResponse=!0,d.output.meta||(d.output.meta={},d.output.meta.usermessagedetails={},d.output.meta.usermessagedetails.msg_title=b),g(a.objId,c,g)},k=function(){Commands.hideLoadingIcon(a.objId)};c?$WC.Ajax.postRequestToChatWithLocation(h,d,j,k,null,null,i):$WC.Ajax.postRequestToChat(h,d,j,k,null,null,i)}),Gator(this.editorreplydiv).on("click",".wms_cw_replyclose, [data-replymsgtime], #wms_notifyeditmsg",function(b){var c=$WC.Util.getEventTarget(b);if(c.id==="wms_notifyeditlabel")return;if(this.id==="wms_notifyeditmsg"){var d=c.parentNode.querySelector('[data-type="custom"]');d.className=d.className==="wms_settings_customcheckbox"?"wms_settings_customcheckboxsel":"wms_settings_customcheckbox",b.stopPropagation()}else this.getAttribute("data-replymsgtime")?(Message.glowBubble(this.getAttribute("data-replymsgtime"),a.ctrlcomp),b.stopPropagation()):a.closeReplyPreview()}),Gator(this.progressbarnode).on("click","[data-purpose]",function(){var a=this.getAttribute("data-purpose"),c=this.getAttribute("data-filename");a==="uploadcancel"?WmsFileUploadUI.cleanUpFileUpload(b,null,null,!0):a==="expand"||a==="collapse"?WmsFileUploadUI.expandFilesContainer(b,a):a==="retryall"&&WmsFileUploadUI.resendAllFiles(b),a==="resend"?WmsFileUploadUI.resendFile(b,c):a==="close"&&WmsFileUploadUI.cleanUpFileUpload(b,null,c,!0,!0)}),Gator(this.mainwin).on("click","[data-fwdclose=true]",this.toggleMessageSelection.bind(this)),Gator(this.mainwin).on("click","[data-fwdmsg=true]",this.forwardSelectedMessages.bind(this)),Gator(this.mainwin).on("click","[data-minimizeicon=true]",this.minimizeAndPropagate.bind(this)),Gator(this.mainwin).on("click","[data-header=true]",this.focus.bind(this)),Gator(this.mainwin).on("click","[data-enlargeicon=true]",this.toggleEnlargeWindow.bind(this)),Gator(this.mainwin).on("click","[data-closeicon=true]",this.closeAndPropagate.bind(this)),Gator(this.mainwin).on("click","#wms-smileyinvoker",this.toggleSmiley.bind(this)),Gator(this.mainwin).on("click","[data-action=true]",this.toggleActions.bind(this)),Gator(this.mainwin).on("click","[data-titlecontainer=true]",this.editChatTitle.bind(this)),Gator(this.mainwin).on("click","[data-edittitleicon=true]",this.editChatTitle.bind(this)),Gator(this.mainwin).on("click","[data-urlpreviewclose=true]",this.hideUrlPreview.bind(this,!0)),Gator(this.mainwin).on("dblclick","[data-composer=true]",this.textAreaMinimize.bind(this)),Gator(this.mainwin).on("click","[data-videoinfo=true]",this.toggleVideoDropdown.bind(this)),Gator(this.mainwin).on("click","[data-audioicon=true]",this.handleMediaCall.bind(this)),Gator(this.mainwin).on("click","[data-videoicon=true]",this.handleMediaCall.bind(this)),Gator(this.mainwin).on("click","[data-shareicon=true]",this.handleMediaCall.bind(this)),Gator(this.mainwin).on("click","[data-composer=true]",this.focus.bind(this)),Gator(this.mainwin).on("blur","[data-composer=true]",this.blurChat.bind(this)),Gator(this.mainwin).on("blur","[data-titleform=true]",function(a){this.checkChatTitle(a.target.value)}.bind(this)),Gator(this.mainwin).on("submit","[data-titleform=true]",function(a){return this.saveChatTitle(a.target.querySelector("#wmseditchattitletxt").value),!1}.bind(this)),Gator(this.mainwin).on("keydown","[data-titleform=true]",this.checkkey.bind(this)),Gator(this.mainwin).on("keydown","[data-composer=true]",function(a){if(this.salesiqchat&&typeof WmsUIImpl!="undefined")return WmsImplHandler.invoke(WmsUIImpl.handleKeyDown,a,this.objId);if(!(a.keyCode=="13"&&this.urlpreviewvisible&&this.unfurldata_cache_id&&this.unfurlmsg&&$WC.Config.get("zoholinks_auth")==0))return WMSUI.handleEvent(a,this.composer,this.objId);(new $WC.UrlConsent).mountComponent(function(b,c){this.unfurlmsg=b;if(c)return WMSUI.handleEvent(a,this.composer,this.objId)}.bind(this))}.bind(this)),Gator(this.mainwin).on("keydown",function(a){if(this.permdenied&&a.keyCode=="27")return WMSUI.handleEvent(a,this.composer,this.objId)}.bind(this)),Gator(this.mainwin).on("input","[data-composer=true]",function(a){WMSUI.handleStatus(a,this.composer,this.objId),WindowHandler.makeNormalWinById(this.objId)}.bind(this)),Gator(this.mainwin).on("keyup","[data-composer=true]",function(a){if(this.salesiqchat)return typeof WmsUIImpl!="undefined"&&(WmsImplHandler.invoke(WmsUIImpl.handleKeyMovement,a,this.objId),WmsImplHandler.invoke(WmsUIImpl.handleKeyUp,a,this.objId)),!0}.bind(this)),Gator(this.mainwin).on("click","[data-memdel=true]",function(){WMSUI.deleteParticipant(this.objId,event.target.getAttribute("data-zcprofileid"),event.target.getAttribute("data-dname"))}.bind(this)),Gator(this.mainwin).on("change","#wms-file",function(){WMSUI.submitFile(this.objId)}.bind(this)),this.composer.onscroll=function(){WMSUI.handleSync(this.composer)}.bind(this),this.barwin.onclick=this.maximize.bind(this),this.barwin.querySelector("[data-barclose=true]").onclick=this.closeAndPropagate.bind(this),this.ctrlcomp.addEventListener("mouseup",this.checkSelectionAndFocus.bind(this))},ChatWindow.prototype.blurChat=function(){Self.status.idle(this.objId)},ChatWindow.prototype.updatePinnedInfo=function(a){this.ispinned=a,a?(this.pinactionnode.className="wms_cw_toolbar_actionitem wms_cw_unpinchat",$WC.Util.isBotChid(this.objId)?$WC.$CUtil.setInnerText(this.pinactionnode,$WC.I18N("chat.unpinbot")):$WC.$CUtil.setInnerText(this.pinactionnode,$WC.I18N("common.shortcut.description.unpin"))):(this.pinactionnode.className="wms_cw_toolbar_actionitem wms_cw_pinchat",$WC.Util.isBotChid(this.objId)?$WC.$CUtil.setInnerText(this.pinactionnode,$WC.I18N("chat.pinbot")):$WC.$CUtil.setInnerText(this.pinactionnode,$WC.I18N("common.shortcut.description.pin")))},ChatWindow.prototype.updateMuteInfo=function(a){this.mutedinterval=a;var b=this.mutechatnode;a?(b.setAttribute("data-mute","true"),$WC.Util.removeClass(b,"wms_cw_muteaction"),$WC.Util.addClass(b,"wms_cw_unmuteaction")):(b.setAttribute("data-mute","false"),$WC.Util.removeClass(b,"wms_cw_unmuteaction"),$WC.Util.addClass(b,"wms_cw_muteaction")),this.updateMuteTitle()},ChatWindow.prototype.updateMuteTitle=function(){var a=this.mutedinterval,b=this.mutechatnode.querySelector("[data-mutetitle]");if(a){var c=$WC.I18N("chat.mute.onmute");if(a=="9223372036854775807")c+=" "+$WC.I18N("chat.forever");else if(a!=1){var d=(new Date).getTime(),e=a-d,f=new Date(e),g=f.getUTCDate()-1,h=f.getUTCHours(),i=f.getUTCMinutes(),j="";g&&(j+=" "+g+" ",j+=g==1?$WC.I18N("chat.mute.day"):$WC.I18N("chat.mute.days")),h&&(j+=" "+h+" ",j+=h==1?$WC.I18N("chat.mute.hour"):$WC.I18N("chat.mute.hours")),i&&(j+=" "+i+" ",j+=i==1?$WC.I18N("chat.mute.minute"):$WC.I18N("chat.mute.minutes")),j==""&&(j=" "+$WC.I18N("chat.mute.seconds")),c+=j+" "+$WC.I18N("chat.mute.timeleft")}this.mutechatnode.title=c,$WC.$CUtil.setInnerText(b,$WC.I18N("common.shortcut.description.unmute"))}else this.mutechatnode.title=$WC.I18N("common.shortcut.description.mute"),$WC.$CUtil.setInnerText(b,$WC.I18N("common.shortcut.description.mute"))},ChatWindow.prototype.updateUserStatus=function(a,b,c){if(this.ctype==="9"){b="chatbot.smsg",a="chatbot";if($WC.Util.isBotChid(this.objId)){var d=$WC.Bots.getBotId(this.objId);$WC.Bots.get(d)&&$WC.Bots.get(d).STATUSMSG&&(b=$WC.Bots.get(d).STATUSMSG)}}b==undefined&&(b=""),this.salesiqchat&&(b=WmsUIImpl.getChatWindowStatusText(this.objId)),b=$WC.Util.unescapeHTML(b),this.smsg=b,b=$WC.I18N(b),this.ctype==="1"&&this.partcount>2||(this.statusmsgnode.title=b),$WC.$CUtil.setInnerText(this.statusmsgnode,b),this.stype=WMSUI.getStype(c),this.scode=a;var e=this.avatarnode&&this.avatarnode.firstChild,f=this.baravatarnode&&this.baravatarnode.firstChild;if(a=="-1"||a=="-3"||a=="-4"||a=="-5"||a=="-6"||!WmsContacts.get(this.recipant))var g="wms_badge_imgwrapper";else g="wms_badge_imgwrapper wms_badge_statusicon_"+WmsContacts.getStatusClassName(null,this.scode,this.stype);e&&(e.className=g,e.title=$WC.I18N(WebMessanger.statusarr[a])),f&&(f.className=g);var h="wms_cw_bar_typing_indicator ";a=="0"?h+="wms_cw_bar_typing_offline":a=="1"?h+="wms_cw_bar_typing_online":a=="3"?h+="wms_cw_bar_typing_busy":a=="4"?h+="wms_cw_bar_typing_idle":a=="7"&&(h+="wms_cw_bar_typing_away"),$WC.Util.removeClass(this.statusmsgnode,"wms_cw_contactstatus"),$WC.Util.removeClass(this.statusmsgnode,"wms_cw_status_accepticon"),$WC.Util.removeClass(this.statusmsgnode,"wms_cw_status_invited");if(a=="-1"||a=="-3"||a=="-4"||a=="-5"||a=="-6"||!WmsContacts.get(this.recipant))$WC.Util.addClass(this.statusmsgnode,"wms_cw_contactstatus"),(a=="-3"||a=="-6")&&$WC.Util.addClass(this.statusmsgnode,"wms_cw_status_accepticon"),a=="-1"&&$WC.Util.addClass(this.statusmsgnode,"wms_cw_status_invited");a!=""&&a!="10"&&(this.typingindicatornode.className=h)},ChatWindow.prototype.updateChannelInfo=function(a){this.channeldesc=a.cd,this.channelphotoid=a.photoid,this.channeltype=a.sc,this.channelid=a.oc_id,this.channelservicecode=a.service,this.channelsoid=a.servicespecid},ChatWindow.prototype.updatePartCount=function(a){var b=a,c=b>=2?$WC.I18N("chat.participants"):$WC.I18N("chat.participant"),d=b+" "+c;b==0&&(d=$WC.I18N("chat.participants.none")),this.statusmsgnode.title="",$WC.$CUtil.setInnerText(this.statusmsgnode,d),$WC.Util.addClass(this.statusmsgnode,"wms_cw_activeusers")},ChatWindow.prototype.updatePartinfo=function(a,b,c,d){for(var e in this.partinfo){var f=this.partinfo[e],g=f.uname;WmsProfileInfo.details[g]||(WmsProfileInfo.details[g]={}),WmsProfileInfo.details[g].dname=f.dname;if(g==a){this.partinfo[e].scode=b,this.partinfo[e].smsg=c,this.partinfo[e].stype=d;break}}},ChatWindow.prototype.updateOfflineMessage=function(){this.partcount===2&&(this.composer.placeholder=$WC.I18N("chat.userofflineinfo"),this.offlinemessage=!0)},ChatWindow.prototype.updateOnlineMessage=function(){this.partcount===2&&(this.composer.placeholder="",this.offlinemessage=!1)},ChatWindow.prototype.updateUserInfoStatus=function(a){this.typingstatusnode.innerHTML=a,this.typingstatusnode.setAttribute("title",a)},ChatWindow.prototype.selectChat=function(){WindowHandler.lastViewed!=this.winIndex&&WindowHandler.lastViewed!=-1&&WindowHandler.exist[WindowHandler.lastViewed]!=null&&WindowHandler.exist[WindowHandler.lastViewed]!="empty"&&(this.prevIndex=WindowHandler.lastViewed),WindowHandler.lastViewed=this.winIndex},ChatWindow.prototype.getMeFront=function(){this.selectChat()},ChatWindow.prototype.getScode=function(){return this.scode},ChatWindow.prototype.getSmsg=function(){return this.smsg},ChatWindow.prototype.getStype=function(){return this.stype},ChatWindow.prototype.getTitle=function(){return this.title},ChatWindow.prototype.getObjId=function(){return this.objId},ChatWindow.prototype.setObjId=function(a){this.objId=a},ChatWindow.prototype.closeAndPropagate=function(a){if(this.iscallongoing){var b=this,c='<div class="wms-dialog-txtcont">'+$WC.I18N("mediacall.close.confirm")+"<br>"+$WC.I18N("mediacall.close.continue")+"</div>",d={bodyhtml:c,focusbutton:2,operations:[{name:$WC.I18N("mediacall.close.proceed"),action:function(){b.close(),WmsAVChat.close(),b.propagateOperation("close")}},{name:$WC.I18N("Cancel"),classname:"wms-dialog-rejectbtn"}]};WmsDialog.showModal(d)}else this.close(),this.propagateOperation("close");a&&(typeof a.stopPropagation=="function"?a.stopPropagation():a.cancelBubble=!0)},ChatWindow.prototype.detachEvents=function(){Gator(this.mainwin).off(),Gator(this.videocontainer).off(),Gator(this.actionlistnode).off(),Gator(this.editorreplydiv).off(),Gator(this.resendoverlay).off(),Gator(this.ctrlcomp.querySelector("#ctrlcomp")).off(),Gator(this.progressbarnode).off()},ChatWindow.prototype.close=function(a){a&&WmsAVChat.isRunning&&WmsAVChat.close(),this.checkAndStoreDraftMsg(),WmsMediaPlayer.stopPlayingMedia("chatwindow",this.objId),WmsMediaPlayer.showPlay(this.objId),ChatBlink.stopRepeat(),$WC.VideoPlayerFactory.removeAllComponents(this.objId),this.smileyvisible&&(this.smileycontainer.style.border="none",this.smileyinstance.unmountComponent(),this.smileyvisible=!1),WmsFileUploadHandler.getLivefupObj(this.objId)&&WmsFileUploadUI.cleanUpFileUpload(this.objId),this.detachEvents(),a?(WmsChatCache.remove(this.getObjId()),Message.deletedMessages.remove(this.getObjId())):this.msgdisp.firstChild&&this.msgdisp.firstChild.matches("[data-loading]")===!0?(WmsChatCache.remove(this.objId),Message.deletedMessages.remove(this.objId)):!this.mutedinterval&&WebMessanger.isAutoJoinAllowed(this.title)&&!this.lazyload_transcript&&(Message.furlVideoElement(this.msgdisp),WmsChatCache.insert(this.objId,this.msgdisp.innerHTML));var b=function(a,b){if(document.getElementById(b.getObjId())){$WC.Util.removeElement(b.win),WindowHandler.openedChats[b.getObjId()]="close";try{WindowHandler.exist[b.getPreIndex()].focus("",!0)}catch(c){WindowHandler.moveFocus(b.getObjId(),"",!0)}Factory.destroyDialog(b.winIndex,!0),WindowHandler.count--}};if(this.savehistory=="0"&&$WC.Util.getCssAnimEndListener()){var c=$WC.Util.getCssAnimEndListener();$WC.Util.addEvent(this.win,c,b,!0,this),$WC.Util.addClass(this.win,"delete-chat")}else b(null,this);Message.PREV_SENDER["ch"+this.objId]&&delete Message.PREV_SENDER["ch"+this.objId],this.removeWindowState(),typeof WmsUIImpl!="undefined"&&WmsImplHandler.invoke(WmsUIImpl.handleChatWindowClose,this.ctype,this.objId,this.getChannelUID())},ChatWindow.prototype.isMaximised=function(){return this.maximized},ChatWindow.prototype.hide=function(){this.win.style.display="none"},ChatWindow.prototype.makeNormalAndPropagate=function(){this.makeNormal(!0)},ChatWindow.prototype.makeNormal=function(a){this.resetBarStatusIcon(),this.unread=!1,this.toggleUnreadBanner(),this.headernode.className.indexOf("wms_cw_highlight")!==-1&&($WC.Util.removeClass(this.headernode,"wms_cw_highlight"),$WC.Util.removeClass(this.barwin,"wms_cw_highlight"),a&&this.propagateOperation("seen"))},ChatWindow.prototype.highlight=function(){this.maximized?$WC.Util.addClass(this.headernode,"wms_cw_highlight"):(this.updateBarMsgcount(),$WC.Util.addClass(this.headernode,"wms_cw_highlight"),$WC.Util.addClass(this.barwin,"wms_cw_highlight")),this.unread=!0},ChatWindow.prototype.titleGlow=function(){this.maximized?$WC.Util.addClass(this.headernode,"wms-titleglow"):$WC.Util.addClass(this.barwin,"wms-titleglow"),this.focus()},ChatWindow.prototype.getInnerObject=function(a,b){return WindowHandler.getObjectInObject(this.win,a,b)},ChatWindow.prototype.checkSelectionAndFocus=function(a){window.getSelection().toString()===""&&this.focus(a)},ChatWindow.prototype.focus=function(a,b){if(a){var c=$WC.Util.getEventTarget(a);if(c.id==="wmseditchattitletxt"||c.getAttribute("data-title")==="true"||c.getAttribute("data-edittitleicon")==="true"||c.getAttribute("data-videoinfo")==="true"||c.getAttribute("data-edited"))return;(c.getAttribute("data-previewable")!=="true"&&c.getAttribute("data-titlecontainer")!=="true"||c.className.indexOf("zcmsg_bx")!==-1)&&this.composer.focus()}else this.composer.focus();b||this.makeNormalAndPropagate(),this.hideActions(),this.hideVideoDropdown(),WindowHandler.checkAndHidePinmsgOptions(),ChatBlink.stopRepeat(),this.smileyvisible&&(this.smileycontainer.style.border="none",this.smileyinstance.unmountComponent(),this.hideReactionsUI(),this.smileyvisible=!1,this.footernode.style.borderRadius="5px 5px 5px 5px"),this.salesiqchat&&WmsUIImpl.onComposerFocus(this.objId)},ChatWindow.prototype.maximize=function(){this.mainwin.style.display="flex",this.barwin.style.display="none",this.unread&&!this.salesiqchat?this.scrollToUnread():this.scrollDisplay(),this.focus(),this.maximized=!0,this.getMeFront(),WindowHandler.openedChats[this.getObjId()]="max",this.storeWindowState("max"),this.updateBarMsgcount(),this.changeFooterHeight(),this.lazyload_transcript&&(Message.loadSpecificTranscript(this.objId,this.msgdisp,this.lazyload_transcript),this.lazyload_transcript=null),this.attached===!1&&WebMessanger.attachSession(this.objId)},ChatWindow.prototype.textAreaMinimize=function(){this.composer.value===""&&this.minimizeAndPropagate()},ChatWindow.prototype.checkAndMinimize=function(a){var b=$WC.Util.getEventTarget(a);(b.getAttribute("data-footer")||b.getAttribute("data-toolbar"))&&this.minimizeAndPropagate()},ChatWindow.prototype.minimizeAndPropagate=function(){this.disableminimize||(this.minimize(!0),this.propagateOperation("min"))},ChatWindow.prototype.minimize=function(a){this.disableminimize||(Self.Idle=!1,this.mainwin.style.display="none",this.barwin.style.display="block",this.maximized=!1,WindowHandler.lastViewed=-1,WindowHandler.openedChats[this.getObjId()]="min",a&&this.resetBarStatusIcon(),this.storeWindowState("min"))},ChatWindow.prototype.propagateOperation=function(a){var b="chid="+this.objId+"&action="+a;a==="close"&&(b+="&uname="+myMsgObj.sender+"&sid="+encodeURIComponent(WebMessanger.getSid())),a==="seen"?$WC.Ajax.requestToChat("propagatemsgseen.do","chid="+this.objId):$WC.Ajax.request("sendchatwindowopr.do",b)},ChatWindow.prototype.scrollDisplay=function(a,b){b=b||this.ctrlcomp;if(typeof a=="boolean"&&a===!1)return;b.scrollHeight!==0&&(b.scrollTop=b.scrollHeight-b.clientHeight)},ChatWindow.prototype.updateChatTitle=function(a){var b=this.titlenode.querySelector('[data-title="true"]');a=="Group Chat"&&(a=$WC.I18N("Group_Chat")),this.title=a,a=$WC.Util.unescapeHTML(a),$WC.$CUtil.setInnerText(b,a),$WC.$CUtil.setInnerText(this.bartitlenode,a),b.setAttribute("title",a)},ChatWindow.prototype.setTitle=function(a){this.updateChatTitle(a),this.partcount>2||this.title===WmsContacts.getDisplayName(this.recipant)||!!this.salesiqchat?this.reverttitlenode.style.display="none":this.reverttitlenode.style.display="block"},ChatWindow.prototype.setIndex=function(a){this.winIndex=a},ChatWindow.prototype.getIndex=function(){return this.winIndex},ChatWindow.prototype.getPreIndex=function(){return this.prevIndex},ChatWindow.prototype.setPreIndex=function(a){this.prevIndex=a},ChatWindow.prototype.isMinimized=function(){return!this.maximized},ChatWindow.prototype.updateParticipantsFromJoin=function(a){this.addParticipants(a,!1)},ChatWindow.prototype.getImageUrl=function(){return this.imgurl},ChatWindow.prototype.updateAvatar=function(){var a="";this.ctype!=1||this.partcount!=2||!!this.customgroup&&this.customgroup!="false"?$WC.Util.isChannelChid(this.objId)?a=$WC.HybridSearch.generateImageHtml(this.objId,$WC.WmsConstants.HYBRIDSEARCH.CHANNEL):$WC.Util.isBotChid(this.objId)?a=$WC.HybridSearch.generateImageHtml($WC.Bots.getBotId(this.objId),$WC.WmsConstants.HYBRIDSEARCH.BOT):a=$WC.HybridSearch.generateImageHtml(this.objId,$WC.WmsConstants.HYBRIDSEARCH.CHAT,{TITLE:this.title,SALESIQCHAT:this.salesiqchat},!0):a=$WC.HybridSearch.generateImageHtml(this.recipant,$WC.WmsConstants.HYBRIDSEARCH.CONTACT),this.avatarnode.innerHTML=a,$WC.Util.loadOriginalImage(this.avatarnode,null,!0),this.baravatarnode.innerHTML=a,$WC.Util.loadOriginalImage(this.baravatarnode,null,!0)},ChatWindow.prototype.updateChannelImage=function(){var a=$WC.HybridSearch.generateImageHtml(this.objId,$WC.WmsConstants.HYBRIDSEARCH.CHANNEL);this.updateAvatar(a)},ChatWindow.prototype.updateBotImage=function(a){var b=$WC.HybridSearch.generateImageHtml(a,$WC.WmsConstants.HYBRIDSEARCH.BOT);this.updateAvatar(b)},ChatWindow.prototype.updateWebUrl=function(a){var b=JSON.parse(a).weburl;b&&this.updateUserStatus("",b)},ChatWindow.prototype.clearChatContent=function(){this.msgdisp.innerHTML=""},ChatWindow.prototype.updateInfoMsgTemplate=function(a){var b=JSON.parse(a).infomsgtemplate;this.addinfotemplate=b&&b.addmem,this.deleteinfotemplate=b&&b.deletemem,this.titleinfotemplate=b&&b.chattitle},ChatWindow.prototype.populateParticipants=function(){var a="10",b=" ",c;if(this.ctype!=1||this.partcount!=2||!!this.customgroup&&this.customgroup!="false"){if(this.ctype!=8){var e=$WC.HybridSearch.generateImageHtml(this.objId,$WC.WmsConstants.HYBRIDSEARCH.CHAT,{TITLE:this.title,SALESIQCHAT:this.salesiqchat},!0);this.updateAvatar(e),b=this.getGroupStatus(),this.statusmsgnode.title="",$WC.Util.addClass(this.statusmsgnode,"wms_cw_activeusers"),this.meetingnode.style.display="none",this.recentchatsnode.style.display="none",this.videoinfonode.className="wms_cw_primetime",this.videoinfonode.setAttribute("title",$WC.I18N("videobroadcast.primetime")+" - "+$WC.I18N("videobroadcast.dlg.imagetitle")),delete WebMessanger.ucmap[WebMessanger.chatmap[this.objId]],delete WebMessanger.chatmap[this.objId]}}else{var d=Object.keys(this.partinfo)[0];if(d){e=$WC.HybridSearch.generateImageHtml(d,$WC.WmsConstants.HYBRIDSEARCH.CONTACT),this.updateAvatar(e),a=WmsContacts.status(d)||this.partinfo[d].scode,b=WmsContacts.getStatusMsg(d),c=WMSUI.getStype(this.partinfo[d].st);if(a!=="0"||a!=="2")this.composer.placeholder=""}this.recentchatsnode.style.display="block",this.videoinfonode.className="wms_cw_videoinfo",this.videoinfonode.removeAttribute("title")}this.ctype==="10"&&(b=this.entityweburl||b),this.ctype!=8&&this.updateUserStatus(a,b,c)},ChatWindow.prototype.addParticipants=function(a,b){a.forEach(function(a){this.partinfo[a.uname]=a},this),b&&(this.updateParticipantsCount(),this.fetchparticipants=!0),this.populateParticipants()},ChatWindow.prototype.getGroupStatus=function(){var a=$WC.Util.getObjectLength(this.partinfo),b=this.partinfo[WebMessanger.zuid]!=undefined?a:a+1,c=b>=2?$WC.I18N("chat.participants"):$WC.I18N("chat.participant"),d=b+" "+c;return b==0&&(d=$WC.I18N("chat.participants.none")),d},ChatWindow.prototype.updateParticipantsCount=function(){this.partcount=$WC.Util.getObjectLength(this.partinfo)+1},ChatWindow.prototype.deleteParticipants=function(a){for(var b=0;b<a.length;b++){var c=a[b].uname;this.partinfo&&this.partinfo[c]&&delete this.partinfo[c]}this.updateParticipantsCount(),this.populateParticipants()},ChatWindow.prototype.updateAddInfo=function(a){if(a){var b=a.split(":"),c={};for(var d=0;d<b.length;d+=2){var e=b[d];e!=undefined&&(c[e]=b[d+1]!=undefined?b[d+1]:"")}this.addinfo=c}},ChatWindow.prototype.isLiveSupportChat=function(){return this.getChatType()==CT_NFY_LIVESUPPORT?!0:!1},ChatWindow.prototype.isZohoGroupChat=function(){return this.getChatType()==CT_NFY_ZOHOGROUP||this.customgroup==="true"&&this.ctype==="1"?!0:!1},ChatWindow.prototype.getChatType=function(){try{return this.addinfo.CT_TYPE}catch(a){return null}},ChatWindow.prototype.getToolBarStatus=function(){if(this.ctype!=="5"&&this.ctype!=="8"&&this.ctype!=="10"&&this.partcount===2&&this.isLiveSupportChat()===!1&&this.isZohoGroupChat()===!1&&this.salesiqchat!==!0)if(WebMessanger.isMediaCallEnabled(WmsAVChat.CALL_TYPE_VIDEO)||WebMessanger.isMediaCallEnabled(WmsAVChat.CALL_TYPE_VOICE)||WebMessanger.meeting)return!0;return!1},ChatWindow.prototype.checkAndHideVideoDropdown=function(a){if(a.relatedTarget&&(a.relatedTarget.getAttribute("data-videodropdown")||a.relatedTarget.closest("[data-videodropdown=true]")))return;this.hideVideoDropdown()},ChatWindow.prototype.toggleVideoDropdown=function(a){this.videodropdownshown?(this.hideVideoDropdown(),this.videodropdownshown=!1):(this.showVideoDropdown(a),this.videodropdownshown=!0)},ChatWindow.prototype.hideVideoDropdown=function(){this.videodropdownnode.style.display="none",this.videodropdownnode.className="wms_videoinfo_dropdown",this.videodropdownshown=!1},ChatWindow.prototype.showVideoDropdown=function(a){if(a&&$WC.Util.getEventTarget(a).id!=="wms_cw_videoinfo")return;if(this.getToolBarStatus()){var b="none",c="none",d="none",e="none";try{WebMessanger.isMediaCallEnabled(WmsAVChat.CALL_TYPE_VIDEO)&&WmsSettings.getAdminSetting("isMediacallAllowed")&&(b="block")}catch(f){}try{WebMessanger.isMediaCallEnabled(WmsAVChat.CALL_TYPE_VOICE)&&WmsSettings.getAdminSetting("isMediacallAllowed")&&(c="block")}catch(f){}try{WmsSettings.getAdminSetting("isMediacallAllowed")&&(e="block")}catch(f){}WebMessanger.meeting&&this.ctype!=="5"&&this.ctype!=="8"&&this.ctype!=="10"&&(d="block"),this.meetingnode.style.display=d;if(b==="none"&&c==="none")this.videoinfonode.style.display="none";else if(a){c!=="none"&&(this.audioiconnode.style.display="block"),b!=="none"&&(this.videoiconnode.style.display="block"),e!=="none"&&(this.shareiconnode.style.display="none");var g=this.videodropdownnode;g.style.display="block"}else this.videoinfonode.style.display="inline-flex"}else(this.isZohoGroupChat()||this.partcount>2&&this.ctype==="1"||this.ctype==="8")&&WebMessanger.isCliqUser()&&($WC.$CUtil.isChrome()||$WC.$CUtil.isFirefox())?(this.videoinfonode.className="wms_cw_primetime",this.videoinfonode.setAttribute("title",$WC.I18N("videobroadcast.primetime")+" - "+$WC.I18N("videobroadcast.dlg.imagetitle"))):this.videoinfonode.style.display="none"},ChatWindow.prototype.clearTypingStatus=function(){var a=this.typingstatusnode;$WC.Util.addClass(a,"wms_cw_typingstatus_animate"),a.setAttribute("data-typingstatus",!1)},ChatWindow.prototype.handleMediaCall=function(a){if(this.getToolBarStatus())for(var b in this.partinfo){var c=this.partinfo[b].zuid.trim();if(c.length>0){var d=$WC.Util.getEventTarget(a);d.getAttribute("data-audioicon")?WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VOICE,c,WebMessanger.ismediacallnewwindow,this):d.getAttribute("data-videoicon")?WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VIDEO,c,WebMessanger.ismediacallnewwindow,this):d.getAttribute("data-shareicon")&&WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_SCREENSHARE,c,WebMessanger.ismediacallnewwindow,this)}}this.checkAndHideVideoDropdown(a),a.stopPropagation()},ChatWindow.prototype.startPrimeTime=function(){if(this.isZohoGroupChat()||this.partcount>2&&this.ctype==="1"||this.ctype==="8"){var a=_WMSCHATURL+"startprimetime.do?chid="+encodeURIComponent(this.objId),b=WmsSettings.primetime_onboard_count;if(b>2)window.open(a);else{var c="primetime_onboard_count="+(parseInt(b)+1);WebMessanger.updateSettings(c);if(document.getElementById("zcwindows")===null){var d=$WC.Util.createElement("div","zcwindows","zcoverlay");d.style.zIndex=WebMessanger.setzindex,document.body.appendChild(d)}var e='<div class="mcontent"><div class="zcprime_lhs"><img src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/pt_dialog.png" width="280" height="218" />'+'<strong class="zcprime_content">'+$WC.I18N("videobroadcast.dlg.imagetitle")+"</strong></div>"+'<div class="zcprime_rhs">'+"<p>"+$WC.I18N("videobroadcast.dlg.title")+"</p>"+"<ul>"+'<li class="mcontent_p">'+$WC.I18N("videobroadcast.dlg.desc1")+"</li>"+'<li class="mcontent_p">'+$WC.I18N("videobroadcast.dlg.desc2")+"</li>"+'<li class="mcontent_p">'+$WC.I18N("videobroadcast.dlg.desc3")+"</li>"+"</ul>"+'<a href=" '+_PRIMETIMEHELPLINK+'" target="_blank">'+$WC.I18N("common.learnmore")+"</a>"+'<div class="zcprime_confirm">'+"<p>"+$WC.I18N("videobroadcast.dlg.session")+"</p>"+'<div id="primetime_start_confirm" class="zcdbtn">'+$WC.I18N("videobroadcast.dlg.proceed")+"</div>"+"</div>"+"</div>"+"</div>";$WC.$Win.create({id:"primetime_trigger",header:'<div class="wms_cw_primetime "><strong>'+$WC.I18N("videobroadcast.primetime")+"</strong></div>",html:e,"class":"zcprime"});var f=document.getElementById("primetime_start_confirm");Gator(f).on("click",function(){$WC.$Win.destroy("primetime_trigger"),window.open(a)})}}},ChatWindow.prototype.startMeeting=function(){if(this.getToolBarStatus())for(var a in this.partinfo){var b=this.partinfo[a].zuid.trim();b==""&&(b=a.substring(a.indexOf("|")+1,a.length));if(b.length>0){WMSUI.startMeeting(b);break}}return this.hideActions(),!1},ChatWindow.prototype.toggleActions=function(){this.actionlistnode.style.display==="block"?this.hideActions():($WC.Util.addClass(this.actionbutton,"wms_cw_toolbar_actionbutton_selected"),this.actionlistnode.style.display="block",this.makeNormalAndPropagate())},ChatWindow.prototype.hideActions=function(){this.actionlistnode.style.display==="block"&&(this.actionlistnode.style.display="none",$WC.Util.removeClass(this.actionbutton,"wms_cw_toolbar_actionbutton_selected"),this.makeNormalAndPropagate())},ChatWindow.prototype.getActions=function(a){if(this.actionlistnode.querySelector('[data-purpose="wms_botactions"]'))return;var b=$WC.Bots.get(a),c=this.objId;if(!$WC.Util.isEmpty(b)&&b.actionhandles&&b.actionhandles.length){this.updateActionsUI(a);return}$WC.Bots.updateBotActions(a,[]);var d=function(){var b=JSON.parse(this.response);$WC.Bots.updateBotActions(a,b.data.actions);var d=WindowHandler.getWinObjById(c);d&&(d.updateActionsUI(a),d.updatePinnedInfo(d.ispinned))},e=function(){$WC.Bots.updateBotActions(a,undefined)},f="v1/bots/"+a+"/getactions";$WC.Ajax.requestToChat(f,null,d,e)},ChatWindow.prototype.updateActionsUI=function(a){var b="",c=$WC.Bots.get(a);if(!$WC.Util.isEmpty(c)&&typeof c.actionhandles!="undefined")for(var d=0;d<c.actionhandles.length;d++){var e=c.actionhandles[d];b+='<div data-purpose="wms_botactions" data-botid="'+a+'" data-exec_id="'+e.id+'" data-display_props="'+e.display_props.name+'" class="wms_cw_toolbar_actionitem wms_botactionicn">'+e.display_props.name+"</div>"}this.actionlistnode.insertAdjacentHTML("beforeend",b)},ChatWindow.prototype.populateChatTitleEdit=function(){var a=this.partcount>2||this.isLiveSupportChat()||this.isZohoGroupChat()?"wms-gni":"wms-cni";return'<form data-titleform="true"><input type="text" class="'+a+'" id="wmseditchattitletxt" autocomplete="off"/></form>'},ChatWindow.prototype.checkkey=function(a){a.keyCode==27&&this.setTitle(this.getTitle())},ChatWindow.prototype.focusChatTitle=function(){var a=this.getInnerObject("wmseditchattitletxt","INPUT");a.select(),a.focus()},ChatWindow.prototype.openInCliq=function(){var a=_WMSCHATURL+"chats/"+this.objId;window.open(a,"_blank").opener=null},ChatWindow.prototype.getRecentChats=function(){if($WC.Util.getObjectLength(this.partinfo)===1){for(var a in this.partinfo)var b=a;ZMSGUI.showChatHistory(b)}this.hideActions()},ChatWindow.prototype.muteChat=function(a){var b=$WC.Util.getEventTarget(a),c=!0,d=b.getAttribute("data-duration");this.mutedinterval?c=!1:d||(d="-1"),this.updateMuteInfo(c),this.hideActions(),WebMessanger.muteChat(this.objId,d,c)},ChatWindow.prototype.unsubscribeBot=function(a){var b="b-"+$WC.Bots.getBotId(this.objId);$WC.Ajax.postRequestToChat("v1/bots/"+b+"/unsubscribe"),this.closeAndPropagate(a)},ChatWindow.prototype.showInfoMsg=function(a){this.showErrorMsg(a,"info")},ChatWindow.prototype.showErrorMsg=function(a,b){$WC.$CUtil.setInnerText(this.errormsgnode,a),this.errormsgnode.className=b==="info"?"wms_cw_infomsg wms-halign":"wms_cw_errormsg wms-halign",this.errormsgnode.style.display="block",this.error_timer=setTimeout(function(a){a.hideErrorMsg()},3e3,this)},ChatWindow.prototype.hideErrorMsg=function(){this.errormsgnode.style.display="",$WC.$CUtil.setInnerText(this.errormsgnode,"")},ChatWindow.prototype.pinChat=function(){WebMessanger.pinChat(this.objId,!this.ispinned),this.hideActions()},ChatWindow.prototype.revertTitle=function(){var a=WmsContacts.getDisplayName(this.recipant)||this.partinfo[this.recipant].dname;WebMessanger.setChatTitle(this.objId,a,this.title),this.hideActions()},ChatWindow.prototype.toggleChatTitle=function(){this.getInnerObject("wms-chattitle","P").getAttribute("data-purpose")==="cleartitle"?WebMessanger.setChatTitle(this.objId,""):this.editChatTitle()},ChatWindow.prototype.editChatTitle=function(){if(this.ctype==="1"&&this.partcount===2||this.ctype==="9"||this.ctype==="8"||this.ctype==="5"||this.ctype==="10"||document.activeElement.id==="wmseditchattitletxt"||WMSUI.showErrorIfPermDenied(this.objId)||this.ctype==="4"&&this.salesiqchat)return;var a=this.titlenode.querySelector('[data-title="true"]');a.innerHTML=this.populateChatTitleEdit();var b=WindowHandler.getObjectInObject(a,"wmseditchattitletxt","INPUT");b.value=$WC.Util.unescapeHTML(this.getTitle()),this.focusChatTitle()},ChatWindow.prototype.checkChatTitle=function(a){try{a=a.trim();if(a.length>200)return this.focusChatTitle(),!1;this.setTitle(unescape(this.getTitle()))}catch(b){return!1}},ChatWindow.prototype.saveChatTitle=function(a){a=a.trim();var b=this.getTitle();if(b!=a){if(a.length==0)return alert($WC.I18N("Please_enter_the_chat_title")),this.focusChatTitle(),!1;if(a.length>200)return alert($WC.I18N("Max_200_chatracters_allowed_for_chat_title")),this.focusChatTitle(),!1;WebMessanger.setChatTitle(this.objId,a,b),this.setTitle(a)}else this.setTitle(a)},ChatWindow.prototype.insertAddParticipant=function(a){this.hideActions();if(WMSUI.showErrorIfPermDenied(this.objId))return;var b=this.composer.selectionStart;this.composer.value=this.composer.value.substring(0,b)+"+"+this.composer.value.substring(b),$WC.Util.moveCaretPosition(this.composer,b+1,b+1),WMSUI.handleStatus(a,this.composer,this.objId)},ChatWindow.prototype.setHistoryStorage=function(){this.hideActions();if(WMSUI.showErrorIfPermDenied(this.objId))return;this.savehistory==="0"?(WebMessanger.setHistoryStorage("enable",this.objId),$WC.$CUtil.setInnerText(this.actionlistnode.querySelector("[data-historyoff]"),$WC.I18N("history.off"))):(WebMessanger.setHistoryStorage("disable",this.objId),$WC.$CUtil.setInnerText(this.actionlistnode.querySelector("[data-historyoff]"),$WC.I18N("history.on")))},ChatWindow.prototype.leaveChannel=function(){WebMessanger.leaveChannel(this.objId),this.hideActions()},ChatWindow.prototype.updateSaveHistory=function(a){this.savehistory=a},ChatWindow.prototype.updateSaveHistoryInUI=function(){this.savehistory==="0"?($WC.$CUtil.setInnerText(this.actionlistnode.querySelector("[data-historyoff]"),$WC.I18N("history.on")),WmsChatCache.get(this.objId)||this.updateInfoMessage($WC.I18N("history.message"))):this.savehistory==="1"&&$WC.$CUtil.setInnerText(this.actionlistnode.querySelector("[data-historyoff]"),$WC.I18N("history.off"))},ChatWindow.prototype.changeActive=function(){WMSUI.handleDocumentActive()},ChatWindow.prototype.joinChat=function(){this.objId!=undefined&&setTimeout("WebMessanger.join('"+this.objId+"',true)",3e3)},ChatWindow.prototype.populateGroupMembers=function(){WMSUI.showParticipantsList(this.objId,this.title)},ChatWindow.prototype.showProgress=function(a){var b=a/100,c=this.progressbarnode.querySelector("[data-progressbar-basic]");if(a==-1){var d='<div class="wms_progressbar_failure_text">'+$WC.I18N("Sharing_failed")+'<span class="wms_cw_progressbar_cls" data-clearprogress="true" ><span class="wms_cw_opr_close"></span></span></div>';this.progressbarnode.style.display="block",c.setAttribute("data-progressbar-basic","true"),c.innerHTML=d}else if(c.getAttribute("data-progressbar-basic")=="false"||a==0)d='<div class="wms_cw_progress_shadow"><div class="wms_cw_progressholder"><div class="wms-loading-sub" data-progressindicator="true" style="transform: scaleX('+b+')"></div></div>'+'<span id="wmsloadingtxt"class="wms-loading-text" data-progresstext="true">'+$WC.I18N("Sharing")+" "+a+"%</span>"+"</span>"+"</div>",this.progressbarnode.style.display="block",c.setAttribute("data-progressbar-basic","true"),c.innerHTML=d;else{var e=this.progressbarnode.querySelector("[data-progressindicator]");e.style.transform="scaleX("+b+")";var f=this.progressbarnode.querySelector("[data-progresstext]");$WC.$CUtil.setInnerText(f,$WC.I18N("Sharing")+" "+a+"%")}},ChatWindow.prototype.clearProgress=function(){this.progressbarnode.style.display="none";var a=this.progressbarnode.querySelector("[data-progressbar-basic]");a.setAttribute("data-progressbar-basic","false"),a.innerHTML=""},ChatWindow.prototype.removeSendFile=function(){this.attachmentnode.style.display="none"},ChatWindow.prototype.storeWindowState=function(a){$WC.WmsSessionStorage.setChatInfo({chid:this.objId,state:a})},ChatWindow.prototype.removeWindowState=function(){$WC.WmsSessionStorage.removeChatState(this.objId)},ChatWindow.prototype.updateAttachInfo=function(a){this.attached=a},ChatWindow.prototype.replaceMessages=function(a){$WC.Util.isArray(a)&&a.length>0&&(Message.constructAndAppendChatContent(a,this.msgdisp,this.getObjId()),this.scrollDisplay())},ChatWindow.prototype.isMsgAlreadyUpdated=function(a,b){var c=b.querySelector('[data-msgid="'+a.sender+"_"+a.msgid+'"],[data-msgid="'+a.sender+"_"+a.time+'"]');return c?!0:!1},ChatWindow.prototype.updateMessage=function(a){var b=this.ctrlcomp,c=this.scrollDisplay,d,e=b.scrollHeight-b.clientHeight<=b.scrollTop+20?!0:!1,f={};Message.isMetaMsg(a)?f=$WC.Util.cloneObject(a,!0):f=a,$WC.Util.isArray(f)||(f=[f]);var g=this.msgdisp.querySelectorAll("#"+this.msgdisp.id+" > [data-senderzuid]");if(g.length>0)var h=g[g.length-1].getAttribute("data-senderzuid");var i=this.msgdisp.querySelectorAll("[data-msgtime]");if(i.length>0)var j=i[i.length-1].getAttribute("data-msgtime");j==""&&i[i.length-2]&&(j=i[i.length-2].getAttribute("data-msgtime"));var k=$WC.Util.isLocalUser(f[0].sender);if(f[0]&&Message.isDelayMsg(f[0])){var l=parseInt(f[0].meta.config.d);clearTimeout(this.msgdelaytimer),this.msgdelaytimer=setTimeout(function(){Message.constructAndAppendChatContent(f,this.msgdisp,this.getObjId(),h,j),c(e,b)}.bind(this),l)}else{d=this.typingstatusnode.getAttribute("data-typingstatus"),d&&this.typingstatusnode&&!k&&($WC.Util.addClass(this.typingstatusnode,"wms_cw_typingstatus_animate"),clearTimeout(Self.Timer[this.getObjId()]));var m=this.msgdisp.lastChild,n=m&&m.getAttribute("data-loadmorebutton")?!0:!1;n&&k&&(this.msgdisp.innerHTML="",h="",j=""),Message.constructAndAppendChatContent(f,this.msgdisp,this.getObjId(),h,j),k&&this.msgdisp.lastChild.getAttribute("data-timefrag")=="true"&&(Message.getMessageType(a)==="TEXTMSG"||Message.getMessageType(a)==="REPLYMSG")&&a.sentfromcomposer&&(this.msgdisp.lastChild.innerText=$WC.I18N("message.status.sending"));if(n){var o=$WC.Util.createElement("div");o.setAttribute("data-nexttime",f[0].time),k?this.msgdisp.prepend(o):m.parentNode.replaceChild(o,m),Message.loadSpecificTranscript(this.objId,this.msgdisp,o)}else k&&(this.clearUnreadMarker(),this.scrollDisplay())}this.scrollDisplay(e,b),typeof WmsUIImpl!="undefined"&&WmsImplHandler.invoke(WmsUIImpl.handleNewMessage,this.ctype,this.objId,this.getChannelUID(),f[0]&&f[0].msg)},ChatWindow.prototype.updateMessageFragment=function(a,b){var c=this.ctrlcomp;b=b||a.sender+"_"+a.msgid;var d=c.querySelector('[data-msgid="'+b+'"]');if(!d)return;var e=Message.getMessageType(a);if(Message.isMetaMsg(a)||e===Message.types.IMGATT||e===Message.types.FILEATT||e===Message.types.AUDIOATT||e===Message.types.VIDEOATT){var f=c.scrollHeight-c.clientHeight<=c.scrollTop+20?!0:!1,g={};Message.isMetaMsg(a)?(g.dname=a.dname,g.meta=a.meta,g.msg=a.msg,g.msgid=a.msgid||b,g.sender=a.sender,g.time=a.time,g.msguid=a.msguid,a.reactions&&(g.reactions=a.reactions)):g=a,$WC.Util.isArray(g)||(g=[g]);var h=c.querySelectorAll("[data-senderzuid]");if(h.length>0){var i=h[h.length-1].getAttribute("data-senderzuid");a.meta&&(a.meta.message_source||a.meta.btnindexvsdetails)&&(i=g[0].sender)}var j=c.querySelectorAll("[data-msgtime]");if(j.length>0)var k=j[j.length-1].getAttribute("data-msgtime");if(!d.querySelector("[data-furl]")){var o=Message.constructChatContent(g,"",a.chid,i,k);d.nextSibling&&d.nextSibling.className==="wms-msgtime"&&$WC.Util.removeElement(d.nextSibling),d.outerHTML=o,this.scrollDisplay(f,c);return}var l="/"+_CHATCONT+"/v1/attachments/"+g[0].msg.url;d.querySelector("[data-furl]").setAttribute("data-src",g[0].msg.url);if(d.querySelector("[href]")){var m=d.querySelectorAll("[href]");for(var n=0;n<m.length;n++)m[n].href=l}d.querySelector("[data-media]")&&d.querySelector("[data-media]").setAttribute("source",l),d.querySelector("[data-fcontent]")&&d.querySelector("[data-fcontent]").setAttribute("data-fcontent",g[0].msg.content)}else $WC.$CUtil.setInnerText(d.querySelector('[class="wms-msgtime"]'),$WC.DateUtil.formatTime(a.time));if(a.mtype===""+CT_EDITED_MSG){d.nextSibling&&d.nextSibling.className==="wms-msgtime"&&$WC.Util.removeElement(d.nextSibling);var p=d;while(p&&!p.getAttribute("data-senderzuid"))p=p.previousSibling;a.msg.mtype=a.mtype,o=Message.constructChatContent([a.msg],c,this.objId,p.getAttribute("data-senderzuid")),d.outerHTML=o,this.updateReactionFragment(a.msg.msguid),d.setAttribute("data-msgtime",a.msg.origin_time),d.setAttribute("data-msgid",a.msg.sender+"_"+a.msg.origin_time),d.setAttribute("data-msguid",a.msg.msguid),d=c.querySelector('[data-msgid="'+b+'"]'),d.nextSibling&&d.nextSibling.className==="wms-msgtime"&&($WC.$CUtil.setInnerText(d.nextSibling,$WC.DateUtil.formatTime(a.msg.origin_time)),d.nextSibling.setAttribute("data-edited",$WC.I18N("message.edit.info"))),this.scrollDisplay(f,c)}else d.removeAttribute("data-notack"),d.setAttribute("data-msgtime",a.time),d.setAttribute("data-msgid",a.sender+"_"+a.time),this.savehistory!=="0"&&d.setAttribute("data-msguid",a.msguid)},ChatWindow.prototype.updateReactionFragment=function(a){var b=this.ctrlcomp.querySelector('[data-msguid="'+a+'"]');if(b){var c=b.querySelector(".wms_reaction_frag"),d=Message.getScrollHeight(this.ctrlcomp),e=Message.getScrollTop(this.ctrlcomp);c?this.reactions[a]?c.outerHTML=Message.constructReactionsFragment(this.reactions[a].data,this.reactions[a].list):c.outerHTML="":this.reactions[a]&&b.insertAdjacentHTML("beforeend",Message.constructReactionsFragment(this.reactions[a].data)),Message.restoreScrollPosition(this.ctrlcomp,d,e)}Message.toggleLiveZomoji(this.ctrlcomp)},ChatWindow.prototype.updateReactionData=function(a,b){var c=Object.keys(b);if(c.length===0)delete this.reactions[a];else{if(this.reactions[a]&&this.reactions[a].list.length){var d=this.reactions[a].list,e=c,f=[];for(var g=0;g<d.length;g++)e.indexOf(d[g])!==-1&&f.push(d[g]);for(var h=0;h<e.length;h++)f.indexOf(e[h])===-1&&f.push(e[h]);this.reactions[a].list=f}else{this.reactions[a]={list:[],data:{}};var i=c.sort(function(a,c){return b[c].length-b[a].length});this.reactions[a].list=i}this.reactions[a].data=b}},ChatWindow.prototype.updateMyReactionData=function(a,b,c){if(c){var d=this.reactions[a].data[b],e=d.indexOf(d.find(function(a){if(a.indexOf(":"+WebMessanger.zuid+":")!==-1)return!0}));d.splice(e,1),d.length===0&&(delete this.reactions[a].data[b],this.reactions[a].list.splice(this.reactions[a].list.indexOf(b),1)),this.reactions[a].list.length===0&&delete this.reactions[a]}else{var f=Date.now()+":"+WebMessanger.zuid+":"+WebMessanger.nname;this.reactions[a]?this.reactions[a].data[b]?this.reactions[a].data[b].push(f):(this.reactions[a].list.push(b),this.reactions[a].data[b]=[f]):(this.reactions[a]={list:[b],data:{}},this.reactions[a].data[b]=[f])}this.updateReactionFragment(a)},ChatWindow.prototype.updateInfoMessage=function(a,b,c){a={msg:a,type:c};var d={msg:a,messagetype:Message.types.INFOMSG,time:b||(new Date).getTime()};this.updateMessage(d)},ChatWindow.prototype.checkAndUpdateMissingTranscript=function(a,b){var c=a.lmsgtime,d=a.time,e=c&&this.msgdisp.querySelector('[data-msgtime="'+c+'"]');if(!c||e||!b)return;while(!b.getAttribute("data-msgid")||b.getAttribute("data-msgid")&&(b.getAttribute("data-notack")||b.getAttribute("data-type")=="INFOMSG"))b=b.previousSibling;var f=b.getAttribute("data-msgtime");if(f&&f<d){var g=$WC.Util.createElement("div",null,null,{"data-prevtime":f});while(b.nextSibling.className=="wms-msgtime"||b.nextSibling.getAttribute("data-msgfailure"))b=b.nextSibling;b.insertAdjacentElement("afterend",g),Message.loadSpecificTranscript(this.objId,this.msgdisp,g)}},ChatWindow.prototype.getAdjacentMsg=function(a,b){while(a&&(!a.getAttribute("data-msgid")||a.getAttribute("data-type")=="INFOMSG"))a=b?a.previousSibling:a.nextSibling;return a},ChatWindow.prototype.checkAndRemoveMsg=function(a){var b=a.nextSibling,c=a.previousSibling,d=[];if(b&&b.className=="wms-msgtime"){var e=this.getAdjacentMsg(c,!0),f=e&&e.nextSibling;!e||f&&f.className=="wms-msgtime"?d.push(b):b.removeAttribute("data-edited")}if(c&&c.getAttribute("data-senderzuid")){var g=this.getAdjacentMsg(b,!1),h=g&&g.previousSibling;(!g||h&&h.getAttribute("data-senderzuid"))&&d.push(c)}d.push(a),d.forEach(function(a){$WC.Util.removeElement(a)})},ChatWindow.prototype.forwardSelectedMessages=function(){var a=[{onclick:function(a){var b={sid:WebMessanger.sid,fwdasgroup:!1},c=[],d=[];a.forEach(function(a){WmsContacts.getContactsList(a)||WmsOrgContacts.getOrgContactsList(a)?c.push(a):d.push(a),WmsMainUI.scheduleAutoFocus(a)}),c.length&&(b.userids=c.join(",")),d.length&&(b.fwdchidlists=d.join(",")),b.msguids=this.getSelectedMsgsId().join(",");var e={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF(),"Content-Type":"application/json"};$WC.Ajax.postRequestToChat("v1/chats/"+this.objId+"/forward",b,null,null,null,null,e),this.toggleMessageSelection()}.bind(this)}],b=[$WC.WmsConstants.HYBRIDSEARCH.ORGCONTACT,$WC.WmsConstants.HYBRIDSEARCH.JOINEDCHANNEL,$WC.WmsConstants.HYBRIDSEARCH.CHAT];$WC.Participants.showChatsList(this.objId,$WC.I18N("message.forward.to",""),$WC.I18N("message.forward.placeholder"),a,b)},ChatWindow.prototype.getSelectedMsgsId=function(){var a=this.msgdisp.querySelectorAll('[data-msgsel="true"]'),b=[];return a.forEach(function(a){b.push(a.closest('[class^="wms-msgfrag"]').getAttribute("data-msgid"))}),b},ChatWindow.prototype.toggleMessageSelection=function(a,b){var c=this.msgdisp.querySelectorAll("[data-msgsel]");if(a&&b){c.forEach(function(a){a.getAttribute("data-type")!=="DELETEDMSG"&&($WC.Util.removeClass(a,"wms_checkbox_hidden"),$WC.Util.addClass(a,"wms_checkbox_visible"))});var d=b.closest('[class^="wms-msgfrag"]');if(d){var e=d.querySelector("[data-msgsel]");$WC.Util.removeClass(e,"wms_fwdcheckbox"),$WC.Util.addClass(e,"wms_fwdcheckboxsel"),e.setAttribute("data-msgsel","true"),this.msgoprnode.style.display="flex",this.footernode.style.display="none",this.actionbutton.style.display="none"}}else c.forEach(function(a){$WC.Util.removeClass(a,"wms_checkbox_visible"),$WC.Util.removeClass(a,"wms_fwdcheckboxsel"),$WC.Util.addClass(a,"wms_checkbox_hidden"),$WC.Util.addClass(a,"wms_fwdcheckbox"),a.setAttribute("data-msgsel",!1)}),this.msgoprnode.style.display="none",this.footernode.style.display="table",this.actionbutton.style.display="block",$WC.$CUtil.setInnerText(this.msgselectcntnode,$WC.I18N("msg.select.fwdcnt",[1])),this.msgoprnode.setAttribute("data-msgoperation",!0),$WC.Util.removeClass(this.msgselectcntnode.parentNode,"wms_fwdsel_alert"),$WC.Util.removeClass(this.msgoprnode,"wms-shake")},ChatWindow.prototype.toggleSmiley=function(){this.permdenied||(this.smileyvisible?(this.smileycontainer.style.border="none",this.smileyinstance.unmountComponent(),this.composer.focus(),this.footernode.style.borderRadius="5px 5px 5px 5px",this.smileyvisible=!1):(this.smileycontainer.style.border="solid 1px #e0e0e0",this.smileyinstance.mountComponent(this.smileycontainer,!0,function(a){Smiley.updateSmiley(this.composer,a),this.toggleSmiley()}.bind(this),function(){this.toggleSmiley()}.bind(this)),this.smileyvisible=!0,this.footernode.style.borderRadius="0px 0px 5px 5px"))},ChatWindow.prototype.resetBarStatusIcon=function(){WmsMainUI.resetUnreadCount(this.objId),$WC.HybridSearch.isUnreadFilterOpen()&&WmsMainUI.filterUnreadChats(),WmsMainUI.updateUnreadChatsCount(),this.updateBarMsgcount()},ChatWindow.prototype.updateBarMsgcount=function(){this.salesiqchat&&$WC.Config.get("customContacts")?$WC.$CUtil.setInnerText(this.barmsgcountnode,WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").getUnreadCount,this.objId)):$WC.$CUtil.setInnerText(this.barmsgcountnode,WmsMainUI.getUnreadCount(this.objId)),WmsMainUI.updateUnreadCountInUI(this.objId),WmsMainUI.getUnreadCount(this.objId)>0?this.barmsgcountnode.style.display="block":this.barmsgcountnode.style.display="none"},ChatWindow.prototype.getChannelUID=function(){return this.channelid||$WC.Channels.get(this.objId)&&$WC.Channels.get(this.objId).oc_id},ChatWindow.prototype.getChannelServiceCode=function(){return this.channelservicecode||$WC.Channels.get(this.objId)&&$WC.Channels.get(this.objId).service},ChatWindow.prototype.getChannelSOID=function(){return this.channelsoid||$WC.Channels.get(this.objId)&&$WC.Channels.get(this.objId).servicespecid},ChatWindow.prototype.getReplyMessageId=function(){var a,b,c=this.editorreplydiv.getAttribute("data-editmsg")==="true"?!0:!1;return this.editorreplydiv.style.display=="block"&&!c&&(a=this.editorreplydiv.querySelector("[data-replymsgtime]"),b=a.getAttribute("data-replysenderzuid")+"_"+a.getAttribute("data-replymsgtime")),b},ChatWindow.prototype.constructReplyMessageObject=function(a,b,c){var d,e=a.getAttribute("data-msgtime"),f=a.getAttribute("data-msgid"),g=a.getAttribute("data-msguid"),h=a.querySelector("[data-sendername]"),i=a.getAttribute("data-sendername")||h&&h.getAttribute("data-sendername");d=Message.getMsgFromDom(this.objId,f,!1,!0);var j=Message.getMessageType(d),k=f.split("_")[0],l={meta:{opr_replydetails:{messagetype:j,msgtime:e,sender:k,sendername:i,msguid:g}}};b&&(l.msg=b,l.time=c,l.sender=WebMessanger.zuid);if(j===Message.types.IMGATT)var m="addinfo";else m="msg";return l.meta.opr_replydetails[m]=d,l},ChatWindow.prototype.showEditPreview=function(a){a.getAttribute("data-type")==="REPLYMSG"&&(a=a.querySelector("[data-msgid]"));var b=a.querySelector("[data-urlpreviewcomment]")||a.firstChild;this.composer.value=Message.getTextMsgFromDom(b.childNodes,!1,!0),this.changeFooterHeight();var c=this;$WC.Util.convertToArray(b.childNodes).forEach(function(a){a.nodeName==="SPAN"&&(c.atmentions+=a.getAttribute("data-zcprofileid")+",",WMSUI.curtrigger=$WC.Util.getInnerText(a).slice(0,1))}),WMSUI.atMentions.changeColor(this.composer),this.editorreplydiv.setAttribute("data-originalmsg",this.composer.value),this.editorreplydiv.setAttribute("data-editmsg",!0);var d=this.attachmentnode.querySelector('[id="wms-file"]');d.disabled="true"},ChatWindow.prototype.showReplyPreview=function(a,b){this.closeReplyPreview();var c=Message.constructReplyMessageFragment(this.constructReplyMessageObject(a),!0,b);this.focus(),b&&this.showEditPreview(a),this.footernode.style.borderRadius="0px 0px 5px 5px",this.editorreplydiv.innerHTML=c,this.editorreplydiv.style.display="block"},ChatWindow.prototype.closeReplyPreview=function(){this.editorreplydiv.innerHTML="",this.editorreplydiv.style.display="none";if(this.editorreplydiv.getAttribute("data-editmsg")){this.editorreplydiv.removeAttribute("data-editmsg");var a=this.attachmentnode.querySelector('[id="wms-file"]');a.removeAttribute("disabled"),this.composer.value="",this.invisiblediv.innerHTML="",this.changeFooterHeight()}this.footernode.style.borderRadius="5px 5px 5px 5px"},ChatWindow.prototype.showRestrictedChannelIcon=function(){var a=this.win.querySelector("[data-channelrestricted]"),b=$WC.Channels.get(this.objId)&&$WC.Channels.get(this.objId).open_to_all;b=="false"&&$WC.Util.setAttribute(a,"data-channelrestricted",!0)},ChatWindow.prototype.disableActions=function(a){a=a||this;if(a.actionbutton){var b=a.actionbutton;b.style.cursor="not-allowed",b.disabled="true",a.actionlistnode.style.display="none"}},ChatWindow.prototype.disableComposerOptions=function(a,b){b=b||this,b.composer.disabled="true";if(b.attachmentnode){b.attachmentnode.setAttribute("data-disabled",!0);var c=b.attachmentnode.querySelector('[id="wms-file"]');c.disabled="true"}var d=b.smileyinvoker;d.disabled="true",this.footernode.setAttribute("data-disabled","true"),this.footernode.querySelector("[data-restriction-text]").innerText=a,$WC.Util.setAttribute(this.mainwin,"tabindex","1")},ChatWindow.prototype.hideActionItem=function(a,b){var c=this.actionlistnode.querySelector("[data-"+a+'="'+b+'"]');c.style.display="none"},ChatWindow.prototype.toggleEnlargeWindow=function(){this.isEnlarged?this.shrinkEnlargedWindow():(WindowHandler.shrinkEnlargedWindows(),this.focus(),this.isEnlarged=!0,this.enlargeicon.title=$WC.I18N("chat.shrink"),$WC.Util.addClass(this.mainwin,"wms_cw_enlarged"),$WC.Util.addClass(this.enlargeicon,"wms_cw_enlargeicon_rotate")),WindowHandler.onResize()},ChatWindow.prototype.shrinkEnlargedWindow=function(){this.isEnlarged=!1,this.changeFooterHeight(!0),this.enlargeicon.title=$WC.I18N("chat.enlarge"),$WC.Util.removeClass(this.enlargeicon,"wms_cw_enlargeicon_rotate"),$WC.Util.removeClass(this.mainwin,"wms_cw_enlarged")},ChatWindow.prototype.showReactionsUI=function(a){this.createOverlay();var b=$WC.Util.createElement("div",null,"wms_cw_reaction_container"),c=$WC.Util.createElement("span",null,"wms_cw_overlay_close");c.onclick=this.hideReactionsUI.bind(this);var d=$WC.Util.createElement("div",null,"wms_cw_reactionsparent");d.appendChild(b),d.appendChild(c),this.cw_overlay.appendChild(d),this.smileyinstance.mountComponent(b,!0,function(b){this.updateMyReactionData(a,b),WebMessanger.updateReaction(this.objId,a,b),this.hideReactionsUI()}.bind(this),function(){this.hideReactionsUI()}.bind(this)),this.smileyvisible=!0},ChatWindow.prototype.hideReactionsUI=function(){this.smileyinstance.unmountComponent(),this.composer.focus(),this.smileyvisible=!1,this.removeOverlay()},ChatWindow.prototype.showUnreadMsgs=function(a){var b=$WC.RecentChats.getLastSeenTime(this.objId),c=this.ctrlcomp.scrollHeight-this.ctrlcomp.clientHeight<=this.ctrlcomp.scrollTop+20?!0:!1,d=this.win.querySelector('[data-msgtime="'+b+'"][data-msgid]'),e;d&&(e=d.previousSibling.getAttribute("data-senderzuid")?d.previousSibling:d);if(e){this.clearUnreadMarker();var f=$WC.Util.createElement("div","","wms_unread_marker",{"data-unread":"true"},'<div class="wms_unread_marker_wrapper"><span class="wms_unread_marker_text">'+$WC.I18N("chat.newmessages")+"</span></div>");e.insertAdjacentElement("beforeBegin",f)}a?this.scrollToUnread():c&&this.scrollDisplay(),this.toggleUnreadBanner()},ChatWindow.prototype.clearUnreadMarker=function(){var a=this.win.querySelector("[data-unread]");a&&$WC.Util.removeElement(a)},ChatWindow.prototype.scrollToUnread=function(a){var b=this.win.querySelector("[data-unread]");if(!b)return;a?setTimeout(function(){$WC.Util.scrollIntoView(b,{block:"center",behavior:"smooth"})},1):$WC.Util.scrollIntoView(b,{block:"center"})},ChatWindow.prototype.toggleUnreadBanner=function(){var a=this.win.querySelector("[data-unread]");this.unread&&a?$WC.Util.isScrolledIntoView(a,this.ctrlcomp,!0)?(this.newmsgbanner.style.display="none",$WC.Util.setAttribute(this.newmsgbanner,"data-newmsgbanner",!1)):(a.getBoundingClientRect().top>this.ctrlcomp.getBoundingClientRect().bottom?$WC.Util.addClass(this.newmsgbanner,"wms_unread_msg_bottom"):$WC.Util.removeClass(this.newmsgbanner,"wms_unread_msg_bottom"),$WC.Util.setAttribute(this.newmsgbanner,"data-newmsgbanner",!0),this.newmsgbanner.style.display="block"):(this.newmsgbanner.style.display="none",$WC.Util.setAttribute(this.newmsgbanner,"data-newmsgbanner",!1))},ChatWindow.prototype.scrollToLastMsg=function(){var a=this.msgdisp.lastChild,b=a&&a.getAttribute("data-loadmorebutton")?!0:!1;if(b){$WC.RecentChats.updateLastSeenTime(this.objId);var c=$WC.Util.createElement("div");c.setAttribute("data-latestchunk",!0),this.msgdisp.innerHTML="",this.msgdisp.prepend(c),Message.loadSpecificTranscript(this.objId,this.msgdisp,c)}else $WC.Util.scrollIntoView(a,{behavior:"smooth"})},ChatWindow.prototype.createOverlay=function(){var a=$WC.Util.createElement("div",null,"wms_cw_overlay");this.cw_overlay=this.mainwin.appendChild(a),this.cw_overlay.onclick=function(){this.cw_overlay&&this.cw_overlay.childNodes[0]&&this.cw_overlay.childNodes[0].getAttribute("data-msgaction")==="true"&&this.hideMessageActionsUI()}.bind(this)},ChatWindow.prototype.removeOverlay=function(){this.cw_overlay&&($WC.Util.removeElement(this.cw_overlay),this.cw_overlay=null)},ChatWindow.prototype.showUrlPreview=$WC.Util.debounce(function(){var a=$WC.Util.getUnfurlableLink($WC.Util.safeHTML(this.composer.value));a[0]?a=a[0].trim():a="",this.previewlinkdetails&&a!=this.previewlinkdetails.url&&this.hideUrlPreview();var b=function(){this.hideUrlPreview()}.bind(this),c=function(b){if(b&&!this.urlpreviewvisible&&!$WC.Util.isEmptyObject(b)&&this.composer.value.indexOf(a)>-1){this.previewlinkdetails=b.linkdetails,this.unfurlmsg=!0,this.previewlinkdetails.redirected_url&&(this.previewlinkdetails.url=this.previewlinkdetails.redirected_url),this.previewlinkdetails.redirected_thumbnail_url&&(this.previewlinkdetails.thumbnailurl=this.previewlinkdetails.redirected_thumbnail_url);var c=$WC.UrlPreview.populate(this.previewlinkdetails,this.winIndex,null,!0,!1);this.urlpreviewcontainer.innerHTML=c,this.urlpreviewvisible=!0,this.unfurldata_cache_id=this.previewlinkdetails.unfurldata_cache_id?this.previewlinkdetails.unfurldata_cache_id:"",!$WC.Config.get("zoholinks_auth")&&(this.previewlinkdetails.authentication_consent==0||this.previewlinkdetails.authentication_consent==1)&&$WC.Config.set({zoholinks_auth:this.previewlinkdetails.authentication_consent}),this.urlpreviewcontainer.style.border="1px solid rgb(213, 213, 213)",this.fetchpreviewdetails=!1}else($WC.Util.isEmptyObject(b)||!b)&&this.hideUrlPreview()}.bind(this);a&&!this.urlpreviewvisible&&(this.urlpreviewcontainer.innerHTML=$WC.UrlPreview.showLoadingPreview(),this.footernode.style.borderRadius="0px 0px 5px 5px",this.fetchpreviewdetails=!0,this.unfurlmsg=!0,$WC.Ajax.postRequestToChat("getunfurleddata.do","link="+encodeURIComponent(a),c,b))},null,500),ChatWindow.prototype.hideUrlPreview=function(a){if(this.urlpreviewvisible||this.fetchpreviewdetails)this.unfurlmsg=!0,a===!0&&(this.unfurlmsg=!1),this.urlpreviewcontainer.innerHTML="",this.urlpreviewcontainer.style.border="none",this.footernode.style.borderRadius="5px 5px 5px 5px",this.urlpreviewvisible=!1,this.fetchpreviewdetails=!1,this.previewlinkdetails=null},ChatWindow.prototype.getUnfurlData=function(a){var b=$WC.Util.getUnfurlableLink(a);return b[0]&&(b=b[0].trim()),this.previewlinkdetails&&b&&this.previewlinkdetails.url===b?this.previewlinkdetails:!1},ChatWindow.prototype.checkAndStoreDraftMsg=function(){if(this.composer.value){var a=$WC.Drafts.get(this.objId);if(a&&a.msg==this.composer.value)return;var b=this.getReplyMessageId(),c=this.composer.value;this.atmentions&&(c=$WC.Util.unescapeHTML(WMSUI.atMentions.formatAtMentions(c,this.atmentions,this.objId,!0)));var d={msg:c,time:(new Date).getTime(),replied_to:b,chid:this.objId};$WC.Drafts.updateInServer(this.objId,d)}},ChatWindow.prototype.checkAndDeleteDraft=function(){this.composer.value===""&&$WC.Drafts.deleteDraftInServer(this.objId)},ChatWindow.prototype.restoreDraftedMsg=function(){function b(b){var c=a.meta&&a.meta.mentions,d=Message.isAddMsg(a.msg),e=Message.formatDraftMsg(a);if(e){b.composer.value=e;if(c||d){for(var f in c)if(c[f].type===$WC.CMsgUtil.UserMention||c[f].type==$WC.CMsgUtil.SpecialMention.participants||c[f].type==$WC.CMsgUtil.SpecialMention.available)b.atmentions+=c[f].id+",",WMSUI.curtrigger="@";d&&(b.atmentions="",$WC.Matcher.replace("addmember",a.msg,function(a,c){b.atmentions+=c+","}),WMSUI.curtrigger="+"),WMSUI.atMentions.changeColor(b.composer)}}}var a=$WC.Drafts.get(this.objId);if(a&&this.composer.value===""){if(a.replied_to){var c=this.win.querySelector('[data-msgid="'+a.replied_to+'"]');if(c)b(this),this.showReplyPreview(c);else{var d=a.replied_to.split("_")[1],e=this.objId+"|"+d,f=$WC.Util.createElement("div",null,null,{"data-mentionmsgid":e});f.style="display:none";var g=this.msgdisp.querySelector("[data-loadmore],[data-transerror]");this.msgdisp.replaceChild(f,g);var h=f;Message.loadSpecificTranscript(this.objId,this.msgdisp,h)}}else b(this);this.changeFooterHeight()}},ChatWindow.prototype.changeFooterHeight=function(a){var b=this.ctrlcomp.offsetHeight;this.footernode.style.height="56px",a&&setTimeout(this.changeFooterHeight.bind(this),260);var c=this.composer.offsetParent===null?this.msgoprnode:this.composer;c.scrollHeight<140?(this.footernode.style.height=c.scrollHeight+"px",this.composer.style.overflow="hidden",this.invisiblediv.style.overflow="hidden",this.msgoprnode.style.overflow="hidden"):(this.footernode.style.height="140px",this.composer.style.overflow="auto",this.invisiblediv.style.overflow="auto",this.msgoprnode.style.overflow="auto"),b>=this.ctrlcomp.offsetHeight?this.ctrlcomp.scrollTop=this.ctrlcomp.scrollTop+(b-this.ctrlcomp.offsetHeight):this.ctrlcomp.scrollTop!=this.ctrlcomp.scrollHeight-this.ctrlcomp.offsetHeight&&(this.ctrlcomp.scrollTop=this.ctrlcomp.scrollTop-(this.ctrlcomp.offsetHeight-b)),this.urlpreviewcontainer.style.bottom=this.footernode.offsetHeight+4+"px",this.smileycontainer.style.bottom=this.footernode.offsetHeight+4+"px",this.autocompletediv.style.bottom=this.footernode.offsetHeight+4+"px",this.editorreplydiv.style.bottom=this.footernode.offsetHeight+4+"px"},ChatWindow.prototype.updatePlatformMsg=function(a){var b=JSON.parse(a.addldata),c=this.ctrlcomp.querySelector('[data-msguid="'+a.msguid+'"]').getAttribute("data-msgid");a.time=a.msguid.split("%")[0];var d=$WC.CustomMsg.msgobj[a.chid][a.time];a.meta=b.meta,a.msg=b.msg,d.reactions&&Object.keys(d.reactions).length!=0&&(a.reactions=d.reactions),d.replied&&(a.meta.opr_replydetails=d.replied.info),a.sender=d.sender,a.zuid=d.sender,a.dname=d.dname,a.nname=d.dname,this.updateMessageFragment(a,c)},ChatWindow.prototype.showMessageActionsUI=function(a,b,c){this.createOverlay();var d=$WC.Util.createElement("div",null,"wms_cw_reaction_container"),e=$WC.Util.createElement("span",null,"wms_cw_overlay_close");e.onclick=this.hideMessageActionsUI.bind(this);var f=$WC.Util.createElement("div",null," wms_cw_msgactionsparent",{"data-msgaction":!0});f.appendChild(d),f.appendChild(e),this.cw_overlay.appendChild(f),this.messageactionsinstance.mountComponent({node:d,msgnode:a,allowed_actions:b,messageactionscallback:c,closeComponent:this.hideMessageActionsUI.bind(this)})},ChatWindow.prototype.hideMessageActionsUI=function(){this.messageactionsinstance.unmountComponent(),this.removeOverlay()},ChatWindow.prototype.showPinnedMsg=function(a){if(WebMessanger.is_msgpin_option_disabled)return;var b=this.objId,c=a.type==="stickymessage"||a.module==="ADD_STICKY"?a.data:a.stickymessage;if(c){c=typeof c=="string"?JSON.parse(c):c;var d=c.message,e=c.creator&&c.creator.name,f=this.pinmsgnode.getElementsByClassName("wms_pinmsg_content")[0];f.innerHTML=this.createPinMsgContentHTML(d),f.title=$WC.I18N("pinmsg.creator.info",e),this.pinmsgdetails.info.creator=c.creator&&c.creator.id,this.pinmsgdetails.info.msgtime=d&&d.origin_time||d.time,this.pinmsgdetails.info.msgid=c.message&&c.message.msguid,this.pinmsgdetails.info.duration=c.expiry_time,this.pinmsgdetails.info.duration_shown=!1,this.pinmsgnode.style.display="flex";var g=this.pinmsgdetails.action_enabled?!0:!1;this.pinmsgnode.setAttribute("data-show-options",g)}else a.addinfo&&a.addinfo.indexOf("STICKY")!=-1?_WMSWINFOCUS?WebMessanger.getPinnedMsg(b):(WebMessanger.get_pinmsg_onfocus=!0,this.pinmsgdetails.msg_pinned=!0):this.pinmsgdetails.msg_pinned=!1},ChatWindow.prototype.createPinMsgContentHTML=function(a){var b;if(a.mod){var c="wms_pinmsg_att_icon",d=a.msg.name||a.msg.fName;a.mod==="contact"?c+=" wms_pinmsg_contact_icon":a.mod==="location"?c+=" wms_pinmsg_location_icon":a.mod==="event"&&(c+=" wms_pinmsg_event_icon"),b=$WC.Util.safeHTML($WC.Util.unescapeHTML(d))+'<span class="'+c+'"></span>'}else{var e=a.msg.indexOf("<br>"),f=a.msg.indexOf("\n");b=a.msg.substring(0,e!==-1?e:f!==-1?f:a.msg.length),b=$WC.Util.safeHTML($WC.Util.unescapeHTML(b)),b=$WC.Markdown.apply(b);var g=$WC.Util.cloneObject(a,!0);g.msg=b,b=g.meta&&g.meta.mentions?$WC.Util.formatMentions(g,!0):$WC.Util.formatMentions(b),b=Smiley.replace(b,!0)}return b},ChatWindow.prototype.updatePinnedMsg=function(a){var b=this.createPinMsgContentHTML(a.msg),c=this.pinmsgnode.getElementsByClassName("wms_pinmsg_content")[0];c.innerHTML=b},ChatWindow.prototype.clearPinnedMsg=function(){var a=this.pinmsgnode.getElementsByClassName("wms_pinmsg_content")[0];a.innerText="",a.title="",this.pinmsgdetails.info={},this.pinmsgdetails.msg_pinned=!1,this.pinmsgnode.style.display="none"},ChatWindow.prototype.highlightPinnedMsg=function(a,b){a=typeof a=="string"?a:this.pinmsgdetails.info.msgtime;var c=this.ctrlcomp;if(!Message.glowBubble(a,c,this.objId)){b=b||this.pinmsgdetails.info.creator;var d=this.objId+"|"+b+"|"+a,e=Message.getMarkerElement(d,a,this.msgdisp);Message.loadSpecificTranscript(this.objId,this.msgdisp,e)}},ChatWindow.prototype.togglePinMsgOptions=function(a){var b=this.pinmsgdetails.info.duration,c=this.pinmsgnode.getElementsByClassName("wms_pinmsg_options")[0];if(c.getAttribute("data-pinmsg-options")=="true"||a)this.pinmsgdetails.info.duration_shown&&(this.pinmsg_duration_selector_instance.unmountComponent(),this.pinmsgdetails.info.duration_shown=!1),c.setAttribute("data-pinmsg-options","false");else{var d="";b==-1?d=$WC.I18N("chat.forever"):(d=$WC.DateUtil.relativeTimeLeft(b),d.indexOf($WC.I18N("chat.mute.day"))!==-1&&d.indexOf($WC.I18N("chat.mute.minute"))!==-1&&(d=d.substring(0,d.indexOf($WC.I18N("chat.mute.minute"))-4)));var e=$WC.I18N("pinmsg.timeleft",d);$WC.$CUtil.setInnerText(this.pinmsgduration,e),c.setAttribute("data-pinmsg-options","true")}},Factory.createDialog=function(a,b){var c=new ChatWindow;WindowHandler.exist.push(c);var d=WindowHandler.exist.length-1;c.setIndex(d);var e=c.create(a,b);return e},Factory.removeDialog=function(a){WindowHandler.exist[a]="empty",WindowHandler.rearrange()},Factory.destroyDialog=function(a,b){Factory.removeDialog(a,b),WindowHandler.reopenRemovedChat()},WindowHandler.deleteParticipantsByID=function(a,b){var c=WindowHandler.getWinObjById(a);c&&c.deleteParticipants(b)},WindowHandler.addParticipantsByID=function(a,b){var c=WindowHandler.getWinObjById(a);c&&c.addParticipants(b,!0)},WindowHandler.checkAndHighlightChat=function(a){var b=WindowHandler.getWinObjById(a),c=$WC.RecentChats.getChatIdList($WC.RecentChats.getUnreadChatList());b&&c.indexOf(a)!=-1&&b.highlight()},WindowHandler.init=function(){this.count=0,this.exist=[],this.removed=[],this.lastViewed=-1,this.openedChats={},this.prevtime=null,this.cwsize=323,this.enlargedsize=455},WindowHandler.init(),WindowHandler.getMaxWin=function(){var a=0;WebMessanger.isServiceStatus()===!1&&(a=document.getElementById("wmsstatusbar").offsetWidth),WMSUI.globalsearchenabled&&document.getElementById("wmsglobalsearch")&&(a+=document.getElementById("wmsglobalsearch").offsetWidth);var b=document.getElementById("wmstoolbar").offsetWidth,c=WindowHandler.exist.find(function(a){if(a!=="empty"&&a.isEnlarged)return!0}),d=c?this.enlargedsize-this.cwsize:0,e=(b-(a+document.getElementById("wms-menucontainer").offsetWidth+d))/this.cwsize;return e<1&&(e=1),typeof WebMessanger.forceMaxWin!="undefined"&&(e=WebMessanger.forceMaxWin),parseInt(e,10)},WindowHandler.reopenRemovedChat=function(){var a=WindowHandler.removed.pop();a!=null&&($WC.WmsSessionStorage.setChatInfo({chid:a,removed:"false"}),WebMessanger.join(a,!0))},WindowHandler.removeExcessChat=function(a,b){function c(b){var c=WindowHandler.exist[b];return c!="empty"&&c!=null&&!c.detached&&document.getElementById(c.getObjId())!=null&&(c.getObjId()!=a&&e==null&&document.activeElement!=c.composer&&!c.iscallongoing&&(c.composer.value?f=c:e=c),d++),e}var d=0,e=null,f=null,g;if(b)for(g=WindowHandler.exist.length;g>=0;g--)e=c(g);else for(g=0;g<WindowHandler.exist.length;g++)e=c(g);d>this.getMaxWin()?(e==null&&(e=f),WindowHandler.removed.push(e.getObjId()),$WC.WmsSessionStorage.setChatInfo({chid:e.getObjId(),removed:"true"}),e.win.style.display="none",$WC.Util.removeElement(e.win),WmsChatCache.remove(e.getObjId()),Message.deletedMessages.remove(e.getObjId()),Factory.removeDialog(e.winIndex,!1),WindowHandler.count--):WindowHandler.rearrange()},WindowHandler.sendBotSuggestions=function(a,b){var c=a.getAttribute("chid"),d=WindowHandler.getWinObjById(c);Message.send(c,b),d.listcommon.showUI(""),d.autocompletediv.style.display="none",d.footernode.style.borderRadius="5px"},WindowHandler.onResize=function(){if(document.getElementById("wms-menucontainer")){var a=$WC.Util.getObjectLength(WindowHandler.openedChats),b=WindowHandler.getMaxWin();if(a>b){var c=a-b;for(var d=0;d<c;d++)WindowHandler.removeExcessChat(null,!0)}else if(b>a&&WindowHandler.removed.length>0){var e=b-a;for(d=0;d<e;d++)WindowHandler.reopenRemovedChat()}}},$WC.Util.addEvent(window,"resize",WindowHandler.onResize),WindowHandler.getObjectInObject=function(a,b,c){var d=a.getElementsByTagName(c);for(var e=0;e<d.length;e++)if(d[e].id==b)return d[e];return null},WindowHandler.getBarObject=function(a,b){return WindowHandler.getObjectInObject(this.chatbar,a,b)},WindowHandler.moveFocus=function(a,b,c){var d=0,e=0,f={},g={},h={};for(var i=WindowHandler.exist.length;i>0;i--){var j=WindowHandler.exist[i];if(j!="empty"&&j!=null&&j.win!=null&&j.win!=undefined&&!j.isMinimized()){g=j;break}}for(var k=0;k<WindowHandler.exist.length;k++){var l=WindowHandler.exist[k];if(l!="empty"&&l!=null&&l.win!=null&&l.win!=undefined&&!l.detached&&!l.isMinimized()){d==0&&(f=l),d++;if(l.getObjId()==a){e=a;continue}if(e!=0)return b?$WC.Util.getObjectLength(h)?(h.selectChat(),h.focus("",c)):WmsMainUI.menu.style.display==="block"?(WmsMainUI.searchdiv.focus(),WindowHandler.lastViewed=-1):(g.selectChat(),g.focus("",c)):(l.selectChat(),l.focus("",c)),!1;h=l}}return b?(h.selectChat(),h.focus("",c)):c&&g.getObjId&&e==g.getObjId()&&f!=g?(f.selectChat(),f.focus("",!0)):e&&WmsMainUI.menu.style.display==="block"?(WmsMainUI.searchdiv.focus(),WindowHandler.lastViewed=-1):d&&(b?(g.selectChat(),g.focus("",c)):(f.selectChat(),f.focus("",c))),!1},WindowHandler.rearrange=function(){WindowHandler.openedChats={};for(var a=0;a<WindowHandler.exist.length;a++){var b=WindowHandler.exist[a];if(b!="empty"&&b!=null&&b.win!=null&&b.win!=undefined){var c=b.isMinimized()?"min":"max";$WC.WmsSessionStorage.setChatInfo({chid:b.getObjId(),state:c}),WindowHandler.openedChats[b.getObjId()]=c}}},WindowHandler.makeNormalWinById=function(a){var b=WindowHandler.getWinObjById(a);b&&b.makeNormal(!0)},WindowHandler.getWinObjById=function(a){a=""+a;for(var b=0;b<WindowHandler.exist.length;b++){var c=WindowHandler.exist[b];if(c!="empty"&&c!=null&&c.getObjId()==a)return c}return null},WindowHandler.removeWinById=function(a){var b=WindowHandler.getWinObjById(a);b&&b.close(!0)},WindowHandler.closeWinById=function(a){var b=WindowHandler.getWinObjById(a);b&&b.closeAndPropagate()},WindowHandler.updateMediacallPermissions=function(){for(var a=0;a<WindowHandler.exist.length;a++){var b=WindowHandler.exist[a];b!=="empty"&&b.showVideoDropdown()}},WindowHandler.updateUserStatus=function(a,b,c,d){for(var e=0;e<WindowHandler.exist.length;e++){var f=WindowHandler.exist[e];if(f!="empty"&&f!=null){var g=a;f.updatePartinfo(g,b,c,d),f.partcount===2&&f.partinfo[g]!==undefined?(f.updateUserStatus(b,c,d),b==0?f.updateOfflineMessage():b!=0&&f.offlinemessage&&f.updateOnlineMessage()):f.partcount>2&&f.partinfo[g]!==undefined&&f.populateParticipants()}}},WindowHandler.setTitle=function(a,b){WindowHandler.getWinObjById(a).setTitle(b)},WindowHandler.updateChatTitle=function(a,b){WindowHandler.getWinObjById(a).updateChatTitle(b)},WindowHandler.updateStatus=function(a,b,c,d){WindowHandler.getWinObjById(a).updateUserStatus(b,c,d)},WindowHandler.focusChatById=function(a){WindowHandler.getWinObjById(a).focus()},WindowHandler.changeActive=function(){WMSUI.handleDocumentActive()},WindowHandler.restoreChats=function(a){var b=$WC.WmsSessionStorage.getItem("wms_openchats");if(b===null)return;WindowHandler.removed=[];for(var c=0;c<b.length;c++){var d=b[c].chid;b[c].removed==="true"?WindowHandler.removed.push(d):b[c].salesiqchat==="true"?typeof WmsUIImpl!="undefined"&&WmsImplHandler.invoke(WmsUIImpl.restoreChat,d):WebMessanger.prefetch_channels&&$WC.Util.isChannelChid(d)&&$WC.Channels.getLastFetchedTime()===null?($WC.Channels.initChannels(),WmsMainUI.scheduleAutoJoin(d)):a&&WebMessanger.join(d)}},WindowHandler.syncChatWindowTranscripts=function(){function c(a,b){setTimeout(function(){var b=WindowHandler.getWinObjById(a),c=b.msgdisp,d=c.querySelectorAll("[data-transerror],[data-loading]"),e=c.querySelectorAll(".wms-msgfrag:not([data-notack]):not([data-transerror]),.wms-msginfofrag[data-editinfo]");if(e){var f=e[e.length-1];if(f){d.length&&!d[d.length-1].nextSibling&&$WC.Util.removeElement(d[d.length-1]);var g=$WC.Util.createElement("div",null,null,{"data-prevtime":f.getAttribute("data-msgtime"),"data-scrollbehaviour":"bottom"});g.style="display:none",c.appendChild(g),Message.loadSpecificTranscript(a,c,g,!0)}}},b)}var a=this.openedChats,b=0;for(var d in a)WindowHandler.getWinObjById(d).makeNormal(),b+=500,c(d,b)},WindowHandler.syncDraftsInUI=function(){for(var a=0;a<WindowHandler.exist.length;a++){var b=WindowHandler.exist[a];b!=="empty"&&b.restoreDraftedMsg()}},$WC.Util.pubsub.subscribe("drafts/updateui",function(){WindowHandler.syncDraftsInUI()}),WindowHandler.resetAllTypingStatus=function(){for(var a=0;a<WindowHandler.exist.length;a++)if(WindowHandler.exist[a]!=="empty"){WindowHandler.exist[a].typingstatusnode.innerHTML="",WindowHandler.exist[a].typingindicatornode.style.display="none";var b=WindowHandler.exist[a].msgdisp.querySelector("[data-typingstatus]");b&&$WC.Util.removeElement(b)}},WindowHandler.updateBotsInfoInUI=function(){for(var a=0;a<WindowHandler.exist.length;a++){var b=WindowHandler.exist[a];if(b!=="empty"&&b.ctype==9){var c=$WC.Bots.getBotId(b.objId),d=$WC.Bots.get(c);b.updateBotImage(c),b.setTitle(d.DNAME),b.updateUserStatus()}}},$WC.Util.pubsub.subscribe("/bots/updateui",function(){WindowHandler.updateBotsInfoInUI()}),WindowHandler.updateChannelProperties=function(){for(var a=0;a<WindowHandler.exist.length;a++){var b=WindowHandler.exist[a];b!=="empty"&&b.ctype==8&&($WC.Channels.get(b.objId)&&($WC.Channels.isUserHasPermission(b.objId,$WC.WmsConstants.USERPERMISSIONS.SEND_MESSAGE)==0&&(b.permdenied=!0,b.disableComposerOptions($WC.I18N("channels.announcementonly"))),$WC.Channels.isUserHasPermission(b.objId,$WC.WmsConstants.USERPERMISSIONS.ADD_MEMBER)==1&&(b.addmembernode.style.display="block"),$WC.Channels.isUserHasPermission(b.objId,$WC.WmsConstants.USERPERMISSIONS.STICKY_MESSAGE)==0&&(b.pinmsgdetails.action_enabled=!1,b.pinmsgnode.setAttribute("data-show-options",!1)),b.showRestrictedChannelIcon(),$WC.Channels.get(b.objId).leave_allowed==0&&(b.leavechannelnode.style.display="none")),b.updateChannelImage())}},WindowHandler.shrinkEnlargedWindows=function(){for(var a=0;a<WindowHandler.exist.length;a++)WindowHandler.exist[a]!=="empty"&&WindowHandler.exist[a].shrinkEnlargedWindow()},WindowHandler.hideAllActions=function(){for(var a=0;a<WindowHandler.exist.length;a++)WindowHandler.exist[a]!=="empty"&&(WindowHandler.exist[a].hideActions(),WMSUI.autoComplete.hideUI(WindowHandler.exist[a].objId))},WindowHandler.showProgress=function(a,b,c){var d=WindowHandler.getWinObjById(a);d!=null&&d.showProgress(b,c,WmsDragDrop.nooffiles)},WindowHandler.clearProgress=function(a){var b=WindowHandler.getWinObjById(a);b!=null&&b.clearProgress()},WindowHandler.checkAndHidePinmsgOptions=function(a){for(var b=0;b<WindowHandler.exist.length;b++)if(WindowHandler.exist[b]!=="empty"&&!$WC.Util.isEmptyObject(WindowHandler.exist[b].pinmsgdetails.info)){if(a&&WindowHandler.exist[b].objId===a)continue;WindowHandler.exist[b].togglePinMsgOptions(!0)}},WindowHandler.getPinMsgForOpenedChats=function(){for(var a=0;a<WindowHandler.exist.length;a++)WindowHandler.exist[a]!=="empty"&&WindowHandler.exist[a].pinmsgdetails.msg_pinned&&WebMessanger.getPinnedMsg(WindowHandler.exist[a].objId);WebMessanger.get_pinmsg_onfocus=!1},Message.types={TEXTMSG:"TEXTMSG",INFOMSG:"INFOMSG",IMGATT:"IMGATT",FILEATT:"FILEATT",LOADMORE:"LOADMORE",LOADMOREBUTTON:"LOADMOREBUTTON",TRANSERR:"TRANSERR",AUDIOATT:"AUDIOATT",VIDEOATT:"VIDEOATT",LOCATT:"LOCATT",CONTACTATT:"CONTACTATT",EVENTATT:"EVENTATT",CUSTOMMSG:"CUSTOMMSG",VIDEOLINK:"VIDEOLINK",AUDIOLINK:"AUDIOLINK",IMGLINK:"IMGLINK",BOTMSG:"BOTMSG",REPLYMSG:"REPLYMSG",TEMPMSG:"TEMPMSG",HRMSG:"HRMSG",DELETEDMSG:"DELETEDMSG",EDITEDMSG:"EDITEDMSG"},Message.getMsgCategory=function(a){return/span class="wms-commandtext">[/](?:.+?)<\/span>/.test(a)?"command":/span class="wms-atmtntext">[@](?:.+?)<\/span>/.test(a)?"atmentions":/span class="wms-atmtntext">[+](?:.+?)<\/span>/.test(a)?"addmem":"msg"},Message.getCurtriggers=function(a){return a=="atmentions"?["@",":"]:a=="addmem"?["+",":"]:WMSUI.triggers},Message.metaInfo={},Message.mentionMsgInfo={},Message.toggleLiveZomoji=function(a){var b=a.querySelectorAll("[class^=zomoji-f-24-],[class^=zomoji-f-48-]");for(var c=0;c<b.length;c++){var d=b[c],e=$WC.$CUtil.isScrolledIntoView(d,a,!0);if(e){var f=d.closest("[data-reaction]").getAttribute("data-reaction");f=f.replace(/:/g,""),f=f.replace("!","");var g="https://img.zohostatic.com/chat/default/officechat/images/default/sm-animation/48/"+f+".png";$WC.Config.get("builddomain")&&(g=$WC.Config.get("builddomain")+g);if(WMSUI.isLoadedImg(g))d.className.indexOf("zomoji-f-24-")>-1?d.className="zomojianim-24-"+f:d.className.indexOf("zomoji-f-48-")>-1&&(d.className="zomojianim-48-"+f);else{var h=new Image;h.src=g,h.onload=function(){WMSUI.loadedimg[g]=!0,Message.toggleLiveZomoji(a)}}}}var i=a.querySelectorAll("[class^=zomojianim-24-],[class^=zomojianim-48-]");for(var c=0;c<i.length;c++){var d=i[c],e=$WC.$CUtil.isScrolledIntoView(d,a,!0);if(!e){var f=d.closest("[data-reaction]").getAttribute("data-reaction");f=f.replace(/:/g,""),f=f.replace("!",""),d.className.indexOf("zomojianim-24-")>-1?d.className="zomoji-f-24-"+f:d.className.indexOf("zomojianim-48-")>-1&&(d.className="zomoji-f-48-"+f)}}},Message.PREV_SENDER={},Message.send=function(a,b,c,d,e,f,g,h,i,j){var k=WindowHandler.getWinObjById(a);if(WMSUI.showErrorIfPermDenied(a))return;if(WebMessanger.offline==1)return k.updateInfoMessage($WC.I18N("Unable_to_send_message")),!1;if(b.length>4e3)return k.updateInfoMessage($WC.I18N("You_cannot_send_message_over_4000_characters_long")),!1;var l=(new Date).getTime();b=Smiley.replaceTextToEnglishCodes(b);if(h&&k){var m=k.ctrlcomp.querySelector('[data-msguid="'+h+'"]');m&&m.nextSibling&&m.nextSibling.getAttribute("data-timefrag")=="true"&&(m.nextSibling.innerText=$WC.I18N("message.status.sending"))}WebMessanger.sendFormattedMessage(a,b,l,c,d,e,f,g,h,j),b=$WC.Util.safeHTML(b),b=$WC.Markdown.apply(b),k.getUnfurlData(b)||(b=Message.trim(b));if(g){var n=k.msgdisp.querySelector('[data-msgid="'+g+'"]'),o=k.constructReplyMessageObject(n,WMSUI.atMentions.updateMessage(b,a),l);o.sentfromcomposer=i,k.closeReplyPreview()}else if(k.urlpreviewcontainer.childNodes.length>0&&k.getUnfurlData(b)){var p=k.getUnfurlData(b),q=/{[\+|\-]?[@#](.*?)}/g,r=b.match(q);r&&(b=$WC.Util.unescapeHTML(WMSUI.atMentions.updateMessage(b,a))),o={sender:WebMessanger.zuid,msg:b,time:l,notack:!0,meta:{linkdetails:p},sentfromcomposer:i}}else o={sender:WebMessanger.zuid,msg:WMSUI.atMentions.updateMessage(b,a),time:l,notack:!0,sentfromcomposer:i};return k.hideUrlPreview(),h?k.closeReplyPreview():!d&&!Commands.isCommandMsg(b)&&k.updateMessage(o),k.removePromptMsg(),Self.isIdle[a]=!0,!0},Message.isSameBrowser=function(a){return a==WebMessanger.getSid()?!0:!1},Message.isSentFromApi=function(a){return a&&a.api?!0:!1},Message.isCustomMsg=function(a){var b=$WC.CMsgUtil.convertMsgObj(a);return b["btnindexvsdetails.msg"]&&!b.info||b["btnindexvsdetails.msg"]&&b.info&&b.info.type!="unfurling"||!$WC.Util.isEmptyObject(b["brief.msg"])&&b["brief.msg"]||typeof b["long.msg"]!="undefined"&&b["long.msg"].length>0},Message.isReplyMsg=function(a){return a.meta!=undefined&&a.meta.opr_replydetails!=undefined},Message.isBotMsg=function(a){return a.meta!==undefined&&a.meta.ms==1&&a.meta.bm||typeof a.sender=="string"&&$WC.Bots.isBotId(a.sender)||a.meta!==undefined&&a.meta.usermessagedetails&&a.meta.usermessagedetails.custom_sender_id&&$WC.Bots.isBotId(a.meta.usermessagedetails.custom_sender_id)},Message.isMsgFromBot=function(a){var b=Message.getMessageType(a);return a&&a.meta&&Message.isBotMsg(a)&&a.meta.message_source&&(a.meta.message_source.type==="bot"||a.meta.message_source.type==="command")||b===Message.types.BOTMSG||b===Message.types.CUSTOMMSG},Message.isDelayMsg=function(a){return a.meta!==undefined&&a.meta.ms==1&&a.meta.config&&a.meta.config.d},Message.isHidingMsg=function(a){return a.meta!==undefined&&a.meta.ms==1&&a.meta.config&&a.meta.config.h},Message.isMetaMsg=function(a){return a.meta!==undefined},Message.isTempMsg=function(a){return a.meta!==undefined&&a.meta.isTempResponse},Message.furlVideoElement=function(a){var b=a.querySelectorAll("[data-playable=true]"),c;for(var d=0;d<b.length;d++)c=b[d].getAttribute("thumbnailimg"),b[d].innerHTML='<div id="wms-urlvideo-play" class="wms-urlvideo-play wms-hvalign"></div>'+c},Message.formatCustomMsg=function(a,b){ZMSGUI.createOverlay();var c=Message.metaInfo[b],d=c.usermessagedetails,e=c.formattedmsg,f="",g="",h="",i='<span class="wms-imgpreviewclose"><img src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/spacer.gif" class="wms-imgpreviewcls"></span>',j='<div class="wms-custmmsgtitle">',k=d&&d.msg_title?'<div class="wms-custmmsgvline wms-truncate-ellipsis">{{msgtitle}}</div>':"",l=d&&(d.thumbnail_url||d.thumbnail_id)?'<div class="wms-custmmsgthumbnail"><img src="{{thumbnailurl}}" class="wms-custmmsgimg"></div>':"",m='<div class="wms-custmmsgpadding">{{custommsg}}</div></div>',n=e?e.length:0,o="";d&&d.thumbnail_url?o=d.thumbnail_url:d&&d.thumbnail_id&&(o="/"+_CHATCONT+"/v1/images/"+d.thumbnail_id);for(var p=0;p<n;p++){var q=e[p],r=q.data,s=q.type,t=q.title;if(s==="text")f=t?'<div class="wms-custmmsgtitle"><span class="wms-custmmsgtitvline wms-truncate-ellipsis">'+$WC.Util.escapeHTML(t)+"</span>":'<div class="wms-custmmsgtitle">',f+='<div class="wms-custmmsgcnt">'+$WC.Util.escapeHTML(r)+"</div></div>";else if(s==="list"){g=t?'<div class="wms-custmmsgtitle"><span class="wms-custmmsgtitvline wms-truncate-ellipsis">'+$WC.Util.escapeHTML(t)+"</span>":'<div class="wms-custmmsgtitle">',g+='<ul class="wms-custmmsglist">';var u=r?r.length:0;for(var v=0;v<u;v++)g+="<li>"+$WC.Util.escapeHTML(r[v])+"</li>";g+="</ul></div>"}else if(s==="table"){h=t?'<div class="wms-custmmsgtitle"><span class="wms-custmmsgtitvline wms-truncate-ellipsis">'+$WC.Util.escapeHTML(t)+"</span>":'<div class="wms-custmmsgtitle">',h+='<div class="wms-custmtablediv"><div class="wms-custmtable"><div class="wms-custmrow">';var w=r.headers.length;for(var x=0;x<w;x++)h+='<div class="wms-custmcel">'+$WC.Util.escapeHTML(r.headers[x])+"</div>";h+="</div>";var y=r.rows?r.rows.length:0;for(var z=0;z<y;z++){h+='<div class="wms-custmrow">',u=r.rows[z].length;for(var A=0;A<u;A++)h+='<div class="wms-custmcel">'+$WC.Util.escapeHTML(r.rows[z][A])+"</div>";h+="</div>"}h+="</div></div>"}}j+=k+l+m+f+g+h+'</div></div><span class="wms-imgpreviewclose"><img src="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/spacer.gif" class="wms-imgpreviewcls"></span>',j=$WC.template.replace(j,{msgtitle:d?d.msg_title:"",thumbnailurl:o,custommsg:a});var B=$WC.Util.createElement("div","wms-custmmsgcontainer","wms-custmmsg wms-hvalign");B.style.zIndex=$WC.Config.get("zindex"),document.body.appendChild(B),document.getElementById("wms-custmmsgcontainer").innerHTML=j,document.getElementById("wms-overlay").innerHTML=i},Message.resend=function(a,b,c){var d=a.getAttribute("data-chid"),e=[],f=[];c?f=a.querySelectorAll("[data-msgfailure]"):f.push(b);for(var g=f.length-1;g>=0;g--)e.push(Message.getMsgFromDom(d,f[g].getAttribute("data-msgid")||f[g].parentNode.querySelector("[data-msgid]").getAttribute("data-msgid"),!1,!1)),Message.removeFailedMessages(f[g]);Message.sendmsg(d,e)},Message.removeFailedMessages=function(a){var b=a.previousSibling,c=a.nextSibling;b&&b.className==="wms-msgtime"&&(b=b.previousSibling),c&&c.className==="wms-msgtime"&&(c=c.nextSibling);if(b&&b.getAttribute("data-senderzuid")&&(!c||c&&c.getAttribute("data-senderzuid"))){var d=a.previousSibling;d.previousSibling.className==="wms-msgdate"&&$WC.Util.removeElement(d.previousSibling),$WC.Util.removeElement(a.previousSibling)}a.nextSibling&&a.nextSibling.className==="wms-msgtime"&&$WC.Util.removeElement(a.nextSibling),$WC.Util.removeElement(a)},Message.sendmsg=function(a,b){var c=b.pop();Message.send(a,c,b)},Message.getTextMsgFromDom=function(a,b,c){var d="";for(var e=0;e<a.length;e++)if(a[e].nodeName==="#text"||a[e].nodeName==="A"||a[e].getAttribute("data-urlpreviewcomment"))a[e].nodeName==="A"&&a[e].getAttribute("markdown")==="linkhtml"?d+=b?$WC.Util.safeHTML("["+$WC.Util.getInnerText(a[e])+"]("+a[e].href+")"):"["+$WC.Util.getInnerText(a[e])+"]("+a[e].href+")":d+=b?$WC.Util.safeHTML($WC.Util.getInnerText(a[e])):$WC.Util.getInnerText(a[e]);else if(a[e].nodeName==="SPAN"){var f=a[e].outerHTML;d+=c?a[e].innerHTML:WMSUI.atMentions.replaceAtMentionsForHtml(f,b)}else if(a[e].nodeName==="EM"){var g=a[e].outerHTML;d+=Smiley.replaceSmileyForHtml(g)}else a[e].nodeName==="BLOCKQUOTE"?d+=b?$WC.Markdown.apply("!"+Message.getTextMsgFromDom(a[e].childNodes,b)):"!"+Message.getTextMsgFromDom(a[e].childNodes,b):a[e].nodeName==="CODE"?d+=b?$WC.Markdown.apply("`"+Message.getTextMsgFromDom(a[e].childNodes,b)+"`"):"`"+Message.getTextMsgFromDom(a[e].childNodes,b)+"`":a[e].nodeName==="PRE"?d+=b?$WC.Markdown.apply("```"+Message.getTextMsgFromDom(a[e].childNodes,b)+"```"):"```"+Message.getTextMsgFromDom(a[e].childNodes,b)+"```":a[e].nodeName==="STRONG"?d+=b?$WC.Markdown.apply("*"+Message.getTextMsgFromDom(a[e].childNodes,b)+"*"):"*"+Message.getTextMsgFromDom(a[e].childNodes,b)+"*":a[e].nodeName==="STRIKE"?d+=b?$WC.Markdown.apply("~"+Message.getTextMsgFromDom(a[e].childNodes,b)+"~"):"~"+Message.getTextMsgFromDom(a[e].childNodes,b)+"~":a[e].nodeName==="I"?d+=b?$WC.Markdown.apply("_"+Message.getTextMsgFromDom(a[e].childNodes,b)+"_"):"_"+Message.getTextMsgFromDom(a[e].childNodes,b)+"_":a[e].nodeName==="H1"?d+=b?$WC.Markdown.apply("# "+Message.getTextMsgFromDom(a[e].childNodes,b)):"# "+Message.getTextMsgFromDom(a[e].childNodes,b):a[e].nodeName==="H2"?d+=b?$WC.Markdown.apply("## "+Message.getTextMsgFromDom(a[e].childNodes,b)):"## "+Message.getTextMsgFromDom(a[e].childNodes,b):a[e].nodeName==="H3"?d+=b?$WC.Markdown.apply("### "+Message.getTextMsgFromDom(a[e].childNodes,b)):"### "+Message.getTextMsgFromDom(a[e].childNodes,b):a[e].nodeName==="H4"?d+=b?$WC.Markdown.apply("#### "+Message.getTextMsgFromDom(a[e].childNodes,b)):"#### "+Message.getTextMsgFromDom(a[e].childNodes,b):a[e].nodeName==="H5"?d+=b?$WC.Markdown.apply("##### "+Message.getTextMsgFromDom(a[e].childNodes,b)):"##### "+Message.getTextMsgFromDom(a[e].childNodes,b):a[e].nodeName==="H6"?d+=b?$WC.Markdown.apply("###### "+Message.getTextMsgFromDom(a[e].childNodes,b)):"###### "+Message.getTextMsgFromDom(a[e].childNodes,b):a[e].nodeName==="BR"?d+="\n":a[e].nodeName==="HR"&&(d+="---");return d},Message.getMsgFromDom=function(a,b,c,d,e){var f=WindowHandler.getWinObjById(a).msgdisp,g=c?'.wms-msgfrag [data-msgid="'+b+'"]':'[data-msgid="'+b+'"]',h=f.querySelector(g),i=h.getAttribute("data-type");h=h&&h.firstChild;var j=h.childNodes,k,l;if(i==Message.types.TEXTMSG||i==Message.types.BOTMSG||i==Message.types.EDITEDMSG)return Message.getTextMsgFromDom(j,d,e);if(i==Message.types.IMGATT){var m=h.querySelector("img[data-previewable]");return l=m.getAttribute("data-fname"),{messagetype:i,fName:d?$WC.Util.safeHTML(l):l,fileurl:m.src.split("/").pop(),isv1:m.getAttribute("data-isv1")}}if(i==Message.types.REPLYMSG)return Message.getMsgFromDom(a,b,!0,d);if(i==Message.types.FILEATT)return k=h.querySelector(".wms-filetitle"),l=$WC.Util.getInnerText(k),{messagetype:i,fName:d?$WC.Util.safeHTML(l):l};if(i==Message.types.LOCATT)return k=h.querySelector(".wms-locmsgimg a"),l=$WC.Util.getInnerText(k),{messagetype:i,name:d?$WC.Util.safeHTML(l):l};if(i==Message.types.CONTACTATT)return k=h.querySelector(".wms-contactmsgimg span"),l=$WC.Util.getInnerText(k.firstChild),{messagetype:i,name:d?$WC.Util.safeHTML(l):l};if(i==Message.types.EVENTATT)return k=h.querySelector(".wms-evntmsgname"),l=$WC.Util.getInnerText(k),{messagetype:i,name:d?$WC.Util.safeHTML(l):l};if(i==Message.types.AUDIOATT)return k=h.querySelector(".wms-audioinfo a"),l=$WC.Util.getInnerText(k),{messagetype:i,fName:d?$WC.Util.safeHTML(l):l};if(i==Message.types.VIDEOATT)return k=h.querySelector("#wms-videoplayer"),l=k.getAttribute("data-fname"),{messagetype:i,fName:d?$WC.Util.safeHTML(l):l};if(i==Message.types.CUSTOMMSG)return k=h.querySelector(".zcdesc"),k?(l=$WC.Util.getInnerText(k),{messagetype:i,desc:d?$WC.Util.safeHTML(l):l}):Message.getTextMsgFromDom(j,d);if(i==Message.types.VIDEOLINK||i==Message.types.AUDIOLINK)return k=h.querySelector("a"),l=$WC.Util.getInnerText(k),{messagetype:i,desc:d?$WC.Util.safeHTML(l):l};if(i==Message.types.IMGLINK)return k=h.querySelector("img"),{messagetype:i,desc:d?$WC.Util.safeHTML(k.src):k.src};if(i==Message.types.HRMSG)return h=h.parentNode.lastChild,Message.getTextMsgFromDom([h],d)},Message.formatDraftMsg=function(a){var b=a.msg;if(a.meta&&a.meta.mentions){var c=a.meta.mentions;for(var d in c)if(c[d].type===$WC.CMsgUtil.UserMention){var e="{@"+c[d].id+"}";b.indexOf(e)!=-1&&(b=b.replace(e,"@"+$WC.Util.getContactName(c[d].id,c[d].name)))}else if(c[d].type===$WC.CMsgUtil.ChannelMention){var e="{#"+c[d].id+"}";b.indexOf(e)!=-1&&(b=b.replace(e,c[d].dname))}else if(c[d].type==$WC.CMsgUtil.SpecialMention.participants||c[d].type==$WC.CMsgUtil.SpecialMention.available){var e="{@"+c[d].id+"}";b.indexOf(e)!=-1&&(b=b.replace(e,c[d].dname))}}return Message.isAddMsg(b)&&(b=WMSUI.atMentions.format(b,!0)),b},Message.isMentionMsg=function(a){return $WC.Matcher.check("atmention",a)||$WC.Matcher.check("usersilentmention",a)||a.meta&&a.meta.mentions},Message.isAddMsg=function(a){return $WC.Matcher.check("addmember",a)||a.meta&&a.meta.mentions},Message.formatLastMsgInfo=function(a){var b=a;if(Message.isMentionMsg(a)||Message.isAddMsg(a)){var c=!0;b=WMSUI.atMentions.format(a,c)}else typeof a=="string"&&a.indexOf("<hr>")!==-1&&(b=a.replace("<hr>","---"));return b},Message.getDnameFromMetaDataFormat=function(a){var b=$WC.Util.getContactName(a.split(":")[1]);return a.split(":")[1]===WebMessanger.zuid?b=WebMessanger.getNickName():b||(b=a.split(":")[3]),b=$WC.Util.escapeHTML(b)},Message.constructMessageFragment=function(){function a(a,b,c,d,e){var f="wms-msgsender",g="",h="",i="",j=null,k='<div class="{{classname}}" data-zcmsgsource={{msgsource}} data-senderzuid="{{senderzuid}}"><img class="wms_cw_userphoto" data-zcprofileid="{{senderzuid}}" src="{{userimage}}"><span class="wms_profileinfo_text" data-zcmsgsource={{msgsource}} data-zcprofileid="{{senderzuid}}">{{sendername}}</span></div>';if(!a||e)k='<div class="{{classname}}" data-zcmsgsource={{msgsource}} data-senderzuid="{{senderzuid}}"><img class="wms_cw_userphoto" src="{{userimage}}"><span class="wms_profileinfo_text" data-zcmsgsource={{msgsource}}>{{sendername}}</span></div>';d&&d.message_source&&d.message_source.type&&(i=new $WC.IntegrationsData(d.message_source));if(d&&d.usermessagedetails&&d.usermessagedetails.custom_sender_name)g=d.usermessagedetails.custom_sender_name,h=d.usermessagedetails.custom_sender_imageurl?d.usermessagedetails.custom_sender_imageurl:"https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/customimg-default.png",a=i&&i.getID()||a,d.usermessagedetails.custom_sender_imageid?h=_WMSCHATURL+"v1/images/"+d.usermessagedetails.custom_sender_imageid:i&&(d.usermessagedetails.custom_sender_id||d.message_source.photo_id)&&(h=i.getImageURL());else if(i&&d.isTempResponse)g=d.message_source.name,h=i.getImageURL(),a=i.getID(),j=i.getModule(),$WC.Util.isLocalUser(a)&&(f+=" wms-msgsenderhl");else{if(!a||c===a)return"";$WC.Util.isLocalUser(a)?(g=$WC.I18N("chat.you"),f+=" wms-msgsenderhl"):g=$WC.Util.getContactName(a,b)}return $WC.template.replace(k,{sendername:$WC.Util.unescapeHTML(g),senderzuid:a,classname:f,msgsource:j,userimage:h||WmsContacts.getUserPhoto(a)})}function b(a,b,c){return Message.isBotMsg(a)&&Message.isCustomMsg(a)?(Message.metaInfo[b]=a.meta,'<a data-custommsg="true" >'+Message.formatLinks(a.msg)+"</a>"):(a=Message.isMentionMsg(a)||Message.isAddMsg(a)?WMSUI.atMentions.format(a):a,c||(a=$WC.Markdown.apply(a)),a=Message.getDisplayContent(a),a)}function e(a,b){var c="",d="",e="",f="",g="",h="",i={},j="wms-imgmsgcontainer",k=240,l=130,m,n,o,p,q=a.url||a.fileurl,r=a.content||a.contenttype;if(a.meta&&a.meta.linkdetails&&a.meta.linkdetails.mimetype.indexOf("image/")!==-1)e=a.meta.linkdetails.url,a=a.msg,j="wms-imgmetamsgcontainer",n=k,m=l;else{a.meta&&a.meta.linkdetails&&a.meta.linkdetails.mimetype.indexOf("text/")!==-1?(d='<div class="wms-iconseperator"><div class="wms-urlinfoouterdiv"><div class="wms-urlinfo"><a href="{{urllink}}" target="_blank" class="wms-urlinfolink">{{urltitlelink}}</a></div><div class="wms-urlinfo"><a href="{{urlauthorurl}}" target="_blank" class="wms-urlinfoauthor">{{urlauthor}}</a></div><div class="wms-urlinfo"><a href="{{urlproviderurl}}" target="_blank" class="wms-urlsiteinfo">{{urlprovider}}</a></div></div>',e=a.meta.linkdetails.imgurl,i=a.meta.linkdetails,a=a.msg,f=i.imgurl,g=i.providerurl,j="wms-imgmetamsgcontainer"):(e=a.constructeddownloadurl||a.url,h=a["img-data"]?"data:image/jpeg;base64,"+a["img-data"]:"",d='<div class="wms-msg wms-imgwrapper">');if(a.dim){var s=a.dim.height/a.dim.width;n=a.dim.width,a.dim.width>=k&&(n=k),m=Math.ceil(n*s),n<k&&(n=k),m<l&&(m=l),p=a.dim.width,o=a.dim.height}else n=229,m=l,o=l,p=k,e=a.constructeddownloadurl||a.url}var t="";if(a.comment){t=$WC.Util.safeHTML($WC.Util.unescapeHTML(a.comment));var u=$WC.Markdown.apply(Message.trim(Smiley.replace(t)));c=$WC.template.replace('<div class="wms-msgcomment">{{comment}}</div>',{comment:u},"InSecureHTML"),j+=" wms-imgmsgcontainer-withcomment"}var v='src="{{originalsrc}}"';!WMSUI.isLoadedImg(e)&&h&&(v='class="wms-imgbluroverlay" originalsrc="{{originalsrc}}" src="{{src}}"');var w=d+'<div class="{{classname}}" data-previewable="true">'+"<img "+v+'src="{{originalsrc}}" data-fname="{{filename}}" data-fsize="{{size}}" data-fsender="{{sender}}" data-fdate="{{date}}" data-ftime="{{time}}" data-fheight="{{actualheight}}" data-fwidth="{{actualwidth}}" data-fcomment="{{comment}}" data-fcontent="{{content}}" data-furl="{{url}}" data-dname="{{dname}}" data-previewable="true" data-filefrwrd={{filefrwrdsupport}} data-isv1={{isv1}}>'+"</div>"+c+"</div>";return $WC.template.replace(w,{originalsrc:e,src:h,classname:j,size:a.size||"",sender:a.sender,date:$WC.DateUtil.formatDate(a.time),time:$WC.DateUtil.formatTime(a.time),actualheight:o,actualwidth:p,height:m,width:n,filename:a.fName,comment:t,content:r,url:q,dname:b,linkurl:f,urllink:i.url,urltitlelink:i.title,urlauthorurl:i.authorurl,urlproviderurl:g,urlauthor:i.authorname,urlprovider:i.providername,filefrwrdsupport:a.isFileForwardSupported?!0:!1,isv1:a.isv1?!0:!1,$download:"chat.download",$forward:"chat.forward",$preview:"chat.preview"})}function f(a,b){if(a&&a!=="-1")if(!b||b&&$WC.DateUtil.formatDate(b)!==$WC.DateUtil.formatDate(a))return $WC.template.replace("<div class='wms-msgdate' data-msgtime={{msgtime}}><span>{{date}}</span></div>",{date:$WC.DateUtil.formatDateWithWords(a),msgtime:a});return""}function g(a){var b="",c="";a.commentmsg="",a.previewurl=Message.getDownloadUrl(a)+"&x-cli-msg=%7Bmode%3Aview%7D",WebMessanger.isUDSDownloadEnabled()||(a.previewurl=Message.getDownloadUrl(a)+"/view");if(a.comment&&a.comment.trim()){c=$WC.Util.safeHTML($WC.Util.unescapeHTML(a.comment));var d=$WC.Markdown.apply(Message.trim(Smiley.replace(c))).trim();b="<div class='wms-msgcomment'>{{comment}}</div>",b=$WC.template.replace(b,{comment:d},"InSecureHTML"),a.commentmsg=c}var e="";if(a.thumb){var f=a.constructeddownloadurl+Message.getThumbnailImageUrl(a.constructeddownloadurl);if(WMSUI.isLoadedImg(f))a.thumbnailurl=f;else{var g=new Image;g.src=f,g.onload=function(){var b=document.querySelector('[data-msgid="'+a.msgid+'"');if(b){var c=b.querySelector("[data-filethumbnail=true]").firstElementChild;f=a.constructeddownloadurl+Message.getThumbnailImageUrl(a.constructeddownloadurl),c.src=f,WMSUI.isLoadedImg[f]=!0}},a.thumbnailurl="data:image/jpeg;base64,"+a["img-data"]}}return $WC.UrlPreview.constructFileFragment(a)+b}function h(a,b){var c='<div class="wms-msginfo" data-infotype="{{infotype}}" title="{{time}}">{{msg}}</div>';return $WC.template.replace(c,{msg:$WC.MsgUtil.getInfoMsgString(a),time:$WC.DateUtil.formatDTTime(b),infotype:a.type?a.type:"msginfo",zuid:a.opruser?a.opruser.zuid:""},"InSecureHTML")}function i(a,b,c,d){var e=a?' data-prevtime="'+a+'"':" ";return e+=b?' data-nexttime="'+b+'"':" ",e+=c?' data-mentionmsgid="'+c+'"':" ",e+=d?' data-latestchunk="'+d+'"':" ",'<div class="wms-msgfrag wms-transerror" data-transerror="true"'+e+">"+$WC.I18N("transcript.error")+' <span class="wms-transretry" data-retry="true">'+$WC.I18N("transcript.retry")+"</span></div>"}function j(a){var b="",c="";if(a.comment){c=$WC.Markdown.apply($WC.Util.safeHTML($WC.Util.unescapeHTML(a.comment)));var d=Smiley.replace(c);b="<div class='wms-msgcomment'>{{comment}}</div>",b=$WC.template.replace(b,{comment:d},"InSecureHTML")}var e='<div class="wms-audiofilecontainer"><div data-media="true" id="wms-audioplayer" class="wms-audioplayerdiv" data-fsrc="{{filesrc}}" data-fname="{{filename}}" data-fcontent="{{type}}" data-furl="{{url}}" ><div class="wms-audioplayer wms-valign-mid-block" id="wms-mediaplaypause" data-attr="play"><div id="wms-audioplay" data-operation="play" class="wms-audioplay wms-hvalign"></div><div id="wms-audiopause" data-operation="pause" class="wms-audiopause wms-hvalign"></div></div><div class="wms-audioinfo wms-truncate-ellipsis wms-valign-mid-block"><a href="{{filesrc}}" title="{{filename}}">{{filename}}</a><div><div id="wms-audioremtime" data-operation="remtime"></div><a href="{{filesrc}}" download><span id="wms-audioplayerdwnld" class="wms-audioplayerdwnld" data-operation="mediadwnld" title="{{filesize}}"/></span></a>';a.isFileForwardSupported&&(e+='<span class="wms-audiofilefrwrd" data-fsrc="{{filesrc}}" data-fcontent="{{type}}" data-furl="{{url}}" data-fname="{{filename}}" data-fcomment="{{comment}}" data-filefrwrd="true" title="'+$WC.I18N("chat.forward")+'"></span>'),e+="</div></div></div></div></div>"+b;var f=a.content||a.contenttype,g=a.url||a.fileurl,h=a.meta&&a.meta.linkdetails?a.meta.linkdetails.url:a.constructeddownloadurl?a.constructeddownloadurl:_WMSCHATURL+"download.sas?mime="+f+"&url="+g+"&fName="+a.fName;return $WC.template.replace(e,{filesrc:h,filename:a.fName||h,filesize:a.size||"",duration:"",url:g,type:f,comment:c})}function k(a){var b="",c="",d="wms-videoplayer wms-videoplayarea";if(a.comment){c=$WC.Util.safeHTML($WC.Util.unescapeHTML(a.comment));var e=$WC.Markdown.apply(Smiley.replace(c));b="<div class='wms-msgcomment'>{{comment}}</div>",d+=" wms-videoplayer-withcomment",b=$WC.template.replace(b,{comment:e},"InSecureHTML")}var f=a.content||a.contenttype,g=a.url||a.fileurl,h=a.meta&&a.meta.linkdetails?a.meta.linkdetails.url:a.constructeddownloadurl?a.constructeddownloadurl:_WMSCHATURL+"download.sas?mime="+f+"&url="+g+"&fName="+a.fName,i={hideforwardicon:a.isFileForwardSupported?!1:!0},j=(new $WC.VideoPlayer).createInitialState(h,i),k='<div id="wms-videoplayer" data-media="true" class="{{classname}}" data-fcomment="{{comment}}" data-fsrc="{{filesrc}}" data-fname="{{filename}}"  data-fcontent="{{type}}" data-furl="{{url}}" data-filefrwrd="{{filefrwrd}}">'+j+"</div>"+b;return $WC.template.replace(k,{filesrc:h,filename:a.fName||h,filesize:a.size||"",duration:"",classname:d,url:g,type:f,comment:c,filefrwrd:a.isFileForwardSupported?!0:!1})}function l(a){var b="<div class='wms-filemsgcontainer wms-locmsgimg'><div class='wms-location-details'><a href='"+window.location.protocol+"//maps.google.com/?q={{latitude}},{{longitude}}' target='_blank'>{{locname}}</a><div id='wms-locationinfo' class='wms-locationinfo'><span title='{{loc}}' class='wms-truncate-ellipsis wms-filetype'>{{loc}}</span></div></div></div>";return $WC.template.replace(b,{latitude:a.lat,longitude:a.lng,locname:a.name,loc:a.loc||""})}function m(a){var b="<div class='wms-filemsgcontainer wms-contactmsgimg'><span>{{contactname}}<div id='wms-contactinfo'><span class='wms-truncate-ellipsis wms-filetype'>{{contactno}}</span></div></div>",c="";return a.extras&&(c=a.extras[0].value),$WC.template.replace(b,{contactname:a.name,contactno:c})}function n(a){var b="<div class='wms-evntmsgcontainer'><div class='wms-evntmsgdiv'><div class='wms-evntmsgmon'>{{eventmonth}}</div><div class='wms-evntmsgdate'>{{eventdate}}<div class='wms-evntmsgtime'>&#64;{{eventstarttime}}</div></div></div><div class='wms-evntmsginfo'><span class='wms-evntmsgname'>{{eventname}}</span><div class='wms-evntmsgduration'>{{eventtime}}</div></div></div>",c=$WC.DateUtil.formatDTTime(a.startdate)+" "+$WC.I18N("chat.event.to")+" "+$WC.DateUtil.formatDTTime(a.enddate),d=c.split(" "),e=d[1],f=d[0]+" "+$WC.I18N("chat.event.th"),g=d[3]+d[4];return $WC.template.replace(b,{eventmonth:e,eventdate:f,eventstarttime:g,eventname:a.name,eventtime:c})}function o(a,b){if(a&&a.meta){var c;if(a.meta.revision===1||a.meta.revision===2)a.raw=!0;a.meta.usermessagedetails||(a.meta.usermessagedetails={}),a.meta.usermessagedetails.themeid=a.meta.usermessagedetails.themeid||1;var d=$WC.CMsgUtil.convertMsgObj(a);return c=$WC.CustomMsgUI.getCustomMessageContent(d),c}}function q(a,c){var d={};typeof a.msg=="object"&&(a=a.msg);if(typeof a=="string")d.msg=a;else for(var e in a)d[e]=a[e];d.editedtime=a.time,d.time=a.origin_time,d.mtype=a.origin_mtype;var f=Message.getMessageType(d);if(f===Message.types.TEXTMSG||Message.types.VIDEOLINK||f===Message.types.AUDIOLINK||f===Message.types.IMGLINK)return $WC.Matcher.checkWithFlag("linkRegExp",a.msg,"gi")&&a.meta&&a.meta.linkdetails?(c||(a.msg=$WC.Markdown.apply($WC.Util.safeHTML($WC.Util.unescapeHTML(a.msg)))),r(a,f)):(c||(d.msg=$WC.Markdown.apply($WC.Util.safeHTML($WC.Util.unescapeHTML(d.msg)))),'<div class="wms-msg wms-txtmsg">'+b(d.meta&&d.meta.mentions?$WC.Util.formatMentions(d):d.msg)+"</div>");if(f===Message.types.HRMSG)return'<div class="wms-hrmsg">'+d.msg+"</div>";if(f===Message.types.REPLYMSG)return'<div class="wms-msg">'+p(d)+"</div>"}function r(a,b){var c={dname:a.dname,sender:a.sender,date:$WC.DateUtil.formatDate(a.time),time:$WC.DateUtil.formatTime(a.time)},d=$WC.Util.getUnfurlableLink(a.msg),e=a.msg;a.meta.mentions&&(e=$WC.Util.formatMentions(a)),e=e.replace(d[0],'<a href="'+d[0]+'" rel="noopener" target="_blank">'+d[0]+"</a>");var f='<div class="wms-msgcomment"  data-urlpreviewcomment="true">'+Smiley.replace(e).trim()+"</div>",g=!1;a.meta.linkdetails.linktype==="rich"&&(a.meta.linkdetails.html||a.meta.linkdetails.iframe_url)&&(g=!0);if(b===Message.types.VIDEOLINK)return'<div class="wms-msg">'+$WC.UrlPreview.constructVideoLinkFragment(a)+f+"</div>";if(b===Message.types.AUDIOLINK)return'<div class="wms-msg">'+$WC.UrlPreview.constructAudioLinkFragment(a)+f+"</div>";if(b===Message.types.IMGLINK)return a.meta.linkdetails.redirected_url&&(a.meta.linkdetails.url=a.meta.linkdetails.redirected_url),'<div class="wms-msg">'+$WC.UrlPreview.constructImageLinkFragment(a)+f+"</div>";var h=a.meta.linkdetails;return h.redirected_url&&(h.url=h.redirected_url),h.redirected_thumbnail_url&&(h.thumbnailurl=h.redirected_thumbnail_url),'<div class="wms-msg wms-urlpreviewmsg">'+$WC.UrlPreview.populate(h,null,c,!1,g)+f+"</div>"}var c;Message.constructReactionsFragment=c=function(a,b){var c=Object.keys(a);b=b||c.sort(function(b,c){return a[c].length-a[b].length});var e=b.map(function(b){return d(a,b)}).join("");return e+='<span class="wms_reaction_container wms_reaction_add" title="'+$WC.I18N("message.actions.addreactions")+'" data-addreaction=true></span>','<div class="wms_reaction_frag">'+e+"</div>"};var d;Message.constructReactionFragment=d=function(a,b){var c=!1,d=a[b].map(function(a){a=a.split(":");var b=a[1];return c===!1&&(c=$WC.Util.isLocalUser(b)),$WC.Util.isLocalUser(b)?$WC.I18N("chat.you"):$WC.Util.getContactName(b,a[2],!0)}).reverse().join(", "),e=Message.reactions.getSmileyName(b)||b,f='<span class="wms_reaction_container" title="{{title}}" {{is_reacted_by_me}} data-reaction="{{code}}">{{reaction}}<span>{{count}}</span></span>';return $WC.template.replace(f,{reaction:Message.reactions.replace(b,!0),count:a[b].length,is_reacted_by_me:c?"data-reactedbyme=true":"",title:$WC.Util.safeHTML($WC.I18N("reactions.title",[d,e])),code:$WC.Util.safeHTML(b)},"InSecureHTML")};var p;return Message.constructReplyMessageFragment=p=function(a,c,d){function e(a,b){var c,d,e,f=Message.getMessageType(a);if(f===Message.types.IMGATT||f===Message.types.FILEATT)b?(c=a,d=c.contenttype,e=c.fileurl):(c=a.msg,d=c.content,e=c.url),c.constructeddownloadurl=Message.getDownloadUrl(c),f===Message.types.IMGATT&&c.thumb&&(c.constructeddownloadurl+=Message.getThumbnailImageUrl(c.constructeddownloadurl)),c.isFileForwardSupported=!0}a.meta&&(a.meta.message_source||a.meta.btnindexvsdetails)&&(a.msg=o(a)),a.msg=a.meta&&a.meta.mentions?$WC.Util.formatMentions(a):a.msg;var f=a.meta.opr_replydetails;f.msg=f.meta&&f.meta.mentions?$WC.Util.formatMentions(f):f.msg;var g=f.msg||f;if(typeof g=="object")for(var h in g.addinfo)g[h]=g.addinfo[h];var i=$WC.Util.getContactName(f.sender)||f.sendername;delete a.meta,e(a),e(f,!0);var j;if(Message.getMessageType(g)===Message.types.IMGATT)j='<div class="wms-replyimg"><img src="{{replyimgurl}}"/><span class="imgtext wms-truncate-ellipsis">{{fname}}</span></div>';else if(Message.getMessageType(g)===Message.types.FILEATT)j='<span class="imgtext wms-truncate-ellipsis">{{fname}}</span>';else if(Message.getMessageType(g)===Message.types.AUDIOATT)j='<span class="imgtext wms-truncate-ellipsis">{{fname}}</span>';else if(Message.getMessageType(g)===Message.types.VIDEOATT)j='<span class="imgtext wms-truncate-ellipsis">{{fname}}</span>';else if(Message.getMessageType(g)===Message.types.LOCATT)j="<div class='wms-filemsgcontainer wms-locmsgimg'><div><span>{{locname}}</span></div></div>";else if(Message.getMessageType(g)===Message.types.CONTACTATT)j="<div class='wms-filemsgcontainer wms-contactmsgimg'><span>{{contactname}}</span></div>";else if(Message.getMessageType(g)===Message.types.EVENTATT)j='<div class="wms-evntmsgcontainer"><span class="wms_calicon"></span><span>{{eventname}}</span></div>';else if(Message.getMessageType(g)===Message.types.CUSTOMMSG||Message.getMessageType(g)===Message.types.BOTMSG||Message.getMessageType(g)===Message.types.VIDEOLINK||Message.getMessageType(g)===Message.types.AUDIOLINK||Message.getMessageType(g)===Message.types.IMGLINK)j='<div class="wms-replytext">{{desc}}</div>';else try{j='<div class="wms-replytext">'+b(g)+"</div>"}catch(k){j="=========FORMAT TO BE SUPPORTED========"}var l="";if(!c){var m=a.sender+"_"+a.time,n=a.time;a.mtype===""+CT_EDITED_MSG&&(m=a.sender+"_"+a.origin_time,n=a.origin_time),l=Message.constructMessageFragment(a.sender,a.dname,n,a.msg,Message.getMessageType(a),a.sender,n,m,!0,null,null,null,a.msguid)}var p="";c&&(p='<div class="wms_cw_replyclose"></div>');var q="",r="",s="";d?(s='<div class="wms-replymsg"  data-replymsgtime="{{replymsgtime}}" data-msguid="{{msguid}}">',q='<span class="wms-editmsgicon"></span><span class="wms-replymsgtitle" title="'+$WC.I18N("message.edit.title")+'">'+$WC.I18N("message.edit.title")+"</span>",r='<div class="wms_settings_chckbx"><span data-type="custom" class="wms_settings_customcheckbox"></span><input id="wms_notifyeditmsg" data-setting="notifyedit" type="checkbox" class="wms_settings_checkbox"><label id="wms_notifyeditlabel" class="wms_settings_label" for="wms_notifyeditmsg">'+$WC.I18N("message.edit.notify")+"</label>"+"</div>"):(s='<div class="wms-replymsg"  data-replymsgtime="{{replymsgtime}}" data-replysenderzuid="{{senderzuid}}">',q='<span class="wms-replymsgicon"></span><span class="wms-replymsgsender wms-truncate-ellipsis" title="{{sendername}}">{{sendername}}</span><span class="wms-replymsgtime wms-truncate-ellipsis" title="{{dateinwords}} {{formattedtime}}">{{dateinwords}} {{formattedtime}}</span>');var t='<div class="wms-replymsgwrapper">'+s+'<div class="wms-replymsgheader">'+q+p+"</div>"+"<div>"+j+r+"</div>"+"</div>"+l+"</div>";return $WC.template.replace(t,{replymsgtime:f.msgtime,sendername:i,senderzuid:f.sender,dateinwords:$WC.DateUtil.formatDateWithWords(f.msgtime),formattedtime:$WC.DateUtil.formatTime(f.msgtime),replyimgurl:g.constructeddownloadurl,locname:g.name,contactname:g.name,eventname:g.name,fname:g.fName,desc:g.desc,msguid:f.msguid})},function(d,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G){var H,I,J,K="",L="",M=B?'data-msgackid="'+B+'"':"",N=C?'data-notack="true"':"";D=D?'data-msguid="'+D+'"':"";var O="",P="",Q='<span data-type="'+v+'" data-msgsel="false" class="wms_fwdcheckbox wms-valign-mid-block wms_checkbox_hidden"></span>';if(v===Message.types.LOADMORE)return'<div style="display:none" data-loadmore="true"></div>';if(v===Message.types.LOADMOREBUTTON)return'<div style="display:block" class="wms-loadmorebutton" data-loadmorebutton="true" data-prevtime="'+x+'"><a>'+$WC.I18N("chat.loadinbetween")+"</a></div>";if(v===Message.types.TRANSERR)return i(u.prevtime,u.nexttime,u.mentionmsgid,u.latestchunk);if(z)H="",I="",J="";else{H=f(t,x),H&&(w="");if(u.meta&&u.meta.shareIntegrationResponse)u.meta.isTempResponse=!0,P='<div class="wms-cmdvisiblediv"><span class="wms-cmdvisible"></span>'+$WC.I18N("chat.command.visibility")+"</div>";else if(u.isTempResponse||u.meta&&u.meta.isTempResponse)u.meta.isTempResponse=!0,P='<div class="wms-cmdvisiblediv"><span class="wms-cmdvisible"></span>'+$WC.I18N("chat.command.visibility")+"</div><div data-chid="+u.chid+" data-msgid="+u.time+' data-purpose="shareresponseclick_onmsg" class="wms_cmdvisible_share">'+$WC.I18N("chat.command.share")+"</div>";I=a(d,s,w,u.meta,G);if(v!==Message.types.INFOMSG){v===Message.types.DELETEDMSG&&(t=u.origin_time);if(!A||$WC.DateUtil.formatTime(t)!==$WC.DateUtil.formatTime(A))K=Message.constructTimeFragment(t);u.mtype===""+CT_EDITED_MSG&&(K=Message.constructTimeFragment(u.origin_time,!0))}J="wms-msgfrag",$WC.Util.isLocalUser(d)&&(!u.meta||!u.meta.isTempResponse)&&(!Message.isMsgFromBot(u)||u.meta&&u.meta.message_source&&u.meta.message_source.forwarded)&&(J+=" wms-msgsenderhl")}var R="";if(v===Message.types.IMGATT)u.time=t,u.sender=d,R+=e(u,s),u.meta&&u.meta.linkdetails&&(I="",H="",J="",t="");else if(v===Message.types.FILEATT)u.dname=s,u.time=t,u.sender=d,u.msgid=y,R+='<div class="wms-msg">'+g(u)+"</div>";else if(v===Message.types.INFOMSG)u.opruser=u.opruser||{zuid:d,nname:s},typeof u.msg=="object"&&!u.mode&&(u=u.msg),R+=h(u,t),I="",J="wms-msginfofrag",O=u.mode||(u.msg&&u.msg.mode)==="MESSAGE EDITED"?'data-editinfo="true"':"";else if(v===Message.types.AUDIOATT)R+='<div class="wms-msg wms-audioattmsg">'+j(u)+"</div>",u.meta&&u.meta.linkdetails&&(I="",H="",J="");else if(v===Message.types.VIDEOATT)u.sender=d,R+='<div class="wms-msg">'+k(u)+"</div>",u.meta&&u.meta.linkdetails&&(I="",H="",J="");else if(v===Message.types.LOCATT)R+="<div class='wms-msg'>"+l(u)+"</div>";else if(v===Message.types.CONTACTATT)R+="<div class='wms-msg'>"+m(u)+"</div>";else if(v===Message.types.EVENTATT)R+="<div class='wms-msg'>"+n(u)+"</div>";else if(v===Message.types.CUSTOMMSG){var S=Message.isTempMsg(u)?"wms_tempcustmmsg":"wms_custmmsg";R+='<div class="wms-msg '+S+'">'+o(u,y)+P+"</div>"}else if(v===Message.types.BOTMSG)if(u.meta){var T=$WC.CMsgUtil.convertMsgObj(u);$WC.CustomMsg.storeMsgObj(T),R+="<div class='wms-msg'>"+o(u,y)+P+"</div>"}else u.msg=$WC.Markdown.apply($WC.Util.safeHTML($WC.Util.unescapeHTML(u.msg))),R+="<div class='wms-msg wms-txtmsg'>"+b(u.msg,y)+P+"</div>";else if(v===Message.types.VIDEOLINK||v===Message.types.AUDIOLINK||v===Message.types.IMGLINK)R+=r(u,v);else if(v===Message.types.REPLYMSG)u.sentfromcomposer||(u.msg=typeof u.msg=="string"?$WC.Markdown.apply($WC.Util.safeHTML($WC.Util.unescapeHTML(u.msg))):u.msg,u.meta.opr_replydetails.msg=typeof u.meta.opr_replydetails.msg=="string"?$WC.Markdown.apply($WC.Util.safeHTML($WC.Util.unescapeHTML(u.meta.opr_replydetails.msg))):u.meta.opr_replydetails.msg),R+='<div class="wms-msg">'+p(u)+"</div>";else if(v===Message.types.TEMPMSG){if(u.meta){var U=$WC.CMsgUtil.convertMsgObj(u);$WC.CustomMsg.storeMsgObj(U)}R+='<div class="wms-msg">'+b(u.msg,y)+P+"</div>"}else if(v===Message.types.HRMSG)J+=" wms-hrmsg",R=$WC.Markdown.apply(u.msg||u),K="";else if(v===Message.types.DELETEDMSG){if(u.isNextMsgDeleted)return Message.incrementDeletedMsgCount(u.time),$WC.template.replace("{{datefragment}}{{senderfragment}}",{datefragment:H,senderfragment:I},"InSecureHTML");R+=Message.getDeletedMsgInfo(u.time)}else if(v===Message.types.EDITEDMSG)R+=q(u,z);else{!z&&!u.sentfromcomposer&&(typeof u=="object"?u.msg=$WC.Util.safeHTML($WC.Util.unescapeHTML(u.msg)):u=$WC.Util.safeHTML($WC.Util.unescapeHTML(u)));if($WC.Matcher.checkWithFlag("linkRegExp",u.msg,"gi")&&u.meta&&u.meta.linkdetails)R+=r(u);else{var V=u.ignoremarkdown;if(u.meta){if(!u.meta.mentions){var U=$WC.CMsgUtil.convertMsgObj(u);$WC.CustomMsg.storeMsgObj(U),u=u.msg}}else u.msg&&(u=u.msg);R+="<div class='wms-msg wms-txtmsg'>",R+=b(u,y,V)+P+"</div>"}}return E&&(L=c(E)),z&&(Q=""),$WC.template.replace('{{datefragment}}{{senderfragment}}<div class="{{classname}}" data-msgid={{msgid}} {{editmsginfo}} {{msgackattribute}} {{msguid}} data-type="{{msgtype}}" data-sendername="{{sendername}}" data-msgtime={{msgtime}} {{notackattr}}>{{messagefragment}}{{reactionsfragment}}{{forwardsel_fragment}}</div>{{timefragment}}',{classname:J,datefragment:H,msgtime:t,senderfragment:I,messagefragment:R,timefragment:K,msgid:y,msgackattribute:M,msgtype:v,sendername:$WC.Util.safeHTML($WC.Util.unescapeHTML(s)),notackattr:N,msguid:D,editmsginfo:O,reactionsfragment:L,forwardsel_fragment:Q},"InSecureHTML")}}(),Message.constructAndInsertChatContent=function(a,b,c,d,e,f){function h(){return a.find(function(a){if(a.msgid==k)return!0})}var g=b.querySelectorAll("[data-notack]:not([data-msgfailure])");for(var i=0;i<g.length;i++){var j=g[i],k=j.getAttribute("data-msgtime"),l=h();l&&(j.setAttribute("data-msgtime",l.time),j.setAttribute("data-msgid",l.sender+"_"+l.time),j.removeAttribute("data-notack"),a.splice(a.indexOf(l),1))}var m=b.querySelector('[data-msgtime="'+(e-1)+'"]'),n=b.querySelector('[data-msgtime="'+f+'"]');if(m&&n){a[a.length-1].time==f&&(n=n.nextSibling);function o(a){for(var b=0;b<a.length;b++)a[b].previousSibling.getAttribute("data-senderzuid")&&$WC.Util.removeElement(a[b].previousSibling),a[b].nextSibling.className=="wms-msgtime"&&$WC.Util.removeElement(a[b].nextSibling),$WC.Util.removeElement(a[b])}var p=[],q=m.nextSibling;while(q!=n)q.getAttribute("data-msgid")&&!q.getAttribute("data-msgfailure")&&q.getAttribute("data-type")!="INFOMSG"&&p.push(q),q=q.nextSibling;o(p);for(var r in a){var s=b.querySelector('[data-msgid="'+a[r].sender+"_"+a[r].time+'"]');s&&a.splice(r,1)}a[0].mode=="more"&&a.shift();var t=e-1,u=m.getAttribute("data-msgid"),v=m.getAttribute("data-type")=="INFOMSG"?"":u.substring(0,u.indexOf("_"))}if(!e&&!f){m=b.querySelector("[data-msguid]");if(m){var w=0,x=a.length-1;for(var y=x;y>=0;y--){var r=a[y];r.msguid===m.getAttribute("data-msguid")&&(w=y)}a.splice(w,x)}}var z=!0,A=Message.constructChatContent(a,b,c,v,t,z),B=Message.getScrollHeight(b),C=Message.getScrollTop(b),D=a[a.length-1],E=b.querySelector(".wms-msgdate");if(E){var F=E.getAttribute("data-msgtime"),G=D&&D.time;$WC.DateUtil.isSameDay(F,G)&&$WC.Util.removeElement(E)}var H=b.querySelector(".wms-msgsender");if(H){var I=H.getAttribute("data-senderzuid"),J=D&&Message.getMessageType(D)==="INFOMSG"?"":D&&D.sender;$WC.DateUtil.isSameDay(F,G)&&J===I&&$WC.Util.removeElement(H)}d.insertAdjacentHTML("afterend",A),d===d.parentNode.firstChild&&Message.restoreScrollPosition(b,B,C),d.getAttribute("data-scrollbehaviour")==="bottom"&&!b.closest("[data-scrolldown]")&&Message.scrollDisplay(b)},Message.constructAndAppendChatContent=function(a,b,c,d,e){var f=Message.constructChatContent(a,b,c,d,e);b.insertAdjacentHTML("beforeend",f),b.parentElement.scrollTop===0&&Message.toggleLiveZomoji(b.parentElement)},Message.getMessageType=function(a){if(a.messagetype)return a.messagetype;if(a.mode==="more")return Message.types.LOADMORE;if(a.mode==="morebutton")return Message.types.LOADMOREBUTTON;if(Message.isReplyMsg(a))return Message.types.REPLYMSG;if(a.mtype===""+CT_EDITED_MSG)return Message.types.EDITEDMSG;if(typeof a.msg!="object"&&!a.mod){if(Message.isCustomMsg(a))return Message.types.CUSTOMMSG;if(Message.isBotMsg(a))return Message.types.BOTMSG;if(a.meta!==undefined&&a.meta.linkdetails!==undefined){if(a.meta.linkdetails.mimetype==="text/html")return a.meta.linkdetails.linktype==="video"&&(a.meta.linkdetails.iframe_url||a.meta.linkdetails.html)?Message.types.VIDEOLINK:a.meta.linkdetails.linktype==="audio"&&(a.meta.linkdetails.iframe_url||a.meta.linkdetails.html)?Message.types.AUDIOLINK:a.meta.linkdetails.linktype==="image"?Message.types.IMGLINK:Message.types.TEXTMSG;return a.meta.linkdetails.mimetype&&a.meta.linkdetails.mimetype.indexOf("image/")!==-1?Message.types.IMGLINK:Message.types.TEXTMSG}return Message.isTempMsg(a)?Message.types.TEMPMSG:$WC.Markdown.apply(a.msg)==="<hr>"?Message.types.HRMSG:a.mtype===""+CT_DELETED_MSG?Message.types.DELETEDMSG:Message.types.TEXTMSG}if(a.mtype==="16"||a.mtype==="65")return Message.types.INFOMSG;if(a.mod==="location"||a.mode==="att"&&a.msg.__module&&a.msg.__module==="location")return Message.types.LOCATT;if(a.mod==="contact"||a.mode==="att"&&a.msg.__module&&a.msg.__module==="contact")return Message.types.CONTACTATT;if(a.mod==="event"||a.mode==="att"&&a.msg.__module&&a.msg.__module==="event")return Message.types.EVENTATT;if(a.mod==="att"||a.mode==="att"){var b,c,d,e="";a.addinfo&&a.addinfo.fName?c=a.addinfo.fName:c=a.msg&&a.msg.fName,c&&(d=c.split("."),e=d[d.length-1]),a.addinfo&&a.addinfo.contenttype?b=a.addinfo.contenttype:b=a.msg&&a.msg.content;if(b==="video/quicktime"||b==="video/mov"||b==="application/x-matroska")b="video/mp4";return a.msg&&a.msg.content&&a.msg.content.indexOf("image")!==-1&&a.msg.dim&&a.msg.dim.height&&a.msg.dim.width||b&&b.indexOf("image")!==-1?Message.types.IMGATT:b&&b.indexOf("audio")!==-1&&WmsMediaPlayer.isSupportedAudioFormat(b)?Message.types.AUDIOATT:b&&b.indexOf("video")!==-1&&WmsMediaPlayer.isSupportedVideoFormat(b)?Message.types.VIDEOATT:Message.types.FILEATT}},function(){function d(){a=1,c=[]}var a=1,b="",c=[];Message.incrementDeletedMsgCount=function(b){a===1&&c.push(b),a++},Message.getDeletedMsgInfo=function(e){c.push(e),c.sort();var f,g="",h="",i=a===1?$WC.I18N("chat.info.deletemsg"):$WC.I18N("chat.info.deletemsgs",[a]);return c.length===1||$WC.DateUtil.formatTime(c[0])===$WC.DateUtil.formatTime(c[1])?(g=$WC.DateUtil.formatTime(c[0])+", "+$WC.DateUtil.formatDateWithWords(c[0]),f=$WC.I18N("chat.deletemsg.title",[g])):($WC.DateUtil.formatDateWithWords(c[0])===$WC.DateUtil.formatDateWithWords(c[1])?g=$WC.DateUtil.formatTime(c[0]):g=$WC.DateUtil.formatTime(c[0])+", "+$WC.DateUtil.formatDateWithWords(c[0]),h=$WC.DateUtil.formatTime(c[1])+", "+$WC.DateUtil.formatDateWithWords(c[1]),f=$WC.I18N("chat.deletemsgs.title",[g,h])),b="<div class='wms-msg wms-txtmsg wms-delmsg' title=\""+f+'">'+i+"</div>",d(),b}}(),Message.getDownloadUrl=function(a){var b;return a.isv1local?b=a.url:WebMessanger.isUDSDownloadEnabled()&&a.isv1?b=_DOWNLOADSERVERURL+"/webdownload?x-service=CLIQ&event-id="+(a.url||a.fileurl):b=a.isv1?"/"+_CHATCONT+"/v1/attachments/"+(a.url||a.fileurl):_WMSCHATURL+"download.sas?mime="+(a.content||a.contenttype)+"&url="+(a.url||a.fileurl)+"&fName="+a.fName,b},Message.getThumbnailImageUrl=function(a){return WMSUI.isLoadedImg(a)?"":WebMessanger.isUDSDownloadEnabled()?"&x-cli-msg="+encodeURIComponent("{thumbnail:true}"):"/thumbnail"},Message.constructChatContent=function(a,b,c,d,e,f){var g="",h;if(!d){var i=b.querySelectorAll("[data-senderzuid]"),j=i[i.length-1];d=j&&j.getAttribute("data-senderzuid")}if(!e){var k=b.querySelectorAll("[data-msgtime]"),l=k[k.length-1];e=l&&l.getAttribute("data-msgtime")}for(var m=0;m<a.length;m++){var n=Message.getMessageType(a[m]);a[m].meta&&(a[m].msg.meta=Object.assign({},a[m].meta));var o=typeof a[m].msg=="object"?a[m].msg:a[m],p=a[m].revision===1||a[m].meta&&(a[m].meta.revision===1||a[m].meta.revision===2)?!0:!1;if(a[m].mtype=="63"){Message.deletedMessages.insert(c,a[m].origin_time||a[m].time);if(a[m].info_visiblity==0)continue}var q,r=null,s=WindowHandler.getWinObjById(c);s&&(q=s.ctype,a[m].reactions&&s.updateReactionData(a[m].msguid,a[m].reactions));if(q==undefined||q&&q!="5")n===Message.types.IMGATT||n===Message.types.FILEATT||n===Message.types.AUDIOATT||n===Message.types.VIDEOATT?(a[m].salesiqchat?o.downloadurl=WmsUIImpl.customContactsConfig().getAttachmentUrl(o.url):o.constructeddownloadurl=Message.getDownloadUrl(o),(n===Message.types.IMGATT||n===Message.types.VIDEOATT)&&o.thumb&&(o.constructeddownloadurl+=Message.getThumbnailImageUrl(o.constructeddownloadurl)),o.constructeddownloadurl=a[m].salesiqchat?o.downloadurl:o.constructeddownloadurl,o.isFileForwardSupported=a[m].salesiqchat?!1:!0):n===Message.types.INFOMSG&&(o.chid=c);a[m].sender||(n===Message.types.IMGATT||n===Message.types.FILEATT)&&a[m].msg&&a[m].msg.sender&&(a[m].sender=a[m].msg.sender),!a[m].time&&a[m].msgtime&&(a[m].time=a[m].msgtime);if($WC.DateUtil.formatTime(a[m].time)===$WC.DateUtil.formatTime(e)&&!a[m].isedited&&!a[m].isdeleted&&a[m].mtype!=="65"){var t=b&&b.querySelector('[data-msgid][data-msgtime="'+e+'"]');t&&t.nextSibling&&t.nextSibling.className=="wms-msgtime"&&$WC.Util.removeElement(t.nextSibling)}a[m+1]&&(r=a[m+1].time),a[m+1]&&a[m+1].mtype===""+CT_DELETED_MSG&&a[m].sender===a[m+1].sender&&(a[m].isNextMsgDeleted=!0,r=a[m+1].origin_time),h=a[m].origin_time?a[m].sender+"_"+a[m].origin_time:a[m].sender+"_"+a[m].time;var u=a[m].msgackid,v=a[m].notack;Message.isHidingMsg(a[m])&&Message.setTimeToHideMsg(b,a[m],h);if(n===Message.types.REPLYMSG||n===Message.types.BOTMSG||n===Message.types.CUSTOMMSG||n===Message.types.VIDEOLINK||n===Message.types.AUDIOLINK||n===Message.types.IMGLINK||n===Message.types.TEMPMSG||n===Message.types.DELETEDMSG||n===Message.types.EDITEDMSG)o=a[m];a[m].chid=c;var w=a[m].origin_time||a[m].time||a[m].msg.time;g+=Message.constructMessageFragment(a[m].sender,a[m].dname,w,o,n,d,e,h,null,r,u,v,a[m].msguid,a[m].reactions,p,a[m].salesiqchat),d=n!==Message.types.INFOMSG&&n!==Message.types.BOTMSG&&n!==Message.types.CUSTOMMSG?a[m].sender:"",e=n===Message.types.DELETEDMSG||n===Message.types.EDITEDMSG?a[m].origin_time:a[m].time,f&&a[m].sender&&!$WC.Users.getInfo(a[m].sender)&&a[m].dname&&$WC.Users.storeInfo(a[m].sender,{dname:a[m].dname})}return g},Message.setTimeToHideMsg=function(a,b,c){var d=a.getAttribute("data-chid"),e=WindowHandler.getWinObjById(d);clearTimeout(e.msghidetimer);var f=parseInt(b.meta.config.h);e.msghidetimer=setTimeout(function(){Message.hideMsg(a,c)},f)},Message.hideMsg=function(a,b){var c=a.querySelector('[data-msgid="'+b+'"]').parentNode;c.previousSibling.previousSibling.querySelector(".wms-msgdate")&&$WC.Util.removeElement(c.previousSibling.previousSibling),$WC.Util.removeElement(c.previousSibling),$WC.Util.removeElement(c)},Message.deletedMessages={list_index:[],list:{},insert:function(a,b){this.list_index.length==30&&this.remove(this.list_index[0]),this.list[a]?this.list[a].push(b):this.list[a]=[b],this.list_index.indexOf(a)!=-1&&this.list_index.splice(this.list_index.indexOf(a),1),this.list_index.push(a)},get:function(a){if(this.list[a])return this.list[a]},isAvailable:function(a,b){return this.list[a]&&this.list[a].indexOf(b)!==-1?!0:!1},remove:function(a){this.list[a]&&(delete this.list[a],this.list_index.splice($WC.Util.indexOf(this.list_index,a),1))},removeAll:function(){this.list={},this.list_index=[]}},Message.addEventListenersForTranscript=function(a,b){var c=Message.getScrollableParent(a);Message.glowBubble=function(a,b,c){if(Message.deletedMessages.isAvailable(c,a))return WindowHandler.getWinObjById(c).showErrorMsg($WC.I18N("chat.info.deletemsg")),!0;var d=b.querySelector('.wms-msgfrag[data-msgtime="'+a+'"]');return b.setAttribute("data-glowtime",a),d?($WC.$CUtil.isScrolledIntoView(d,b)?($WC.Util.addClass(d.firstChild,"wms-bubbleglow"),b.removeAttribute("data-glowtime")):$WC.Util.scrollIntoView(d,{behavior:"smooth",block:"center"}),!0):!1},Gator(a).on("mouseover","[data-type]",$WC.Util.debounce(function(){var a=this.closest("[data-chid]"),b=a&&a.getAttribute("data-chid"),c=WindowHandler.getWinObjById(b);if(c&&c.ctype==="4"&&c.salesiqchat)return;if(c&&(c.msgoprnode===null||c.msgoprnode.offsetParent===null)&&this.querySelector("[data-options]")===null&&this.getAttribute("data-type")!=="INFOMSG"&&this.getAttribute("data-type")!=="DELETEDMSG"&&this.getAttribute("data-type")!=="HRMSG"&&this.getAttribute("data-msguid")){var d=this.firstChild;if(this.getAttribute("data-type")==="REPLYMSG"){var e=this.querySelector("[data-type]");e.getAttribute("data-type")==="HRMSG"?d=e:d=e.firstChild}d.insertAdjacentHTML("afterbegin",'<div class="wms-valign-mid-block" data-options="hide"></div>')}},null,50)),Gator(a).on("mouseout","[data-type]",$WC.Util.debounce(function(a){var b=a.relatedTarget;if(b&&!b.closest("[data-type]")&&this.querySelector("[data-msgoperations]")===null){var c=this.querySelector("[data-options]");$WC.Util.removeElement(c)}},null,100)),$WC.Util.addEvent(a,"click",function(b){var c=$WC.Util.getEventTarget(b),d=b.target.closest("#ctrlcomp")||b.target.closest("#wmschshtransmsg"),e=Message.getScrollableParent(d),f=d.getAttribute("data-chid");if(c.getAttribute("data-retry")==="true"||c.parentNode.getAttribute("data-loadmorebutton")==="true"){var g=c.parentNode;Message.loadSpecificTranscript(f,d,g)}else if(c.getAttribute("data-previewable")==="true")c.getAttribute("data-filethumbnail")==="true"?c=c.parentNode.querySelector("[data-attachment]"):c.getAttribute("data-filedesc")==="true"&&(c=c.querySelector("[data-attachment]")),c.tagName==="IMG"||c.getAttribute("data-unfurl")==="true"||c.getAttribute("data-attachment")==="true"?WMSUI.imgPreview.init(d,c):WMSUI.imgPreview.init(d,c.firstChild);else if(c.getAttribute("data-custommsg")==="true"){var h=c.parentNode.getAttribute("data-msgid"),i=c.querySelectorAll("br");for(var j=0;j<i.length;j++)i[j].parentNode.replaceChild(document.createTextNode("\n"),i[j]);Message.formatCustomMsg($WC.Util.getInnerText(c),h)}else if(c.parentNode.getAttribute("data-playable")==="true"){var k=c.parentNode.getAttribute("iframe");c.parentNode.innerHTML=k}else if(c.getAttribute("data-filefrwrd")==="true")c.parentNode.parentNode.getAttribute("id")==="wms-videoplayer"&&(c=c.parentNode.parentNode),WmsFileForwardUI.handlePreview(c);else if(c.parentNode.parentNode.getAttribute("data-media")==="true"){var l=c.parentNode.parentNode,m="";l.parentNode.parentNode.getAttribute("data-sendername")?m=l.parentNode.parentNode.getAttribute("data-sendername"):l.parentNode.parentNode.parentNode.getAttribute("data-sendername")&&(m=l.parentNode.parentNode.parentNode.getAttribute("data-sendername"));if(l.getAttribute("data-fcontent").indexOf("video")!==-1||l.getAttribute("data-fcontent").indexOf("application/x-matroska")!==-1){var n=l.getAttribute("data-fsrc"),o=l.closest("[data-msguid]").getAttribute("data-msguid");n.indexOf("&x-cli-msg=%7Bthumbnail%3Atrue%7D")!==-1?n=n.replace("&x-cli-msg=%7Bthumbnail%3Atrue%7D",""):n.indexOf("/thumbnail")!==-1&&(n=n.replace("/thumbnail","")),$WC.VideoPlayerFactory.create(f,d.parentElement,l,n,l.getAttribute("data-fcontent"),l.getAttribute("data-fname"),m,l.getAttribute("data-fsrc"),$WC.Config.get("zindex"),function(){WmsFileForwardUI.handlePreview(l)},b,o,{hideforwardicon:l.getAttribute("data-filefrwrd")==="false"?!0:!1})}if(l.getAttribute("data-fcontent").includes("audio")){if(d.getAttribute("data-msgdisp")==="true")var p="chatwindow";else d.id==="wmschshtransmsg"&&(p="chathistory");WmsMediaPlayer.init(b,p,l,f)}}else if(c.getAttribute("data-msgfailure")==="true"){var q=WindowHandler.getWinObjById(f);q.clickedfailurenode=c,q.createChatwindowOverlay()}else if(c.getAttribute("data-infocallbtn")){var r=c.getAttribute("data-infocallbtn"),s=c.getAttribute("data-calleezuid"),t=WindowHandler.getWinObjById(f);r==="triggerAudioCall"?WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VOICE,s,WebMessanger.ismediacallnewwindow,t):r==="triggerVideoCall"&&WMSUI.makeMediaCall(WmsAVChat.CALL_TYPE_VIDEO,s,WebMessanger.ismediacallnewwindow,t)}else if(c.getAttribute("data-purpose")==="shareresponseclick_onmsg"){var u={msgid:c.getAttribute("data-msgid")},v={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF(),"Content-Type":"application/json"};$WC.Ajax.postRequestToChat("v1/chats/"+f+"/shareintegrationresponse",u,null,null,null,null,v)}else if(c.closest("[data-replymsgtime]")){var w=c.closest("[data-replymsgtime]"),x=w.getAttribute("data-replymsgtime");if(!Message.glowBubble(x,e,f)){var y=w.getAttribute("data-replysenderzuid"),z=f+"|"+y+"|"+x,A=Message.getMarkerElement(z,x,d);Message.loadSpecificTranscript(f,d,A)}}else if(c.getAttribute("data-options")){WebMessanger.parseReminderTime(c,f),Message.hideOptions();var B="";q=WindowHandler.getWinObjById(f);var C=c.getBoundingClientRect(),D=q.ctrlcomp.getBoundingClientRect();C.x+C.width+158>D.x+D.width&&(B='style="left: auto; right: 38px;" data-align="left"');var E={include_all:!0};typeof WmsUIImpl!="undefined"&&(E=WmsImplHandler.invokeSynchronously(WmsUIImpl.getMessageActions,WebMessanger.zuid,f,q.ctype)||E);if($WC.Util.isEmptyObject(E))return;E=Message.getAllowedActions(c,E,f),q.showMessageActionsUI(c.closest("[data-msgid]"),E,Message.handleMessageActions),c.setAttribute("data-options","show"),WMSUI.addIndocClickcallbackQue("msgoptions",c,function(){Message.hideOptions(c)}),b.stopPropagation()}else if(c.getAttribute("data-operation")==="addmem"){var F=c.getAttribute("data-id").split(",");q=WindowHandler.getWinObjById(f),WMSUI.confirmAndAddMember(f,null,F),q.removePromptMsg()}else if(c.getAttribute("data-operation")==="removepromptmsg")q=WindowHandler.getWinObjById(f),q.removePromptMsg();else if(!c.getAttribute("data-edited")||c.previousSibling.getAttribute("data-type")!=="REPLYMSG"&&c.previousSibling.getAttribute("data-type")!=="EDITEDMSG")if(!c.closest("[data-reaction]")||c.parentNode.getAttribute("class")!=="wms_reaction_container"&&c.parentNode.getAttribute("class")!=="wms_reaction_frag"){if(c.closest("[data-addreaction]")){var o=c.closest("[data-msguid]").getAttribute("data-msguid"),q=WindowHandler.getWinObjById(f);q&&q.showReactionsUI(o)}else if(c.getAttribute("data-msgsel")||WindowHandler.getWinObjById(f)&&WindowHandler.getWinObjById(f).msgoprnode.offsetParent!==null){var q=WindowHandler.getWinObjById(f);if(WindowHandler.getWinObjById(f).msgoprnode.offsetParent!==null){var G=c.closest('[class^="wms-msgfrag"]');c=G&&G.querySelector("[data-msgsel]")}if(c){var K=q.msgdisp.querySelectorAll('[data-msgsel="true"]').length;K==25&&c.getAttribute("data-msgsel")=="false"&&($WC.Util.addClass(q.msgselectcntnode.parentNode,"wms_fwdsel_alert"),$WC.Util.removeClass(q.msgoprnode,"wms-shake"),setTimeout(function(){$WC.Util.addClass(q.msgoprnode,"wms-shake")},300)),c.getAttribute("data-msgsel")==="true"?($WC.Util.removeClass(c,"wms_fwdcheckboxsel"),$WC.Util.addClass(c,"wms_fwdcheckbox"),c.setAttribute("data-msgsel","false"),--K):K<25&&($WC.Util.removeClass(c,"wms_fwdcheckbox"),$WC.Util.addClass(c,"wms_fwdcheckboxsel"),c.setAttribute("data-msgsel","true"),++K),K&&K<26?($WC.$CUtil.setInnerText(q.msgselectcntnode,$WC.I18N("msg.select.fwdcnt",[K])),q.msgoprnode.setAttribute("data-msgoperation",!0),K<25&&($WC.Util.removeClass(q.msgselectcntnode.parentNode,"wms_fwdsel_alert"),$WC.Util.removeClass(q.msgoprnode,"wms-shake"))):($WC.$CUtil.setInnerText(q.msgselectcntnode,$WC.I18N("msg.tap.select")),q.msgoprnode.setAttribute("data-msgoperation",!1))}}else if(c.getAttribute("data-mentiontype")=="6"){var q=WindowHandler.getWinObjById(f),L="";if(q)L=q.title;else{var M=ZMSG_transContent.querySelector('[cid="'+f+'"]');L=$WC.Util.getInnerText(M.querySelector('[id="namedivCID"]'))}WMSUI.showParticipantsList(f,L)}else if(c.getAttribute("data-pinned-msgtime")){var q=WindowHandler.getWinObjById(f);if(q){var N=c.getAttribute("data-pinned-msgtime"),O=c.getAttribute("data-pinned-user");q.highlightPinnedMsg(N,O)}}}else{var H=c.closest("[data-reaction]");H.className!="wms_reaction_container"&&(H=H.parentNode);var I=H.getAttribute("data-reaction"),o=c.closest("[data-msguid]").getAttribute("data-msguid"),J=H.getAttribute("data-reactedbyme");WebMessanger.updateReaction(f,o,I,J);var q=WindowHandler.getWinObjById(f);q&&q.updateMyReactionData(o,I,J)}else{var G=c.previousSibling;G.getAttribute("data-type")==="REPLYMSG"&&(G=G.querySelector("[data-msgid]")),Message.showEditMessageHistory(G,f)}}),Message.getAllowedActions=function(a,b,c){var d=a.closest("[data-type]")&&a.closest("[data-type]").getAttribute("data-type"),e=a.closest("[data-msgid]"),f=d==="TEXTMSG"||d==="EDITEDMSG"||d==="HRMSG"?!0:!1,g=d==="DELETEDMSG"?!1:!0,h=Message.isDeletable(e),i=Message.isEditable(e),j=WebMessanger.is_set_reminder_option_disabled||d==="CUSTOMMSG"||WebMessanger.isCliqUser()===!1?!1:!0,k=WebMessanger.is_copy_message_link_disabled===!1?!0:!1,l=WindowHandler.getWinObjById(c),m=l.pinmsgdetails.info.msgid,n=e.getAttribute("data-msguid")===m?!1:!0,o=!WebMessanger.is_msgpin_option_disabled&&l.pinmsgdetails.action_enabled,p,q,r,s,k;p=q=r=s=!0;var t={};return t.forward=b.forward==="enable"||g?!0:!1,t.reply=b.reply==="enable"||r?!0:!1,t.copy=b.copy==="enable"||f?!0:!1,t.react=b.reaction==="enable"||q?!0:!1,t.fork=b.fork==="enable"||p?!0:!1,t.setreminder=b.reminder==="enable"||j?!0:!1,t.markasunread=b.markasunread==="enable"||s?!0:!1,t.messagelink=b.messagelink==="enable"||k?!0:!1,t.edit=b.edit==="enable"||i?!0:!1,t.delete=b.delete==="enable"||h?!0:!1,t.pinmsg=b.pinmsg==="enable"||o?n:!1,t.unpinmsg=b.pinmsg==="enable"||o?!n:!1,t},Message.isDeletable=function(a){var b=a&&a.getAttribute("data-msgid"),c=b&&b.split("_")[0];return $WC.Util.isLocalUser(c)&&WebMessanger.isMessageDeletionEnabled()&&(new Date).getTime()-a.getAttribute("data-msgtime")<=WebMessanger.getDeleteMessageTimeFrame()?!0:!1},Message.isEditable=function(a){if(a){var b=a.getAttribute("data-msgid"),c=b&&b.split("_")[0],d=a.getAttribute("data-type");if((d==="TEXTMSG"||d==="EDITEDMSG"||d==="REPLYMSG"||d==="HRMSG"||d==="VIDEOLINK"||d==="AUDIOLINK"||d==="IMGLINK")&&$WC.Util.isLocalUser(c)&&WebMessanger.isMessageEditingEnabled()&&(new Date).getTime()-a.getAttribute("data-msgtime")<=WebMessanger.getEditMessageTimeFrame())return!0}return!1},Gator(a).on("click",".zcmsg_bx",function(a){if(document.getElementById("zcwindows")===null){var b=$WC.Util.createElement("div","zcwindows","zcoverlay");b.style.zIndex=WebMessanger.setzindex,document.body.appendChild(b),Gator(b).on("click","[purpose='custom_image_preview']",function(a){$WC.CustomMsgUI.handleCustomBoxClick(this,a)})}if(a.target.closest("[custombuttonclick_onmsg]")===null){document.activeElement.blur();var c=function(){$WC.Util.removeElement(document.getElementById("zcwindows"))};$WC.CustomMsgUI.handleCustomBoxClick(this,a,c)}}),Gator(a).on("dblclick",".wms-msgfrag",function(a){var b=$WC.Util.getEventTarget(a),c=a.target.closest("#ctrlcomp");if(b.closest(".wms-msg")===null&&this.getAttribute("data-type")!=="DELETEDMSG"&&this.getAttribute("data-type")!=="HRMSG"){var d=c.getAttribute("data-chid"),e=WindowHandler.getWinObjById(d);e&&!e.salesiqchat&&e.showReplyPreview(b)}}),$WC.Util.addEvent(c,"scroll",$WC.Util.debounce(function(c){var d=$WC.Util.getEventTarget(c);clearTimeout(this.scrolltimer);if(d){this.scrolltimer=setTimeout(function(){WMSUI.loadImages(d)},_WMSORIGINALIMG_LOAD_TIMEOUT),clearTimeout(this.livezomoji),this.livezomoji=setTimeout(function(){Message.toggleLiveZomoji(d)},100);var e=d.scrollHeight-(d.scrollTop+d.clientHeight);if(d.scrollHeight>d.clientHeight&&d.scrollTop<=2*d.clientHeight&&d.getAttribute("data-glowtime")===null){var f=d.querySelector("[data-loadmore]");f&&f.nextSibling&&(f.nextSibling.getAttribute("data-msgtime")&&f.setAttribute("data-nexttime",f.nextSibling.getAttribute("data-msgtime")),Message.loadSpecificTranscript(b,d,f))}else if(d.closest("[data-scrolldown]")&&e<=d.clientHeight){var g=d.querySelectorAll("[data-loadmore],[data-loadmorebutton]");if(g.length){var f=g[g.length-1];if(f.previousSibling){var h=f.previousSibling.getAttribute("data-msgtime")||f.previousSibling.previousSibling.getAttribute("data-msgtime");h&&f.setAttribute("data-prevtime",h),Message.loadSpecificTranscript(b,d,f)}}}}},this,70)),$WC.Util.addEvent(c,"scroll",$WC.Util.debounce(function(a){if(a.target){var b=Message.getScrollableParent(a.target.closest("#ctrlcomp")||a.target.querySelector("#ctrlcomp")||a.target.closest("#wmschshtransmsg")),c=b.getAttribute("data-glowtime");if(c){var d=b.querySelector('.wms-msgfrag[data-msgtime="'+c+'"]');d&&($WC.Util.addClass(d.firstChild,"wms-bubbleglow"),b.removeAttribute("data-glowtime"))}}},this,70));var d=$WC.Util.getCssAnimEndListener();$WC.Util.addEvent(c,d,function(a){if(a.animationName==="wms-bubbleglow"){var b=$WC.Util.getEventTarget(a);$WC.Util.removeClass(b,"wms-bubbleglow")}})},Message.hideOptions=function(a){var b=a&&a.closest&&a.closest("[data-options]")||document.querySelector('[data-options="show"]');if(!b)return;$WC.Util.removeElement(b)},Message.loadSpecificTranscript=function(a,b,c,d){var e=!1,f,g,h;if(c.getAttribute("data-mentionmsgid")){var i=c.getAttribute("data-mentionmsgid");f=i,e=!0;var j=16;i.split("|").length===2&&(j=30)}else if(c.getAttribute("data-prevtime"))f=c.getAttribute("data-prevtime"),g=+f+1;else if(c.getAttribute("data-nexttime"))f=c.getAttribute("data-nexttime"),h=+f;else if(c.getAttribute("data-latestchunk")){f="latestchunk";var k=!0}if(b.getAttribute("data-unread")==="true")var l=!0;b.getAttribute("data-fromchat")==="true"&&(e=!0);var m=c.nextSibling;while(!h&&m)m.getAttribute("data-msgtime")&&!m.getAttribute("data-notack")&&(h=+m.getAttribute("data-msgtime")),m=m.nextSibling;f=="latestchunk"&&h&&(f=h);var n=c===c.parentNode.lastChild?!0:!1,o=WMSUI.showLoadingIcon(c,"insert");o.setAttribute("data-marker",f),(c.getAttribute("data-scrollbehaviour")||n)&&o.setAttribute("data-scrollbehaviour",c.getAttribute("data-scrollbehaviour")||"bottom");var p=b;b.getAttribute("data-ctrlcomp")==="true"&&(p=b.querySelector("[data-msgdisp]"));var q=WindowHandler.getWinObjById(a);WebMessanger.getTranscript({chid:a,fromtime:g,totime:h,lineslimit:j||50,partial:k,type:"insert",mentionmsgid:i,salesiqchat:q&&q.salesiqchat||!1,unreadchat:l},p,e,d)},Message.formatAndDisplay=function(a){var b=a.chid;a.time||(a.time=Date.now()),WindowHandler.getWinObjById(b).updateMessage(a)},Message.getScrollableParent=function(a){return a.getAttribute("data-msgdisp")?a.parentNode:a},Message.getScrollHeight=function(a){return Message.getScrollableParent(a).scrollHeight},Message.getScrollTop=function(a){return Message.getScrollableParent(a).scrollTop},Message.restoreScrollPosition=function(a,b,c){a.getAttribute("data-msgdisp")&&(a=a.parentNode);var d=b-c,e=a.scrollHeight-d;a.scrollTop=e},Message.scrollDisplay=function(a){a=Message.getScrollableParent(a),a.scrollTop=a.scrollHeight},Message.trim=function(a){return a=a.replace(/<p>|<\/p>/gi,""),a=a.replace(/<a/gi,"<a target='_blank'"),a=a.replace(/\n/gi,"<br>"),a=a.replace(/^\s*$/gi,""),a=a.replace(/^(<br>)*$/gi,""),a=a.replace(/(<br>)*$/gi,""),a=a.replace(/\s*$/gi,""),a},Message.format=function(a){try{var b=a.split(" "),c=[],d=/([a-z0-9]([a-z0-9_\-.+]*)@([a-z0-9_\-.]*)(\.[a-z]{2,3}(\.[a-z]{2}){0,2}))/gi;for(var e=0;e<b.length;e++){var f=Message.formatLinks(b[e]);b[e]===f&&(f=f.replace(d,"<a href='mailto:$1'>$1</a>")),c.push(f)}a=c.join(" ")}catch(g){}return a},Message.formatLinks=function(){function a(a){var b=a;a.indexOf("http://")!==0&&a.indexOf("https://")!==0&&(b="http://"+a);var c=$WC.Util.createElement("a");c.href=b;var d=c.href.toLowerCase();return d===b.toLowerCase()||d===a.toLowerCase()+"/"||d===b.toLowerCase()+"/"?a:decodeURI(c.href)}function b(b,c,d){d=a(d);var e=d;return d.indexOf("http://")!==0&&d.indexOf("https://")!==0&&(e="http://"+d),c+"<a href='"+e+"' target='_blank' rel='noopener'>"+d+"</a>"}return function(a){a=" "+a;var c=/([^(href|src)="'])(((http(s){0,1}:\/\/))([^ <\n]*))/gi,d=/([^(href|src|//)"'=])((www\.)([^ <\n]*))/gi,e=/(^| )(([\w\d-]+\.)+(com|org|net|int|edu|gov|mil|info|biz))(?=( |$))/gi,f=/(^| )(([\w\d-]+\.)+((?!js|cp)[a-z]){2})(?=( |$))/gi;return a=a.replace(c,b),a=a.replace(d,b),a=a.replace(f,b),a=a.replace(e,b),a.trim()}}(),Message.getDisplayContent=function(a){return a=Smiley.replace(a,!1,!0),a=Message.trim(a),a=Message.format(a),a},Message.decodehtml=function(a){var b=a.replace(/&lt;/g,"<");return b=b.replace(/&gt;/g,">"),b},Message.updateReminderInfo=function(a){var b=Object.keys(a)[0],c=WebMessanger.getReminderInfo(b);if(c>0){var d=document.getElementById("wms_reminderdiv");d&&(d.datepicker.updateDate(c),d.timepicker.updateTime(c))}},Message.showEditMessageHistory=function(a,b){if(document.getElementById("wms_msghistdiv")===null){ZMSGUI.createOverlay();var c=$WC.Util.createElement("div","wms_msghistdiv","wms_msghistdiv wms-hvalign");c.style.zIndex=$WC.Config.get("zindex"),document.body.appendChild(c);var d=a.getAttribute("data-msguid");WebMessanger.getEditMsgHistory(b,d),a=a.querySelector('[class~="wms-msg"]')||a.querySelector('[class~="wms-hrmsg"]');var e=document.getElementById("wms_msghistdiv"),f={time:a.getAttribute("data-msgtime"),msg:Message.getTextMsgFromDom(a.childNodes,!0,!0)},g=Message.getEditMessageHTML([f]);g+='<div id="wms_loadingicon" class="wms-cmdloading"><div class="wms-loadingicon"><div class="wms_loading_container"><div></div><div></div><div></div></div></div></div>',e.insertAdjacentHTML("beforeend",'<div id="wms_msghistheader" class="wms_msghistheader">'+$WC.I18N("message.edit.history")+'<span data-operation="close" class="wms_msghistclose"></span>'+"</div>"+'<div id="wms_msghistcont" class="wms_msghistcont" data-msguid="'+d+'">'+g+"</div>"),Gator(e).on("click",'[data-operation="close"]',function(){$WC.Util.removeElement(this.closest('[id="wms_msghistdiv"]')),ZMSGUI.removeOverlay()})}},Message.getEditMessageHTML=function(a){var b="";return a.forEach(function(a){var c=$WC.DateUtil.formatTime(a.time),d=$WC.DateUtil.formatDate(a.time);a.msg=$WC.Util.safeHTML($WC.Util.unescapeHTML(a.msg));var e=a.meta&&a.meta.mentions?a:a.msg;e=Message.isMentionMsg(e)?$WC.Util.formatMentions(e):e,b+='<div id="wms_msghistitem" class="wms_msghistitem"><div id="wms_msghistitem_title" class="wms_msghistitem_title">'+$WC.I18N("message.edit.timeinfo",['<span class="wms_msghistitem_time">'+c+"</span>",d])+"</div>"+'<div class="wms_msghistitemcontent">'+Message.getDisplayContent(e)+"</div>"+"</div>"}),b},Message.updateEditMsgHistory=function(a){var b=document.getElementById("wms_msghistcont"),c=b&&b.getAttribute("data-msguid");a.reverse(),c===a[0].msguid&&(b.innerHTML=Message.getEditMessageHTML(a))},Message.handleMessageLinkClick=function(a){if(WebMessanger.isChatPaused()||silent)return;if(a.target.href&&a.target.href.match&&a.target.href.match($WC.Matcher.regexes.messagelinkregex)){var b=a.target.href,c=b.match($WC.Matcher.regexes.messagelinkregex)[1],d=b.match($WC.Matcher.regexes.messagelinkregex)[2];if(d.indexOf("_")>-1)var e=d.split("_")[0];else if(d.indexOf("%20")>-1)var e=d.split("%20")[0];var f=WindowHandler.getWinObjById(c);if(f){var g=f.ctrlcomp.querySelector("#ctrlcomp");f.isMinimized()&&f.maximize();if(g.querySelector('.wms-msgfrag[data-msgtime="'+e+'"]'))Message.glowBubble(e,f.ctrlcomp,c);else{var h=Message.getMarkerElement(c+"|"+e,e,g);Message.loadSpecificTranscript(c,g,h)}}else Message.mentionMsgInfo[c]=c+"|"+e,WebMessanger.attachSession(c),WmsMainUI.scheduleAutoFocus(c);a.preventDefault(),a.stopPropagation()}},Message.getMarkerElement=function(a,b,c){var d=$WC.Util.createElement("div",null,null,{"data-mentionmsgid":a});d.style="display:none";var e,f=c.querySelectorAll("[data-prevtime]");if(f.length)for(var g=0;g<f.length;g++){var h=f[g].getAttribute("data-prevtime");isNaN(h)?(h=h.split("|")[2],+b>+h&&(e=f[g].parentNode.insertBefore(d,f[g].nextSibling))):+b>+h&&(e=f[g].parentNode.insertBefore(d,f[g].nextSibling))}if(!e){var i=c.querySelector("[data-loadmore],[data-transerror]");c.replaceChild(d,i),e=d}return e},Message.handleMessageActions=function(a,b){var c=a.closest("#ctrlcomp").getAttribute("data-chid"),d=WindowHandler.getWinObjById(c);d.hideMessageActionsUI();if(b==="reply")d&&d.showReplyPreview(a);else if(b==="copy"){var a=a.closest('[data-type="TEXTMSG"]')||a.closest('[data-type="EDITEDMSG"]'),e;a?e=a.firstChild.childNodes:(a=a.closest('[data-type="HRMSG"]'),e=[a.lastChild]);var f=Message.getTextMsgFromDom(e,!0,!0),g='<textarea id="wms_copyhidden" style="display:block;">'+f+"</textarea>";a.insertAdjacentHTML("afterend",g),d=WindowHandler.getWinObjById(c),document.getElementById("wms_copyhidden").select(),document.execCommand("copy"),a.parentElement.removeChild(document.getElementById("wms_copyhidden")),d.showInfoMsg($WC.I18N("message.info.copied"))}else if(b==="delete"){var h=a,i='<div class="wms-dialog-txtcont">'+$WC.I18N("dialog.delete.msg")+"<p>"+$WC.I18N("dialog.delete.info")+"</p></div>",j='<div class="wms-dialog-imgouter"><div class="wms-dialog-imginner"><div class="wms-dialog-deleteimg"></div></div></div>',k={imghtml:j,bodyhtml:i,focusbutton:1,operations:[{name:$WC.I18N("dialog.delete.confirm"),classname:"wms-dialog-rejectbtn",action:function(){WebMessanger.deleteMessage(h,c)}}]};WmsDialog.showModal(k)}else if(b==="edit")d=WindowHandler.getWinObjById(c),d&&d.showReplyPreview(a,!0);else if(b==="setreminder"){var l=a.getAttribute("data-type"),m=a.getAttribute("data-msgtime"),c=c,n="";l==="TEXTMSG"||l==="EDITEDMSG"?n=Message.getTextMsgFromDom(a.childNodes[0].childNodes,!0,!0):(l==="IMGATT"||l==="FILEATT"||l==="AUDIOATT"||l==="VIDEOATT")&&a.querySelector('[class="wms-msgcomment"]')&&(n=$WC.Util.safeHTML($WC.Util.getInnerText(a.querySelector('[class="wms-msgcomment"]')))),ZMSGUI.createOverlay();var o=$WC.Util.createElement("div","wms_reminderdiv","wms_reminderdiv wms-hvalign");o.style.zIndex=$WC.Config.get("zindex"),document.body.appendChild(o);var p=(new Date).getTime(),q=$WC.DateUtil.formatTime(p).split(" "),r=q[0].split(":"),s=document.getElementById("wms_reminderdiv");s.insertAdjacentHTML("beforeend",'<div id="wms_reminderwrapper" class="wms_reminderwrapper"><div id="wms_reminderheader" class="wms_reminderheader">'+$WC.I18N("message.actions.setreminder")+'<span data-operation="close" class="wms_reminderclose"></span>'+"</div>"+'<div class="wms_reminderdivwrapper">'+'<div class="wms_remmsglabel">'+$WC.I18N("Message")+"</div>"+'<textarea id="wms_remmsgarea" class="wms_remmsgarea" data-originalmsg="'+n+'"></textarea>'+"</div>"+'<div class="wms_reminderdivwrapper">'+'<div class="wms_remtimelabel">'+$WC.I18N("message.reminder.time")+"</div>"+'<span class="wms_reminderdate" id="wms_reminderdate"></span>'+'<span class="wms_remindertime" id="wms_remindertime"></span>'+"</div>"+'<div id="wms_remindertype" class="wms_reminderdivwrapper">'+'<div class="wms_remtimelabel">'+$WC.I18N("message.reminder.type")+"</div>"+'<div class="wms_remtypewrapper">'+'<div class="wms_remtypeopt">'+'<label><input type="radio" data-operation="selfreminder" name="wms_remtype" checked=true>'+$WC.I18N("message.reminder.self")+"</label>"+"</div>"+'<label><input type="radio" data-operation="assigneereminder" name="wms_remtype">'+$WC.I18N("message.reminder.others")+"</label>"+"</div>"+"</div>"+'<div class="wms_reminderlistwrapper" id="wms_remassignee">'+'<div id="wms_remmemberslist" class="wms_remmemberslist"></div>'+'<textarea id="wms_remmemberinput" data-operation="populatelist" placeholder="'+$WC.I18N("users.name.search")+'"></textarea>'+"</div>"+"</div>"+"</div>"+'<div class="wms_reminderdivwrapper">'+'<div id="wms_remanimationdiv" class="wms_remassigneediv">'+'<span id="wms_remselmembers"></span>'+"</div>"+'<span data-operation="addreminder" class="wms_addreminder">'+$WC.I18N("message.actions.addreminder")+"</span>"+"</div>");var t=s.querySelector("#wms_remmsgarea"),u=s.querySelector("#wms_reminderdate"),v=s.querySelector("#wms_remindertime"),w=s.querySelector("#wms_remselmembers"),x=s.querySelector('[data-operation="assigneereminder"]'),y=s.querySelector("#wms_remmemberinput"),z=s.querySelector("#wms_remmemberslist"),A=10;WebMessanger.userslist=new WmsUsersList(y,z,w,A),t.focus(),t.value=$WC.Util.unescapeHTML(n)||n;var B=new $WC.DatePicker,C=new $WC.Time;s.datepicker=B,s.timepicker=C;var D=function(a){u.setAttribute("data-selecteddate",(new Date(a)).getTime())},E=function(a,b,c,d){if(c){WMSUI.showErrorMsg($WC.I18N("reminders.invalidtime.hours"));return}if(d){WMSUI.showErrorMsg($WC.I18N("reminders.invalidtime.minutes"));return}v.setAttribute("data-selectedtime",b)},F=WebMessanger.getReminderInfo(m),G=F>0?F:(new Date).getTime(),H=new Date(G);u.setAttribute("data-selecteddate",G),v.setAttribute("data-selectedtime",H.getHours()+":"+H.getMinutes()),B.mountComponent(u,G,D),C.mountComponent(v,G,E),Gator(s).on("click",function(a){var b=$WC.Util.getEventTarget(a),d=b.getAttribute("data-operation");if(d==="close")ZMSGUI.removeReminderDialog(!0),delete WebMessanger.userslist;else if(d==="selfreminder")y.style.display="none",w.innerHTML="";else if(d==="assigneereminder")y.style.display="block",y.focus(),z.style.display="block",WMSUI.curtrigger="",WebMessanger.userslist.showList();else if(d==="deletemembers"){var e=b.closest("[data-userid]").getAttribute("data-userid"),f=w.querySelector('[data-userid="'+e+'"]');$WC.Util.removeElement(f),WebMessanger.userslist.showList()}else if(d==="populatelist")WebMessanger.userslist.showList();else if(d==="addreminder"){var g=v.getAttribute("data-selectedtime").split(":"),h=(new Date(+u.getAttribute("data-selecteddate"))).setHours(g[0],g[1]),i=t.value,j={time:""+h,message_id:m,chat_id:c,sender_id:WebMessanger.zuid};i!==t.getAttribute("data-originalmsg")&&(j.content=i);if(x.checked){var k=[],l=w.querySelectorAll("[data-userid]");$WC.Util.convertToArray(l).forEach(function(a){k.push(a.getAttribute("data-userid"))}),j.user_ids=k}if(x.checked&&!k.length){WMSUI.showErrorMsg($WC.I18N("reminders.members.none"));return}WebMessanger.setReminder(j),ZMSGUI.removeReminderDialog(!0)}b.closest('[id="wms_remassignee"]')===null&&d!=="assigneereminder"&&d!=="deletemembers"&&(z.style.display="none")})}else if(b==="fork"){var I=a.getAttribute("data-msgid"),J=WindowHandler.getWinObjById(c),K=J.title+$WC.I18N("fork.title.text"),L=J.recipant.split(",");(new $WC.ForkChat).mountComponent(c,K,I,L,WMSUI.showErrorMsg)}else if(b==="react"){var M=a.closest("[data-msguid]").getAttribute("data-msguid"),d=WindowHandler.getWinObjById(c);d.showReactionsUI(M)}else if(b==="markasunread"){var M=a.getAttribute("data-msguid"),m=a.getAttribute("data-msgtime");WebMessanger.markAsUnread(c,M,m);var d=WindowHandler.getWinObjById(c);d.close()}else if(b==="messagelink"){var M=a.getAttribute("data-msguid"),N=_WMSCHATURL+"chats/"+c+"/messages/"+M.replace("%20","_"),g='<textarea id="wms_copyhidden" style="display:block;">'+N+"</textarea>";a.insertAdjacentHTML("afterend",g),d=WindowHandler.getWinObjById(c),document.getElementById("wms_copyhidden").select(),document.execCommand("copy"),a.parentElement.removeChild(document.getElementById("wms_copyhidden")),d.showInfoMsg($WC.I18N("messagelink.info.copied"))}else if(b==="forward")$WC.Util.isEmptyObject($WC.Channels.get())&&$WC.Channels.initChannels(),d=WindowHandler.getWinObjById(c),d.toggleMessageSelection(!0,a);else if(b==="pinmsg"){var O=a,P=function(a,b){var d=O.getAttribute("data-msguid");WebMessanger.pinMsg(c,d,a,b)},Q=!1;O.closest("[data-type="+Message.types.REPLYMSG+"]")&&(Q=!0);var R=Message.getMsgFromDom(c,O.getAttribute("data-msgid"),Q,!0,!0);if(typeof R=="object"){var S="wms_pinmsg_att_icon";R.messagetype==="CONTACTATT"?S+=" wms_pinmsg_contact_icon":R.messagetype==="LOCATT"?S+=" wms_pinmsg_location_icon":R.messagetype==="EVENTATT"&&(S+=" wms_pinmsg_event_icon"),R=R.fName||R.name||R.desc,R=R+'<span class="'+S+'"></span>'}else if(typeof R=="string"){var T=R.lastIndexOf("<br>"),U=R.lastIndexOf("\n");R=R.substring(T!==-1?T+4:U!==-1?U+1:0),R=$WC.Markdown.apply(R),R=Smiley.replace(R,!0)}var V=WindowHandler.getWinObjById(c),W=V.pinmsgdetails.info.msgid?!0:!1,X=new $WC.PinMsgDialog;X.mountComponent(P,R,W)}else b==="unpinmsg"&&WebMessanger.unpinMsg(c)},Message.constructTimeFragment=function(a,b){if(a){var c=b?"data-edited="+$WC.I18N("message.edit.info"):"";return $WC.template.replace("<div class='wms-msgtime' title='{{date}}' data-timefrag=\"true\" {{editinfo}}>{{msgtime}}</div>",{msgtime:$WC.DateUtil.formatTime(a),date:$WC.DateUtil.formatDate(a),editinfo:c})}return""},Chat.isExists=function(a){var b=document.getElementById(a);return b!=null?!0:!1};var ChatBlink=function(){function e(){b==1&&(b=!1,h(a),clearTimeout(c))}function f(c){c&&(e(),a=i(),h(Message.decodehtml(c)),d=i(),h(a),b=!0,g())}function g(){if(!Self.Idle){e();return}var b=a,f=i();d!==f&&(a=f,b=d),h(b),c=setTimeout(g,1500)}function h(a){a&&(document.title=a)}function i(){if(document.title)return document.title}var a,b,c,d;return{start:f,stopRepeat:e}}();document.onclick=function(){Self.Idle=!1},$WC.Util.addEvent(window,"focus",function(){ChatBlink.stopRepeat()});var wmsuserstatus={};Self.init=function(){Self.isIdle={},Self.prevIdleStatus={},Self.prevTypingTime={},Self.Timer={},setInterval(function(){Self.status.chkstatus()},1e4),Self.Idle=!0},Self.status={init:function(a){Self.isIdle[a]=!0,Self.Idle=!0,Self.prevIdleStatus[a]=!0},chkstatus:function(){try{var a={};for(var b in wmsuserstatus){var c=wmsuserstatus[b];if(c!=null&&typeof c!="undefined"&&typeof c!="function"){var d=0;for(d in c);if(d==0)continue;if((new Date).getTime()-Self.prevTypingTime[b]<14e3){a[b]=c;continue}Self.status.getmsg(b)!=""&&Self.status.send(b,NFY_USER_ENTERED),Self.prevIdleStatus[b]=Self.isIdle[b],Self.isIdle[b]=!0,Self.Idle=!0}}wmsuserstatus=a}catch(e){}},isEnabled:function(){return WebMessanger.scode==WMS_INVISIBLE?!1:!0},send:function(a,b){try{if($WC.Util.indexOf(WebMessanger.liveChats,a)===-1)return}catch(c){}b==NFY_USER_ENTERED&&(wmsuserstatus[a]={});if(Self.status.isEnabled()){var d="userid="+WebMessanger.getUserName()+"&chid="+a+"&status="+b+"&dname="+encodeURIComponent(WebMessanger.getNickName())+"&sid="+encodeURIComponent(WebMessanger.getSid());$WC.Ajax.postRequest("sendstatus"+dext,d)}},idle:function(a){var b={};b[(new Date).getTime()]=NFY_USER_IDLE,Self.prevIdleStatus[a]=Self.isIdle[a],Self.isIdle[a]=!0,Self.Idle=!0,wmsuserstatus[a]=b},update:function(a){var b=""+a.chid,c=b+"."+a.sender;clearTimeout(Self.Timer[c]),delete Self.Timer[c];if(a.sender==WebMessanger.getUserName()||a.sender==WebMessanger.getZuid())return;var d=document.getElementById(b);if(d!=null){var e=WindowHandler.getWinObjById(b).typingstatusnode;e.title="";var f=WindowHandler.getWinObjById(b).typingindicatornode;a.msg!=""?f.style.display="inline-block":f.style.display="none"}},check:function(a){var b={};b[(new Date).getTime()]=NFY_USER_TYPING,Self.isIdle[a]!=Self.prevIdleStatus[a]&&(Self.status.getmsg(a)!=""?(WindowHandler.makeNormalWinById(a),ChatBlink.stopRepeat(),Self.status.send(a,NFY_USER_TYPING),Self.prevTypingTime[a]=(new Date).getTime()):(Self.prevIdleStatus[a]=Self.isIdle[a],Self.Idle=!0,Self.isIdle[a]=!0,b[(new Date).getTime()]=NFY_USER_IDLE)),wmsuserstatus[a]=b},active:function(a){Self.prevIdleStatus[a]=Self.isIdle[a],Self.isIdle[a]=!1,Self.Idle=!1;if(a==undefined)return;Self.status.check(a)},clear:function(a,b){var c=a+"."+b;delete Self.Timer[c],Self.prevTypingTime[a]={};var d=document.getElementById(a);d!=null&&(WindowHandler.getWinObjById(a).typingindicatornode.style.display="none")},getmsg:function(a){try{var b=document.getElementById(a);if(b!=null){var c=WindowHandler.getWinObjById(a).composer;return c.value}if(document.getElementById("editor")!=null)return document.getElementById("editor").value}catch(d){}return""}},Self.init(),WMSZohoApi.acceptLiveSupport=function(a,b,c,d){if(_WMSCHATURL!=""){var e;e=document.createElement("script"),e.setAttribute("type","text/javascript");var f="?chid="+a+"&guid="+b+"&a="+c+"&g="+d;silent||(f=f+"&sid="+encodeURIComponent(WebMessanger.getSid())),e.setAttribute("src",_WMSCHATURL+"acccsupport.ext"+f),document.body.appendChild(e)}},WMSKeyHandler.init=function(){ie?document.attachEvent("onkeydown",WMSKeyHandler.handle):document.addEventListener("keydown",WMSKeyHandler.handle),ie?document.attachEvent("onclick",WMSKeyHandler.onclick):document.addEventListener("click",WMSKeyHandler.onclick),WMSKeyHandler.skipeventlistener=!1},WMSKeyHandler.onclick=function(a){if(WMSKeyHandler.skipeventlistener===!0){WMSKeyHandler.skipeventlistener=!1;return}WmsProfileInfo.handleDocumentClick(a),WMSUI.handleDocumentClick(a),Message.handleMessageLinkClick(a)},WMSKeyHandler.handle=function(a){a||(a=window.event);var b=window.event?a.keyCode:a.which;if(WMSUI.imgPreview.handleKeyMovement(a)||ChatTour.handleKeyMovement(a)){a.stopImmediatePropagation();return}b==27&&WMSKeyHandler.escapee(a)&&WMSKeyHandler.cancelEvent(a),WebMessanger.allprdchatdeactivated===!1&&WebMessanger.chatdeactivated===!1&&WebMessanger.smartchatshortcutdisabled===!1&&WMSUI.smartchatenabled===!0&&b==32&&a.ctrlKey===!0&&a.metaKey===!1&&(WmsHybridSearch.toggleUI(),WMSKeyHandler.cancelEvent(a)),ZMSGUI.handleEvent(a)},WMSKeyHandler.escapee=function(a){return WMSUI.handleDocumentEscape(a)},WMSKeyHandler.cancelEvent=function(a){ie?(a.cancelBubble=!0,a.returnValue=!1):(a.preventDefault(),a.stopPropagation())},WMSKeyHandler.preventHandlingTabUpDownEnter=function(a){(a.keyCode===$WC.WmsConstants.KEYCODES.DOWN||a.keyCode===$WC.WmsConstants.KEYCODES.UP||a.keyCode===$WC.WmsConstants.KEYCODES.ENTER||a.keyCode===$WC.WmsConstants.KEYCODES.TAB)&&a.preventDefault()},WMSKeyHandler.init(),WMSSessionConfig.CHAT=1,WMSSessionConfig.CHAT_PRESENCE=2,WMSSessionConfig.PRESENCE_PERSONAL=4,WMSSessionConfig.PRESENCE_ORG=8,WMSSessionConfig.LOADBALANCED=16,WMSSessionConfig.MP=32,WMSSessionConfig.CROSS_PRD=64,WMSSessionConfig.MULTI_DISPATCH=128,WMSSessionConfig.REUSE_SESSION=256;var _SOUND_PLAYER;WmsSound.getTune={},WmsSound.players={},WmsSound.init=function(){(new Audio).canPlayType("audio/wav")!=""&&(new Audio).canPlayType("audio/wav")!="no"?WmsSound.getTune={newchat:"https://media.zohostatic.com/ichat/Mar_30_2020_3_https/sound/newchatmsg2.wav",chatmsg:"https://media.zohostatic.com/ichat/Mar_30_2020_3_https/sound/tik.wav"}:WmsSound.getTune={newchat:"https://media.zohostatic.com/ichat/Mar_30_2020_3_https/sound/newchatmsg2.mp3",chatmsg:"https://media.zohostatic.com/ichat/Mar_30_2020_3_https/sound/tik.mp3"},WmsSound.timer=null},WmsSound.checkAndPlayTune=function(a,b){(a||wmsnotifyowner&&wmsnotifyowner.isOwner())&&WmsSound.playTune(b)},WmsSound.playTune=function(a,b){if(WmsSettings.sound==0)return;try{a=a||"notify",WmsSound.players[a]=WmsSound.players[a]||new Audio(WmsSound.getTune[a]),_SOUND_PLAYER=WmsSound.players[a],_SOUND_PLAYER.play(),b!=null&&(WmsSound.timer=setInterval(function(){_SOUND_PLAYER.play()},1400),setTimeout(function(){WmsSound.stop()},b))}catch(c){}},WmsSound.stop=function(){try{_SOUND_PLAYER.pause(),clearInterval(WmsSound.timer)}catch(a){}},WmsSound.getWinFocus=function(){return _WMSWINFOCUS},WmsSettings.bsettings={},WmsSettings.bsettings={sound:"0",soc:"1",scp:"0",vmessage:"0",vmymessage:"1",vmention:"1",groupmessage_visual_notify:"1",botmessage_visual_notify:"1",vustatus:"0",disann:{},deact:"",chatenabled:!0,cpinnedchats:"1",cunreadchats:"1",crecentchats:"1",tourenabled:"0",wmstourprops:"0",primetime_onboard_count:"0",adminsettings:{},salesiq_chatbar:"0",salesiq_chatbar_prdlist:""},WmsSettings.constants={ONBOARD:1},WmsSettings.populate=function(){this.sound=WmsSettings.bsettings.sound,this.soc=WmsSettings.bsettings.soc,this.scp=WmsSettings.bsettings.scp,this.vmessage=WmsSettings.bsettings.vmessage,this.vmymessage=WmsSettings.bsettings.vmymessage,this.vmention=WmsSettings.bsettings.vmention,this.groupmessage_visual_notify=WmsSettings.bsettings.groupmessage_visual_notify,this.botmessage_visual_notify=WmsSettings.bsettings.botmessage_visual_notify,this.vustatus=WmsSettings.bsettings.vustatus,this.disann=WmsSettings.bsettings.disann,this.deact=WmsSettings.bsettings.deact&&WmsSettings.bsettings.deact.split(","),this.chatenabled=WmsSettings.bsettings.chatenabled,this.cpinnedchats=WmsSettings.bsettings.cpinnedchats,this.cunreadchats=WmsSettings.bsettings.cunreadchats,this.crecentchats=WmsSettings.bsettings.crecentchats,this.primetime_onboard_count=WmsSettings.bsettings.primetime_onboard_count,this.salesiq_chatbar=WmsSettings.bsettings.salesiq_chatbar,this.salesiq_chatbar_prdlist=WmsSettings.bsettings.salesiq_chatbar_prdlist&&WmsSettings.bsettings.salesiq_chatbar_prdlist.split(","),WmsSettings.adminsettings={isChannelAllowed:!0,isMediacallAllowed:!0,isDisableHistoryAllowed:!0,cliqaccess:!0};for(var a in WmsSettings.bsettings.adminsettings)WmsSettings.adminsettings[a]=WmsSettings.bsettings.adminsettings[a];typeof WmsSettings.adminsettings.orgPolicies=="object"&&(WmsSettings.adminsettings.orgPolicies.chat_with_non_org_users==="false"&&$WC.Config.set({other_orguser_chat:"disable"}),WmsSettings.adminsettings.orgPolicies.allow_turn_off_chat_history==="false"&&(WmsSettings.adminsettings.isDisableHistoryAllowed=!1)),WmsSettings.adminsettings.moduleconfig=typeof WmsSettings.adminsettings.moduleconfig=="string"&&WmsSettings.adminsettings.moduleconfig!==""?JSON.parse(WmsSettings.adminsettings.moduleconfig):"",typeof WmsSettings.adminsettings.moduleconfig=="object"&&$WC.SecurityManager.update(WmsSettings.adminsettings.moduleconfig),typeof WmsSettings.adminsettings.service_configurations=="object"&&(_DOWNLOADSERVERURL=WmsSettings.adminsettings.service_configurations.download_server_url,_UPLOADSERVERURL=WmsSettings.adminsettings.service_configurations.upload_server_url),WmsSettings.adminsettings.isChannelAllowed===!1&&$WC.Config.set({channels:"disable"}),WmsSettings.adminsettings.features&&WmsSettings.adminsettings.features.chatdrafts&&$WC.Drafts.checkAndUpdateLMTime(WmsSettings.adminsettings.features.chatdraft_lmtime),wmsUserConfig.infomsg&&WMSUI.processAnnMsg(wmsUserConfig.infomsg,wmsUserConfig.infomsgtype),$WC.$CUtil.getBrowserName()==="ie"&&!$WC.$CUtil.isIEVersion11()&&(silent=!0,WebMessanger.showEmptyBar()),WebMessanger.registerAnnonUser||setTimeout(function(){WebMessanger.appendPhoneBridge()},1);if(_WMSEMPTYBAR)WMSUI.populateEmptyBar();else if(this.chatenabled===!1){WebMessanger.isServiceStatus()===!1?(WebMessanger.showEmptyBar(),WMSUI.populateEmptyBar()):silent=!0;try{WmsUIImpl.handleUIHidden()}catch(b){}}else $WC.Util.indexOf(this.deact,"ALL")!==-1||$WC.Util.indexOf(this.deact,WebMessanger.prd)!==-1||WmsSettings.adminsettings.cliqaccess===!1?($WC.Util.indexOf(this.deact,"ALL")!==-1?(WebMessanger.allprdchatdeactivated=!0,WebMessanger.chatdeactivated=!1):$WC.Util.indexOf(this.deact,WebMessanger.prd)!==-1&&(WebMessanger.allprdchatdeactivated=!1,WebMessanger.chatdeactivated=!0),WmsSettings.adminsettings.cliqaccess===!1&&(WebMessanger.chatdisabled=!0),silent||WMSUI.populateDeactivatedChatUI()):(WebMessanger.chatdeactivated=!1,WebMessanger.allprdchatdeactivated=!1,WmsMainUI.maincontainer&&WmsMainUI.maincontainer.parentNode&&WmsMainUI.maincontainer.parentNode.removeChild(WmsMainUI.maincontainer),silent||(WMSUI.usersdiv=null,WMSUI.groupdiv=null,WMSUI.actchatdiv=null,WMSUI.populateMainBar(),WebMessanger.loadSalesIQJS()))},WmsSettings.updateWmsSettings=$WC.Util.debounce(function(a,b,c,d,e,f){b==="deact"?c?WebMessanger.UpdateWmsSettings(a,b,c,null,d,e,f):WebMessanger.UpdateWmsSettings(a,b,WebMessanger.prd,null,d,e,f):b==="disann"?WebMessanger.UpdateWmsSettings(a,b,wmsUserConfig.infomsgid,wmsUserConfig.infomsgprd):WebMessanger.UpdateWmsSettings(a,b,c)},null,500,!1),WmsSettings.handleUpdateWmsSettings=function(a){for(var b in a)if(b=="sound")this.sound=a[b],WmsMainUI.handleSettings(this.sound,WmsMainUI.settingscontainer.querySelector('[data-setting="sound"]'));else if(b=="vmymessage")this.vmymessage=a[b],WmsMainUI.handleSettings(this.vmymessage,WmsMainUI.settingscontainer.querySelector('[data-setting="vmymessage"]'));else if(b=="vmention")this.vmention=a[b],WmsMainUI.handleSettings(this.vmention,WmsMainUI.settingscontainer.querySelector('[data-setting="vmention"]'));else if(b=="groupmessage_visual_notify")this.groupmessage_visual_notify=a[b],WmsMainUI.handleSettings(this.groupmessage_visual_notify,WmsMainUI.settingscontainer.querySelector('[data-setting="groupmessage_visual_notify"]'));else if(b=="botmessage_visual_notify")this.botmessage_visual_notify=a[b],WmsMainUI.handleSettings(this.botmessage_visual_notify,WmsMainUI.settingscontainer.querySelector('[data-setting="botmessage_visual_notify"]'));else if(b=="vustatus")this.vustatus=a[b],WmsMainUI.handleSettings(this.vustatus,WmsMainUI.settingscontainer.querySelector('[data-setting="vustatus"]'));else if(b=="cpinnedchats")this.cpinnedchats=a[b];else if(b=="cunreadchats")this.cunreadchats=a[b];else if(b=="crecentchats")this.crecentchats=a[b];else if(b=="primetime_onboard_count")this.primetime_onboard_count=a[b];else if(b=="scp"){this.scp=a[b];try{WMSUI.populateusrs(!1)}catch(c){}}else if(b==="disann")this.disann=a[b],WMSUI.isAnnBlocked()&&WMSUI.clearAnnBanner();else if(b==="deact"){this.deact=a[b].split(",");if($WC.Util.indexOf(this.deact,"ALL")!==-1||$WC.Util.indexOf(this.deact,WebMessanger.prd)!==-1){if(WebMessanger.chatdeactivated===!1||WebMessanger.allprdchatdeactivated===!1)$WC.Util.indexOf(this.deact,"ALL")!==-1?(WebMessanger.allprdchatdeactivated=!0,WebMessanger.chatdeactivated=!1):(WebMessanger.allprdchatdeactivated=!1,WebMessanger.chatdeactivated=!0),WebMessanger.turnOffChat(),WMSUI.populateDeactivatedChatUI()}else(WebMessanger.chatdeactivated===!0||WebMessanger.allprdchatdeactivated===!0)&&WebMessanger.chatdisabled===!1&&(WebMessanger.chatdeactivated=!1,WebMessanger.allprdchatdeactivated=!1,WebMessanger.turnOnChat(),wmsnotifyowner&&wmsnotifyowner.clearOwnerSync(),WebMessanger.registerAnnonUser||(wmsnotifyowner=new $WC.NotificationOwner("chat",!0)),WMSUI.contactsenabled=WebMessanger.disabledmenus&WebMessanger.uisettingsconst.contacts?!1:!0,WMSUI.groupsenabled=WebMessanger.disabledmenus&WebMessanger.uisettingsconst.groups?!1:!0,WMSUI.activechatenabled=WebMessanger.disabledmenus&WebMessanger.uisettingsconst.activechats?!1:!0,WMSUI.profileenabled=WebMessanger.disabledmenus&WebMessanger.uisettingsconst.settings?!1:!0,WMSUI.smartchatenabled=WebMessanger.disabledmenus&WebMessanger.uisettingsconst.smartchat?!1:!0,WmsMainUI.populate());WebMessanger.orgid=="456089"&&(WebMessanger.ismediacallnewwindow=WebMessanger.isChatPaused())}else b==="salesiq_chatbar"?(this.salesiq_chatbar=a[b],WebMessanger.loadSalesIQJS()):b==="salesiq_chatbar_prdlist"?(this.salesiq_chatbar_prdlist=a[b].split(","),WebMessanger.loadSalesIQJS()):this[b]=a[b]},WmsSettings.isTourEnabled=function(){return+WmsSettings.bsettings.tourenabled===1?!0:!1},WmsSettings.isOnboardSeen=function(){var a=+WmsSettings.bsettings.wmstourprops&WmsSettings.constants.ONBOARD;return a===WmsSettings.constants.ONBOARD?!0:!1},WmsSettings.setOnboardSeen=function(){var a=+WmsSettings.bsettings.wmstourprops|WmsSettings.constants.ONBOARD;return a},WmsSettings.getAdminSetting=function(a){return WmsSettings.adminsettings[a]},WmsSettings.handleTourSettings=function(a){WmsSettings.bsettings.wmstourprops=a,WmsSettings.isOnboardSeen()&&ChatTour.exit(!1)},WmsSettings.updateTourSettings=function(a,b){if(a===WmsSettings.constants.ONBOARD){var c=WmsSettings.setOnboardSeen();WebMessanger.updateTourSettings(c,b)}},WmsSettings.initModulesPermissions=function(){$WC.SecurityManager.init({direct_message:{status:"enabled"},audio_call:{status:"enabled"},video_call:{status:"enabled"},channels:{status:"enabled"},external_channels:{status:"enabled"},org_channels:{status:"enabled"},private_channels:{status:"enabled"},team_channels:{status:"enabled"},bots:{status:"enabled"},commands:{status:"enabled"}});var a={audio_call:WindowHandler.updateMediacallPermissions,video_call:WindowHandler.updateMediacallPermissions,direct_message:$WC.HybridSearch.populateRecentChats,channels:WmsHybridSearch.populateGroupResultInMainUI,external_channels:WmsHybridSearch.populateGroupResultInMainUI,team_channels:WmsHybridSearch.populateGroupResultInMainUI,org_channels:WmsHybridSearch.populateGroupResultInMainUI,private_channels:WmsHybridSearch.populateGroupResultInMainUI,bots:WmsHybridSearch.populateContactListInMainUI};$WC.SecurityManager.registerCallbacks(a)},WmsDragDrop.onDropEvent=function(a,b,c,d){b.preventDefault();if(d){var e=WmsDragDrop.dragged_file;e=e.getAttribute("data-filefrwrd")?e:e.closest("[data-msgid]").querySelector("[data-filefrwrd]");if(!e){WmsDragDrop.dragged_file="";return}WmsFileForwardUI.handlePreview(e);var f={};f.chid=a;var g=WindowHandler.getWinObjById(a);if(g.ctype=="8")f.imagehtml=$WC.HybridSearch.generateImageHtml(a,$WC.WmsConstants.HYBRIDSEARCH.CHANNEL);else if(g.ctype=="1"&&g.partcount>2)f.imagehtml=$WC.HybridSearch.generateImageHtml(a,$WC.WmsConstants.HYBRIDSEARCH.GROUP,{TITLE:g.title});else{var h=g.recipant||$WC.Bots.getBotId(a),i=WmsContacts.get(h);f.imagehtml=$WC.HybridSearch.generateImageHtml(h,$WC.WmsConstants.HYBRIDSEARCH.CONTACT,i)}f.dname=g.title,f.type=g.ctype,WmsFileForwardUI.insertSuggestion("","",f),document.getElementById("wms-fileupldcmt").focus();return}var j=b.dataTransfer.files;WmsDragDrop.nooffiles=j.length,WmsDragDrop.pos=0;var k=WindowHandler.getWinObjById(a);if(k.ctype=="5"||k.editorreplydiv.getAttribute("data-editmsg")==="true"||k.permdenied)return;if($WC.Util.isFilesizeExceeded(j))return!1;WmsFileUploadUI.checkSupport()&&j.length?WmsFileUploadUI.handlePreview(a,j):WmsDragDrop.uploadFile(a,j)},WmsDragDrop.uploadFile=function(a,b){var c={onprogress:function(b){var c=Math.round(b.loaded/b.total*100);WindowHandler.showProgress(a,c,WmsDragDrop.pos)},oncomplete:function(){},success:function(){WindowHandler.showProgress(a,100,WmsDragDrop.pos),WmsDragDrop.pos<WmsDragDrop.nooffiles?(WindowHandler.showProgress(a,0,WmsDragDrop.pos),WmsDragDrop.uploadFileUsingPost(a,b[WmsDragDrop.pos],c,b),WmsDragDrop.pos++):WindowHandler.clearProgress(a)}};WmsDragDrop.uploadFileUsingPost(a,b[WmsDragDrop.pos],c,b),WmsDragDrop.pos++},WmsDragDrop.uploadFileUsingPost=function(a,b,c,d){try{if(b.size>1e7){alert($WC.I18N("You_have_exceeded_the_maximum_allowed_file_size_of_10MB")),WindowHandler.clearProgress(a),WmsDragDrop.nooffiles>WmsDragDrop.pos+1&&(WmsDragDrop.pos++,WmsDragDrop.uploadFileUsingPost(a,d[WmsDragDrop.pos],c,d));return}var e=new XMLHttpRequest,f=["chid","username","sender","mod","sid",_CHATCFPARAMNAME],g=[a,WebMessanger.getUserName(),WebMessanger.getUserName(),"att",WebMessanger.getSid(),$WC.Cookie.get(_CHATCFTOKEN)];e.onreadystatechange=function(){if(e.readyState==4){var a=e.status==200?c.success:c.fail;a&&a(e.responseText)}},c.onprogress&&(e.addEventListener("progress",c.onprogress,!1),e.upload.addEventListener("progress",c.onprogress,!1)),c.oncomplete&&(e.addEventListener("load",c.oncomplete,!1),e.upload.addEventListener("load",c.oncomplete,!1));var h="/"+_CHATCONT+"/upload.do";e.open("POST",h,!0);if(typeof FormData!="undefined"){var i=new FormData;for(var j=0;j<f.length;j++)i.append(f[j],g[j]);return i.append("file1",b),e.send(i),e}var k=(new Date).getTime(),l="";l+="\r\n--"+k;var m="\r\n",n=b.fileName,o;o||(o=[]);for(var p=0;p<f.length;p++)o[o.length]=WmsDragDrop.getMultiPartParamObject(f[p],g[p]);for(p=0;p<o.length;p++){var q=o[p];m+=WmsDragDrop.getMultiPartParamStr(q.name,encodeURIComponent(q.value))+"\r\n--"+k+"\r\n"}l+=m,n=b.fileName;if(n==undefined||null)n="file1";return l+='Content-Disposition: form-data; name="file1";filename="'+n+'"'+"\r\n"+"Content-Type:"+b.type+"\r\n"+"\r\n"+b.getAsBinary(),l+="\r\n--"+k+"--",e.setRequestHeader("Content-Length",l.length),e.setRequestHeader("Content-Type","multipart/form-data; charset: UTF-8; accept-charset: UTF-8; boundary="+k),e.setRequestHeader("Connection","close"),e.sendAsBinary(l),e}catch(r){}},WmsDragDrop.getMultiPartParamStr=function(a,b){return'Content-Disposition: form-data; name="'+a+'"\r\n\r\n'+b},WmsDragDrop.getMultiPartParamObject=function(a,b){return{name:a,value:b}},WmsDragDrop.isFileSharable=function(){return WmsDragDrop.dragged_file&&!WmsDragDrop.dragged_file.getAttribute("data-filefrwrd")&&!WmsDragDrop.dragged_file.closest("[data-msgid]").querySelector("[data-filefrwrd]")?!1:!0},PubSubApi.initialised=!1,PubSubApi.heartBeat=function(){for(var a in this.subinfo)try{PubSubApi.resubscribe(this.subinfo[a])}catch(b){}setTimeout(function(){PubSubApi.heartBeat()},3e4)},PubSubApi.init=function(){this.iframeObj=document.getElementById("psconnect"),this.uname="",this.wms_samedomain="",this.prdid="",this.userid="",this.sid="",this.nname="",typeof WebMessanger=="function"?(this.uname=WebMessanger.zuid!=""?WebMessanger.zuid:WebMessanger.uname,this.wms_samedomain=_WMS_SAMEDOMAIN,this.prdid=WebMessanger.getPrd(),this.userid=WebMessanger.getUserId(),this.sid=WebMessanger.getSid(),this.nname=WebMessanger.getNickName()):typeof WmsLite=="function"&&(this.uname=WmsLite.zuid!=""?WmsLite.zuid:WmsLite.uname,this.wms_samedomain=WM_SAMED,this.prdid=getPrd(),this.userid=getUserId(),this.sid=getSid(),this.nname=getNickName());if(this.iframeObj==undefined){this.iframeObj=document.createElement("iframe"),this.iframeObj.name="wmspsconnect",this.iframeObj.id="psconnect",this.iframeObj.style.display="none",this.iframeObj.src="/"+_WMSCONT+"/psconnect.sas?wmscont="+_WMSCONT+"&samedomain="+this.wms_samedomain+"&nodomainchange="+_WMS_NODOMAINCHANGE+"&uname="+this.uname;if(typeof WebMessanger=="function"&&WebMessanger.tokenpairauth||typeof WmsLite=="function"&&WmsLite.tokenpairauth)this.iframeObj.src+="&tokenpair=true";document.body.appendChild(this.iframeObj),this.initialised===!1&&(this.initialised=!0,this.subinfo={},this.psids={},setTimeout(function(){PubSubApi.heartBeat()},3e4))}else PubSubImpl.onConnect()},PubSubApi.subscribe=function(a,b,c,d,e,f){var g="pskey="+a+"&prd="+this.prdid+"&wmsid="+this.userid+"&sid="+encodeURIComponent(this.sid)+"&config="+c+"&dname="+this.nname+"&opr=subscribe";f!=undefined&&e!=undefined&&(g=g+"&authtype="+e+"&authid="+f);var h=[a,b,c,d,e,f];this.wms_samedomain?PubSubBridge.httpPost("subscribe","/pubsubsrv/"+b+"/pubsub",g,h):PubSubBridge.httpPost("subscribe","/"+b+"/pubsub",g,h)},PubSubApi.resubscribe=function(a){var b="pskey="+a.pskey+"&prd="+this.prdid+"&wmsid="+this.userid+"&sid="+encodeURIComponent(this.sid)+"&config="+a.config+"&dname="+this.nname+"&opr=resubscribe";a.authid!=undefined&&a.authtype!=undefined&&(b=b+"&authtype="+a.authtype+"&authid="+a.authid);var c=[a.pskey];this.wms_samedomain?PubSubBridge.httpPost("resubscribe","/pubsubsrv/"+a.psuri+"/pubsub",b,c):PubSubBridge.httpPost("resubscribe","/"+a.psuri+"/pubsub",b,c)},PubSubApi.unSubscribe=function(a){if(PubSubApi.isSubscribed(a)){var b=PubSubApi.subinfo[a],c="pskey="+a+"&prd="+this.prdid+"&wmsid="+this.userid+"&sid="+encodeURIComponent(this.sid)+"&config="+b.config+"&dname="+this.nname+"&opr=unsubscribe";b.authid!=undefined&&b.authtype!=undefined&&(c=c+"&authtype="+b.authtype+"&authid="+b.authid);var d=[a];this.wms_samedomain?PubSubBridge.httpPost("unsubscribe","/pubsubsrv/"+b.psuri+"/pubsub",c,d):PubSubBridge.httpPost("unsubscribe","/"+b.psuri+"/pubsub",c,d)}},PubSubApi.getSubscribedList=function(){var a=new Array;for(var b in this.psids)a.push(b);return a},PubSubApi.isSubscribed=function(a){return this.psids[a]!=undefined},PubSubApi.getUsers=function(a){return PubSubApi.isSubscribed(a)?this.subinfo[a].getUsers():null},PubSubApi.isValidPSID=function(a,b){return this.psids[a]==b},PubSubApi.getPsid=function(a){return this.psids[a]},PubSubApi.ackSubscribe=function(a,b,c,d,e,f,g){var h=new PubSubObject(a,b,c,d,e,f);PubSubApi.subinfo[a]=h,PubSubApi.psids[a]=g},PubSubApi.ackUnSubscribe=function(a){delete PubSubApi.psids[a],delete PubSubApi.subinfo[a]},PubSubApi.ackResubscribe=function(a,b){PubSubApi.psids[a]!=b&&PubSubApi.subinfo[a].reInitUsers(),PubSubApi.psids[a]=b},PubSubApi.handleError=function(a,b){delete PubSubApi.psids[a],delete PubSubApi.subinfo[a];switch(b){case 1:break;case 2:break;case 3:}},PubSubApi.removeUsers=function(a,b,c){PubSubApi.isValidPSID(a,b)&&PubSubApi.subinfo[a].removeUsers(c)},PubSubApi.addUsers=function(a,b,c){PubSubApi.isValidPSID(a,b)&&PubSubApi.subinfo[a].addUsers(c)},PubSubBridge.onconnect=function(){PubSubImpl.onConnect()},PubSubBridge.handleHttpPost=function(a,b,c){try{if(a=="subscribe"){var d=JSON.parse(b)[0];if(d.errcode!=undefined){var e=d.errcode;PubSubApi.handleError(d.pskey,e),PubSubImpl.handleError(a,d.pskey,e)}else PubSubApi.ackSubscribe(c[0],c[1],c[2],c[3],c[4],c[5],d.psid),PubSubImpl.handleSubscribe(c[0])}else a=="unsubscribe"?(d=JSON.parse(b)[0],d.errcode!=undefined?(e=d.errcode,PubSubImpl.handleError(a,c[0],e)):(PubSubApi.ackUnSubscribe(c[0]),PubSubImpl.handleUnSubscribe(c[0]))):a=="resubscribe"&&b!=""&&(d=JSON.parse(b)[0],d.errcode!=undefined?(e=d.errcode,PubSubApi.handleError(d.pskey,e),PubSubImpl.handleError(a,d.pskey,e)):PubSubApi.ackResubscribe(c[0],d.psid))}catch(f){}},WmsChatCache=function(){var a={},b=[],c=25,d=1e5,e={insert:function(e,f){return},get:function(b){if(a[b])return a[b]},remove:function(c){if(this.isAvailable(c))return delete a[c],b.splice($WC.Util.indexOf(b,c),1),!0},removeAll:function(){a={},b=[]},isAvailable:function(a){return this.get(a)?!0:!1}};return e}(),WmsNotification.notifyNewMessage=function(a,b,c){var d=a.sender,e=a.chid,f=WindowHandler.getWinObjById(e),g=f?f.getTitle():a.title,h=f?f.ctype:a.ctype;if(d!==WebMessanger.zuid||h==="9"){f&&f.highlight();if(c||wmsnotifyowner&&wmsnotifyowner.isOwner()){var i=WMSUI.getNotificationTitle(a)+" "+$WC.I18N("Says")+"...";h==="9"&&(i=g+" "+$WC.I18N("Says")+"..."),WMSUI.isBarVisible()&&WebMessanger.scode!=="3"&&ChatBlink.start(i)}}WebMessanger.scode!=3&&(c||wmsnotifyowner.isOwner())&&(b==="newchat"||!WmsSound.getWinFocus())&&WmsSound.playTune(b),WMSUI.checkAndNotifyMsg(a)},WmsNotification.notifyNewCall=function(a,b,c){if(WMSUI.isBarVisible()&&WebMessanger.scode!=="3"&&wmsnotifyowner.isOwner()){var d=b==WmsAVChat.CALL_TYPE_VIDEO?"mediacall.incoming.video":"mediacall.incoming.audio",e=a?a+" "+$WC.I18N("mediacall.calling"):$WC.I18N(d);ChatBlink.start(e),!_WMSWINFOCUS&&WmsSettings.vmymessage==1&&$WC.DesktopNotification.show({title:a||"",body:$WC.I18N(d),icon:WmsContacts.getUserPhoto(c),checkownership:wmsnotifyowner,requireInteraction:!0,duration:WmsAVChat.AnswerCall.CLOSE_TIMEOUT,id:"call",onclick:WmsAVChat.AnswerCall.checkAndAcceptCall})}},WMSUI.imgPreview={images:[],curimgpos:-1,init:function(a,b){var c=a.querySelectorAll('img[data-previewable="true"]:not([data-rich="true"]) , div[data-unfurl="true"] , div[data-attachment="true"]');b.getAttribute("data-rich")==="true"&&(b=b.closest('[data-urlpreview="true"]').querySelector('div[data-unfurl="true"]')),WMSUI.imgPreview.getCurrentImgPosition(b,c),WMSUI.imgPreview.createOverlay(),WMSUI.imgPreview.bindevents(),WMSUI.imgPreview.getAndReplaceImageDetails(WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos])},getAndReplaceImageDetails:function(a){var b=a.getAttribute("data-fname")!=null?decodeURIComponent(a.getAttribute("data-fname")):"",c=a.getAttribute("data-fsize")!=null?a.getAttribute("data-fsize"):"",d=a.getAttribute("data-fsender"),e=a.getAttribute("data-fdate"),f=a.getAttribute("data-ftime"),g=a.getAttribute("data-fcomment"),h=a.getAttribute("data-dname"),i=a.getAttribute("data-fcontent"),j=a.getAttribute("data-src")||a.getAttribute("data-furl"),k=a.getAttribute("data-customimg"),l=a.getAttribute("data-filefrwrd"),m=a.getAttribute("data-isv1"),n='<span id="wms-imgpreviewfdate">'+$WC.Util.escapeHTML(e)+'</span> | <span id="wms-imgpreviewftime">'+$WC.Util.escapeHTML(f)+"</span>";n+=c?' | <span id="wms-imgpreviewfsize">'+$WC.Util.escapeHTML(c)+"</span>":"";if($WC.Util.isLocalUser(d))var o=$WC.I18N("Me");else o=$WC.Util.getContactName(d,h);var p=WMSUI.imgPreview.curimgpos+1,q=WMSUI.imgPreview.images.length,r=WMSUI.imgPreview.generateUI(),s="";a.getAttribute("originalsrc")?s=WMSUI.imgPreview.trimThumbnailImageUrl(a.getAttribute("originalsrc")):a.getAttribute("src")&&(s=WMSUI.imgPreview.trimThumbnailImageUrl(a.getAttribute("src"))),r+=k?"</div>":'<div id="wms-imgpreviewfinfo" class="wms-imgpreviewfinfo"><div id="wms-imgpreviewfname" class="wms-imgpreviewfname">{{FNAME}}</div><div class="wms-imgpreviewfdetails" id="wms-imgpreviewfdetails"></div></div></div>',r+=k?"":'<div id="wms-imgpreviewsenderinfo" class="wms-imgpreviewfsenderinfo"><div style="display:table-row"><div class="wms-imgpreviewuserinfo"><img src="{{SENDERPIC}}" class="wms-imgpreviewfsenderpic"><span id="wms-imgpreviewfsender" class="wms-imgpreviewfsender">{{FSENDERNAME}}</span><div id="wms-imgpreviewcomment" class="wms-imgpreviewcomment wms-truncate-ellipsis" title="{{COMMENT}}"><span id="wms-imgpreviewfcomment" class="wms-imgpreviewfcomment"></span></div></div><div id="wms-imgpreviewstatus" class="wms-imgpreviewstatus">{{IMGSTATUS}}</div><div class="wms-imgpreviewactions"><div class="wms-imgpreviewfdownload" data-fsize="{{FSIZE}}"><a id="wms-imgpreviewfdownload" target="_blank" href="{{IMGSRC}}" download="{{FNAME}}"></a></div>',r+=b&&l!=="false"?'<span class="wms-fileforwardimg" data-fcomment="{{COMMENT}}" data-fcontent="{{CONTENT}}" data-furl="{{URL}}" data-fname="{{FNAME}}" data-fsrc="{{IMGSRC}}" data-purpose="forward" data-isv1={{ISV1}} title="Forward"></span></div></div></div>':"</div></div></div>",r+='<span class="wms-imgpreviewclose" data-purpose="close"></span>',r=$WC.template.replace(r,{FNAME:b,FSIZE:c,FDATE:e,FTIME:f,COMMENT:g,$IMGSTATUS:["chat.imgpreview.status",[p,q]],FSENDERNAME:o,IMGSRC:s,SENDERPIC:_WMSPHOTOSERVER+"/file?ID="+d+"&t=user&width=38&height=38",CONTENT:i,URL:WMSUI.imgPreview.trimThumbnailImageUrl(j),ISV1:m}),document.getElementById("wms-imgpreviewcontainer").innerHTML=r,document.getElementById("wms-imgpreviewfdetails")&&(document.getElementById("wms-imgpreviewfdetails").innerHTML=n),g&&(document.getElementById("wms-imgpreviewfsender").style.margin="0px 0px 0px 15px",document.getElementById("wms-imgpreviewcomment").style.display="block",document.getElementById("wms-imgpreviewfcomment").insertAdjacentHTML("beforeend",$WC.Markdown.apply($WC.Util.safeHTML($WC.Util.unescapeHTML(g))))),q===1?(document.getElementById("wms-imgpreviewright").style.cursor="not-allowed",document.getElementById("wms-imgpreviewnext").style.display="none",document.getElementById("wms-imgpreviewprev").style.display="none",document.getElementById("wms-imgpreviewleft").style.cursor="not-allowed"):p===1?(document.getElementById("wms-imgpreviewleft").style.cursor="not-allowed",document.getElementById("wms-imgpreviewprev").style.display="none"):p===q&&(document.getElementById("wms-imgpreviewright").style.cursor="not-allowed",document.getElementById("wms-imgpreviewnext").style.display="none"),WMSUI.imgPreview.resize()},bindevents:function(){var a=document.getElementById("wms-imgpreviewcontainer");a.addEventListener("click",function(a){var b=a.target.getAttribute("data-purpose");b=="close"?WMSUI.imgPreview.removeOverlay():b=="nextimg"?WMSUI.imgPreview.next():b=="previmg"?WMSUI.imgPreview.prev():b=="forward"?(WMSUI.imgPreview.removeOverlay(),WmsFileForwardUI.handlePreview(a.target)):b=="startchat"&&(WMSUI.imgPreview.removeOverlay(),WmsHybridSearch.parseAndOpenChat(a.target))})},trimThumbnailImageUrl:function(a){var b=a,c=b.split("&"),d=b.split("/");return c.indexOf("x-cli-msg="+encodeURIComponent("{thumbnail:true}"))!==-1?(c.splice(c.indexOf("x-cli-msg="+encodeURIComponent("{thumbnail:true}")),1),b=c.join("&")):d.indexOf("thumbnail")!==-1&&(d.splice(d.indexOf("thumbnail"),1),b=d.join("/")),b},removeLoadingDiv:function(){var a=document.getElementById("wms_contactdetails_loadingdiv")||document.getElementById("wms_imagepreview_loadingdiv");a&&(a.style.display="none",a.className+=" wms-fadeOut")},cloneImgElement:function(a){var b=a.cloneNode(),c=a.getAttribute("originalsrc"),d=a.getAttribute("src"),e=a.getAttribute("style");return b.setAttribute("tempsrc",d),b.setAttribute("style","background:transparent"),c=c?WMSUI.imgPreview.trimThumbnailImageUrl(c):WMSUI.imgPreview.trimThumbnailImageUrl(d),c&&(b.style.visibility="hidden",b.src=c,b.onload=function(){WMSUI.imgPreview.removeLoadingDiv(),b.style.visibility="visible",this.removeAttribute("originalsrc"),WMSUI.loadedimg[c]=!0},b.onerror=function(){a.src=d,a.setAttribute("style",e),a.setAttribute("class","wms-hvalign wms-blurfilter"),a.setAttribute("originalsrc",c),a.setAttribute("class","wms-hvalign wms-blurfilter")}),b.removeAttribute("class"),b.setAttribute("id","wms-imgpreview"+WMSUI.imgPreview.curimgpos),b.setAttribute("width",a.getAttribute("data-fwidth")+"px"),b.setAttribute("height",a.getAttribute("data-fheight")+"px"),b},createOverlay:function(){if(document.getElementById("wms-imgpreviewcontainer")==null){var a=$WC.Util.createElement("div","wms-imgpreviewcontainer","wms-imgpreviewcontainer");a.style.zIndex=$WC.Config.get("zindex"),document.body.appendChild(a)}if(document.getElementById("wms-imgoverlay")==null){var b=$WC.Util.createElement("div","wms-imgoverlay","wms-imgoverlay");b.style.zIndex=$WC.Config.get("zindex"),document.body.insertBefore(b,document.getElementById("wms-imgpreviewcontainer"))}},generateUI:function(){return'<div id="wms-imgpreviewleft" class="wms-imgpreviewleft" data-purpose="previmg"></div><div id="wms-imgpreviewright" class="wms-imgpreviewright" data-purpose="nextimg"></div><div id="wms-imgpreviewnext" data-purpose="nextimg" class="wms-imgpreviewnext wms-valign-mid-block"><span class="wms-imgnext" data-purpose="nextimg"></span></div><div id="wms-imgpreviewprev" data-purpose="previmg" class="wms-imgpreviewprev wms-valign-mid-block"><span class="wms-imgprev" data-purpose="previmg"></span></div><div id="wms-imgpreviewholder" class="wms-imgpreviewholder"><div id="wms-imgpreviewlist" class="wms-imgpreviewlist"></div>'},resize:function(){var a=document.getElementById("wms-imgpreviewnext"),b=document.getElementById("wms-imgpreviewprev"),c;if(a&&b)if(document.getElementById("wms-imgpreview"+WMSUI.imgPreview.curimgpos))c=document.getElementById("wms-imgpreview"+WMSUI.imgPreview.curimgpos);else{c=WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos];var d=c.getAttribute("data-fname")&&c.getAttribute("data-fname").split(".")[c.getAttribute("data-fname").split(".").length-1];if(c.getAttribute("data-attachment")==="true"&&$WC.UrlPreview.isFileSupportedByCliq(c.getAttribute("data-fcontent"),d)){var e=function(a){a=JSON.parse(a);if(a.code===200){document.getElementById("wms-imgpreviewfinfo").style.display="block",WMSUI.imgPreview.removeLoadingDiv();var b=a.data.response;WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos].setAttribute("src",b),c=WMSUI.imgPreview.cloneImgElement(WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos]),WMSUI.imgPreview.populateUI(c)}else f()},f=function(){WMSUI.imgPreview.removeLoadingDiv(),document.getElementById("wms-imgpreviewfinfo").style.display="block",WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos].removeAttribute("src"),WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos].setAttribute("data-nopreview","true"),c=WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos],WMSUI.imgPreview.populateUI(c)};document.getElementById("wms-imgpreviewcontainer").insertAdjacentHTML("beforeend",'<span id="wms_imagepreview_loadingdiv" class="wms-hvalign wms_imagepreview_loadingdiv"></span>'),document.getElementById("wms-imgpreviewfinfo").style.display="none",$WC.Ajax.requestToChat("v1/attachments/"+c.getAttribute("data-fsrc")+"/preview","",e,f)}else c=WMSUI.imgPreview.cloneImgElement(WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos]),WMSUI.imgPreview.populateUI(c)}},getCurrentImgPosition:function(a,b){for(var c=0;c<b.length;c++)b[c+1]&&b[c+1].getAttribute("data-furl")==b[c].getAttribute("data-furl")&&b[c].getAttribute("src").startsWith("data:image")?a=b[c]===a?b[c+1]:a:(b[c].getAttribute("data-unfurl")||b[c].getAttribute("data-attachment")?WMSUI.imgPreview.images.push(WMSUI.imgPreview.getIframeNode(b[c])):WMSUI.imgPreview.images.push(b[c]),b[c]===a&&(WMSUI.imgPreview.curimgpos=WMSUI.imgPreview.images.length-1))},next:function(){WMSUI.imgPreview.curimgpos+1<WMSUI.imgPreview.images.length&&(WMSUI.imgPreview.curimgpos++,WMSUI.imgPreview.getAndReplaceImageDetails(WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos]))},prev:function(){WMSUI.imgPreview.curimgpos>0&&(WMSUI.imgPreview.curimgpos--,WMSUI.imgPreview.getAndReplaceImageDetails(WMSUI.imgPreview.images[WMSUI.imgPreview.curimgpos]))},populateUI:function(a){var b=window.innerWidth,c=window.innerHeight;document.getElementById("wms-imgpreviewsenderinfo")&&(c-=document.getElementById("wms-imgpreviewsenderinfo").clientHeight),document.getElementById("wms-imgpreviewfinfo")&&(c-=document.getElementById("wms-imgpreviewfinfo").clientHeight);if(a.nodeName=="IFRAME"||a.getAttribute("id")=="wms-nopreview")a.height=window.innerHeight*.8,a.width=window.innerWidth*.8;var d=a.width,e=a.height,f=400,g=300,h=0,i=0,j=document.getElementById("wms-imgpreviewholder");if(d>b||e>c){var k=[b/d,c/e];k=Math.min(k[0],k[1]),k<1&&(d*=k,e*=k)}f=d,g=e;var l=c/2-e/2,m=b/2-d/2;if(d<400||e<300)d<400&&(f=400),e<300&&(g=300),h=l,i=m,l=c/2-g/2,m=b/2-f/2;j.style.top=l+"px",j.style.left=m+"px",j.style.width=f+"px",j.style.height=g+"px";if(h!=0||i!=0)h-=l,i-=m;a.style.top=h+"px",a.style.left=i+"px",a.style.width=d+"px",a.style.height=e+"px",a.style.position="absolute",document.getElementById("wms-imgpreviewlist").appendChild(a),a.getAttribute("data-nopreview")==="true"&&a.nodeName=="IFRAME"&&(document.getElementById("wms-imgpreviewlist").querySelector('[data-nopreview="true"]').contentWindow.document.body.innerHTML='<div id="wms-nopreview" style=" display: flex;align-items: center;justify-content: center;background-color: #141414;border: 6px solid #fff;border-bottom: none;color: #fff;font-size: 20px;box-sizing: border-box;height:100%;width:100%;">'+$WC.I18N("chat.nopreview")+"</div>"),a.getAttribute("data-nopreview")!=="true"&&!WMSUI.isLoadedImg(a.getAttribute("src"))&&document.getElementById("wms-imgpreviewlist").insertAdjacentHTML("beforeend",'<span id="wms_contactdetails_loadingdiv" class="wms-hvalign wms_loading_div"></span>')},removeOverlay:function(){var a=document.getElementById("wms-imgoverlay"),b=document.getElementById("wms-imgpreviewcontainer");a&&b&&(document.body.removeChild(a),document.body.removeChild(b)),WMSUI.imgPreview.images.length&&(WMSUI.imgPreview.images.length=0)},handleKeyMovement:function(a){if(document.getElementById("wms-imgoverlay")!==null){var b=$WC.Util.getEventTarget(a);if(b.nodeName=="TEXTAREA"||b.type=="text"||b.id==="wms-filefrwrdrecipant")return!0;var c=window.event?a.keyCode:a.which;return c==39?WMSUI.imgPreview.next():c==37?WMSUI.imgPreview.prev():c==27&&WMSUI.imgPreview.removeOverlay(),!0}},getIframeNode:function(a){var b=document.createElement("div");b.innerHTML=a.getAttribute("src");var c={};a.getAttribute("data-attachment")==="true"?(c["data-fcontent"]=a.getAttribute("data-fcontent"),c["data-attachment"]=a.getAttribute("data-attachment"),c["data-fsrc"]=a.getAttribute("data-fsrc"),c["data-furl"]=a.getAttribute("data-furl"),c["data-filefrwrd"]=a.getAttribute("data-filefwd"),c["data-isv1"]=a.getAttribute("data-isv1")):(c["data-fsrc"]=b.childNodes[0].src,c["data-furl"]=b.childNodes[0].src),c.src=b.childNodes[0].src,c["data-fname"]=a.getAttribute("data-fname"),c["data-ftime"]=a.getAttribute("data-ftime"),c["data-fdate"]=a.getAttribute("data-fdate"),c["data-fsender"]=a.getAttribute("data-fsender"),c["data-dname"]=a.getAttribute("data-dname"),c.frameBorder="0";var d=$WC.Util.createElement("iframe","wms-url-preview",null,c);return d}};var WmsFileUploadHandler={live_file_uploads:{},islivefupExist:function(a){return this.live_file_uploads.hasOwnProperty(a)},getLivefupObj:function(a){return this.live_file_uploads[a]},handleAckReceived:function(a,b){this.islivefupExist(a)&&this.getLivefupObj(a).handleAckReceived(b)},addToPendingFilesList:function(a,b){this.islivefupExist(b.chat_id)&&(this.getLivefupObj(b.chat_id).pendingfiles[a]=b)},setReplyMsgId:function(a,b,c){var d=this.live_file_uploads[a];d&&d.filesdetails[c]&&(d.filesdetails[c].replyMsgUid=b)},addFileForUpload:function(a,b,c){this.islivefupExist(a)||(this.live_file_uploads[a]=new WmsFileUpload(a));var d=this.getLivefupObj(a);return d.addFileForUpload(b,c)},startNextFileUpload:function(a,b){this.startFileUpload(a,b)},startFileUpload:function(a,b){var c=function(a){var b=Object.keys(a);for(var c=0;c<b.length;c++)if(!a[b[c]].error)return b[c];return""};if(this.islivefupExist(a)){var d=this.getLivefupObj(a);if(Object.keys(d.filesdetails).length==1){var e=WindowHandler.getWinObjById(a);e.composer.value="",$WC.WmsSessionStorage.setChatInfo({chid:a,text:""}),e.changeFooterHeight()}if(!d.isAlreadyInProgress()){var f=c(d.filesdetails);if(!f)return;this.doPost(a,f,b),WmsFileUploadUI.toggleCancelButton(a,f)}}},trimFileName:function(a,b){if(a.length>b){var c=a.lastIndexOf("."),d=c>0?a.substring(c):"";d=d.length>b/2?d.substring(0,b/2):d,a=c>0?a.substring(0,c):a,a=a.substring(0,b-(d.length+1))+d}return a},doPost:function(a,b,c){var d=c.progresscallback,e=c.successcallback,f=c.errorcallback,g=this.getLivefupObj(a),h=g.getFileDetails(b),i=(new Date).getTime();g.uploaded==0&&(g.startingtime=(new Date).getTime());var j=this.trimFileName($WC.Matcher.replace("invalidfilenamechars",h.fileobj.name,"-"),WmsFileUploadUI.MAX_ALLOWED_FILE_NAME_LENGTH),k=WebMessanger.isUDSUploadEnabled(),l=new XMLHttpRequest,m="/"+_CHATCONT+"/v1/attachments";l.upload.addEventListener("progress",function(c){if(typeof d=="function")return d(c,a,b)},a),l.onreadystatechange=function(){if(l.readyState==4)if(l.status==200)WmsFileUploadHandler.cleanUpFileUpload(a,c,b,!0),typeof e=="function"&&e(a,b,l),this.startNextFileUpload(a,c);else{var d=function(a){return a&&!(a.getResponseHeader("x-error")||a.statusText==="abort"||a.status>=400&&a.status<500)};d(l)&&typeof f=="function"?(this.markAsError(a,b),f(a,b)):this.cleanUpFileUpload(a,c,b),this.startNextFileUpload(a,c)}}.bind(this);if(k){m=_UPLOADSERVERURL+"/webupload",l.open("POST",m,!0),l.withCredentials=!0;var n={"upload-id":a,"x-service":_UDS_CLIQ_SERVICE,"x-cliq-sid":WebMessanger.sid,"x-dfs-service":"zfs",charset:"UTF-8","x-streammode":"1","x-cliq-content-type":encodeURIComponent(h.fileobj.type),"file-name":encodeURIComponent(j),"Content-type":encodeURIComponent(h.fileobj.type)};for(var o in n)l.setRequestHeader(o,n[o]);h.comment&&l.setRequestHeader("x-cliq-comment",encodeURIComponent(h.comment)),h.replyMsgUid&&l.setRequestHeader("x-cliq-repliedmsguid",h.replyMsgUid)}else{if(h.comment){var p={};p[1]=h.comment,h.comment=p}l.open("POST",m,!0)}l.setRequestHeader("X-XHR-exception","true"),l.setRequestHeader("X-ZCSRF-TOKEN",$WC.Util.getCSRF()),h.startingtime=(new Date).getTime(),h.req=l,l.opts=h;var q=l.opts.fileobj;l.opts.id=i,l.opts.comment=h.comment,k?l.setRequestHeader("x-cliq-msgid",i):(q=g.getFormData(a,i,b),l.opts.comment?(q.append("comment",JSON.stringify(l.opts.comment)),q.append("files",l.opts.fileobj,"1_"+l.opts.fileobj.name)):q.append("files",l.opts.fileobj)),l.send(q),WmsFileUploadHandler.addToPendingFilesList(h.id,{chat_id:a,callbackobj:c,filename:b});var r=WindowHandler.getWinObjById(a);r&&r.closeReplyPreview(),WMSUI.imgPreview.removeOverlay(),WindowHandler.getWinObjById(a).composer.focus()},markAsError:function(a,b){if(this.islivefupExist(a)){var c=this.getLivefupObj(a);c.markAsError(b)}},cleanUpFileUpload:function(a,b,c,d){var e=!this.islivefupExist(a)||$WC.Util.isEmpty(c),f;!e&&this.islivefupExist(a)&&!$WC.Util.isEmpty(c)&&(f=this.getLivefupObj(a),f.removeFileFromUpload(c,d));if(e||f.getRemainingFilesCount()==0&&f.getPendingFilesCount()==0)!$WC.Util.isEmpty(b)&&typeof b.oncompletecallback=="function"&&b.oncompletecallback(a,null,!0),this.islivefupExist(a)&&(f=this.getLivefupObj(a),f.removeFileFromUpload(),delete this.live_file_uploads[a])},getFailFilesCount:function(a){if(this.islivefupExist(a)){var b=this.getLivefupObj(a);return b.getFailedFilesCount()}},resendFile:function(a,b,c,d){if(this.islivefupExist(a)&&b){var e=this.getLivefupObj(a);e.markForResend(b),this.startFileUpload(a,c,d)}}},WmsFileUpload=function(a){this.chid=a,this.uploadedfilecount=0,this.filesdetails={},this.total=0,this.uploaded=0,this.startingtime=(new Date).getTime(),this.failfilecount=0,this.pendingfiles={}};WmsFileUpload.prototype={getTotalFileCount:function(){return this.uploadedfilecount+$WC.Util.getObjectLength(this.filesdetails)},getSharingFilesCount:function(){var a=this.uploadedfilecount+1,b=this.getTotalFileCount();return a>b?b:a},getRemainingFilesCount:function(){return $WC.Util.getObjectLength(this.filesdetails)},getPendingFilesCount:function(){var a=0;for(var b in this.pendingfiles)this.pendingfiles[b].isuploaded&&a++;return a},getFileDetails:function(a){return a?this.filesdetails[a]:this.filesdetails},getFailedFilesCount:function(){return this.failfilecount},isReplyMessage:function(a){return this.filesdetails[a]&&this.filesdetails[a].replyMsgUid},getReplyMsgId:function(a){var b=this.filesdetails[a],c=b.replyMsgUid;return c},addFileForUpload:function(a,b){var c=this.getTotalFileCount(),d=a.name;if(!d){var e=a.type,f=e.substring(e.indexOf("/")+1,e.length);d=$WC.I18N("chat.file.upload")+$WC.DateUtil.formatTime(new Date)+"."+f,a.name=d}return d=d+"_"+c+"_"+$WC.DateUtil.formatTime(new Date),typeof this.filesdetails[d]=="undefined"&&(this.filesdetails[d]=[],this.filesdetails[d].fileobj=a,this.filesdetails[d].comment=b,this.filesdetails[d].uploaded=0,this.filesdetails[d].total=a.size,this.filesdetails[d].startingtime=(new Date).getTime(),this.filesdetails[d].req=null,this.filesdetails[d].progressing=!1,this.filesdetails[d].error=!1,this.total=this.total+a.size),d},isAlreadyInProgress:function(){for(var a in this.filesdetails)if(this.filesdetails[a].req!==null)return!0;return!1},markAsError:function(a){var b=this.filesdetails;if(!a||$WC.Util.isEmptyObject(b)||typeof b[a]=="undefined")return;var c=b[a];this.uploaded-=c.uploaded,c.req=null,c.error=!0,this.failfilecount++},removeFileFromUpload:function(a,b){var c=this.filesdetails;if(!a){var d={};this.failfilecount=0;for(var e in c)typeof c[e]!="undefined"&&c[e].req!==null?d[e]=c[e]:delete this.filesdetails[e];for(var f in d)d[f].req.abort(),delete this.filesdetails[f]}else if(!$WC.Util.isEmptyObject(c)&&typeof c[a]!="undefined"){var g=c[a].req,h=c[a].fileobj.size-c[a].uploaded;g!==null&&!b&&(g.status!==0||g.statusText!=="abort")&&c[a].req.abort(),this.uploadedfilecount+=b?1:0,this.failfilecount-=c[a].error?1:0,this.uploaded=this.uploaded+(h>0?h:0),delete this.filesdetails[a]}},markForResend:function(a){var b=this.filesdetails;if(!a||$WC.Util.isEmptyObject(b)||!b[a]||!b[a].error)return;b[a].error=!1,b[a].uploaded=0,this.failfilecount--},updateProgressDetails:function(a,b){b>this.filesdetails[a].uploaded&&(this.uploaded=this.uploaded+(b-this.filesdetails[a].uploaded),this.filesdetails[a].uploaded=b)},getFormData:function(a,b,c){var d={id:a,sid:WebMessanger.getSid()};this.getTotalFileCount()===1&&b&&(d.msgid=b);var e=this.getReplyMsgId(c);e&&(d.repliedmsguid=e);if(typeof FormData!="undefined"){var f=new FormData;for(var g in d)f.append(g,d[g]);return f}},handleAckReceived:function(a){if(this.pendingfiles[a]){var b=this.pendingfiles[a],c=b.chat_id,d=b.filename;delete this.pendingfiles[a],WmsFileUploadUI.cleanUpFileUpload(c,b.callbackobj,d,!0,!1)}}};var WmsFileUploadUI={zomojicomponent:new $WC.ZomojiComponent,zomojicomponentvisible:!1,chidvsfiles:{},MAX_ALLOWED_FILE_SIZE:52428800,MAX_ALLOWED_FILE_NAME_LENGTH:100,handlePreview:function(a,b){if(!this.validateInput(a,b))return;WMSUI.imgPreview.createOverlay(),this.showPreview(a,b)},validateInput:function(a,b){return $WC.Util.isFile(b[0])&&$WC.Util.isFilesizeExceeded(b,WmsFileUploadUI.MAX_ALLOWED_FILE_SIZE)?(this.resetForm(a),!1):!0},resetForm:function(a){delete this.chidvsfiles[a];var b=document.getElementById(a).querySelector("#formsend");b.reset()},showPreview:function(a,b){$WC.Util.isEmpty(this.chidvsfiles[a])||(b=Array.prototype.slice.call(b).concat(this.chidvsfiles[a]));var c=b.length==1?"wms-fileupldcontainer1":"wms-fileupldcontainer",d=b.length==1?"wms-fileupldcnt1 wms-fileupldpreview":"wms-fileupldpreview",e=b.length==1?"style=display:none":"",f=this.getFileUploadWindowHTML();f=$WC.template.replace(f,{$SHAREINFO:["share.file.user",$WC.Util.unescapeHTML(WindowHandler.getWinObjById(a).title)],PREVIEWCLASS:c}),document.getElementById("wms-imgpreviewcontainer").innerHTML=f;var g=this.fillFileDetails(a,b);g=$WC.template.replace(g,{UPLOADCLASS:d,STYLE:e}),document.getElementById("wms-fileupldcontainer").innerHTML=g;for(var h=0;h<b.length;h++){var i=document.getElementById("wms-fileupldpreview"+h);this.setPreview(i,b[h])}b.length==1&&(document.getElementById("wms-fileupldcontainer").querySelector("#wms-fileupldcmt").value=WindowHandler.getWinObjById(a).composer.value),document.getElementById("wms-fileupldcmt").focus(),this.bindEvents(a),this.chidvsfiles[a]=Array.prototype.slice.call(b)},getFileUploadWindowHTML:function(){return'<div id="wms-fileupldwin" class="wms-fileupldwin wms-hvalign"><div id="wms-fileupldwinheader" class="wms-fileupldwinheader">{{SHAREINFO}}<span class="wms-fileupldclose" data-purpose="cancel"></span></div><div id="wms-fileupldwinbody" class="wms-fileupldwinbody"><div id="wms-filefrwrderrormsg" class="wms-fileuploaderror"></div><div id="wms-fileupldcontainer" class="{{PREVIEWCLASS}}">FILESLIST</div><div class="wms-fileupldactions"><input type="button" data-purpose="cancel" value="Cancel" class="wms-fileupldcancel"><input type="button" id="wms-fileupload" data-purpose="upload" value="Upload" class="wms-fileupld"></div></div></div>'},fillFileDetails:function(a,b){var c="",d="",e,f;for(var g=0;g<b.length;g++){f=WindowHandler.getWinObjById(a).salesiqchat?" wms_filecomment_hide":"",c+=this.getFileHTML(),e=b[g].name&&this.validateAndReplaceFilename("replace",b[g].name),e||(e=$WC.I18N("chat.file.upload")+$WC.DateUtil.formatTime(new Date));var h=e.lastIndexOf(".");h!=-1?d=e.substring(h):h=e.length,e=e.substring(0,h),c=$WC.template.replace(c,{FNAME:e,FEXTN:d,INDEX:g,HIDEFILECOMMENT:f})}return c},setPreview:function(a,b){if($WC.Matcher.check("imagemimetype",b.type)){var c=new FileReader;c.onload=function(b){var c='<img src="'+b.target.result+'">';a.innerHTML=c},c.readAsDataURL(b)}else $WC.Util.addClass(a,"wms_fileupldbg"),a.innerHTML='<span class="wms-fileimgpreview wms-hvalign"></span>'},getFileHTML:function(){return this.checkSupport()?'<div data-fileindex="{{INDEX}}" data-fextn="{{FEXTN}}" data-type="file" class="{{UPLOADCLASS}}"><input class="wms-fileupldfname" id="wms-fileupldfname" data-purpose="fileupload" value="{{FNAME}}"><span class="wms-fileupldcls" {{STYLE}} data-purpose="close"></span><div id="wms-fileupldpreview{{INDEX}}" class="wms-fileupldimgpreview"></div><div class="wms-smileycontainer wms-fileupldsmileycon" data-smileycontainer="true"></div><div id="wms-footer" class="wms-footer{{HIDEFILECOMMENT}}"><textarea id="wms-fileupldcmt" data-purpose="keyupload" placeholder="'+$WC.I18N("file.upload.comment")+'" class="wms-fileupldcmt"></textarea>'+'<div class="wms-filecmntcount" data-limit="1000">1000</div>'+'<div id="wms-smileyinvoker" class="wms-smileyinvoker wms-fileupldsmileyinvoker" data-purpose="smiley"></div>'+"</div>"+"</div>":'<div data-fileindex="{{INDEX}}" data-fextn="{{FEXTN}}" data-type="file" class="{{UPLOADCLASS}}"><input class="wms-fileupldfname" id="wms-fileupldfname" style="height:10%" value="{{FNAME}}" disabled><div id="wms-fileupldpreview{{INDEX}}" class="wms-fileupldimgpreview" style="height:90%"></div></div>'},validateAndReplaceFilename:function(a,b){var c=/[`~!$%^&|\\"<>?/]/g;if(a==="check")return c.test(b)||!b;if(a==="replace")return b.replace(c,"-")},checkSupport:function(){if(typeof (new XMLHttpRequest).upload!="undefined"&&typeof (new FormData)!="undefined")return!0},handleSmileyClick:function(a){var b=a.target.parentNode.parentNode,c=b.querySelector("[data-smileycontainer]");this.zomojicomponentvisible?(this.zomojicomponentvisible=!1,this.zomojicomponent.unmountComponent(),c.style.border="none"):(c.style.border="1px solid rgb(224, 224, 224)",this.zomojicomponent.mountComponent(c,!0,function(a,b){WmsFileUploadUI.updateSmiley(a,b)}),this.zomojicomponentvisible=!0)},updateSmiley:function(a,b){var c=null;if(document.getElementById("wms-fileupldwin")){var d=$WC.Util.getEventTarget(b),e=d.closest('[data-type="file"]');c=e.getElementsByClassName("wms-fileupldcmt")[0]}Smiley.updateSmiley(c,a)},handleClose:function(a,b){var c=a.parentNode;c.remove();var d=c.getAttribute("data-fileindex");this.chidvsfiles[b].splice(parseInt(d),1);var e=document.getElementById("wms-fileupldcontainer"),f=e.querySelectorAll('[data-type="file"]'),g=f.length;for(var h=0;h<g;h++)f[h].setAttribute("data-fileindex",h);g==1&&(e.className="wms-fileupldcontainer1",e.children[0].className="wms-fileupldcnt1 wms-fileupldpreview",f[0].querySelector('[class="wms-fileupldcls"]').setAttribute("style","display:none"))},bindEvents:function(a){var b=document.getElementById("wms-fileupldwin");b.addEventListener("click",function(c){var d=c.target.getAttribute("data-purpose");if(d==="upload")this.checkSupport()?this.uploadFile(a):WMSUI.iframeUpload(a);else if(d==="cancel")WMSUI.imgPreview.removeOverlay(),this.resetForm(a);else if(d==="close")this.handleClose(c.target,a);else if(d=="smiley")this.handleSmileyClick(c);else if(d!=="search"&&this.zomojicomponentvisible){var e=b.querySelectorAll("[data-smileycontainer]");for(var f=0;f<e.length;f++)e[f].style.border="none";this.zomojicomponent.unmountComponent(),this.zomojicomponentvisible=!1}}.bind(this)),b.addEventListener("keydown",function(b){var c=b.target.getAttribute("data-purpose");c=="keyupload"&&b.keyCode==13&&(b.ctrlKey||b.metaKey)&&(this.uploadFile(a),b.preventDefault())}.bind(this)),b.addEventListener("keyup",function(b){b.keyCode==27?b.target.value?(b.target.value="",this.updateCommentCount(b.target)):(WMSUI.imgPreview.removeOverlay(),this.resetForm(a)):b.target.getAttribute("data-purpose")!="search"&&this.updateCommentCount(b.target)}.bind(this)),b.addEventListener("focusin",function(a){var b=a.target.getAttribute("data-purpose");if(b=="fileupload"){var c=this.getElementsByClassName("wms-fileupldfname");for(var d=0;d<c.length;d++)c[d].setAttribute("style","border-color: transparent");document.getElementById("wms-filefrwrderrormsg").setAttribute("style","display:none")}}.bind(this))},updateCommentCount:function(a){var b=a.parentNode.querySelector("[data-limit]"),c=a.value.length,d=b.getAttribute("data-limit"),e=d-c;e<10?$WC.Util.addClass(b,"wms_cntred"):$WC.Util.removeClass(b,"wms_cntred"),e<0?a.value=a.value.substring(0,d):$WC.$CUtil.setInnerText(b,e)},setAndClearReplyMsg:function(a,b){var c=WindowHandler.getWinObjById(a),d=c.getReplyMessageId();$WC.Util.isEmpty(d)||WmsFileUploadHandler.setReplyMsgId(a,d,b),c&&c.closeReplyPreview()},uploadFile:function(a){var b=this.chidvsfiles[a],c=document.getElementById("wms-fileupldcontainer"),d=c.querySelectorAll('[data-type="file"]'),e=WindowHandler.getWinObjById(a);if(e&&e.salesiqchat){WmsUIImpl.uploadFile(b,this.getCommentsDetails(d),a),this.resetForm(a),WMSUI.imgPreview.removeOverlay(),e.composer.focus();return}for(var f=0;f<b.length;f++){var g=d[f].querySelector('[id="wms-fileupldcmt"]').value,h=b[f],i=WmsFileUploadHandler.addFileForUpload(a,h,g);this.setAndClearReplyMsg(a,i)}var j=this.getCallBackObject();WmsFileUploadHandler.startFileUpload(a,j),this.resetForm(a),WMSUI.imgPreview.removeOverlay(),e.composer.focus(),this.addProgressBarForEachFile(a,j)},getCallBackObject:function(){return{progresscallback:this.handleProgress,successcallback:this.handlesuccess,errorcallback:this.errorUploadProgress,oncompletecallback:this.clearUploadProgress}},toggleCancelButton:function(a,b){if(!$WC.Util.isEmpty(a)){var c=WindowHandler.getWinObjById(a).progressbarnode;if(!$WC.Util.isEmpty(b)&&WmsFileUploadHandler.islivefupExist(a)){c.querySelector('[data-purpose="uploadcancel"]').display="none";var d=c.querySelector('[data-filename="'+b+'"]');WmsFileUploadHandler.getLivefupObj(a).getTotalFileCount()>1&&d&&(d.querySelector('[data-purpose="close"]').display="none")}}},addProgressBarForEachFile:function(a){var b=WmsFileUploadHandler.getLivefupObj(a),c=b.getFileDetails(),d="",e=WindowHandler.getWinObjById(a).progressbarnode;if(b.getTotalFileCount()>1){var f='<div  class="wms_uploaddetails {{FAIL}}" data-filename="{{FILENAME}}"><div class="wms_uploadprogress"><div class="wms_uploadfiledetails"><span class="wms_uploadfilename" title="{{FILE_DISPLAY_NAME}}">{{FILE_DISPLAY_NAME}}</span><span class="wms_file_errorinfo"></span></div><div class="wms_uploadprogresswrapper"><div id="wmsloadingtxt" class="wms-loading-sub" data-progressindicator="true"></div></div></div><div class="wms_uploadicons"><span data-purpose="resend" data-filename="{{FILENAME}}" title="Retry" class="wms_fileupld_resend"></span><span data-purpose="close" data-filename="{{FILENAME}}" title="Cancel" class="wms_fileupld_close"></span></div></div>';for(var g in c){var h=e.querySelector('[data-filename="'+g+'"]');if(!h){var i=c[g];d+=$WC.template.replace(f,{FILE_DISPLAY_NAME:$WC.Util.safeHTML(i.fileobj.name)+this.getFileSizeForDisplay(i),FAIL:i.error?"sending-failed":"",FILENAME:g})}}var j=e.querySelector('[id="wms_expandfilescontainer" ]');j.insertAdjacentHTML("beforeend",d)}this.updateUploadProgressBarContainer(e,a,b)},getFileSizeForDisplay:function(a){return" - ("+$WC.Util.getFileSize(a.fileobj.size)+")"},cleanUpFileUpload:function(a,b,c,d,e){WmsFileUploadHandler.cleanUpFileUpload(a,b,c,d),this.clearUploadProgress(a,c,d,e)},resendFile:function(a,b,c){if(!a||!b)return;WmsFileUploadHandler.resendFile(a,b,this.getCallBackObject()),this.handleResend(a,b,c)},resendAllFiles:function(a){if(WmsFileUploadHandler.islivefupExist(a)){var b=WmsFileUploadHandler.getLivefupObj(a),c=b.filesdetails,d=WindowHandler.getWinObjById(a).progressbarnode;for(var e in c)this.resendFile(a,e,d)}},handleResend:function(a,b,c){if(!a)return;var d=WmsFileUploadHandler.getFailFilesCount(a);c=c||WindowHandler.getWinObjById(a).progressbarnode;var e=c.querySelector('[data-filename="'+b+'"]');b&&e&&$WC.Util.removeClass(e,"wms_sending_failed");var f=d?$WC.I18N("common.file.fail",[d]):"";f=d===1?$WC.I18N("common.singlefile.fail"):f,$WC.$CUtil.setInnerText(c.querySelector('[id="wms_failcountbar"]'),f),d||$WC.Util.removeClass(c.querySelector('[data-purpose="filecontainer" ]'),"wms_sending_failed")},handleProgress:function(a,b,c){if(a.lengthComputable){var d=WmsFileUploadHandler.getLivefupObj(b);if(!$WC.Util.isEmpty(d)&&!$WC.Util.isEmptyObject(d)&&d.getTotalFileCount()>0&&typeof d.getFileDetails(c)!="undefined"){var e=d.getFileDetails();if(!$WC.Util.isEmpty(e[c])){d.updateProgressDetails(c,a.loaded);var f=e[c],g={uploaded:f.uploaded,total:f.total,fup:d};WmsFileUploadUI.updateUploadprogressBar(b,g,c)}}}},updateUploadprogressBar:function(a,b,c){var d=WindowHandler.getWinObjById(a);if(d){var e=d.progressbarnode,f=e.querySelector("[data-progressindicator]"),g=b.fup,h=function(a,b){var c=a/b*(100/g.getTotalFileCount());return c+=(g.getTotalFileCount()-g.getRemainingFilesCount())*(100/g.getTotalFileCount()),c&&c>100?100:Math.round(c)},i=h(g.uploaded,g.total)/100;f.style.transform="scaleX("+i+")";if(g.getTotalFileCount()>1){i=(b.uploaded/b.total).toFixed(2);var j=e.querySelector('[data-filename="'+c+'"]');if(j){var k=j.querySelector("[data-progressindicator]");k.style.transform="scaleX("+i+")"}}}},updateUploadProgressBarContainer:function(a,b,c){c=$WC.Util.isEmpty(c)?WmsFileUploadHandler.getLivefupObj(b):c;var d=a.querySelector('[id="wms_failcountbar"]');if(!$WC.Util.isEmpty(c)){var e=Object.keys(c.getFileDetails())[0];if(!$WC.Util.isEmpty(e)){var f=a.querySelector('[id="wms_fileexpandicon"]'),g=a.querySelector("[data-progresstext]");if(c.getTotalFileCount()==1){var h=c.getFileDetails(e);g.innerHTML=$WC.I18N("chat.file.sharing",["<b>"+$WC.Util.safeHTML(h.fileobj.name)+"</b>",this.getFileSizeForDisplay(h)]),$WC.Util.removeClass(f,"wms_fileupld_shrink"),$WC.Util.addClass(f,"wms_fileupld_expand"),f.setAttribute("title",$WC.I18N("common.expand")),f.setAttribute("data-purpose","expand"),f.style.display="none",a.querySelector("[data-progressholder]").style.display="block",a.querySelector('[id="wms_expandfilescontainer"]').style.display="none"}else g.innerHTML=$WC.I18N("chat.files.sharing",["<b>"+c.getSharingFilesCount()+"</b>","<b>"+c.getTotalFileCount()+"</b>"]),f.style.display="block",d.style.display="block";a.style.display="block"}}else a.querySelector("[data-progressindicator]").style="",d.style.display="none"},handlesuccess:function(a,b,c){var d=WmsFileUploadHandler.getLivefupObj(a);d&&d.pendingfiles.hasOwnProperty(c.opts.id)&&(d.pendingfiles[c.opts.id].isuploaded=!0),WmsFileUploadUI.clearUploadProgress(a,b)},clearUploadProgress:function(a,b,c,d){var e=WindowHandler.getWinObjById(a).progressbarnode,f=e.querySelector('[id="wms_expandfilescontainer"]'),g=e.querySelector('[id="wms_fileexpandicon"]'),h,i,j=e.querySelector('[data-filename="'+b+'"]');if(b&&j){var k=j.querySelector('[data-purpose="close"]');if(c){d||($WC.Util.removeClass(k,"wms_fileupld_close"),$WC.Util.addClass(k,"wms_fileupld_sel"),k.style.display="block"),h=f.getBoundingClientRect().height;var l=WmsFileUploadHandler.getLivefupObj(a);l?setTimeout(function(){var a=l.getRemainingFilesCount()+l.getPendingFilesCount(),b=a*(j.getBoundingClientRect().height+4)>h?h:a*(j.getBoundingClientRect().height+4);$WC.Util.animate(f,"height",h,b),!b&&$WC.Util.getObjectLength(l.filedetails)==0&&(f.innerHTML="",f.style.border="none",f.style.padding="0px",WmsFileUploadUI.toggleExpandContainerIcon(g),e.querySelector("[data-progressindicator]").style.display="block"),j.style.display="none",k.style.display="none"},1e3):(e.style.display="none",f.innerHTML="",f.style="",WmsFileUploadUI.toggleExpandContainerIcon(g))}else k.style.display="none"}else c&&(i=function(){f.innerHTML="",f.style.border="none",f.style.padding="0px"},h=f.getBoundingClientRect().height,$WC.Util.animate(f,"height",h,0,i),WmsFileUploadUI.toggleExpandContainerIcon(g),e.querySelector("[data-progressindicator]").style.display="block",e.style.display="none");WmsFileUploadUI.handleResend(a,b,e),WmsFileUploadUI.updateUploadProgressBarContainer(e,a),WmsFileUploadUI.toggleCancelButton(a,b,!0)},toggleExpandContainerIcon:function(a){a.style.display!=="none"&&($WC.Util.removeClass(a,"wms_fileupld_shrink"),$WC.Util.addClass(a,"wms_fileupld_expand"),a.setAttribute("data-purpose","expand"),a.setAttribute("title",$WC.I18N("common.expand")))},errorUploadProgress:function(a,b){var c=WindowHandler.getWinObjById(a).progressbarnode,d=c.querySelector('[id="wms_failcountbar"]'),e=WmsFileUploadHandler.getLivefupObj(a);$WC.Util.addClass(c.querySelector('[data-purpose="filecontainer" ]'),"wms_sending_failed"),d.innerHTML=e.getTotalFileCount()==1?$WC.I18N("common.singlefile.fail"):$WC.I18N("common.file.fail",[WmsFileUploadHandler.getFailFilesCount(a)]),d.style.display="block",b&&c&&$WC.Util.addClass(c.querySelector('[data-filename="'+b+'"]'),"wms_sending_failed"),WmsFileUploadUI.toggleCancelButton(a,b,!0)},expandFilesContainer:function(a,b){var c=WindowHandler.getWinObjById(a).progressbarnode,d=c.querySelector('[id="wms_expandfilescontainer"]'),e=c.querySelector('[id="wms_fileexpandicon"]'),f=c.querySelector("[data-progressindicator]"),g,h;b==="expand"?(d.style="",d.style.display="block",h=function(){setTimeout(function(){d.style.overflowY="auto"},500)},g=d.getBoundingClientRect().height,$WC.Util.animate(d,"height",0,g,h),$WC.Util.removeClass(e,"wms_fileupld_expand"),$WC.Util.addClass(e,"wms_fileupld_shrink"),e.setAttribute("title",$WC.I18N("common.collapse")),e.setAttribute("data-purpose","collapse"),f.style.display="none"):(h=function(){setTimeout(function(){d.style.border="none",d.style.padding="0px"},500)},d.style.overflow="hidden",g=d.getBoundingClientRect().height,$WC.Util.animate(d,"height",g,0,h),$WC.Util.removeClass(e,"wms_fileupld_shrink"),$WC.Util.addClass(e,"wms_fileupld_expand"),e.setAttribute("title",$WC.I18N("common.expand")),e.setAttribute("data-purpose","expand"),f.style.display="block")},handlePaste:function(a){var b=a.target.getAttribute("chid"),c=[],d=WindowHandler.getWinObjById(b),e=(a.originalEvent||a).clipboardData;if(e){var f=e.items;if(f){for(var g=0;g<f.length;g++)$WC.Matcher.check("imagemimetype",f[g].type)&&f[g].getAsFile()!==null&&c.push(f[g].getAsFile());c.length!==0&&!d.restrict_file_upload&&(WmsFileUploadUI.handlePreview(b,c),document.getElementById("wms-fileupldcmt").focus())}}},getCommentsDetails:function(a){var b={};b.comments={};for(var c=0;c<a.length;c++){var d=parseInt(a[c].getAttribute("data-fileindex")),e=a[c].querySelector('[id="wms-fileupldcmt"]').value;e&&(b.comments[d+1]=e.trim())}return b}},WmsFileForwardUI={handlePreview:function(a){WMSUI.imgPreview.createOverlay();var b=this.getWindowHTML();document.getElementById("wms-imgpreviewcontainer").innerHTML=b,document.getElementById("wms-filefrwrdrecipant").focus(),a.getAttribute("data-filefrwrd")=="true"&&!a.getAttribute("src")&&a.closest("#wms-videoplayer")&&(a=a.closest("#wms-videoplayer")),this.fill(a),this.bindEvents()},getWindowHTML:function(){return'<div id="wms-fileupldwin" class="wms-fileupldwin wms-hvalign"><div id="wms-fileupldwinheader" class="wms-fileupldwinheader">'+$WC.I18N("file.forward")+'<span class="wms-fileupldclose" data-purpose="cancel"></span>'+"</div>"+'<div id="wms-fileupldwinbody" class="wms-fileupldwinbody wms_filefrwrdwinbody">'+'<div id="wms-filefrwrderrormsg" class="wms-filefrwrderror"></div>'+"<span>"+'<div class="wms_filefrwrd_info">'+$WC.I18N("file.forward.to")+":</div>"+'<div id="wms-filefrwrdrecipant" data-type="contact" contenteditable="true" class="wms-filefrwrdrecipant" data-purpose="selectrecipant" placeholder="'+$WC.I18N("fileforward.select.recipient")+'"></div>'+'<div id="wms_filefrwrdsugg_wrapper" class="wms_filefrwrdsugg_wrapper">'+'<div class="wms_filefrwrdsugg_container">'+'<span class="wms_filefrwrdsugg_info">'+$WC.I18N("file.forward.suggestions")+"</span>"+'<div class="wms_filefrwrdsugg">'+this.getSuggestionsHTML()+"</div>"+"</div>"+"</div>"+'<div id="wms-selrecipant" class="wms-filefrwrdrecipant" style="display:none"></div>'+'<div id="wms-filefrwrdautocomplete" class="wms-filefrwrdautocomplete" style="display:none"></div>'+'<div id="wms-fileupldcontainer" class="wms-filefrwrdwinbody"></div>'+'<div class="wms-fileupldactions wms_filefrwrdactions">'+'<input type="button" data-purpose="cancel" value="Cancel" class="wms-fileupldcancel">'+'<input type="button" data-purpose="forwardfile" id="wms-fileforward" value="Forward" class="wms-fileupld">'+"</div>"+"</span>"+"</div>"+"</div>"},getSuggestionsHTML:function(){var a=$WC.HybridSearch.filter("DNAME","",WmsContacts.getContactsList(),5,"","EMAILID"),b="",c='<img title="{{DNAME}}" data-dname="{{DNAME}}" data-type="'+$WC.WmsConstants.HYBRIDSEARCH.CONTACT+'" data-id="{{USERID}}" data-purpose="usersugg" src="{{WMSPHOTOSERVER}}/file?ID={{USERID}}&exp=6000&t=user&fs=thumb">';return a.forEach(function(a){b+=$WC.template.replace(c,{DNAME:a.DNAME,USERID:a.USERID,WMSPHOTOSERVER:_WMSPHOTOSERVER})}),b},getFileHTML:function(){return WmsFileUploadUI.checkSupport()?'<div data-type="file" data-fextn="{{FEXTN}}" data-content="{{CONTENT}}" data-url="{{URL}}" data-isv1={{ISV1}} class="wms-filefrwrdcnt1 wms-fileupldpreview"><input class="wms-fileupldfname" id="wms-fileupldfname" data-purpose="forwardfilename" placeholder="'+$WC.I18N("file.add.name")+'" value="{{FNAME}}">'+'<div id="wms-fileupldpreview" class="wms-fileupldimgpreview"></div>'+'<div class="wms-smileycontainer wms-filefrwrdsmileycon" data-smileycontainer="true"></div>'+'<div id="wms-footer" class="wms-footer">'+'<textarea id="wms-fileupldcmt" data-purpose="keyforward" placeholder="'+$WC.I18N("file.forward.comment")+'" class="wms-fileupldcmt"></textarea>'+'<div class="wms-filecmntcount" data-limit="1000">1000</div>'+'<div id="wms-smileyinvoker" class="wms-smileyinvoker wms-fileupldsmileyinvoker" data-purpose="smiley"></div>'+"</div>"+"</div>":'<div data-type="file" data-fextn="{{FEXTN}}" data-content="{{CONTENT}}" data-url="{{URL}}" data-isv1={{ISV1}} class="wms-filefrwrdcnt1 wms-fileupldpreview"><input class="wms-fileupldfname" id="wms-fileupldfname" placeholder="'+$WC.I18N("file.add.name")+'" style="height:10%" value="{{FNAME}}">'+'<div id="wms-fileupldpreview" class="wms-fileupldimgpreview" style="height:90%"></div>'+"</div>"},fill:function(a){var b="",c="",d=a.getAttribute("data-fcomment")!=="null"?a.getAttribute("data-fcomment"):"",e=a.getAttribute("data-fsrc")||a.src,f=a.getAttribute("data-fcontent"),g=a.getAttribute("data-src")||a.getAttribute("data-furl"),h=a.getAttribute("data-fname"),i=a.getAttribute("data-isv1"),j=h.lastIndexOf(".");j!=-1?c=h.substring(j):j=h.length,h=h.substring(0,j);var k=this.getFileHTML();k=$WC.template.replace(k,{FNAME:h,FEXTN:c,COMMENT:d,URL:g,CONTENT:f,ISV1:i});var l=document.getElementById("wms-fileupldcontainer");l.innerHTML=k;var m=document.getElementById("wms-fileupldpreview");d&&(l.querySelector("#wms-fileupldcmt").value=d),/^image\/.+$/.test(f)?b="<img src="+e+">":(b='<span class="wms-fileimgpreview wms-hvalign"></span>',$WC.Util.addClass(m,"wms_fileupldbg")),m.innerHTML=b},bindEvents:function(){var a=document.getElementById("wms-fileupldwin");a.addEventListener("click",function(b){var c=a.querySelector("[data-smileycontainer]"),d=$WC.Util.getEventTarget(b),e=d.getAttribute("data-purpose");e=="forwardfile"?this.createChatAndForward():e=="cancel"?WMSUI.imgPreview.removeOverlay():e=="selectrecipant"||e=="keyforward"?(e=="keyforward"&&(WmsFileUploadUI.zomojicomponentvisible&&(WmsFileUploadUI.zomojicomponent.unmountComponent(),WmsFileUploadUI.zomojicomponentvisible=!1,c.style.border="none"),this.closeRecipientList()),document.getElementById("wms-filefrwrderrormsg").setAttribute("style","display:none"),$WC.Util.removeClass(document.getElementById("wms_filefrwrdsugg_wrapper"),"wms_filefrwrderr")):e=="smiley"?WmsFileUploadUI.zomojicomponentvisible?(WmsFileUploadUI.zomojicomponent.unmountComponent(),WmsFileUploadUI.zomojicomponentvisible=!1,c.style.border="none"):(c.style.border="1px solid rgb(224, 224, 224)",WmsFileUploadUI.zomojicomponent.mountComponent(c,!0,function(a,b){WmsFileUploadUI.updateSmiley(a,b)}),WmsFileUploadUI.zomojicomponentvisible=!0):e=="usersugg"?this.insertSuggestion(b):e=="delsugg"?this.removeSuggestion(b):d.closest("[data-id]")?this.insertSuggestion(b):e!=="search"&&WmsFileUploadUI.zomojicomponentvisible&&(c.style.border="none",WmsFileUploadUI.zomojicomponent.unmountComponent(),WmsFileUploadUI.zomojicomponentvisible=!1,this.closeRecipientList())}.bind(this)),a.addEventListener("keyup",function(a){var b=$WC.Util.getEventTarget(a),c=b.getAttribute("data-purpose"),d=document.getElementById("wms-filefrwrdautocomplete");c=="selectrecipant"?a.keyCode==40||a.keyCode==38?this.handleNavigation(a):a.keyCode==13?(b=this.getSelectedRecipient(),this.insertSuggestion(b,!0)):a.keyCode==27?b.textContent==""?WMSUI.imgPreview.removeOverlay():d.style.display==="block"?this.closeRecipientList():b.textContent="":this.populateRecipant():a.keyCode==27?b.value?(b.value="",WmsFileUploadUI.updateCommentCount(b)):WMSUI.imgPreview.removeOverlay():c!=="search"&&WmsFileUploadUI.updateCommentCount(b)}.bind(this)),a.addEventListener("keydown",function(a){var b=$WC.Util.getEventTarget(a),c=b.getAttribute("data-purpose");c=="keyforward"?a.keyCode==13&&(a.ctrlKey||a.metaKey)&&this.createChatAndForward():c=="selectrecipant"&&a.keyCode==13&&a.preventDefault()}.bind(this)),a.addEventListener("mouseover",function(a){var b=$WC.Util.getEventTarget(a),c=b.closest("[data-id]");if(c&&c.className.indexOf("wms_menu_item")==0){var d=document.getElementById("wms-filefrwrdautocomplete").getElementsByClassName("wms-hysearch-result-hover")[0];d&&$WC.Util.removeClass(d,"wms-hysearch-result-hover"),$WC.Util.addClass(c,"wms-hysearch-result-hover")}}.bind(this))},createChatAndForward:function(){var a,b=document.getElementById("wms-filefrwrdrecipant"),c=document.getElementById("wms-fileupldcontainer").querySelector('[data-type="file"]'),d=document.getElementById("wms-fileupldfname").value;if(document.getElementById("wms-fileupldcmt")){var e=document.getElementById("wms-fileupldcmt").value.trim();e=Smiley.replaceTextToEnglishCodes(e)}if(this.validate(d,e,b))return;var f=b.getAttribute("data-type"),g=f==$WC.WmsConstants.HYBRIDSEARCH.CONTACT||f==$WC.WmsConstants.HYBRIDSEARCH.ORGCONTACT?"im":f==$WC.WmsConstants.HYBRIDSEARCH.CHANNEL?"channel":"chat",h=c.getAttribute("data-url"),i=c.getAttribute("data-fextn"),j=c.getAttribute("data-content"),k=c.getAttribute("data-isv1"),l;a="id="+b.getAttribute("data-userid"),a+="&type="+g+"&mod=att&sid="+encodeURIComponent(WebMessanger.getSid()),e&&(a+="&comment="+encodeURIComponent(e));var m=function(){var a=JSON.parse(this.response);a[0].objString.ERRCODE==400&&WMSUI.showErrorMsg($WC.I18N("Sharing_failed"))};k==="true"?(l={"X-XHR-exception":"true","X-ZCSRF-TOKEN":$WC.Util.getCSRF()},$WC.Ajax.postRequestToChat("v1/attachments/"+h+"/forward",a,null,m,null,null,l)):(l={"X-XHR-exception":"true"},a+="&fname="+d+i+"&url="+h+"&mime="+j,$WC.Ajax.postRequestToChat("fileforward.do",a,null,m,null,null,l)),WMSUI.imgPreview.removeOverlay()},closeRecipientList:function(){var a=document.getElementById("wms-filefrwrdautocomplete");a.style.display=="block"&&(a.innerHTML="",a.style.display="none")},insertSuggestion:function(a,b,c){var d=document.getElementById("wms-filefrwrdrecipant"),e=b?a:$WC.Util.getEventTarget(a),f=e&&e.closest("[data-id]"),g=f?f.getAttribute("data-id"):c.chid,h=f?f.getAttribute("data-dname"):c.dname,i=e&&e.getAttribute("data-purpose")=="usersugg"?e:c?c.imagehtml:f.getElementsByClassName("wms_badge_imgwrapper")[0],j=i.outerHTML||i,k=f?f.getAttribute("data-type"):c.type,l=j+'<span id="wms_filefrwrd_recipient">{{DNAME}}</span><div data-purpose="delsugg" class="wms_filefrwrddel"></div>';d.innerHTML=$WC.template.replace(l,{DNAME:h}),$WC.Util.loadOriginalImage(d),$WC.Util.setAttribute(d,"data-type",k),$WC.Util.setAttribute(d,"data-userid",g),$WC.Util.setAttribute(d,"contenteditable",!1),document.getElementById("wms-filefrwrdautocomplete").style.display="none"},removeSuggestion:function(){var a=document.getElementById("wms-filefrwrdrecipant");a.innerHTML="",$WC.Util.setAttribute(a,"contenteditable",!0),a.removeAttribute("data-userid"),a.removeAttribute("data-type")},handleNavigation:function(a){var b=document.getElementById("wms-filefrwrdautocomplete"),c=b.getElementsByClassName("wms-hysearch-result-hover")[0],d=null;a.keyCode==40?d=c.nextSibling||b.firstChild:a.keyCode==38&&(d=c.previousSibling||b.lastChild),d.className=="wms_menu_item_date"&&(d=a.keyCode==40?d.nextSibling:d.previousSibling||b.lastChild),$WC.Util.bringElemToView(d,a.keyCode),$WC.Util.removeClass(c,"wms-hysearch-result-hover"),$WC.Util.addClass(d,"wms-hysearch-result-hover")},getSelectedRecipient:function(){var a=document.getElementById("wms-filefrwrdautocomplete"),b=a.getElementsByClassName("wms-hysearch-result-hover")[0];return a.setAttribute("style","display:none"),document.getElementById("wms-fileupldcmt").focus(),b},populateRecipant:function(){var a=document.getElementById("wms-filefrwrdautocomplete"),b=$WC.Util.getInnerText(document.getElementById("wms-filefrwrdrecipant"));if(!b){a.innerHTML="",a.style.display="none";return}a.style.display="block";var c={searchtext:b,inpresultset:$WC.WmsConstants.HYBRIDSEARCH.GENERICLIST,silentload:!0};WmsHybridSearch.getNextResultSet(c),$WC.Util.loadOriginalImage(a),$WC.Util.addEvent(a,"scroll",$WC.Util.loadImageWithDebounce(a)),a.firstChild&&a.firstChild.className.indexOf("wmswms_menu_item_date")==-1&&$WC.Util.addClass(a.firstChild,"wms-hysearch-result-hover")},validate:function(a,b,c){return c&&$WC.Util.isEmptyObject(c.childNodes)?($WC.$CUtil.setInnerTextById("wms-filefrwrderrormsg",$WC.I18N("fileforward.error.norecipient")),document.getElementById("wms-filefrwrderrormsg").setAttribute("style","display:block"),$WC.Util.addClass(document.getElementById("wms_filefrwrdsugg_wrapper"),"wms_filefrwrderr"),!0):!1}},WmsHybridSearch=function(){};WmsHybridSearch.tempmsgdetails=[],WmsHybridSearch.hintindex=0,WmsHybridSearch.showUI=function(){$WC.$CUtil.createOverlay(WmsHybridSearch.hideUI),WmsHybridSearch.resshowntext="";var a=document.createElement("div");a.id="wms-hysearch",WmsHybridSearch.keydownlistener=$WC.Util.addEvent(a,"keydown",WmsHybridSearch.handleEvent,!1),WmsHybridSearch.keyuplistener=$WC.Util.addEvent(a,"keyup",WmsHybridSearch.handleKeyUp,!1),a.className="wms-hysearch wms-hvalign",a.style.zIndex=$WC.Config.get("zindex"),a.innerHTML=$WC.template.replace('<div class="wms-hysearch-toppart"><div class="wms_searchicon wms-hysearch-searchicon"></div><div id="wms-hysearch-inpcontainer" class="wms-hysearch-inpcontainer"><input id="wms-hysearch-actualinp" data-selectable="true" data-selected="true" autocomplete="off" required></input><input style="width:0px;opacity:0" id="wms-fakeinput"><label id="wms-hysearch-placeholder" class="wms-hysearch-placeholder"></label></div><div class="wms-hysearch-tipsicon"><div id="wms-hysearch-tips-container" class="wms-hysearch-tips-container" style="display: none;"><div class="wms-hysearch-tips-header">'+$WC.I18N("smartsearch.tips")+"</div>"+'<div class="wms-hysearch-tips">'+'<span class="wms-hysearch-tips-desc">'+$WC.I18N("smartsearch.tips.hint1")+"</span>"+'<div class="wms-hysearch-tips-content">'+'<span class="wms-hysearch-tips-format wms-hysearch-tips-name">'+$WC.I18N("smartsearch.tips.format.name")+"</span>"+'<div class="wms-hysearch-tips-example">'+$WC.I18N("smartsearch.tips.example")+'<span class="wms-hysearch-tips-eg1">'+$WC.I18N("smartsearch.tips.eg1")+"</span>"+'<span class="wms-hysearch-tips-eg3">'+$WC.I18N("smartsearch.tips.eg3")+"</span>"+"</div>"+"</div>"+"</div>"+'<div class="wms-hysearch-tips">'+'<span class="wms-hysearch-tips-desc">'+$WC.I18N("smartsearch.tips.hint2")+"</span>"+'<div class="wms-hysearch-tips-content">'+'<span class="wms-hysearch-tips-format wms-hysearch-tips-name">'+$WC.I18N("smartsearch.tips.format.name1")+"</span>"+'<span class="wms-hysearch-tips-format wms-hysearch-tips-name">'+$WC.I18N("smartsearch.tips.format.name2")+"</span>"+'<span class="wms-hysearch-tips-format wms-hysearch-tips-title">'+$WC.I18N("smartsearch.tips.format.title")+"</span>"+'<span class="wms-hysearch-tips-format wms-hysearch-tips-message">'+$WC.I18N("smartsearch.tips.format.message")+"</span>"+'<div class="wms-hysearch-tips-example">'+$WC.I18N("smartsearch.tips.example")+'<span class="wms-hysearch-tips-eg1">'+$WC.I18N("smartsearch.tips.eg4")+"</span>"+'<span class="wms-hysearch-tips-eg2">'+$WC.I18N("smartsearch.tips.eg2")+"</span>"+'<span class="wms-hysearch-tips-eg3">'+$WC.I18N("smartsearch.tips.eg3")+"</span>"+"</div></div></div></div></div>"+'<div class="wms-hysearch-closeicon"></div></div>'+'<div id="wms-hysearch-rescont" class="wms-hysearch-rescont"><div id="wms-hysearch-defrescont" class="wms-hysearch-defrescont"></div>'+'<div id="wms-hysearch-searchres" class="wms-hysearch-searchres"></div>'+"</div>",{}),document.body.appendChild(a);var b=$WC.template.replace('<div class="wms-hysearch-defres" data-selectable="true"><div class="wms-hysearch-resheading">'+$WC.I18N("menuname.chats")+'</div><div id="wms-hysearch-rchats" data-resset="true" class="wms-hysearch-resset"></div></div>',{}),c=$WC.template.replace('<div class="wms-hysearch-defres" data-selectable="true"><div class="wms-hysearch-resheading">'+$WC.I18N("Contacts")+'</div><div id="wms-hysearch-fcontacts" data-resset="true" class="wms-hysearch-resset"></div></div>',{}),d=$WC.template.replace('<div class="wms-hysearch-defres" data-selectable="true"><div id="wms-hysearch-thirdcolheading" style="visibility:hidden" class="wms-hysearch-resheading">'+$WC.I18N("Contacts")+'</div><div id="wms-hysearch-thirdcol" data-resset="true" class="wms-hysearch-resset"><center><div class="wms_loading_container wms-halign"><div></div><div></div><div></div></div></center></div></div>',{}),e=document.getElementById("wms-hysearch-defrescont");e.insertAdjacentHTML("beforeend",b),$WC.Config.get("contacts")!="disable"&&e.insertAdjacentHTML("beforeend",c),$WC.Config.get("isOrgUser")()&&$WC.Config.get("channels")!="disable"&&$WC.SecurityManager.hasPermission("channels")&&e.insertAdjacentHTML("beforeend",d),WmsHybridSearch.showRotationalHint(),$WC.Util.addEvent($WC.HybridSearch.getNode("inputcontainer"),"click",WmsHybridSearch.focusInput),$WC.Util.addEvent($WC.HybridSearch.getNode("recentchatsdiv"),"scroll",$WC.Util.debounce(function(a){$WC.Util.loadOriginalImage($WC.HybridSearch.getNode("recentchatsdiv")),WmsHybridSearch.checkScrollAndloadMoreChatlist(a)},null,300)),WmsHybridSearch.populateRecentChatsInSmartChat(),WmsHybridSearch.bindEvents(),$WC.Config.get("contacts")!="disable"&&($WC.Util.addEvent($WC.HybridSearch.getNode("freqcontactsdiv"),"scroll",$WC.Util.loadImageWithDebounce($WC.HybridSearch.getNode("freqcontactsdiv"))),$WC.Util.addEvent($WC.HybridSearch.getNode("freqcontactsdiv"),"click",function(b){var c=b.target.closest("[data-id]");b.target.getAttribute("data-operation")?WmsContacts.handleInviteOperation(b.target):c&&WmsHybridSearch.handleSelection(c)}),WmsHybridSearch.populateFrequentContactsInSmartChat(),setTimeout(function(){$WC.Util.loadOriginalImage($WC.HybridSearch.getNode("freqcontactsdiv"))},300)),$WC.Config.get("isOrgUser")()&&$WC.Config.get("channels")!="disable"&&$WC.SecurityManager.hasPermission("channels")&&($WC.Channels.initChannels(),WmsHybridSearch.populateThirdColumnInSmartChat(),$WC.Util.addEvent($WC.HybridSearch.getNode("thirdcolumn"),"scroll",$WC.Util.loadImageWithDebounce($WC.HybridSearch.getNode("thirdcolumn"))));var f=document.getElementById("wmstoolbar")?!0:!1;f&&$WC.Bots.initBots(),$WC.Util.addEvent($WC.HybridSearch.getNode("searchresultdiv"),"scroll",$WC.Util.loadImageWithDebounce($WC.HybridSearch.getNode("searchresultdiv"))),WmsHybridSearch.focusInput()},WmsHybridSearch.populateThirdColumnInSmartChat=function(){$WC.Config.get("isRegistered")()&&$WC.Config.get("isOrgUser")()&&$WC.Config.get("channels")!="disable"&&$WC.SecurityManager.hasPermission("channels")&&WmsHybridSearch.populateActiveChannels()},$WC.Util.pubsub.subscribe("/chatlist/updateui",function(a,b){var c=b&&b.reqid;b.stat===$WC.WmsConstants.REQSTATUS.FAILED?$WC.HybridSearch.updateManager("failureupdate",null,c):$WC.HybridSearch.updateManager("update",null,c)}),$WC.Util.pubsub.subscribe("/bots/updateui",function(){var a={};a.suggestions="show_suggestions",WmsHybridSearch.populateContactListInMainUI(!0,a),$WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&WmsHybridSearch.populateFrequentContactsInSmartChat()}),$WC.Util.pubsub.subscribe("/channels/updateui",function(a,b){var c=b&&b.reqid;b.stat===$WC.WmsConstants.REQSTATUS.FAILED?$WC.HybridSearch.updateManager("failureupdate",null,c):$WC.HybridSearch.updateManager("update",null,c),$WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&(WmsHybridSearch.populateActiveChannels(),WmsHybridSearch.populateRecentChatsInSmartChat());var d=document.getElementById("wmstoolbar")?!0:!1;d&&!$WC.HybridSearch.getSearchText()&&$WC.HybridSearch.populateRecentChats(null,$WC.WmsConstants.HYBRIDSEARCH.modules.CHATMENU),WmsHybridSearch.populateGroupResultInMainUI(),typeof WmsMainUI!="undefined"&&(WmsMainUI.updateLoadingForPinnedChats(!1),$WC.Util.loadOriginalImage(WmsMainUI.defaultgrouplist))}),$WC.Util.pubsub.subscribe("/orgcontacts/updateui",function(a,b){var c=b&&b.reqid;b.stat===$WC.WmsConstants.REQSTATUS.FAILED?$WC.HybridSearch.updateManager("failureupdate",null,c):$WC.HybridSearch.updateManager("update",null,c)}),$WC.Util.pubsub.subscribe("/orgcontacts/suggestionui",function(a,b){var c={};b.stat===$WC.WmsConstants.REQSTATUS.FAILED?c.suggestions="suggestion_req_failed":c.suggestions="show_suggestions",!_WMSEMPTYBAR&&!silent&&!$WC.Config.get("customContacts")&&WmsHybridSearch.populateContactListInMainUI(!0,c)}),$WC.Util.pubsub.subscribe("/recentchats/updateui",function(a,b){document.getElementById("wms-hysearch")&&$WC.HybridSearch.populateRecentChats(b,$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT);var c=document.getElementById("wmstoolbar")?!0:!1;c&&$WC.HybridSearch.populateRecentChats(b)}),WmsHybridSearch.populateSuggestionList=function(a){var b="",c='<div class="wms_menu_subheading" >'+$WC.I18N("chat.suggestions")+"</div>";if(a){var d='<span data-retry="true">'+$WC.I18N("suggestions.retry")+"</span>",e='<div class="wms-suggestions-failed">'+$WC.I18N("suggestions.failed",d)+"</div>";b+=c,b+=e}else{WmsOrgContacts.checkAndUpdateContactsList();if($WC.Util.getObjectLength(WmsOrgContacts.getOrgContactsList())>0){var f=$WC.HybridSearch.generateContactResults(null,!0),g={USERID:f.map(function(a){return a.USERID})},h=$WC.HybridSearch.generateOrgContactResults("","",g,!0);$WC.Util.getObjectLength(h)>0&&(b+=c,b+=$WC.HybridSearch.generateHtml(h))}}return b},WmsHybridSearch.focusInput=function(){setTimeout(function(){$WC.HybridSearch.getNode("inputdiv").focus()},1)},WmsHybridSearch.hideUI=function(){$WC.$CUtil.removeEvent(document,"keydown",WmsHybridSearch.keydownlistener),$WC.$CUtil.removeEvent(document,"keyup",WmsHybridSearch.keyuplistener),$WC.$CUtil.removeOverlay(),$WC.HybridSearch.getNode("mainUI")&&Gator($WC.HybridSearch.getNode("mainUI")).off(),$WC.Util.removeElement($WC.HybridSearch.getNode("mainUI")),WmsHybridSearch.hintindex++},WmsHybridSearch.createInnerSearchFragment=function(a,b,c){var d="wms-hysearch-chosentext";b==="user"&&(d+=" wms-hysearch-atmen"),b==="topic"&&(d+=" wms-hysearch-topic");var e='<span data-id="{{id}}" class="{{classname}}" data-innerfrag="true" data-selectable="true" data-type={{type}}>{{name}}<span class="wms-hysearch-chosentext-closeicon" data-innerfragclose="true"></span></span>';return $WC.template.replace(e,{id:c,name:a,classname:d,type:b})},WmsHybridSearch.showCloseIcon=function(a){WmsHybridSearch.resetChosenClose(),$WC.Util.addClass(a,"wms-hysearch-chosentext-close")},WmsHybridSearch.hideCloseIcon=function(a){$WC.Util.removeClass(a,"wms-hysearch-chosentext-close")},WmsHybridSearch.resetChosenClose=function(){var a=$WC.HybridSearch.getNode("inputcontainer").getElementsByClassName("wms-hysearch-chosentext-close");if(a.length){a=$WC.Util.convertToArray(a);for(var b=0;b<a.length;b++)$WC.Util.removeClass(a[b],"wms-hysearch-chosentext-close")}},WmsHybridSearch.removeChosenText=function(a,b){$WC.Util.removeElement(b.parentNode),WmsHybridSearch.getNextResultSet()},WmsHybridSearch.toggleTipsUI=function(){var a=document.getElementById("wms-hysearch-tips-container");a.style.display==="none"?a.style.display="block":a.style.display="none"},WmsHybridSearch.virtual_list_objs=[],WmsHybridSearch.populateContactsUsingVirtualList=function(a,b,c,d,e,f){function k(a){var b=g[a],d="",e=$WC.WmsConstants.HYBRIDSEARCH.modules.CONTACTMENU,f=$WC.HybridSearch.getResultInfo(b._filtertype),h=$WC.HybridSearch.getDescription(b);if(b.ISBOT)d=$WC.HybridSearch.createResultFragment(b.USERID,b.DNAME,$WC.Util.safeHTML($WC.Util.unescapeHTML(b.STATUSMSG)),$WC.Bots.getPhoto(b.USERID),f,$WC.WmsConstants.HYBRIDSEARCH.BOT,null,null,b,e);else if(b.USERID)d=$WC.HybridSearch.createResultFragment(b.USERID,b.DNAME,$WC.Util.safeHTML($WC.Util.unescapeHTML(h)),null,f,$WC.WmsConstants.HYBRIDSEARCH.CONTACT,null,null,null,e);else if(b=="suggestions")d='<div class="wms_menu_subheading" data-heading="suggestions" data-show="false">'+$WC.I18N("chat.suggestions")+"</div>";else if(b=="suggestions_heading")d='<div class="wms_menu_subheading" data-heading="suggestions" data-show="true">'+$WC.I18N("chat.suggestions")+"</div>";else{var i='<span data-retry="true">'+$WC.I18N("suggestions.retry")+"</span>";d='<div class="wms-suggestions-failed">'+$WC.I18N("suggestions.failed",i)+"</div>"}var j=document.createElement("div");j.innerHTML=d;var k=j.firstChild,l;return b.USERID?$WC.HybridSearch.getCurrentModule()==$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT?l=103-c:l=77-c:l=29-c,k.className!="wms_menu_item"&&k.className!="wms-hysearch-result"&&(k=[k,l]),k}function l(a){var b=a.target?a.target.closest("[data-id]"):a;b&&$WC.HybridSearch.changeHover(b)}var g=$WC.HybridSearch.generateContactResults(null,!0);if($WC.Config.get("isOrgUser")()&&f&&f.suggestions&&g.length<10){var h=f.suggestions;if(h==="suggestion_req_failed")g.push("suggestions"),g.push("suggestions_failed");else if(h==="show_suggestions"){WmsOrgContacts.checkAndUpdateContactsList();var i={USERID:g.map(function(a){return a.USERID})},j=$WC.HybridSearch.generateOrgContactResults("","",i,!0);j.length&&(g.push("suggestions"),g=g.concat(j))}else h==="suggestions_heading"&&g.push("suggestions_heading")}WmsHybridSearch.virtual_list_objs[e]&&WmsHybridSearch.virtual_list_objs[e].remove_event_listeners(),g.length&&(WmsHybridSearch.virtual_list_objs[e]=new $WC.VirtualList({w:a,h:b,itemHeight:c,totalRows:g.length,generatorFn:k,container:d,hoverFunction:l}))},WmsHybridSearch.populateFrequentContactsInSmartChat=function(){var a=$WC.HybridSearch.getNode("freqcontactsdiv");$WC.Util.getObjectLength(WmsContacts.getContactsList())||$WC.Util.getObjectLength(WmsOrgContacts.getOrgContactsList())||$WC.Util.getObjectLength($WC.Bots.getList(!0))?(a.innerHTML="",WmsHybridSearch.populateContactsUsingVirtualList(325,370,62,a,"smartchat")):a.innerHTML='<div class="wms-welcome-msg">'+$WC.I18N("contacts.welcomemessage")+"</div>"},WmsHybridSearch.populateRecentChatsInSmartChat=function(a){$WC.HybridSearch.populateRecentChats(a,$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT)},WmsHybridSearch.checkScrollAndloadMoreChatlist=function(a){var b=a.target;(b.id=="wms-hysearch-rchats"||$WC.HybridSearch.isUnreadFilterOpen()===!1)&&b.scrollTop+b.clientHeight>Math.floor(b.scrollHeight*.75)&&$WC.RecentChats.loadPreviousChatList()},WmsHybridSearch.populateActiveChannels=function(){if($WC.Channels.getLastFetchedTime()){var a=$WC.Channels.getJoinedChannels($WC.Util.getObjectLength($WC.Channels.list));if(a&&a.length){var b="",c;for(var d=0;d<a.length;d++)c=a[d].cd||$WC.I18N("channel.nodescription"),b+=$WC.HybridSearch.createResultFragment(a[d].chid,$WC.Channels.getChannelName(a[d].chid),$WC.Util.safeHTML(c),$WC.Channels.getChannelImageHTML(a[d].chid),null,$WC.WmsConstants.HYBRIDSEARCH.CHANNEL);$WC.$CUtil.setInnerText($WC.HybridSearch.getNode("thirdcolumnheading"),$WC.I18N("menuname.channelsandgroups")),$WC.HybridSearch.getNode("thirdcolumnheading").style.visibility="visible",$WC.HybridSearch.getNode("thirdcolumn").innerHTML=b,$WC.Util.loadOriginalImage($WC.HybridSearch.getNode("thirdcolumn"))}else $WC.HybridSearch.getNode("thirdcolumnheading")&&$WC.Util.removeElement($WC.HybridSearch.getNode("thirdcolumnheading").parentNode)}},WmsHybridSearch.toggleUI=$WC.Util.debounce(function(){$WC.HybridSearch.getNode("mainUI")===null?(typeof WmsProfileInfo!="undefined"&&WmsProfileInfo.hide(),WmsHybridSearch.showUI()):WmsHybridSearch.hideUI()},null,300,!0),WmsHybridSearch.handleClick=function(a){WmsHybridSearch.handleSelection(a)},WmsHybridSearch.generateFreqContactResults=function(){var a=WmsContacts.getSortedContacts("UC",!0,null,WmsContacts.getContactsList().length),b="";if(a.length===0)b='<span class="wms-hysearch-infotxt">'+$WC.I18N("contacts.frequent.none")+"</span>";else for(var c=0;c<a.length;c++)a[c].ISBOT?b+=$WC.HybridSearch.createResultFragment(a[c].USERID,a[c].DNAME,a[c].EMAILID,null,null,$WC.WmsConstants.HYBRIDSEARCH.CONTACT,null,null,a[c]):b+=$WC.HybridSearch.createResultFragment(a[c].USERID,a[c].DNAME,a[c].EMAILID,null,null,$WC.WmsConstants.HYBRIDSEARCH.CONTACT);return b},WmsHybridSearch.handleEvent=function(){function a(a){var b=$WC.HybridSearch.getNode("resultcontainer"),c,d,e,f;getComputedStyle($WC.HybridSearch.getNode("searchresultdiv")).display==="block"?f=$WC.HybridSearch.getNode("searchresultdiv").getElementsByClassName("wms-hysearch-result-select")[0]:f=$WC.HybridSearch.getNode("defaultresultdiv").getElementsByClassName("wms-hysearch-result-select")[0];var g=$WC.HybridSearch.getNode("inputcontainer").querySelectorAll("[data-type='user'],[data-type='topic']");if(!g.length||a!==$WC.WmsConstants.KEYCODES.LEFT&&a!==$WC.WmsConstants.KEYCODES.RIGHT){if(f){$WC.HybridSearch.resetHover();if(a===$WC.WmsConstants.KEYCODES.LEFT||a===$WC.WmsConstants.KEYCODES.RIGHT)if($WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT){d=b.firstChild,f&&(d=f.parentNode.parentNode);var j=f.getBoundingClientRect(),k={x:j.left+d.offsetWidth/2,y:j.top+f.offsetHeight/2},l=$WC.Util.convertToArray(d.parentNode.children),m=l.indexOf(d)+1;a===$WC.WmsConstants.KEYCODES.LEFT?m===1?k.x+=(l.length-1)*d.offsetWidth:k.x-=d.offsetWidth:a===$WC.WmsConstants.KEYCODES.RIGHT&&(m===l.length?k.x-=(l.length-1)*d.offsetWidth:k.x+=d.offsetWidth),c=document.elementFromPoint(k.x,k.y),c.getAttribute("data-id")===null&&(c=c.closest("[data-id]"))}else c=f;else if(a===$WC.WmsConstants.KEYCODES.UP||a===$WC.WmsConstants.KEYCODES.DOWN)if($WC.HybridSearch.getCurrentModule()!==$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&$WC.HybridSearch.getCurrentModule()!==$WC.WmsConstants.HYBRIDSEARCH.modules.CONTACTMENU&&$WC.HybridSearch.getCurrentModule()!==$WC.WmsConstants.HYBRIDSEARCH.modules.CHATMENU||!(f==f.parentNode.querySelector("[data-id]")&&a===$WC.WmsConstants.KEYCODES.UP||f==f.parentNode.lastChild&&a===$WC.WmsConstants.KEYCODES.DOWN))c=$WC.$CUtil.getConditionalNextNode(f,a,"data-type");else{var n=f.closest("[data-menu]");if(a===$WC.WmsConstants.KEYCODES.UP){var o=n&&n.previousSibling;o&&o.id==="wms_menu_pinnedchats"&&(o=o.previousSibling);var p=o&&o.querySelectorAll("[data-type]");c=p&&p[p.length-1]||f}else{var q=n&&n.nextSibling;q&&q.id==="wms_menu_pinnedchats"&&(q=q.nextSibling),c=q&&q.querySelector("[data-type]")||f}}else a===$WC.WmsConstants.KEYCODES.TAB&&$WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&(d=b.firstChild,f&&(d=f.parentNode.parentNode),e=$WC.$CUtil.getConditionalNextNode(d,a,"data-selectable"),e=e.querySelector("[data-resset]"),c=e.querySelector("[data-id]"));c&&$WC.Util.bringElemToView(c,a)}else $WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT?getComputedStyle($WC.HybridSearch.getNode("searchresultdiv")).display==="block"?c=$WC.HybridSearch.getNode("searchresultdiv").firstChild:c=b.firstChild.getElementsByClassName("wms-hysearch-result")[0]:getComputedStyle($WC.HybridSearch.getNode("searchresultdiv")).display==="block"?c=$WC.HybridSearch.getNode("searchresultdiv").querySelector("[data-type]"):c=$WC.HybridSearch.getNode("defaultresultdiv").querySelector('[data-type][class="wms_menu_item"]');c&&$WC.HybridSearch.changeHover(c)}else{var h=$WC.HybridSearch.getNode("inputcontainer").querySelector("[data-selected='true']");if(h){WmsHybridSearch.resetChosenClose(),h.setAttribute("data-selected","false");var i=$WC.$CUtil.getConditionalNextNode(h,a,"data-selectable");i.setAttribute("data-selected","true"),h.nodeName==="INPUT"&&(h.blur(),$WC.HybridSearch.getNode("fakeinput").focus()),i.nodeName!=="INPUT"?WmsHybridSearch.showCloseIcon(i):i.focus(),$WC.Util.bringElemToView(i,a,!0)}}}return function(b){$WC.HybridSearch.getSearchText()===""&&(WmsHybridSearch.removesearchpart=!0),!$WC.Util.isEmptyString($WC.HybridSearch.getSearchText())||b.keyCode!==$WC.WmsConstants.KEYCODES.LEFT&&b.keyCode!==$WC.WmsConstants.KEYCODES.RIGHT?(b.keyCode===$WC.WmsConstants.KEYCODES.UP||b.keyCode===$WC.WmsConstants.KEYCODES.DOWN||b.keyCode===$WC.WmsConstants.KEYCODES.TAB)&&a(b.keyCode):a(b.keyCode),$WC.$CUtil.preventHandlingTabUpDownEnter(b)}}(),WmsHybridSearch.removesearchpart=!1,WmsHybridSearch.handleKeyUp=function(a){if(WmsHybridSearch.resshowntext===""||WmsHybridSearch.resshowntext!==$WC.HybridSearch.getSearchText()||a.keyCode===$WC.WmsConstants.KEYCODES.ENTER||a.keyCode===$WC.WmsConstants.KEYCODES.BACKSPACE)WmsHybridSearch.resshowntext=$WC.HybridSearch.getSearchText(),WmsHybridSearch.parseTextInput(a.keyCode)},WmsHybridSearch.parseTextInput=function(a){var b=$WC.HybridSearch.getSearchText();if(a===$WC.WmsConstants.KEYCODES.BACKSPACE&&$WC.Util.isEmptyString($WC.HybridSearch.getSearchText())){var c=$WC.HybridSearch.getNode("inputcontainer").getElementsByClassName("wms-hysearch-chosentext-close");if(c.length===1)$WC.Util.removeElement(c[0]),WmsHybridSearch.focusInput(),$WC.HybridSearch.getNode("inputdiv").setAttribute("data-selected","true");else if(WmsHybridSearch.removesearchpart===!0){WmsHybridSearch.removesearchpart=!1,$WC.HybridSearch.getNode("inputdiv").setAttribute("data-selected","false");var d=$WC.HybridSearch.getNode("inputcontainer").querySelectorAll("[data-type]");d.length&&(d[d.length-1].setAttribute("data-selected",!0),$WC.Util.addClass(d[d.length-1],"wms-hysearch-chosentext-close"))}}a===$WC.WmsConstants.KEYCODES.ENTER?WmsHybridSearch.handleSelection():b?($WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&(WmsHybridSearch.removesearchpart=!1,WmsHybridSearch.resetChosenClose()),$WC.HybridSearch.getNode("defaultresultdiv").style.display="none",$WC.HybridSearch.getNode("searchresultdiv").style.display="block",typeof WmsMainUI!="undefined"&&WmsMainUI.updateLoadingForPinnedChats(!1),WmsHybridSearch.getNextResultSet(),$WC.HybridSearch.getNode("searchresultdiv").querySelector("[data-type]")&&$WC.HybridSearch.changeHover($WC.HybridSearch.getNode("searchresultdiv").querySelector("[data-type]"))):WmsHybridSearch.getNextResultSet()},WmsHybridSearch.handleSelection=function(a){var b=$WC.HybridSearch.getSearchText(),c;a||(getComputedStyle($WC.HybridSearch.getNode("searchresultdiv")).display==="block"?a=$WC.HybridSearch.getNode("searchresultdiv").getElementsByClassName("wms-hysearch-result-select")[0]:a=$WC.HybridSearch.getNode("defaultresultdiv").getElementsByClassName("wms-hysearch-result-select")[0]);var d=a&&+a.getAttribute("data-type");if(a&&a.getAttribute("data-id")==="wms_menu_feedsnotify")ZMSGUI.launchHistory();else if($WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT){var e=$WC.HybridSearch.getNode("inputcontainer").querySelector("[data-type='topic']");if(a&&a.getAttribute("data-retry")==="true")$WC.HybridSearch.invokeRetry();else if(d===$WC.WmsConstants.HYBRIDSEARCH.CHAT||d===$WC.WmsConstants.HYBRIDSEARCH.CHANNEL)WmsHybridSearch.parseAndOpenChat(a,$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT);else if(b.startsWith("#")&&$WC.HybridSearch.getChosenUsers().length==1||e&&$WC.HybridSearch.getChosenUsers().length==1&&!b.startsWith("@"))WmsHybridSearch.showInfoMessage($WC.I18N("Error"),$WC.I18N("topic.not.allowed"));else if(a&&b.startsWith("@")){var f=a.getElementsByClassName("wms-hysearch-result-name")[0];f=$WC.Util.getInnerText(f),c=a.getAttribute("data-id"),$WC.HybridSearch.getNode("inputdiv").insertAdjacentHTML("beforebegin",WmsHybridSearch.createInnerSearchFragment("@"+f,"user",c)),$WC.HybridSearch.getNode("inputdiv").value="",$WC.HybridSearch.getNode("inputdiv").focus(),WmsHybridSearch.resshowntext="",WmsHybridSearch.getNextResultSet()}else if(e&&b.startsWith("#"))WmsHybridSearch.showInfoMessage($WC.I18N("Error"),$WC.I18N("topic.alreadyselected"));else if(e&&$WC.HybridSearch.getChosenUsers().length===0)WmsHybridSearch.showInfoMessage($WC.I18N("Error"),$WC.I18N("topic.nouser"));else if(!e&&b.startsWith("#")){var g=$WC.HybridSearch.getNode("inputdiv").value;$WC.HybridSearch.getNode("inputdiv").insertAdjacentHTML("beforebegin",WmsHybridSearch.createInnerSearchFragment(g,"topic")),$WC.HybridSearch.getNode("inputdiv").value="",$WC.HybridSearch.getNode("inputdiv").focus(),WmsHybridSearch.resshowntext="",WmsHybridSearch.getNextResultSet()}else a&&WmsContacts.isInvitedContact(a.getAttribute("data-id"))?(WmsHybridSearch.hideUI(),typeof WmsMainUI!="undefined"&&WmsMainUI.showPendingInvitations()):WmsHybridSearch.parseAndOpenChat(a,$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT)}else if(a&&a.getAttribute("data-retry")==="true")$WC.HybridSearch.invokeRetry();else{c=a.getAttribute("data-id");var h=a.getAttribute("data-chid"),i=!1;$WC.Config.get("customContacts")&&(i=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").customContactClick,c,a),WMSUI.handleChatExist(h)),!i&&!WmsContacts.isInvitedContact(c)&&WmsHybridSearch.parseAndOpenChat(a)}$WC.HybridSearch.getNode("inputdiv")&&$WC.Util.bringElemToView($WC.HybridSearch.getNode("inputdiv"),$WC.WmsConstants.KEYCODES.RIGHT,!0)},WmsHybridSearch.parseAndOpenChat=function(a,b){var c=$WC.HybridSearch.getNode("inputcontainer")&&$WC.HybridSearch.getNode("inputcontainer").querySelectorAll("[data-type='user']")||[],d=$WC.HybridSearch.getNode("inputcontainer")&&$WC.HybridSearch.getNode("inputcontainer").querySelector("[data-type='topic']"),e,f,g,h,i,j,k,l,m,n=[];c.length&&(f=$WC.Util.convertToArray(c).map(function(a){return a.getAttribute("data-id")})),d&&(g=$WC.Util.getInnerText(d).slice(1)),f&&(k=$WC.WmsConstants.HYBRIDSEARCH.CONTACT,j=f.join(","),f.length>1&&!g&&(f.forEach(function(a){n.push({zuid:a})}),g=WmsHybridSearch.createChatTitle(n)),e=$WC.HybridSearch.getSearchText(),WmsHybridSearch.tempmsgdetails.push(e));if(a)if(+a.getAttribute("data-type")===$WC.WmsConstants.HYBRIDSEARCH.CONTACT||+a.getAttribute("data-type")===$WC.WmsConstants.HYBRIDSEARCH.ORGCONTACT)j=a.getAttribute("data-id"),k=$WC.WmsConstants.HYBRIDSEARCH.CONTACT;else if(+a.getAttribute("data-type")===$WC.WmsConstants.HYBRIDSEARCH.BOT)j=a.getAttribute("data-id"),k=$WC.WmsConstants.HYBRIDSEARCH.BOT;else if(+a.getAttribute("data-type")===$WC.WmsConstants.HYBRIDSEARCH.GROUP)l=a.getAttribute("data-id"),k=$WC.WmsConstants.HYBRIDSEARCH.GROUP;else if(+a.getAttribute("data-type")===$WC.WmsConstants.HYBRIDSEARCH.CHAT)h=a.getAttribute("data-id"),k=$WC.WmsConstants.HYBRIDSEARCH.CHAT;else if(+a.getAttribute("data-type")===$WC.WmsConstants.HYBRIDSEARCH.CHANNEL)i=a.getAttribute("data-id"),m=a.getAttribute("data-oc_id"),k=$WC.WmsConstants.HYBRIDSEARCH.CHANNEL;else if(+a.getAttribute("data-type")===$WC.WmsConstants.HYBRIDSEARCH.ADDCONTACT){var o=a.closest("[data-operation]");k=$WC.WmsConstants.HYBRIDSEARCH.ADDCONTACT}if(k){if(typeof WmsMainUI!="undefined"){if(h)var p=h;else if(i)var p=i;else if(j&&$WC.Bots.getList(!0)[j])var p=$WC.Bots.getList(!0)[j].CHID;else var p=j;WmsMainUI.scheduleAutoFocus(p)}WmsHybridSearch.hideUI(),$WC.Config.get("adhocchats")=="disable"&&f&&f.length>1||WmsHybridSearch.checkAndOpenChat(k,j,g,e,l,i,h,o,b,m),typeof WmsMainUI!="undefined"&&WmsMainUI.resetToDefaultUI()}else WmsHybridSearch.showInfoMessage($WC.I18N("Error"),$WC.I18N("selection.none"))},WmsHybridSearch.checkAndOpenChat=function(a,b,c,d,e,f,g,h,i,j){var k;g=g||WebMessanger.ucmap[b]||WebMessanger.ucmap[e]||f,g&&WMSUI.handleChatExist(g),i=i==$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT?"smartchat":"mainui";if(a===$WC.WmsConstants.HYBRIDSEARCH.BOT){var l=$WC.Bots.get(b);if(l)if(l.ISSUBSCRIBED)WebMessanger.attachSession(l.CHID,i);else{var m='<div class="wms-dialog-txtcont">'+$WC.Util.safeHTML($WC.I18N("bot.subscribe.confirm",l.DNAME))+"</div>",n={bodyhtml:m,focusbutton:2,operations:[{name:$WC.I18N("bot.action.subscribe"),action:function(){WmsMainUI.scheduleAutoFocus(b),$WC.Bots.subscribe(b),WmsDialog.removeModal()}},{name:$WC.I18N("Cancel"),classname:"wms-dialog-rejectbtn",action:function(){WmsDialog.removeModal()}}]};WmsDialog.showModal(n)}}else if(a===$WC.WmsConstants.HYBRIDSEARCH.CONTACT){c&&(k=!0);var o=b.split(",");if(o.length=="1"&&!$WC.SecurityManager.hasPermission("direct_message")){$WC.SecurityManager.handleError({message:$WC.I18N("module.disabled.directmsg")});return}!k&&g&&d?Chat.isExists(g)?Message.send(g,d):(WmsChatCache.remove(g),Message.deletedMessages.remove(g),WebMessanger.openUserChat(b,k,c,d,i)):WebMessanger.openUserChat(b,k,c,d,i)}if(a===$WC.WmsConstants.HYBRIDSEARCH.CHAT&&g)WebMessanger.attachSession(g,i);else if(a===$WC.WmsConstants.HYBRIDSEARCH.CHANNEL&&f)if($WC.Channels.isJoinedChannel(f)===!1){var m='<div class="wms-dialog-txtcont">'+$WC.Util.safeHTML($WC.I18N("channel.confirmjoin",$WC.Channels.get(f).cn))+"</div>",n={bodyhtml:m,focusbutton:2,operations:[{name:$WC.I18N("Join"),action:function(){WmsMainUI.scheduleAutoFocus(f),WebMessanger.joinChannel(f),WmsDialog.removeModal()}},{name:$WC.I18N("Cancel"),classname:"wms-dialog-rejectbtn",action:function(){WmsDialog.removeModal()}}]};WmsDialog.showModal(n)}else WebMessanger.attachSession(f,i);else if(a===$WC.WmsConstants.HYBRIDSEARCH.ADDCONTACT){var p=h.getAttribute("data-email");WmsHybridSearch.inviteMember(p)}},WmsHybridSearch.createChatTitle=function(a){var b=a.length,c;return b>1&&(c=$WC.Util.getContactName(a[0].zuid,a[0].dname)+", "+$WC.Util.getContactName(a[1].zuid,a[1].dname)+" & ",b===2?c+=WebMessanger.getNickName():b>2&&(c+=b-1+" "+$WC.I18N("more"))),c},WmsHybridSearch.getNextResultSet=function(a){var b=a&&a.inpresultset||WmsHybridSearch.decideResultSet(),c=$WC.HybridSearch.getNode("searchresultdiv"),d=a&&a.searchtext||$WC.HybridSearch.getSearchText(),e;if(b===$WC.WmsConstants.HYBRIDSEARCH.EMPTY)c.innerHTML="";else if(b===$WC.WmsConstants.HYBRIDSEARCH.EMPTYUSERHINT)c.innerHTML="",WmsHybridSearch.setPlaceHolderHint($WC.I18N("hint.chooseuser"));else if(b===$WC.WmsConstants.HYBRIDSEARCH.EMPTYTITLEHINT)c.innerHTML="",WmsHybridSearch.setPlaceHolderHint($WC.I18N("hint.choosetopic"));else if(b===$WC.WmsConstants.HYBRIDSEARCH.EMPTYMSGHINT)c.innerHTML="",WmsHybridSearch.setPlaceHolderHint($WC.I18N("hint.sendmessage"));else if(b===$WC.WmsConstants.HYBRIDSEARCH.FREQCONTACTS)c.innerHTML=$WC.HybridSearch.generateHtml(WmsHybridSearch.generateFreqContactResults());else if(b===$WC.WmsConstants.HYBRIDSEARCH.USERLIST||b===$WC.WmsConstants.HYBRIDSEARCH.USER_CHANNELLIST){d=a&&a.searchtext||$WC.HybridSearch.getPlainSearchText(),e=[],b===$WC.WmsConstants.HYBRIDSEARCH.USER_CHANNELLIST&&(e=$WC.HybridSearch.generateChannelResults(d,null,null,null));var f=[];if($WC.Config.get("customContacts")&&!$WC.Config.get("customContacts").separatePane)f=WmsHybridSearch.generateCustomContactResults(d),c.innerHTML=WmsHybridSearch.generateCustomContactsListHtml(f);else{f=$WC.HybridSearch.generateContactResults(d);var g={USERID:f.map(function(a){return a.USERID})},h=f.concat($WC.HybridSearch.generateOrgContactResults(d,!1,g)),i=$WC.HybridSearch.generateUnsubscribedBotResults(d,g);h=h.concat(i);if(!a||!a.inpresultset)c.innerHTML=$WC.HybridSearch.generateHtml(h.concat(e));(h.length<10||$WC.Matcher.check("emailid",d,!0))&&$WC.HybridSearch.updateManager("fetch",$WC.WmsConstants.HYBRIDSEARCH.ORGCONTACT,null,null,null,a)}}else if(b===$WC.WmsConstants.HYBRIDSEARCH.CUSTOMCONTACTLIST){d=a&&a.searchtext||$WC.HybridSearch.getPlainSearchText();var f=WmsHybridSearch.generateCustomContactResults(d);c.innerHTML=WmsHybridSearch.generateCustomContactsListHtml(f)}else if(b===$WC.WmsConstants.HYBRIDSEARCH.TITLEHINT||b===$WC.WmsConstants.HYBRIDSEARCH.CHANNELLIST){d=$WC.HybridSearch.getPlainSearchText();if(d!==""){e=$WC.HybridSearch.generateChannelResults(d),$WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&b===$WC.WmsConstants.HYBRIDSEARCH.TITLEHINT?c.innerHTML=$WC.HybridSearch.createResultFragment("",d,"","<span></span>",null,$WC.WmsConstants.HYBRIDSEARCH.TITLEHINT)+$WC.HybridSearch.generateHtml(e):c.innerHTML=$WC.HybridSearch.generateHtml(e);if(e.length<10){var j=b===$WC.WmsConstants.HYBRIDSEARCH.TITLEHINT?!0:!1;$WC.HybridSearch.updateManager("fetch",$WC.WmsConstants.HYBRIDSEARCH.CHANNEL,null,j)}}else c.innerHTML=$WC.HybridSearch.generateHtml($WC.HybridSearch.generateChannelResults("",null,!0))}else if(b===$WC.WmsConstants.HYBRIDSEARCH.MESSAGEHINT)c.innerHTML=$WC.HybridSearch.createResultFragment("",d,"","<span></span>","",$WC.WmsConstants.HYBRIDSEARCH.MESSAGEHINT);else if(b===$WC.WmsConstants.HYBRIDSEARCH.GENERICLIST){c.innerHTML="";var k=$WC.HybridSearch.generateSearchResults(d);c.innerHTML=$WC.HybridSearch.generateHtml(k),(k.length<10||$WC.Matcher.check("emailid",d,!0))&&$WC.HybridSearch.updateManager("fetch",null,null,!0)}else b===$WC.WmsConstants.HYBRIDSEARCH.DEFAULTRESULT&&(WmsHybridSearch.showRotationalHint(),$WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT?$WC.HybridSearch.getNode("defaultresultdiv").style.display="table":$WC.HybridSearch.getNode("defaultresultdiv").style.display="block",c.style.display="none");$WC.Util.loadOriginalImage($WC.HybridSearch.getNode("searchresultdiv"))},WmsHybridSearch.updatePresence=function(a){var b=document.getElementById("wms_menu_listcontainer");if(b){var c=b.querySelectorAll('[data-id="'+a+'"],[data-userid="'+a+'"]'),d=$WC.Util.unescapeHTML(WmsContacts.getStatusMsg(a));c=$WC.Util.convertToArray(c),c.forEach(function(b){b.firstChild.className="wms_badge_imgwrapper wms_badge_statusicon_"+WmsContacts.getStatusClassName(a),$WC.$CUtil.setInnerText(b.querySelector("[data-smsg]"),d),$WC.Util.setAttribute(b.querySelector("[data-smsg]"),"title",d)})}},WmsHybridSearch.populateContactListInMainUI=function(a,b){if(WmsMainUI.decideRepopulate("contactlist")||a){var c=$WC.HybridSearch.getNode("defaultresultdiv",$WC.WmsConstants.HYBRIDSEARCH.modules.CONTACTMENU);if($WC.Util.getObjectLength(WmsContacts.getContactsList())||$WC.Util.getObjectLength(WmsOrgContacts.getOrgContactsList())||$WC.Util.getObjectLength($WC.Bots.getList(!0))||!$WC.WmsOrgContacts.isSuggestionsRequested())c.innerHTML="",WmsHybridSearch.populateContactsUsingVirtualList(238,293,54,c,"mainui",b);$WC.Util.loadOriginalImage(WmsMainUI.defaultcontactlist),WmsMainUI.setRePopulateStatus("contactlist",!1)}},WmsHybridSearch.populateCustomContactListInMainUI=function(){var a=$WC.Config.get("customContacts").separatePane?$WC.WmsConstants.HYBRIDSEARCH.modules.CUSTOMCONTACTMENU:$WC.WmsConstants.HYBRIDSEARCH.modules.CONTACTMENU,b=$WC.HybridSearch.getNode("defaultresultdiv",a),c=WmsHybridSearch.generateCustomContactResults(null,!0);b.innerHTML="";var d=WmsHybridSearch.generateCustomContactsListHtml(c);b.innerHTML=d,$WC.Util.loadOriginalImage(WmsMainUI.defaultcontactlist)},WmsHybridSearch.populateGroupResultInMainUI=function(){if($WC.HybridSearch.getCurrentModule()!==$WC.WmsConstants.HYBRIDSEARCH.modules.SMARTCHAT&&typeof WmsMainUI!="undefined"&&WmsMainUI.decideRepopulate("grouplist")){var a=$WC.HybridSearch.generateHtml($WC.HybridSearch.generateChannelResults("",null,!0));a&&(document.getElementById("wms_menu_grouplist_def").innerHTML=a)}},WmsHybridSearch.decideResultSet=function(){var a=$WC.HybridSearch.getSearchText();if($WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.CUSTOMCONTACTMENU)return a===""?$WC.WmsConstants.HYBRIDSEARCH.DEFAULTRESULT:$WC.WmsConstants.HYBRIDSEARCH.CUSTOMCONTACTLIST;if($WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.CONTACTMENU)return a===""?$WC.WmsConstants.HYBRIDSEARCH.DEFAULTRESULT:$WC.WmsConstants.HYBRIDSEARCH.USERLIST;if($WC.HybridSearch.getCurrentModule()===$WC.WmsConstants.HYBRIDSEARCH.modules.GROUPMENU)return a===""?$WC.WmsConstants.HYBRIDSEARCH.DEFAULTRESULT:$WC.WmsConstants.HYBRIDSEARCH.CHANNELLIST;var b=$WC.HybridSearch.getNode("inputcontainer").querySelectorAll("[data-type]"),c,d;if(b.length&&a==="")return c=$WC.HybridSearch.getNode("inputcontainer").querySelectorAll("[data-type='user']"),d=$WC.HybridSearch.getNode("inputcontainer").querySelector("[data-type='topic']"),d&&(!c.length||c.length==1)||c.length==1?$WC.WmsConstants.HYBRIDSEARCH.EMPTYUSERHINT:d&&c.length>1?$WC.WmsConstants.HYBRIDSEARCH.EMPTYMSGHINT:c&&c.length>1?$WC.WmsConstants.HYBRIDSEARCH.EMPTYTITLEHINT:$WC.WmsConstants.HYBRIDSEARCH.EMPTY;return a===""?$WC.WmsConstants.HYBRIDSEARCH.DEFAULTRESULT:(c=$WC.HybridSearch.getNode("inputcontainer").querySelector("[data-type='user']"),d=$WC.HybridSearch.getNode("inputcontainer").querySelector("[data-type='topic']"),a.startsWith("@")?a.indexOf("#")>0?$WC.WmsConstants.HYBRIDSEARCH.CHANNELLIST:$WC.WmsConstants.HYBRIDSEARCH.USER_CHANNELLIST:a.startsWith("#")?a.indexOf("@")>0||!c?$WC.WmsConstants.HYBRIDSEARCH.CHANNELLIST:d?$WC.WmsConstants.HYBRIDSEARCH.EMPTY:$WC.WmsConstants.HYBRIDSEARCH.TITLEHINT:c?$WC.WmsConstants.HYBRIDSEARCH.MESSAGEHINT:b.length?$WC.WmsConstants.HYBRIDSEARCH.EMPTY:$WC.WmsConstants.HYBRIDSEARCH.GENERICLIST)},WmsHybridSearch.showInfoMessage=function(){var a;return function(b,c){WmsHybridSearch.hideInfoMessage();var d='<div id="wms-hysearch-infomsg" class="wms-hysearch-infomsg"><div class="wms-shake"><span style="font-weight: bold;">{{heading}}: </span><span>{{msg}}</span></div></div>',e=$WC.template.replace(d,{heading:b,msg:c});$WC.HybridSearch.getNode("mainUI").insertAdjacentHTML("beforeend",e),clearTimeout(a),a=setTimeout(WmsHybridSearch.hideInfoMessage,3e3)}}(),WmsHybridSearch.hideInfoMessage=function(){$WC.Util.removeElement($WC.HybridSearch.getNode("infomsgdiv"))},WmsHybridSearch.showRotationalHint=function(){var a=["hint.chatwithmsg","hint.searchtopic"];!$WC.Config.get("isOrgUser")()||$WC.Config.get("channels")=="disable"||!$WC.SecurityManager.hasPermission("channels")?a.unshift("search.contactsandchats"):a.unshift("search.commontitle"),$WC.Config.get("adhocchats")!="disable"&&a.push("hint.groupchat"),a[WmsHybridSearch.hintindex]===undefined&&(WmsHybridSearch.hintindex=0);var b=$WC.I18N(a[WmsHybridSearch.hintindex]);WmsHybridSearch.setPlaceHolderHint(b)},WmsHybridSearch.setPlaceHolderHint=function(a){$WC.$CUtil.setInnerTextById("wms-hysearch-placeholder",a)},WmsHybridSearch.inviteMember=function(a){WMSUI.inviteMember(a)},WmsHybridSearch.clearInvite=function(a){a.status==$WC.WmsConstants.CONTACTSTATUS.NOCHAT&&WmsContacts.getPendingInvitedContactsList().indexOf(a.zuid)===-1?WmsContacts.setPendingInvitedContactsList(a.zuid):a.status!=$WC.WmsConstants.CONTACTSTATUS.NOCHAT&&$WC.Util.removeElementFromArray(WmsContacts.getPendingInvitedContactsList(),a.zuid),$WC.Util.removeElementFromArray(WmsContacts.getInvitedContactsList(),a.zuid),document.getElementById("wms-hysearch")&&WmsHybridSearch.populateFrequentContactsInSmartChat();if(typeof WmsMainUI!="undefined"&&!$WC.Config.get("customContacts")){var b={};b.suggestions="show_suggestions",WmsHybridSearch.populateContactListInMainUI(!0,b),WmsMainUI.resetToDefaultUI()}},WmsHybridSearch.showInvite=function(a){WmsContacts.getInvitedContactsList().indexOf(a.zuid)===-1&&WmsContacts.getPendingInvitedContactsList().indexOf(a.zuid)===-1&&(WmsContacts.setInvitedContactsList(a.zuid),WmsContacts.setPendingInvitedContactsList(a.zuid));if(typeof WmsMainUI!="undefined"&&!$WC.Config.get("customContacts")){WmsMainUI.updateChatInvitationCount();var b={};b.suggestions="show_suggestions",WmsHybridSearch.populateContactListInMainUI(!0,b)}document.getElementById("wms-hysearch")&&WmsHybridSearch.populateFrequentContactsInSmartChat()},WmsHybridSearch.generateCustomContactResults=function(a,b){var c=[],d=[],e=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").customContactsList);if(b){c=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").invitationsList),c=c?c:[];if($WC.Util.isArray(e))d=c.concat(e);else if($WC.Util.getObjectLength(e)){var f=[];for(var g in e)if($WC.Util.isArray(e[g])){f.push(g);var h=e[g];h.forEach(function(a){f.push(a)})}d=c.concat(f)}else d=c}else d=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").customContactsList,a);return d},WmsHybridSearch.generateCustomContactsListHtml=function(a){function c(a){var b="wms_menu_item",c="",e="",f="",g="",h="",i="",j="",k="",l="";if(typeof a=="string"){var m='<div class="wms_menu_subheading" data-heading="{{heading}}">{{heading}}</div>';return $WC.template.replace(m,{heading:a})}a.time&&(c='<span class="wms_menu_item_time" title="'+$WC.DateUtil.formatDateWithWords(a.time)+'">'+$WC.DateUtil.formatTime(a.time)+"</span>");var n=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").getUnreadCount,a.id)||!1;n?(f='<span style="display:block" class="wms_menu_item_count" data-unreadcount=true>'+n+"</span>",WmsMainUI.setUnreadCount(a.id,n,$WC.Config.get("customContacts").separatePane)):(f='<span class="wms_menu_item_count" data-unreadcount=true></span>',WmsMainUI.resetUnreadCount(a.id,$WC.Config.get("customContacts").separatePane)),WmsMainUI.updateUnreadCountInUI(a.id);var o=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").isInvitationPending,a)||!1;o?(l=a.statusMsg?a.statusMsg:a.mailId,b="wms_menu_item_invitations"):l=a.statusMsg;var p=l?"wms_menu_item_name wms-truncate-ellipsis":"wms_menu_item_name wms-truncate-ellipsis wms-valign-mid-block";j='<div class="'+p+'" title="{{dname}}">{{dname}}</div>',e=d(a),g='<div class="wms_menu_item_msg wms-truncate-ellipsis" data-smsg="true" title="'+l+'">'+l+"</div>";if($WC.Config.get("customContacts").getChatOwner){var q=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").getChatOwner,a.id);if(q&&q.id!=$WC.Config.get("zuid"))var r=d(q)}o&&(i='<div class="wms_menu_inv" data-dname="{{dname}}"><span data-customoperation="{{invitationAcceptLabel}}" data-id="{{id}}" data-type="{{type}}" title="{{invitationAcceptLabel}}" class="wms_menu_invaccept" > {{invitationAcceptLabel}} </span><span>  |  </span><span data-customoperation="{{invitationDeclineLabel}}" data-id="{{id}}" data-type="{{type}}" title="{{invitationDeclineLabel}}" class="wms_menu_invreject" > {{invitationDeclineLabel}} </span></div>'),r?h='<div class="wms_menu_item_profile_icon_img wms-valign-mid-block" data-zcprofileid="'+a.id+'" style="visibility:visible">'+r+"</div>":!n&&$WC.Config.get("customContacts").disableProfileIcon!==!0&&(h='<div class="wms_menu_item_profile_icon wms-valign-mid-block" data-zcprofileid="'+a.id+'"></div>'),k='<div class="'+b+'" data-id="{{id}}" data-chid="{{chid}}" data-dname="{{dname}}" data-type="{{type}}">'+e+j+c+g+i+f+h+"</div>";var s=a.invitationActions||$WC.Config.get("customContacts").invitationActions||null,t={id:a.id,chid:a.chid||"",time:a.time,type:$WC.WmsConstants.HYBRIDSEARCH.CONTACT,dname:$WC.Util.unescapeHTML(a.name),invitationAcceptLabel:s?s[0].label:$WC.I18N("Accept"),invitationDeclineLabel:s?s[1].label:$WC.I18N("remind.later")};return $WC.template.replace(k,t)}function d(a){var b="",c=WmsImplHandler.invokeSynchronously($WC.Config.get("customContacts").getStatusClass,a.id)||"",d=$WC.Config.get("customContacts").separatePane?"":'data-zcprofileid="'+a.id+'"';return a.name&&a.photo?b="<img "+d+'src="'+a.photo+'"/>':b="<span "+d+'class="wms_badge_letter">'+$WC.HybridSearch.getBadgeLetters(a.name)+"</span>",'<span class="wms_badge_imgwrapper wms_badge_statusicon_'+c+'">'+b+"</span>"}var b="";return a.forEach(function(a){b+=c(a)}),b},WmsHybridSearch.bindEvents=function(){var a=$WC.HybridSearch.getNode("mainUI");Gator(a).on("click","[class~=wms-hysearch-result] ",function(){WmsHybridSearch.handleClick(this)}),Gator(a).on("click","[data-retry]",function(){WmsHybridSearch.handleClick(this)}),Gator(a).on("click","[data-addcontact]",function(){WmsHybridSearch.handleClick(this)}),Gator(a).on("click","[data-innerfragclose]",function(a){WmsHybridSearch.removeChosenText(a,this)}),Gator(a).on("mouseover","[data-innerfrag]",function(){WmsHybridSearch.showCloseIcon(this)}),Gator(a).on("mouseout","[data-innerfrag]",function(){WmsHybridSearch.hideCloseIcon(this)}),Gator(a).on("click","#wms-hysearch-placeholder",WmsHybridSearch.focusInput),Gator(a).on("click","[class=wms-hysearch-closeicon]",WmsHybridSearch.hideUI),Gator(a).on("click","[class=wms-hysearch-tipsicon]",WmsHybridSearch.toggleTipsUI)};var WmsDialog={};WmsDialog.showModal=function(a,b){WmsDialog.removeModal(),ZMSGUI.createOverlay(),WmsDialog.operations=a.operations;var c='<div class="wms-dialogheader"><span class="wms-dialogclose" data-operation="close"></span></div><div class="wms-dialogcontent"><div class="wms-dialogtext">',d=a.imghtml?a.imghtml:"",e=a.width||"480",f=a.bodyhtml?a.bodyhtml:"",g='</div><div class="wms-dialog-inpcont">';for(var h=0;h<a.operations.length;h++){var i=a.operations[h].classname?a.operations[h].classname:"wms-dialog-acceptbtn",j=a.operations[h].name;a.operations[h].link?g+='<a href="'+a.operations[h].link+'" target="_blank" rel="noopener"><input type="button" class="'+i+'" tabindex="'+(h+1)+'" value="'+j+'"></input></a>':g+='<input type="button" class="'+i+'" tabindex="'+(h+1)+'" value="'+j+'"></input>'}g+="</div></div>";var k=c+d+f+g,l=b?{"data-ownerchatid":b}:null,m=$WC.Util.createElement("div","wms-dialog","wms-dialogparent wms-hvalign",l,k);m.style.zIndex=$WC.Config.get("zindex"),m.style.width=e+"px",m.onclick=function(a){var b=$WC.Util.getEventTarget(a),c=b.getAttribute("tabindex"),d=b.getAttribute("data-operation");if(d=="close")WmsDialog.removeModal();else if(c){var e=WmsDialog.operations[c-1].action;e&&e.call(),WmsDialog.removeModal()}};var n=document.body.appendChild(m);n.querySelector('[tabindex="'+a.focusbutton+'"]').focus()},WmsDialog.removeModal=function(){ZMSGUI.removeOverlay();if(document.getElementById("wms-dialog")){var a=document.getElementById("wms-dialog").getAttribute("data-ownerchatid");$WC.Util.removeElement(document.getElementById("wms-dialog")),a&&WindowHandler.focusChatById(a)}};var WmsMediaPlayer={supported_audio_formats:[],supported_video_formats:[],videoelement:"",cache:{},init:function(a,b,c,d){var e=a.target.getAttribute("data-operation")||a.target.getAttribute("data-attr");a.target.parentNode.getAttribute("data-attr")&&(e=a.target.parentNode.getAttribute("data-attr"));var f=WmsMediaPlayer.getCacheObject(c,b,d);e==="fullscreen"?WmsMediaPlayer.fullscreen(c):(e==="pause"||e==="play")&&WmsMediaPlayer.togglePlayAndPause(d,c,f)},initSupportedAudioFormats:function(){var a=new Audio,b=["mp3","mpeg","wav","aac","amr","flac","gsm","tta","wv","x-wav","x-m4a","mp4"];for(var c=0,d=b.length;c<d;c++)a.canPlayType("audio/"+b[c])!==""&&a.canPlayType("audio/"+b[c])!=="no"&&this.supported_audio_formats.push("audio/"+b[c])},initSupportedVideoFormats:function(){var a=$WC.Util.createElement("video");this.IS_VIDEO_TAG_SUPPORTED=!!a.canPlayType;var b=["webm","mkv","flv","ogg","avi","mov","qt","wmv","asf","mp4","3gp","quicktime"];for(var c=0,d=b.length;c<d;c++)a.canPlayType("video/"+b[c])!==""&&a.canPlayType("video/"+b[c])!=="no"&&this.supported_video_formats.push("video/"+b[c])},isSupportedAudioFormat:function(a){return this.supported_audio_formats.indexOf(a)>-1?!0:!1},isSupportedVideoFormat:function(a){return this.supported_video_formats.indexOf(a)>-1?!0:!1},getCacheObject:function(a,b,c){var d=a.getAttribute("data-fsrc").split("&"),e=d[1]&&d[1].substring(4)||d,f=a.getAttribute("data-fsrc"),g;return WmsMediaPlayer.cache[b]||(WmsMediaPlayer.cache[b]={}),WmsMediaPlayer.cache[b][c]||(WmsMediaPlayer.cache[b][c]={}),WmsMediaPlayer.cache[b][c][e]?WmsMediaPlayer.cache[b][c][e]:(a.getAttribute("id")==="wms-audioplayer"?g=new Audio(f):(g=a.querySelector("#wms-video"),g.setAttribute("src",f)),WmsMediaPlayer.cache[b][c][e]=g,WmsMediaPlayer.bindEvents(a,g),g)},bindEvents:function(a,b){b.ontimeupdate=function(){var c=WmsMediaPlayer.formatTime(b.currentTime);$WC.$CUtil.setInnerText(a.querySelector('[data-operation="curtime"]'),c);var d=b.duration-b.currentTime;d===0&&(d=b.duration),a.querySelector('[data-operation="remtime"]')&&$WC.$CUtil.setInnerText(a.querySelector('[data-operation="remtime"]'),"- "+WmsMediaPlayer.formatTime(d))},b.onloadedmetadata=function(){var c="/ "+WmsMediaPlayer.formatTime(b.duration);$WC.$CUtil.setInnerText(a.querySelector('[data-operation="duration"]'),c),a.querySelector('[id="wms-videotime"]')&&(a.querySelector('[id="wms-videotime"]').style.display="block"),a.querySelector('[data-operation="remtime"]')&&(a.querySelector('[data-operation="remtime"]').className="wms-audioremtime",$WC.$CUtil.setInnerText(a.querySelector('[data-operation="remtime"]'),"- "+c))},b.onended=function(){WmsMediaPlayer.showPlayPause(a,"play"),$WC.$CUtil.setInnerText(a.querySelector('[data-operation="curtime"]'),"0:00")}},bindFullScreenEvent:function(){var a=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"];for(var b=0;b<a.length;b++)WmsMediaPlayer.handleFullScreen(a[b])},handleFullScreen:function(a){document.addEventListener(a,function(){WmsMediaPlayer.fullScreen()})},togglePlayAndPause:function(a,b,c){c.paused?(WmsMediaPlayer.stopAllMedia(),WmsMediaPlayer.showPlay(a),WmsMediaPlayer.showPlayPause(b,"pause"),b.querySelector('[id="wms-mediaplaypause"]').setAttribute("data-attr","pause"),b.querySelector('[id="wms-videoscreenplaypause"]')&&setTimeout(function(){b.querySelector('[id="wms-videoscreenplaypause"]').setAttribute("style","display:none")},3e3),c.play()):(WmsMediaPlayer.showPlayPause(b,"play"),b.querySelector('[id="wms-mediaplaypause"]').setAttribute("data-attr","play"),c.pause()),b.querySelector('[id="wms-videoscreenplaypause"]')&&b.querySelector('[id="wms-videoscreenplaypause"]').setAttribute("style","display:block")},formatTime:function(a){var b=Math.floor(a/60),c=Math.floor(a-b*60);return b<10&&(b="0"+b),c<10&&(c="0"+c),b+":"+c},stopPlayingMedia:function(a,b){if(b){if(WmsMediaPlayer.cache[a]){for(var c in WmsMediaPlayer.cache[a][b])WmsMediaPlayer.cache[a][b][c].pause();delete WmsMediaPlayer.cache[a][b]}}else{for(var d in WmsMediaPlayer.cache[a])for(var e in WmsMediaPlayer[a][d])WmsMediaPlayer[a][d][e].pause();delete WmsMediaPlayer.cache[a]}},fullscreen:function(a){a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen(),WmsMediaPlayer.videoelement=a,a.querySelector("#wms-videoinfo").className="wms-videoinfofullscreen wms-videoinfo",a.setAttribute("style","height:"+(screen.height-40)+"px;border:none;width:100%"),a.querySelector("#wms-mediaplaypause").setAttribute("style","height:"+(screen.height-40)+"px;background-color:black;"),a.querySelector("#wms-videofullscreen").setAttribute("style","display:none"),a.querySelector("#wms-videofilefrwrd").setAttribute("style","display:none")},stopAllMedia:function(){for(var a in WmsMediaPlayer.cache)for(var b in WmsMediaPlayer.cache[a])for(var c in WmsMediaPlayer.cache[a][b])WmsMediaPlayer.cache[a][b][c].pause()},showPlay:function(a){var b=document.getElementById(a)||document.getElementById("wmschshtransmsg"),c=b.querySelectorAll('[data-operation="play"]'),d=b.querySelectorAll('[data-operation="pause"]'),e=b.querySelectorAll('[id="wms-videocurtime"]');for(var f=0;f<c.length;f++)c[f].style.display="block",d[f].style.display="none";for(var g=0;g<e.length;g++)e[g].innerHTML="00.00"},showPlayPause:function(a,b){var c=a.querySelectorAll('[data-operation="play"]'),d=a.querySelectorAll('[data-operation="pause"]');for(var e=0;e<c.length;e++)c[e].style.display=b==="play"?"block":"none",d[e].style.display=b==="play"?"none":"block"},fullScreen:function(){if(!(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement)){var a=WmsMediaPlayer.videoelement;a&&(a.querySelector("#wms-videoinfo").className="wms-videoinfo",a.querySelector("#wms-mediaplaypause").removeAttribute("style"),a.querySelector("#wms-videofullscreen").setAttribute("style","display:block"),a.querySelector("#wms-videofilefrwrd").setAttribute("style","display:block"),a.setAttribute("style","width:100%"))}}};ListCommon.prototype.getListHTML=function(a,b){var c="",d=a.USERID||a.id;d=a.ISBOT?"b-"+d:d;var e=$WC.Util.getContactName(d)||a.DNAME||a.name,f=WmsContacts.getEmailId(d)||a.EMAILID||a.description||"",g=a.STATUS||"",h=a.STYPE||"",i=a.STATUSCLASS||"";b?c=a.photo||"":a.id||(c=$WC.Bots.isBotId(d)?$WC.Bots.getPhoto(d):WmsContacts.getUserPhoto(d));var j='<div class="wms-filefrwrdcontact" data-dname="{{dname}}" data-userid="'+d+'" data-list="true">';return c&&(j+='<span class="wms-filefrwrdcontactspan"><div class="wms-filefrwrdcontactdiv"><img class="wms-filefrwrdcontactimg wms-autocompleteimg" src={{image}}><span class="{{statusclass}}"></span></div></span>'),j+='<span class="wms-filefrwrdcontactdetails wms-truncate-ellipsis" title="{{dname}}">{{dname}}</span><span class="wms-truncate-ellipsis wms-filefrwrddesc wms-valign-mid-block" title="{{emailid}}">{{emailid}}</span></div>',h==WmsContacts.userstatus.MOB_LOGIN?g==WmsContacts.userstatus.OFFLINE?i="wms-filefrwrdcontactstatus wms-contactstatus wms-statusicon-offline":g==WmsContacts.userstatus.ONLINE?i="wms-filefrwrdcontactstatus wms-contactstatus wms-statusicon-available-mobile":g==WmsContacts.userstatus.BUSY?i="wms-filefrwrdcontactstatus wms-contactstatus wms-statusicon-busy-mobile":g==WmsContacts.userstatus.AWAY?i="wms-filefrwrdcontactstatus wms-contactstatus wms-statusicon-away":g==WmsContacts.userstatus.IDLE&&(i="wms-filefrwrdcontactstatus wms-contactstatus wms-statusicon-idle-mobile"):g?g==WmsContacts.userstatus.AWAY?i="wms-filefrwrdcontactstatus wms-contactstatus wms-statusicon-away":i="wms-filefrwrdcontactstatus wms-filefrwrdscode-"+g:a.ISBOT&&(i="wms-filefrwrdcontactstatus wms_boticon"),$WC.template.replace(j,{dname:$WC.Util.unescapeHTML(e),emailid:f,statusclass:i,image:c})},ListCommon.prototype.showUI=function(a,b,c,d,e){this.sethtml=c;var f=this,g="";$WC.Util.isArray(a)&&!c?a.forEach(function(a){if(d){var b=a.USERID||a.id;b=a.ISBOT?"b-"+b:b,f.container.querySelector('[data-userid="'+b+'"]')||(g+=f.getListHTML(a,e))}else g+=f.getListHTML(a,e)}):c&&(g=a),d?(this.container.innerHTML+=g,c||(this.selectedelem=this.container.querySelector('[class="wms-filefrwrdcontactsel"]'),this.selectElem(this.selectedelem,!0))):(this.container.innerHTML=g,this.container.scrollTop=0,this.selectedelem="",b&&(this.container.firstChild.getAttribute("data-list")?this.selectedelem=this.container.firstChild:this.selectedelem=this.container.firstChild.firstChild,this.selectElem(this.selectedelem,!0)))},ListCommon.prototype.handleKeyMovement=function(a,b){var c=a.keyCode,d=$WC.Util.getEventTarget(a),e;if(c!==$WC.WmsConstants.KEYCODES.LEFT&&c!==$WC.WmsConstants.KEYCODES.RIGHT||WMSUI.curtrigger!==":")if(c===$WC.WmsConstants.KEYCODES.UP||c===$WC.WmsConstants.KEYCODES.DOWN)b.selectElem(b.selectedelem,!1),b.selectedelem=b.selectedelem?$WC.$CUtil.getConditionalNextNode(b.selectedelem,c,"data-list"):b.container.firstChild,b.selectElem(b.selectedelem,!0),WMSUI.curtrigger===":"?WMSUI.autoComplete.bringElemToView(b.selectedelem,c):b.selectedelem&&$WC.Util.bringElemToView(b.selectedelem,c),a.preventDefault();else if(c===$WC.WmsConstants.KEYCODES.ENTER){if(b.selectedelem){if(WebMessanger.userslist)WebMessanger.userslist.handleKeyMovement(a);else if(WebMessanger.forkedlist)WebMessanger.forkedlist.handleKeyMovement(a);else if(WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.SLASH||WMSUI.curtrigger==="-"&&d.value.indexOf($WC.WmsConstants.TRIGGERS.SLASH)!=-1)Commands.select(d,b.selectedelem);else if(WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ATMENTION||WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ADDMEM)WMSUI.atMentions.select(d,b.selectedelem);else if(WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.SMILEY)WMSUI.autoComplete.select(d,b.selectedelem);else if(b.selectedelem.getAttribute("data-botsuggestion")){var i=b.selectedelem.getAttribute("data-suggestiontext");WindowHandler.sendBotSuggestions(d,i)}a.preventDefault()}}else WebMessanger.userslist?WebMessanger.userslist.handleKeyMovement(a):WebMessanger.forkedlist&&WebMessanger.forkedlist.handleKeyMovement(a);else{b.selectElem(b.selectedelem,!1);var f=b.container.firstChild,g=0;b.selectedelem&&(f=b.selectedelem.parentNode);while(g<f.childElementCount)b.selectedelem===f.childNodes[g]&&(e=g),g++;var h=$WC.$CUtil.getNextRotationalNode(f,c);b.selectedelem=h.childNodes[e],b.selectElem(b.selectedelem,!0),a.preventDefault()}},ListCommon.prototype.selectElem=function(a,b){if(!a&&this.sethtml)return;var c=a.getAttribute("class").replace(/sel$/,""),d=b?c+"sel":c;a.setAttribute("class",d)},ListCommon.prototype.handleClick=function(a,b){a=a.closest('[data-list="true"]');if(a.getAttribute("data-botsuggestion")){var c=a.getAttribute("data-suggestiontext");WindowHandler.sendBotSuggestions(b.input,c)}else WebMessanger.userslist?WebMessanger.userslist.handleClick(a):WebMessanger.forkedlist?WebMessanger.forkedlist.handleClick(a):WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.SLASH||WMSUI.curtrigger==="-"&&b.input.value.indexOf($WC.WmsConstants.TRIGGERS.SLASH)!=-1?Commands.select(b.input,a):WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ATMENTION||WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ADDMEM?WMSUI.atMentions.select(b.input,a):WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.SMILEY&&WMSUI.autoComplete.select(b.input,a);b.selectedelem=a},WMSUI.autoComplete={fetchsmileylist:!0,init:function(a,b){WMSUI.atMentions.changeColor(b);var c=b.value.substring(0,b.selectionStart),d="",e=c.lastIndexOf(" "+$WC.WmsConstants.TRIGGERS.SMILEY)+1;if(e>0||e===0&&c.indexOf($WC.WmsConstants.TRIGGERS.SMILEY)===0||e===0&&c[c.lastIndexOf($WC.WmsConstants.TRIGGERS.SMILEY)-1]==="\n"){var f=WMSUI.autoComplete.getSearchTerm(a,c);d=WMSUI.autoComplete.populateSmiley(a,f),d&&WMSUI.autoComplete.showUI(a,d,!0,!0)}else WMSUI.autoComplete.hideUI(a)},showUI:function(a,b,c,d){var e=WindowHandler.getWinObjById(a),f=e.autocompletediv,g=e.listcommon;g.showUI(b,c,d),f.style.display="block",e.footernode.style.borderRadius="0px 0px 5px 5px"},hideUI:function(a){var b=WindowHandler.getWinObjById(a);b.autocompletediv.style.display="none",b.editorreplydiv.style.display!=="block"&&(b.footernode.style.borderRadius="5px")},getSearchTerm:function(a,b){var c=/:\w+:/g;b=b.replace(c,"");var d=b.lastIndexOf($WC.WmsConstants.TRIGGERS.SMILEY);if(b[d-1]==="\n"||b[d-1]===" "||d===0)return WMSUI.autoComplete.fetchsmileylist=!0,b.substring(d+1);WMSUI.autoComplete.fetchsmileylist=!1;return},populateSmiley:function(a,b){var c="",d="",e="";if(!WMSUI.autoComplete.fetchsmileylist){WMSUI.autoComplete.hideUI(a);return}var f=Smiley.sortSmileys(Smiley.getSmileyLookup(b),b,!0),g=0;for(var h=0;h<f.length;h++){var i=f[h],j=Smiley.textcodes_lookup[i]||i;h%2===0?e+='<div class="wms-smileyinnerdiv" data-list="true" data-smileycode="'+i+'">'+Smiley.replace(i)+'<span class="wms-smileyname">'+j+"</span></div>":d+='<div class="wms-smileyinnerdiv" data-list="true" data-smileycode="'+i+'">'+Smiley.replace(i)+'<span class="wms-smileyname">'+j+"</span></div>",g++}return f.length?c='<div class="wms-smileylist">'+e+"</div><div>"+d+"</div>":WMSUI.autoComplete.hideUI(a),c},select:function(a,b){var c=a.selectionStart,d=a.getAttribute("chid"),e=document.getElementById(d),f=e.querySelector('[id="wms-editorscrolldiv"]'),g=WindowHandler.getWinObjById(d),h=g.autocompletediv,i=b.getAttribute("data-smileycode");i.indexOf("!")>-1?i=":"+Smiley.textcodes_lookup[i]+"!: ":i=":"+Smiley.textcodes_lookup[i]+": ";var j=a.value;j=j.substring(0,c);var k=j.lastIndexOf(" "+$WC.WmsConstants.TRIGGERS.SMILEY)+1;if(k>0||k===0&&j.indexOf($WC.WmsConstants.TRIGGERS.SMILEY)===0||k===0&&j[j.lastIndexOf($WC.WmsConstants.TRIGGERS.SMILEY)-1]==="\n")j[j.lastIndexOf(WMSUI.curtrigger)-1]==="\n"&&(k=j.lastIndexOf("\n"+WMSUI.curtrigger)+1),a.value=a.value.substring(0,k)+i+a.value.substring(c),$WC.Util.moveCaretPosition(a,k+i.length,k+i.length),WMSUI.atMentions.setScrollPosition(f,a),WMSUI.atMentions.changeColor(a);g.listcommon.showUI(""),h.style.display="none",WMSUI.currenttrigger="",g.footernode.style.borderRadius="5px"},bringElemToView:function(a,b){if(WMSUI.autoComplete.isViewableInScroll(a)===!1){var c=a.offsetTop-a.parentNode.offsetTop;b===$WC.WmsConstants.KEYCODES.UP?a.parentNode.parentNode.scrollTop=c-10:b===$WC.WmsConstants.KEYCODES.DOWN&&(a.parentNode.parentNode.scrollTop=c+a.offsetHeight+10-a.parentNode.parentNode.offsetHeight)}},isViewableInScroll:function(a){var b=a.parentNode.parentNode.scrollTop,c=a.parentNode.parentNode.scrollTop+a.parentNode.parentNode.offsetHeight,d=a.offsetTop-a.parentNode.offsetTop,e=d+a.offsetHeight;return d>=b&&e<c?!0:!1}},WMSUI.atMentions={specialmentions:{keys:["available","participants"],getDisplayName:function(a,b){var c=WmsSettings.adminsettings.features.specialmentions_hash;for(var d in c)if(a==d||c[d].unique_key.indexOf(b)!==-1)return c[d].display_name}},fetchmentionlist:!0,getPartInfo:$WC.Util.debounce(function(a){var b=WindowHandler.getWinObjById(a);b.ctype==="8"&&($WC.Util.getObjectLength(b.partinfo)<b.partcount&&WebMessanger.fetchAndShowChannelMembers(b.objId),$WC.Channels.isTeamChannel(a)&&WebMessanger.fetchTeamChannelMembers(a))},null,1e3,!0),init:function(a,b,c){var d=[],e=b.value.substring(0,b.selectionStart),f=e.lastIndexOf(" "+WMSUI.curtrigger)+1,g=WindowHandler.getWinObjById(a),h=g.autocompletediv,i=g.listcommon,j=c&&c.callbackargs&&c.callbackargs.silentload;if(g.disablemembercontrol===!0&&WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ADDMEM||g.salesiqchat)return;WMSUI.atMentions.changeColor(b);if(f>0||f==0&&e.indexOf(WMSUI.curtrigger)==0||f==0&&e[e.indexOf(WMSUI.curtrigger)-1]=="\n"){var k=WMSUI.atMentions.getSearchTerm(a,e);WMSUI.atMentions.fetchmentionlist&&(d=WMSUI.atMentions.getContactList(a,k,j))}d&&d.length?(i.showUI(d,!0,null,j),h.style.display="block",g.footernode.style.borderRadius="0px 0px 5px 5px",(d.length<5||$WC.Matcher.check("emailid",k,!0))&&WmsOrgContacts.isCachedRequest(k)===!1&&WmsHybridSearch.getNextResultSet({searchtext:k,inpresultset:$WC.WmsConstants.HYBRIDSEARCH.USERLIST,chid:a,topicname:"listview",silentload:!0})):k&&(!c||c.stat!==$WC.WmsConstants.REQSTATUS.NORESULTS)?WmsHybridSearch.getNextResultSet({searchtext:k,inpresultset:$WC.WmsConstants.HYBRIDSEARCH.USERLIST,chid:a,topicname:"listview"}):WMSUI.autoComplete.hideUI(a)},getDname:function(a,b){if(!b)return;var c=$WC.Util.getContactName(b);if(!c){var d=WindowHandler.getWinObjById(a).partinfo;c=d[b]&&d[b].dname}return c},getSearchTerm:function(a,b){var c=WindowHandler.getWinObjById(a),d=c.atmentions?c.atmentions.split(","):"";$WC.Util.isArray(d)&&d.forEach(function(c){var d=WMSUI.atMentions.getDname(a,c),e='<span class="wms-atmtntext"> '+WMSUI.curtrigger+d+"</span>",f=WMSUI.curtrigger+d;f=f.replace(/(?=[$*+\[\]() ])/g,"\\");var g=new RegExp(f,"g");b=b.replace(g,e)});var e=/<span class="wms-atmtntext">(.+?)<\/span>/g,f=b.replace(e,""),g=f.lastIndexOf(WMSUI.curtrigger);if(f[g-1]==="\n"||f[g-1]===" "||g===0)return WMSUI.atMentions.fetchmentionlist=!0,f.substring(g+1);WMSUI.atMentions.fetchmentionlist=!1;return},getContactList:function(a,b,c){function j(a,b){var c,d=[];if(a||b>2){c=WmsSettings.adminsettings.features.specialmentions_hash;for(var e in c)d.push({id:c[e].unique_key.slice(c[e].unique_key.indexOf("@")+1),name:c[e].display_name,description:c[e].desc});return d}}function k(a){var b=[];if(WindowHandler.getWinObjById(a).atmentions){var c=WindowHandler.getWinObjById(a).atmentions.slice(0,-1).split(",");$WC.Util.isArray(c)&&c.forEach(function(a){b.push(a)})}return b}function l(a,b,c){var d=[],e=[],f;b===$WC.WmsConstants.CHANNELS.TEAM?f=$WC.Channels.getTeamChannelMembers(a):f=WindowHandler.getWinObjById(a).partinfo;for(var g in f){if($WC.Util.isLocalUser(g))continue;WmsContacts.get(g,!0)?d.push(WmsContacts.get(g,!0)):d.push(WMSUI.atMentions.wrapParticipantsObj(f[g])),e.push(g)}return c?e:d}function m(a){var b=[];return a.filter(function(a){b.push(a.USERID)}),b}function n(a,b){return b={USERID:b||[]},$WC.HybridSearch.filter("DNAME",a,WmsContacts.getContactsList(),10,b,"EMAILID")}function o(a,b){return b={USERID:b||[]},$WC.HybridSearch.filter("DNAME",a,$WC.Bots.getList(!0),10,b,"EMAILID")}function p(a,b){return b={USERID:b||[]},$WC.HybridSearch.filter("DNAME",a,WmsOrgContacts.getOrgContactsList(),10,b,"EMAILID")}var d=[],e=[],f=WindowHandler.getWinObjById(a),g=f.ctype,h=g=="8"?!0:!1,i=f.partinfo;WMSUI.atMentions.getPartInfo(a);if(WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ATMENTION&&g!="5"&&(!h||$WC.Channels.isUserHasPermission(a,$WC.WmsConstants.USERPERMISSIONS.MENTION_USERS))){WebMessanger.isSpecialMentionEnabled()&&(d=$WC.HybridSearch.filter("name",b,j(h,f.partcount),10)),WmsOrgContacts.isEmptyResultReq(b)===!1&&$WC.Channels.isSharedChannel(a)===!1&&!c&&Commands.showLoadingIcon(f.autocompletediv,a),e={USERID:k(a)},d=d.concat($WC.HybridSearch.filter("DNAME",b,l(a),10,e,"EMAILID"));if(!h||$WC.Channels.isSharedChannel(a)===!1&&$WC.Util.getObjectLength(i))d=d.concat(n(b,l(a,null,!0))),d=d.concat(o(b,l(a,null,!0))),d.length<5&&(d=d.concat(p(b,m(d))));return d}if(WMSUI.curtrigger===$WC.WmsConstants.TRIGGERS.ADDMEM&&g!="5"&&(!h||$WC.Channels.isUserHasPermission(a,$WC.WmsConstants.USERPERMISSIONS.ADD_MEMBER)))return e={USERID:k(a).concat(l(a,null,!0))},h&&$WC.Channels.isTeamChannel(a)?($WC.Util.isEmptyObject($WC.Channels.getTeamChannelMembers(a))&&Commands.showLoadingIcon(f.autocompletediv,a),d=$WC.HybridSearch.filter("DNAME",b,l(a,$WC.WmsConstants.CHANNELS.TEAM),10,e,"EMAILID")):(d=$WC.HybridSearch.filter("DNAME",b,n(b),10,e,"EMAILID"),d=d.concat(p(b,e.USERID.concat(m(d)))),d=$WC.HybridSearch.filter("DNAME",b,d,20,null,"EMAILID")),d},wrapParticipantsObj:function(a){var b={};return b.DNAME=a.dname||a.DNAME,b.USERID=a.uname||a.ZUID,b.STATUS=a.scode,b.STYPE=a.st,b.EMAILID=a.email||a.EMAILID,b.UC=b.UC||"0",b},select:function(a,b){var c=b.getAttribute("data-userid"),d=a.getAttribute("chid"),e=$WC.Util.unescapeHTML(WMSUI.atMentions.getDname(d,c)||b.getAttribute("data-dname"))+" ",f=a.selectionStart,g=document.getElementById(d),h=g.querySelector('[id="wms-editorscrolldiv"]'),i=WindowHandler.getWinObjById(a.getAttribute("chid")),j=i.autocompletediv,k=a.value;k=k.substring(0,f),e=e.indexOf(WMSUI.curtrigger)===0?e.substring(1):e,WindowHandler.getWinObjById(d).listcommon.showUI(""),j.style.display="none";var l=k.lastIndexOf(" "+WMSUI.curtrigger)+1;if(l>0||l===0&&k.indexOf(WMSUI.curtrigger)===0||l===0&&k[k.lastIndexOf(WMSUI.curtrigger)-1]==="\n")k[k.lastIndexOf(WMSUI.curtrigger)-1]==="\n"&&(l=k.lastIndexOf("\n"+WMSUI.curtrigger)+1),a.value=a.value.substring(0,l+1)+e+a.value.substring(f),$WC.Util.moveCaretPosition(a,l+e.length+1,l+e.length+1),WMSUI.atMentions.setScrollPosition(h,a),WMSUI.atMentions.insertAtmentions(a.getAttribute("chid"),c),WMSUI.atMentions.changeColor(a);i.footernode.style.borderRadius="5px"},changeColor:function(a){var b=$WC.Util.escapeHTML(a.value),c=a.getAttribute("chid"),d=WindowHandler.getWinObjById(c),e=d.invisiblediv;d.selectedoptions?e.innerHTML=Commands.format(b,d.selectedoptions,c):d.atmentions&&(e.innerHTML=WMSUI.atMentions.formatAtMentions(b,d.atmentions,c));if(a.getAttribute("data-command")){var f=e.innerHTML;e.innerHTML=f.replace(a.getAttribute("data-command"),'<span class="wms-commandtext">'+a.getAttribute("data-command")+"</span>")}e.scrollTop=a.scrollTop},format:function(a,b){var c="1",d="4";a=$WC.Util.formatMentions(a,b);var e=function(e,f){e==="silentmention"?a=$WC.Config.get("getSilentUserMention")(a):a=$WC.Matcher.replace(e,a,function(a,e,g,h){var i=h,j=g,k=e;return i=$WC.Config.get("zuid")==k?$WC.Util.safeHTML($WC.Util.unescapeHTML($WC.Config.get("dname"))):$WC.Util.getContactName(k,i,!0),b?f+i:'<span class="wms-atmtnlink" '+(j!==c&&j!==d||'data-zcprofileid="'+k+'"')+">"+f+""+i+"</span>"})};return e("atmention","@"),e("addmember","+"),e("silentmention"),a},getSilentMentionHtml:function(a){return $WC.Matcher.replace("usersilentmention",a,function(a,b,c,d){var e=c,f=d;f&&(e=WmsContacts.getZuid(f));var g=$WC.Util.isLocalUser(e)?WebMessanger.getNickName():WmsContacts.getDisplayName(e)||b;return'<span class="wms-atmtnlink" data-zcprofileid="'+e+'">'+"@"+$WC.Util.safeHTML($WC.Util.unescapeHTML(g))+"</span>"})},insertAtmentions:function(a,b,c){var d=WindowHandler.getWinObjById(a),e=d.composer.value,f=d.atmentions?d.atmentions.split(","):"";c?(d.atmentions=d.atmentions.replace(b+",",""),d.selectedoptions=d.selectedoptions.replace(WMSUI.atMentions.getDname(a,b)+",","")):f.indexOf(b)<0&&(d.atmentions+=b.concat(","),e.startsWith($WC.WmsConstants.TRIGGERS.SLASH)&&(d.selectedoptions+=WMSUI.curtrigger+WMSUI.atMentions.getDname(a,b).concat(","))),$WC.WmsSessionStorage.setChatInfo({chid:a,atmentions:d.atmentions})},isLocalUserMentioned:function(a){return a.meta&&a.meta.mentions&&(a.meta.mentions.participants||a.meta.mentions.available&&WebMessanger.scode==="1"||a.meta.mentions[$WC.Config.get("zuid")])?!0:!1},formatAtMentions:function(a,b,c,d){var e=Message.getMsgCategory(WindowHandler.getWinObjById(c).invisiblediv.innerHTML),f="";e=="atmentions"||e=="command"?f="@":e=="addmem"?f="+":f=WMSUI.curtrigger,b=b.replace(/,+$/,"");var g=b.split(","),h="",i="";return a=$WC.Util.escapeHTML(a),$WC.Util.isArray(g)&&g.forEach(function(b){if(WMSUI.atMentions.specialmentions.keys.indexOf(b)!==-1){var e=WMSUI.atMentions.specialmentions.getDisplayName("",b);d?h="{"+f+b+"}":h='<span class="wms-atmtntext">'+e+"</span>",i=new RegExp(e),a=a.replace(i,function(){return h})}else{var e=$WC.Util.escapeHTML(WMSUI.atMentions.getDname(c,b));d?f==="+"?h="{addchatmember:"+b+":1:"+e+":addchatmember}":h="{"+f+b+"}":h='<span class="wms-atmtntext">'+f+e+"</span>";if(e){e=e.replace(/(?=[$*+\[\]() ])/g,"\\");var g="["+f+"]"+e;i=new RegExp(g),i.test(a)||WMSUI.atMentions.insertAtmentions(c,b,!0),a=a.replace(i,function(){return h})}}}),a},updateMessage:function(a,b){var c=Message.getMsgCategory(WindowHandler.getWinObjById(b).invisiblediv.innerHTML),d="";if(c=="atmentions"){d="@";var e=WindowHandler.getWinObjById(b).atmentions.replace(/,+$/,""),f=e.split(",");a=$WC.Util.escapeHTML(a),$WC.Util.isArray(f)&&f.forEach(function(c){var e=$WC.Util.escapeHTML(WMSUI.atMentions.getDname(b,c)),f=new RegExp("{@"+c+"}");a=a.replace(f,function(){return WMSUI.atMentions.specialmentions.keys.indexOf(c)!==-1?(e=WMSUI.atMentions.specialmentions.getDisplayName("",c),'<span class="wms-atmtnlink" data-zcprofileid="'+c+'">'+e+"</span>"):'<span class="wms-atmtnlink" data-zcprofileid="'+c+'">'+d+""+e+"</span>"})})}return a},setScrollPosition:function(a,b){var c=b.value.substring(0,b.selectionStart);a.innerHTML=$WC.Util.escapeHTML(c),b.scrollTop=a.scrollHeight,a.innerHTML=""},replaceAtMentionsForHtml:function(a,b){var c=/<span(?:.*?)data-zcprofileid="(.*?)">@(.*?)<\/span>/g,d="";return a.replace(c,function(a,c,e){var f=$WC.Util.getContactName(c,e,b);d+="{mention:"+c+":1:"+f+":mention}"}),d},isLocationAllowedForMentionedBots:function(a){var b=WindowHandler.getWinObjById(a);if(b.atmentions){var c=b.atmentions.split(",");return c.some(function(a){if($WC.Bots.isBotId(a)){var b=$WC.Bots.get(a);if(b&&b.PERMISSION)return(b.PERMISSION&2)>0}})}}};var Commands={};Commands.get=function(a){var b=$WC.WmsSessionStorage.getItem("commands")||{},c="limit=1000";Commands.sync&&b&&b.sync_token&&(c+="&sync_token="+b.sync_token);var d=function(){var b=JSON.parse(this.response);Commands.sync=!1,Commands.updateList(b.data,b.sync_token),Commands.deleteObj(b.deleted||[]),Commands.show(a)};$WC.Ajax.requestToChat("v2/commands",c,d)},Commands.showLoadingIcon=function(a,b){var c=WindowHandler.getWinObjById(b),d='<div class="wms-cmdloading"><div class="wms-loadingicon"><div class="wms_loading_container"><div></div><div></div><div></div></div></div></div>';c.listcommon.showUI(d,!1,!0),a.style.display="block",c.footernode.style.borderRadius="0px 0px 5px 5px"},Commands.hideLoadingIcon=function(a){var b=WindowHandler.getWinObjById(a),c=b.autocompletediv;b.listcommon.showUI(""),c.style.display="none",b.footernode.style.borderRadius="5px"},Commands.showProgressBar=function(a){Commands.removeProgressBar(a);var b='<div id="loadingline" class="wms-loadinglinediv"><div class="wms-loadingline"></div></div>',c=WindowHandler.getWinObjById(a).autocompletediv;c.insertAdjacentHTML("beforebegin",b)},Commands.removeProgressBar=function(a){var b=document.getElementById(a).querySelector('[id="loadingline"]');$WC.Util.removeElement(b)},Commands.show=function(a,b){var c=$WC.WmsSessionStorage.getItem("commands"),d=WindowHandler.getWinObjById(a),e=d.autocompletediv,f=d.composer.value;if(!c||Commands.sync){Commands.get(a),c=$WC.WmsSessionStorage.getItem("commands"),Commands.showLoadingIcon(e,a);return}Commands.remove(e,a);var g=f.lastIndexOf(" "+WMSUI.curtrigger)+1;if(!b)if(g!=0&&f.indexOf(WMSUI.curtrigger)!=0||!f.startsWith(WMSUI.curtrigger))return;var h='<div class="wms-commandlist" data-command="{{commandname}}" data-list="true"><span class="wms-commandname wms-truncate-ellipsis" title="{{commandname}}">{{commandname}}</span><span title="{{commandhint}}" class="wms-commandhint wms-truncate-ellipsis">{{commandhint}}</span></div>',i="",j=Commands.getSearchTerm(d.composer),k="";if(b){j=j.substring(1),k=f.split(" ")[0],WMSUI.atMentions.changeColor(d.composer,!0);var l=Commands.getByName(k).options,m=d.selectedoptions.split(",");for(var n=0;n<m.length;n++)if(m[n]!==""&&m[n].indexOf(j)!==-1){var o=m[n].substring(1);delete l[o]}for(var p in l){var q=l[p];p.startsWith(j)&&(i+=$WC.template.replace(h,{commandname:"-"+p,commandhint:q}))}}else{WMSUI.atMentions.changeColor(d.composer,!0);var r=$WC.HybridSearch.filter("name","",c.list,"","","","name");r.forEach(function(a){k=a.name;var b=a.hint;k.startsWith(j)&&(i+=$WC.template.replace(h,{commandname:"/"+k,commandhint:b}))})}CommandSuggestions.init(a,j),i!=""&&(d.listcommon.showUI(i,!0,!0),e.style.display="block",d.footernode.style.borderRadius="0px 0px 5px 5px")},Commands.remove=function(a,b){var c=WindowHandler.getWinObjById(b);c.listcommon.showUI(""),a.style.display="none",c.footernode.style.borderRadius="5px"},Commands.getSearchTerm=function(a){var b=a.selectionStart,c=a.value.substring(1,b);return c.substring(c.lastIndexOf(" "+WMSUI.curtrigger)+1,b)},Commands.isCommandMsg=function(a){return a.startsWith($WC.WmsConstants.TRIGGERS.SLASH)?!0:!1},Commands.getCommandId=function(a){var b=a.substr(0,a.indexOf(" ")),c=Commands.getByName(b);if(c)return c.id},Commands.select=function(a,b){if(b.getAttribute("data-suggestion"))CommandSuggestions.handleClick(a,b);else{var c=b.getAttribute("data-command");a.setAttribute("data-command",c);var d=a.selectionStart,e=a.value.substring(0,d).lastIndexOf(" "+WMSUI.curtrigger)+2,f=a.getAttribute("chid"),g=WindowHandler.getWinObjById(f),h=g.autocompletediv,i=g.invisiblediv;g.selectedoptions+=c.concat(","),i.innerHTML='<span class="wms-commandtext">/'+c.substring(1)+"</span>",Commands.remove(h,f);var j=a.value;a.value=j.substring(0,e)+c.substring(1)+" "+j.substring(d),$WC.Util.moveCaretPosition(a,e+c.length,e+c.length),WMSUI.atMentions.changeColor(a,!0),CommandSuggestions.init(f,c.substring(1))}},Commands.format=function(a,b,c){var d=WindowHandler.getWinObjById(c);if(b!==""&&a!==""){var e=b.split(",");for(var f=0;f<e.length;f++){var g=new RegExp($WC.Util.escapeHTML(e[f]),"g");if(e[f]==="")continue;g.test(a)||(d.selectedoptions=b.replace(e[f]+",","")),a=a.replace(g,'<span class="wms-commandtext">'+e[f]+"</span>")}}return a},Commands.handle=function(a,b,c){var d=WindowHandler.getWinObjById(c),e=!0,f=Commands.getByName(a).id,g=$WC.Util.unescapeHTML(WMSUI.atMentions.formatAtMentions(b.value,d.atmentions,c,!0)),h="&commandid="+f;$WC.Util.isEmptyString(CommandSuggestions.getSelections(c))||(h+="&selections="+CommandSuggestions.getSelections(c));var i=!0;return e=Message.send(c,g,[],f,h,i),d.selectedoptions="",Commands.showProgressBar(c),e},Commands.clear=function(){$WC.WmsSessionStorage.removeItem("commands")},Commands.showResponse=function(a,b,c){Commands.removeProgressBar(a);var d=WindowHandler.getWinObjById(a),e=[];c.output?c.output.sender=b>0?b+"command":"":c.output={},c.output.meta||(c.output.meta={},c.output.meta.usermessagedetails={},b<0&&(c.output.meta.usermessagedetails.custom_sender_name=Commands.getById(b).name,c.output.meta.usermessagedetails.custom_sender_imageurl="https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/c"+b+".png",c.output.meta.shareIntegrationResponse=!0));if(c.status==="Success"&&c.output){if(c.output.msg)e.push(c.output);else if(c.output&&c.output.inputs){$WC.Channels.initChannels();var f=new $WC.Forms;f.mountComponent(c,Commands.showResponse,function(){var b=WindowHandler.getWinObjById(a);b&&b.composer.focus()})}else c.output.type==="banner"&&(c.output.status==="success"?WMSUI.showInfoMsg(c.output.text):c.output.status==="failure"&&WMSUI.showErrorMsg(c.output.text));e.length&&d.updateMessage(e)}else if(c.status==="Failure")if(!$WC.Util.isEmpty(c.resumeUrl)){var g=new $WC.Consents;g.mountComponent(a,c)}else if(c.output.msg)e.push(c.output),d.updateMessage(e);else{var h={sender:c.output.sender,time:c.output.time,meta:c.output.meta,msg:c.errorMsg||$WC.I18N("commands.exec.error")};e.push(h),d.updateMessage(e)}},Commands.getObject=function(a){var b=$WC.WmsSessionStorage.getItem("commands")||{};return b&&b.list&&b.list[a]},Commands.getImgUrl=function(a,b){var c=Commands.getObject(a);return b=!$WC.Util.isEmpty(c)&&c.photo_id?c.photo_id:b,b?_WMSCHATURL+"commandimg/"+b+"/photo.do":"https://img.zohostatic.com/ichat/Mar_30_2020_3_https/images/bar/slash.png"},Commands.deleteObj=function(a){var b=$WC.WmsSessionStorage.getItem("commands");b.list&&(a.forEach(function(a){delete b.list[a]}),$WC.WmsSessionStorage.setItem("commands",b))},Commands.updateList=function(a,b){var c=$WC.WmsSessionStorage.getItem("commands")||{},d=c.list||{},e=function(a,b){for(var c in b)if(b.id<0)if(typeof b[c]=="object"&&b[c].constructor==Object){a[c]||(a[c]={});for(var d in b[c])a[c][d]=typeof b[c][d]=="boolean"?b[c][d]:$WC.I18N(b[c][d])}else if($WC.Util.isArray(b[c])){a[c]||(a[c]=[]);for(var e=0;e<b[c].length;e++)a[c][e]=typeof b[c][d]=="boolean"?b[c][e]:$WC.I18N(b[c][e])}else a[c]=typeof b[c]=="boolean"?b[c]:$WC.I18N(b[c]);else a[c]=b[c];return a},f=function(a){for(var b=0;b<a.length;b++){var c=a[b],f=c.id;d[f]=d[f]||{},d[f]=e(d[f],c)}};f(a),c.list=d,c.sync_token=b,$WC.WmsSessionStorage.setItem("commands",c)},Commands.getAllowedTriggers=function(a){var b=a.getAttribute("data-command");if(!b)return;return["@","-","/",":"]},Commands.getByName=function(a){var b=$WC.WmsSessionStorage.getItem("commands");if(!b)return;a=a.toLowerCase();for(var c in b.list){var d="/"+b.list[c].name.toLowerCase();if(a==d)return b.list[c]}},Commands.getById=function(a){var b=$WC.WmsSessionStorage.getItem("commands");if(!b)return;for(var c in b.list)if(a==b.list[c].id)return b.list[c]},Commands.isLocationAllowedForExecution=function(a){var b=Commands.getById(a);return(b.permission&1)>0},Commands.isLocationAllowedForSuggestion=function(a){var b=Commands.getById(a);return(b.permission&2)>0},Commands.consentsCallback=function(a,b){if(!b.data.bots){var c=b.data,d=c.dreResponse.message_source||c.dreResponse.output.meta.message_source;c.dreResponse.status==="Success"&&c.dreResponse.result&&c.dreResponse.result.output.length>0?(Commands.hideLoadingIcon(a),CommandSuggestions.populate(a,c.dreResponse.result.output)):Commands.showResponse(a,d.id,b.data.dreResponse)}};var CommandSuggestions={};CommandSuggestions.prevSugg=null,CommandSuggestions.suggestiontimer="",CommandSuggestions.execute=function(a,b,c,d){var e="chid="+b+"&message="+encodeURIComponent(c);d&&(e+="&selections="+d);var f=function(){var a=JSON.parse(this.response).data;if(a.status==="Consent"||a.status==="Failure"){Commands.hideLoadingIcon(b);var d=WindowHandler.getWinObjById(b).composer,e=new $WC.Consents;e.mountComponent(b,a,Commands.consentsCallback,d)}else a.status==="Success"&&CommandSuggestions.prevSugg===c&&CommandSuggestions.populate(b,a.result.output)},g=function(){Commands.hideLoadingIcon(b)},h={"x-consents-version":"1"};Commands.isLocationAllowedForSuggestion(a)?$WC.Ajax.postRequestToChatWithLocation("v1/commands/"+a+"/suggestions",e,f,g,null,null,h):$WC.Ajax.postRequestToChat("v1/commands/"+a+"/suggestions",e,f,g,null,null,h)},CommandSuggestions.populate=function(a,b){if(!b.length){Commands.hideLoadingIcon(a);return}var c="",d=WindowHandler.getWinObjById(a),e=d.autocompletediv,f=b[0],g=f&&f.imageurl&&!f.title&&!f.description;for(var h=0;h<b.length;h++){var i="",j=b[h].id,k=b[h].title,l=b[h].description,m=b[h].imageurl;g?i+='<div data-list="true" class="wms-cmdsuggimgdiv" data-suggestion="true" data-imgurl="{{IMGURL}}"><img src="{{IMGURL}}" class="wms-cmdsuggimg"></div>':k&&(i+='<div class="wms-cmndlist wms-filefrwrdcontact" data-list="true" data-suggestion="true" data-id="{{ID}}" data-title="{{TITLE}}" data-desc="{{DESC}}" data-imgurl="{{IMGURL}}">',m?i+='<img class="wms-filefrwrdcontactimg wms-cmndlistimg" src="{{IMGURL}}"><div class="wms-cmndlistdetails">':i+='<div class="wms-cmndlistdetails wms-valign-mid-block">',i+='<div class="wms-filefrwrdcontactdetails wms-cmndlisttitle wms-truncate-ellipsis" title="{{TITLE}}">{{TITLE}}</div>',l&&(i+='<div class="wms-cmndlistdesc wms-truncate-ellipsis" title="{{DESC}}">{{DESC}}</div>'),i+="</div></div>"),c+=$WC.template.replace(i,{ID:j?j:"",TITLE:k?k:"",DESC:l?l:"",IMGURL:m?m:""})}d.listcommon.showUI(c,!0,!0),e.style.display="block",d.footernode.style.borderRadius="0px 0px 5px 5px"},CommandSuggestions.handleClick=function(a,b){var c=a.value,d=a.getAttribute("chid"),e=WindowHandler.getWinObjById(d),f=!1,g={};e.selectedoptions+=b.getAttribute("data-title")+",",b.getAttribute("data-title")&&(g.title=b.getAttribute("data-title"),f=!0),b.getAttribute("data-desc")&&(g.description=b.getAttribute("data-desc")),b.getAttribute("data-imgurl")&&(g.imageurl=b.getAttribute("data-imgurl")),b.getAttribute("data-id")&&(g.id=b.getAttribute("data-id")),g=$WC.Util.isEmptyObject(g)?"":JSON.stringify([g]);var h=a.getAttribute("data-command"),i=Commands.getByName(h),j=i.id,k="&commandid="+j;$WC.Util.isEmptyObject(g)||(k+="&selections="+encodeURIComponent(g)),CommandSuggestions.format(e,b),CommandSuggestions.init(d,a.value.trim(),CommandSuggestions.getSelections(d)),i.max_suggestions===1?(Message.send(d,c,[],j,k,f),e.listcommon.showUI(""),e.autocompletediv.style.display="none",e.footernode.style.borderRadius="5px",a.value="",e.invisiblediv.innerHTML="",e.changeFooterHeight()):CommandSuggestions.isSelectionLimitReached(i,d)&&(Commands.handle(h,a,d),e.listcommon.showUI(""),e.autocompletediv.style.display="none",e.footernode.style.borderRadius="5px",a.value="",e.invisiblediv.innerHTML="",e.changeFooterHeight())},CommandSuggestions.format=function(a,b){var c=b.getAttribute("data-title"),d=' <span class="wms-commandtext" data-suggestion=true data-title="'+b.getAttribute("data-title")+'" data-desc="'+b.getAttribute("data-desc")+'" data-imgurl="'+b.getAttribute("data-imgurl")+'" data-id="'+b.getAttribute("data-id")+'">'+b.getAttribute("data-title")+"</span> ",e="",f="",g=!0;$WC.Util.convertToArray(a.invisiblediv.childNodes).forEach(function(a){a.nodeType===Node.TEXT_NODE&&a.textContent!==" "?(e+=c?c:a.textContent.trim()+" ",f+=d,g=!1):a.textContent!==" "&&(e+=a.textContent+" ",f+=" "+a.outerHTML)}),a.invisiblediv.innerHTML=g?f.trim()+d:f.trim(),a.composer.value=g&&c?e+c:e},CommandSuggestions.isSelectionLimitReached=function(a,b){var c=WindowHandler.getWinObjById(b),d="/"+a.name+",",e=new RegExp(d+"|^,\\s*|,\\s*$","g"),f=c.selectedoptions.replace(e,"").split(","),g=f.length,h=a.max_suggestions;if(g>h)return!0},CommandSuggestions.getSelections=function(a){var b=WindowHandler.getWinObjById(a),c=[],d=b.invisiblediv.querySelectorAll("[data-suggestion]");for(var e=0;e<d.length;e++){var f={};d[e].getAttribute("data-title")&&(f.title=encodeURIComponent(d[e].getAttribute("data-title"))),d[e].getAttribute("data-desc")&&(f.description=encodeURIComponent(d[e].getAttribute("data-desc"))),d[e].getAttribute("data-imgurl")&&(f.imageurl=encodeURIComponent(d[e].getAttribute("data-imgurl"))),d[e].getAttribute("data-id")&&(f.id=encodeURIComponent(d[e].getAttribute("data-id"))),c.push(f)}return c.length?JSON.stringify(c):""},CommandSuggestions.getFormattedNode=function(a){var b=a.getAttribute("data-title"),c=a.getAttribute("data-desc"),d=a.getAttribute("data-imgurl"),e=a.getAttribute("data-id");return' <span class="wms-commandtext" data-suggestion=true data-title="'+b+'" data-desc="'+c+'" data-imgurl="'+d+'" data-id="'+e+'">'+b+"</span>"},CommandSuggestions.init=function(a,b,c){var d=WindowHandler.getWinObjById(a);if(d.selectedoptions!=""){var e=d.composer.getAttribute("data-command"),f=Commands.getByName(e);if(f&&f.id>0){var g=f.id;CommandSuggestions.prevSugg!=b&&b&&f.has_suggestions&&(!c||!f.max_suggestions||JSON.parse(c).length<f.max_suggestions)&&(clearTimeout(CommandSuggestions.suggestiontimer),CommandSuggestions.prevSugg="/"+b,Commands.showLoadingIcon(d.autocompletediv,a),CommandSuggestions.suggestiontimer=setTimeout(function(){CommandSuggestions.execute(g,a,"/"+b,c)},1e3))}}};var $WC=$WC||{};$WC.CMsgUtil={UserMention:1,GroupMention:2,ChannelMention:3,BotMention:4,SpecialMention:{participants:6,available:7},OldMention:8,isCustomMessage:function(a){return a?!$WC.Util.isEmptyObject(a["brief.msg"]):!1},isCustomFormattedMsg:function(a){return a?typeof a["long.msg"]!="undefined"&&a["long.msg"].length>0:!1},getDisplayContent:function(a,b){var c=a.msg;if(!c)return"";c=c.trim(),c=this.processMsg(c,a,b);if($WC.Matcher.check("atmentiontemplate",c)||this.isNewMentionMsg(c))c=this.getDisplayableMention(a,c,'<span elemtype="{MENTIONELEMTYPE}" hover="true" uid="$1" class="hvrinfo" mentionedid="$1" {MENTIONATTRIBUTES}>$2</span>');return c},isNewMentionMsg:function(a){return $WC.Matcher.check("zcatmention_v2",a)},getDisplayableMentionHTML:function(a,b,c,d){var e=b.type,f=b.mentionedid,g=b.operation,h=b.dname,i="";if(h==null)return b.mentionmsg;h=$WC.$CUtil.processXSS(h);if(e===$WC.CMsgUtil.UserMention){var j=g=="addchatmember"?"+":g=="deletechatmember"?"-":"@";h=j+h,i="user"}else if(e===$WC.CMsgUtil.GroupMention)f.search("G")!=-1&&(f=f.substring(1)),h="@"+h,i="group";else if(e===$WC.CMsgUtil.ChannelMention)h=h?h:WmsChannels.getChannelName(f),i="channel";else if(e===$WC.CMsgUtil.BotMention)h="@"+h,i="user";else if(e===$WC.CMsgUtil.AvailableMention||e===$WC.CMsgUtil.ParticipantsMention)i=e===$WC.CMsgUtil.ParticipantsMention?h+"mention":h,h="@"+h;var k=c+' mentiontype="'+e+'"',l=d.replace(/{MENTIONATTRIBUTES}/g,k).replace(/{MENTIONELEMTYPE}/g,i).replace(/\$1/g,f).replace(/\$2/g,$WC.Matcher.replace("escapeReplacementString",h));return l},getDisplayableMention:function(a,b,c){function m(a){var b=a.hasOwnProperty("meta")?a.meta.hasOwnProperty("mentions")?a.meta.mentions:a.meta:{};return a.hasOwnProperty("mentions")&&$WC.Util.extend(b,a.mentions),a.hasOwnProperty("replied")&&a.replied.hasOwnProperty("info")&&a.replied.info.hasOwnProperty("meta")&&$WC.Util.extend(b,a.replied.info.meta.mentions),typeof b!="undefined"?b:{}}var d=typeof a.ctype!="undefined"?parseInt(a.ctype):1,e=' mention_on="'+d+'"';if(this.isNewMentionMsg(b)){var f=function(a,b,c,d,e){this.type=c,this.mentionedid=d,this.dname=b,this.action=typeof e!="undefined"?e:"",this.mentionmsg=$WC.Util.isEmpty(a)?this.getMentionFormat():a,this.mentionregex=$WC.Util.isEmpty(a)?this.getMentionFormat(!0):a};f.prototype.getMentionFormat=function(a){var b=this.type===$WC.CMsgUtil.ChannelMention?"#":"@",c=this.type===$WC.CMsgUtil.GroupMention?"G":"",d=(a&&!$WC.Util.isEmpty(this.action)?"\\"+this.action:this.action)+b+c+this.mentionedid,e="{"+d+"}";return e},f.prototype.getOperation=function(){return $WC.Util.isEmpty(this.action)?"mention":this.action==="+"?"addchatmember":"deletechatmember"};var g=m(a);if(typeof g!="undefined"&&!$WC.Util.isEmptyObject(g))for(var h in g){var i=g[h],j=new f("",i.name,i.type,i.id,i.action),k={};k.mentionmsg=j.mentionmsg,k.operation=j.getOperation(),k.mentionedid=i.id,k.type=i.type,k.dname=i.name;var l=new RegExp(j.mentionregex,"gi");b=b.replace(l,this.getDisplayableMentionHTML(a,k,e,c))}return b}return $WC.Matcher.replaceWithFlag("atmentiontemplate",b,"g",function(a,b,d,f,g){var h=f.split(":"),i=h[0].slice(1),j=h[1],k=parseInt(h[2]),l="";h=h.slice(3),h.pop();var m=$WC.Util.decodeHTMLEntities(h.join(":"));m=$WC.$CUtil.processXSS(m);if(k===$WC.CMsgUtil.UserMention){var n=i=="addchatmember"?"+":i=="deletechatmember"?"-":"@";m=n+m,l="user"}else k===$WC.CMsgUtil.GroupMention?(m="@"+m,l="group"):k===$WC.CMsgUtil.ChannelMention?l="channel":k===$WC.CMsgUtil.BotMention&&(m="@"+m,l="user");var o=e+' mentiontype="'+k+'"',p=c.replace(/{MENTIONATTRIBUTES}/g,o).replace(/{MENTIONELEMTYPE}/g,l).replace(/\$1/g,j).replace(/\$2/g,$WC.Matcher.replace("escapeReplacementString",m));return p})},processMsg:function(a,b,c){return typeof b!="undefined"&&b.raw&&(a=$WC.$CUtil.processXSS(a),a=$WC.Markdown.replaceInstantButton(a,b),a=$WC.Markdown.apply(a)),this.getMarkedDownContent(a,c)},getMarkedDownContent:function(a,b){a=a.trim(),a=Smiley.replace(a),a=this.trim(a),typeof $WC.Config.get("getSilentUserMention")=="function"&&(a=$WC.Config.get("getSilentUserMention")(a));if(!b){var c=a.split(" "),d=[];for(var e=0;e<c.length;e++){var f=c[e];f=this.convertLinks(f),f===c[e]&&(f=this.convertMailIds(f)),f=this.getSafeATagTarget(f),f=this.addAttributesToViewableImg(f),d.push(f)}a=d.join(" ")}return a},trim:function(a){return a=a.replace(/<p>/gi,"").replace(/<\/p>/gi,"").replace(/\n/gi,"<br>"),a},convertMailIds:function(a){return a=" "+a,a=$WC.Matcher.replaceWithFlag("mail",a,"gi"),a=a.trim(),a},convertHomographToText:function(a){var b=a;a.indexOf("http://")!==0&&a.indexOf("https://")!==0&&(b="http://"+a);var c=document.createElement("a");c.href=b;var d=c.href.toLowerCase();return d===b.toLowerCase()||d===a.toLowerCase()+"/"||d===b.toLowerCase()+"/"?a:c.href},convertLinks:function(a){return a=" "+a,a=$WC.Matcher.replaceWithFlag("linkRegExp",a,"gi",function(b,c){return b!==a&&$WC.Matcher.check("invalidlink",$WC.Util.decodeHTMLEntities(a))?b:"<a href='"+c+"' target='_blank'>"+c+"</a>"}),a=$WC.Matcher.replaceWithFlag("WWWlinkRegExp",a,"gi",function(b,c,d){return b!==a&&$WC.Matcher.check("invalidlink",$WC.Util.decodeHTMLEntities(a))?b:c+"<a href='http"+""+"://"+d+"' target='_blank'>"+d+"</a>"}),a=$WC.Matcher.replaceWithFlag("twoletterendinglink",a,"gi","$1<a href='http://$2' target='_blank'>$2</a>"),a=$WC.Matcher.replaceWithFlag("threeletterendinglink",a,"gi","$1<a href='http://$2' target='_blank'>$2</a>"),a=a.trim(),a},getSafeATagTarget:function(a){return $WC.Matcher.replacer($WC.Matcher.getRegexToGetAttrValueInHtmlTag("a","href"),null,a,function(a,b,c,d,e,f,g,h){return e.indexOf("mailto:")===0?a:b+e+g+' dataurl="'+$WC.$CUtil.processXSS(e)+'" '+h})},addAttributesToViewableImg:function(a){return $WC.Matcher.replacer($WC.Matcher.getRegexToAddAttrToHtmlTag("img"),null,a,'$1 documentclick="viewattachment" previewelem $3')},getFormattedMsgContent:function(a){function F(b){var c=b.data,d="";for(var e=0;e<c.length;e++)d+="<li>"+$WC.CMsgUtil.processMsg(""+c[e],a)+"</li>";return d}var b="",c=a["long.msg"];for(var d=0;d<c.length;d++){var e=c[d],f=e.buttons,g=f&&f.length?"zccustmsg":"";b+='<div class="msgbox '+g+'" >',b+=e.title?'<div class="msgtitle ellips"><span class="subtitle">'+this.processMsg(""+e.title,a)+"</span></div>":"";if(e.type==="text")b+=['<div class="cntmsgtxt">',"<div>"+this.processMsg(e.data,a)+"</div>","</div>"].join("");else if(e.type==="list"){var h="";e.styles&&(h=e.styles.type);var i=h?h:"non_type";b+=['<div class="msgcntbdy dIB">','<ul class="lst mrgL8 '+i+'">'+F(e)+"</ul>","</div>"].join("")}else if(e.type==="table"){var j=[],k=[];e.styles&&(e.styles.width&&(j=e.styles.width),e.styles.text_align&&(k=e.styles.text_align));var l="",m="style=max-width:fit-content; ";j.length&&(l="tblefxed",m=""),b+="<div "+m+'class="msgcntbdy dIB">',b+='<div class="msgtble"><div class="msgtblecnt '+l+'">';var n=e.data.rows,o=e.data.headers,j=[];e.styles&&e.styles.width&&(j=e.styles.width),b+='<div class="tblerow">';for(var p=0;p<o.length;p++){var q="style=text-align:"+(k[p]?k[p]+";":"center;");j[p]&&(q=q+"width:"+j[p]+"%;"),b+='<div class="tblecel" '+q+">"+this.processMsg(""+o[p],a)+"</div>"}b+="</div>";if(n)for(var r=0;r<n.length;r++){var s=n[r];b+='<div class="tblerow">';for(var t=0;t<s.length;t++){var q="style=text-align:"+(k[t]?k[t]:"center");b+='<div class="tblecel" '+q+">"+(s[t]?this.processMsg(""+s[t],a):"-")+"</div>"}b+="</div>"}b+="</div></div></div>"}else if(e.type==="images"){var u=$WC.$CUtil.getAspectRatioFit(e.data[0].width,e.data[0].height,300,200,!1),v="";for(var w=0;w<e.data.length;w++){var x=e.data[w];v+='<img previewelem purpose=custom_image_preview style="height:'+u.height+'px; width: auto;" src="'+x.url+'" />'}b+='<div class="zcimgsldr" style="height:'+u.height+'px;">'+v+"</div>"}else if(e.type==="image"){if($WC.Util.isEmptyObject(e.data))continue;var y=e.data;b+='<div><img previewelem purpose=custom_image_preview style = "max-width:100%; width:'+(y.width?y.width+"px;":"100%;")+" height="+(y.height?y.height+"px;":"224px;")+'" src="'+e.url+'" /></div>'}else if(e.type==="label"){b+='<div class="msgcntbdy dIB"><div class="msgtble"><div class="thmeslabcnt">';var z=e.styles,A="",j="100%",B=z&&z.short?"short":"lblmsgcnt";for(var C=0;C<e.data.length;C++){var D=e.data[C];for(var E in D)b+='<div class="zclblpair '+B+'"><div class="zcmslble">'+this.processMsg(E,a)+"</div>"+'<div class="zcmsnme">'+this.processMsg(D[E],a)+"</div></div>"}b+="</div></div></div>"}b+=f?$WC.CustomMsgUI.getButtonHTML(a,f,!0):"",b+="</div>",b=b.replace(/PRIMARY_INDEX/g,d)}return b},handleButtons:function(a,b,c,d,e,f){var g=$WC.CustomMsg.getMsgObj(a,d,e);if(!g)return;var h,i=g.msguid;if(g["btnindexvsdetails.msg"]){var j=a.getAttribute("btnindex");h=g["btnindexvsdetails.msg"][j]}else{var k=a.parentElement.getAttribute("primaryindex"),j=a.getAttribute("index"),l=k?g["long.msg"][k]:g["brief.msg"];h=l.buttons[j]}var m=h.action,n=m.data;if(typeof n=="undefined")return;var o=m.type,p=m.confirm,d=g.chid,q=g.sender,e=g.time,r;typeof p!="undefined"&&(r=$WC.Util.extend(!0,{},p),r.type="confirm");if(o!=="undefined")if(o==="invoke.function"||o==="oembed.action"||o==="invoke.internalurl"){if(n.name!=="undefined"){var s=n.name;if(typeof r!="undefined"){$WC.$Win.destroy("custommsg"),r.btncallback=function(){typeof c=="function"&&c(s,d,e,a.getAttribute("btnindex"))},p.input&&p.input.type==="user_webhook_token"&&($WC.$Win.destroy("custommsg"),g.message_source.store_appname?r.component_name=g.message_source.store_appname:r.component_name=g.message_source.name);if(typeof WmsMainUI!="undefined"){r.closeCallback=function(){$WC.Util.removeElement(document.getElementById("zcwindows"))};if(document.getElementById("zcwindows")===null){var t=$WC.Util.createElement("div","zcwindows","zcoverlay");t.style.zIndex=WebMessanger.setzindex,document.body.appendChild(t)}}$WC.Widgets.construct(r)}else typeof c=="function"&&c(s,d,e,a.getAttribute("btnindex"))}}else if(o==="open.url"){if(n.web!=="undefined"){var u=n.web;if(typeof r!="undefined"){r.btncallback=function(){window.open(u,"_blank")};if(typeof WmsMainUI!="undefined"){r.closeCallback=function(){$WC.Util.removeElement(document.getElementById("zcwindows"))};if(document.getElementById("zcwindows")===null){var t=$WC.Util.createElement("div","zcwindows","zcoverlay");t.style.zIndex=WebMessanger.setzindex,document.body.appendChild(t)}}$WC.Widgets.construct(r)}else{var v=u.split(window.location.host)[1];!$WC.Util.isEmpty(v)&&window.ZCPermalink&&ZCPermalink.handle(v.split("/"),!0)||window.open(u,"_blank")}}}else if(o==="system.api"){var w=n.api;typeof w!="undefined"&&(this.isClientTriggerSystemApi(w.split("/")[0])&&typeof $WC.Config.get("SystemApiHandler")=="function"?($WC.$Win.destroy("custommsg"),$WC.Config.get("SystemApiHandler")(w,{chid:d,sender:q,msguid:i})):this.triggerSystemAction(w,j,d,i,e,f,{buttonText:b.target.getAttribute("value")||b.target.text}))}},triggerSystemAction:function(a,b,c,d,e,f,g){var h="api="+a+"&chid="+c+(typeof d!="undefined"?"&msguid="+d.replace("%20","_"):""),i={index:b,chid:c,msgtime:e,isTempResponse:f};g&&(i.additionalparams=g),$WC.Config.get("ExecuteButtonResponseHandler")("handleStatusChange","loading"),$WC.Ajax.postRequestToChat("executesystemaction.do",h,function(a){$WC.CMsgUtil.handleActionResponse(a,this.opts.callbackargs)},function(a){$WC.CMsgUtil.handleActionResponse(a,this.opts.callbackargs)},i,!0)},handleActionResponse:function(a,b){$WC.Config.get("ExecuteButtonResponseHandler")("handleStatusChange","complete");if(a){var c=b.chid,d=b.msgtime,e=b.index;if(a.type==="banner")typeof $WC.Config.get("ExecuteButtonResponseHandler")=="function"&&$WC.Config.get("ExecuteButtonResponseHandler")("handleSystemResponse",a,{chid:c});else if(typeof $WC.Config.get("ExecuteButtonResponseHandler")=="function"){var f={chid:c,title:b.additionalparams?b.additionalparams.buttonText:""};$WC.Config.get("ExecuteButtonResponseHandler")("renderResponse",a,f)}}},isClientTriggerSystemApi:function(a){var b=["startchat","audiocall","videocall","videobroadcast","joinchannel","invite","userrecentchats","locationpermission"];return b.indexOf(a)>=0},getBriefMsgTitle:function(a){var b=a["brief.msg"];return typeof b.title!="undefined"?(b.icon?'<img class="zcprvwicn" src="'+b.icon+'"/>':"")+this.processMsg(b.title,a):""},getMsgObjVersion:function(a){return typeof a.version!="undefined"?a.version:"v0"},getImageUrlFromId:function(a){return $WC.Config.get("CHATCONT")?"/"+$WC.Config.get("CHATCONT")+"/v1/images/"+a:"/v1/images/"+a},convertMsgObj:function(a){var b=$WC.CMsgUtil.getMsgObjVersion(a);switch(b){case"v0":var c=$WC.Util.cloneObject(a),d=$WC.Util.cloneObject(a),e=a.mtype?a.mtype:"12";switch(e){case"12":if(typeof c.meta!="undefined"){var f=c.meta.usermessagedetails;if(typeof f!="undefined"){var g={};typeof f.custom_sender_name!="undefined"&&(g.name=f.custom_sender_name,typeof f.hiddensender!="undefined"&&(g.hiddensender=f.hiddensender)),typeof f.custom_sender_imageurl!="undefined"?g.img=f.custom_sender_imageurl:typeof f.custom_sender_imageid!="undefined"&&(g.img=this.getImageUrlFromId(f.custom_sender_imageid)),typeof f.custom_sender_id!="undefined"&&(g.id=f.custom_sender_id),typeof c.meta.ms!="undefined"&&(g.ms=c.meta.ms),$WC.Util.isEmptyObject(g)||(d["custom.sender"]=g);var h={};typeof f.msg_title!="undefined"&&(h.title=f.msg_title),a.meta.usermessagedetails.custom_message&&typeof c.msg!="undefined"&&(h.desc=c.msg),typeof f.thumbnail_url!="undefined"?h.thumbnail=f.thumbnail_url:typeof f.thumbnail_id!="undefined"?h.thumbnail=this.getImageUrlFromId(f.thumbnail_id):typeof f.thumbnail_zuid!="undefined"&&(h.thumbnail=WmsContacts.getUserPhoto(f.thumbnail_zuid)),typeof f.thumbnail_preview_url!="undefined"?h.img=f.thumbnail_preview_url:typeof f.thumbnail_preview_id!="undefined"&&(h.img=this.getImageUrlFromId(f.thumbnail_preview_id)),typeof f.icon_url!="undefined"&&(h.icon=f.icon_url),typeof f.themeid!="undefined"&&(h.themeid=f.themeid),typeof f.buttons!="undefined"&&(h.buttons=f.buttons),$WC.Util.isEmptyObject(h)||(d["brief.msg"]=h)}typeof c.meta.formattedmsg!="undefined"&&(d["long.msg"]=$WC.$CUtil.cloneArray(c.meta.formattedmsg)),typeof c.meta.config!="undefined"&&(d.config=$WC.Util.cloneObject(c.meta.config)),typeof c.meta.linkdetails!="undefined"&&(d.info={type:"unfurling",linkdetails:$WC.Util.cloneObject(c.meta.linkdetails),quotedlink:c.meta.quotedlink}),typeof c.meta.mentions!="undefined"&&(d.mentions=$WC.Util.cloneObject(c.meta.mentions)),typeof c.meta.btnindexvsdetails!="undefined"&&(d["btnindexvsdetails.msg"]=$WC.Util.cloneObject(c.meta.btnindexvsdetails)),typeof c.meta.opr_replydetails!="undefined"&&(d.isreply=!0,d.replied={info:$WC.Util.cloneObject(c.meta.opr_replydetails)}),typeof c.meta.message_source!="undefined"&&(d.message_source=c.meta.message_source),typeof c.meta.native_widget!="undefined"&&(d.native_widget=c.meta.native_widget),delete d.meta}typeof c.temp_info!="undefined"&&typeof c.temp_info.suggestions!="undefined"&&(d.botSuggestions=$WC.$CUtil.cloneArray(c.temp_info.suggestions));break;case"16":d.info=$WC.Util.cloneObject(c.msg,!0),delete d.msg,d.info.type="operations",!$WC.Util.isEmpty(d.info.opruser)&&!$WC.Util.isEmptyObject(d.info.opruser)&&(d.sender=d.info.opruser.zuid);break;case"20":typeof c.meta!="undefined"&&typeof c.meta.opr_replydetails!="undefined"&&(d.isreply=!0,d.replied={info:$WC.Util.cloneObject(c.meta.opr_replydetails)},delete d.meta),d.info=$WC.Util.cloneObject(c.msg,!0),delete d.msg,d.info.type="attachments",d.info.mod=c.mod,c.wmsfilesharingtype&&(d.info.wmsfilesharingtype=c.wmsfilesharingtype)}a=d,a.version="v1",typeof a.msgid!="undefined"&&(a.ack=a.msgid),a.id=a.time,delete a.msgid}return a}};var $WC=$WC||{};$WC.WindowObject=function(a){this.id=a.id,this.draggable=typeof a.draggable!="undefined"?a.draggable:!1,this.nav=a.nav===!0,this.sigleton=a.sigleton===!0,this.bg=typeof a.bg!="undefined"?a.bg:!0,this.opencallback=typeof a.openfn!="undefined"?a.openfn:null,this.closecallback=typeof a.closefn!="undefined"?a.closefn:null,this.closebeforecallback=typeof a.closebeforefn!="undefined"?a.closebeforefn:null,this.closeoutside=typeof a.closeoutside!="undefined"?a.closeoutside:!1,this.aligncenter=typeof a.aligncenter!="undefined"?a.aligncenter:!0},$WC.WindowObject.prototype={create:function(a){var b=this.id,c=this.getTemplate(),d=this.aligncenter?" zcalgncntr":"",e='<span id="winclose" title="'+$WC.I18N("common.to.close")+'" class="zchat-close cclose"></span>',f=a.additionalattrs||"";c=c.replace(/{WININDEX}/g,b).replace(/{WINCLASS}/g,typeof a.class!="undefined"?a.class+d:d).replace(/{WINHEADER}/g,typeof a.header!="undefined"?$WC.Matcher.replace("escapeReplacementString",a.header):"").replace(/{WINCLOSE}/g,typeof a.closehtml!="undefined"?$WC.Matcher.replace("escapeReplacementString",a.closehtml):e).replace(/{DRAGGABLE}/g,this.draggable?"drag":"").replace(/{WINADDITIONALATTR}/g,f).replace(/{WINHTML}/g,$WC.Matcher.replace("escapeReplacementString",a.html));var g=document.getElementById("zcwindows");if(!g)return;g.insertAdjacentHTML("beforeend",c);var h=this.getelem(),i=this;return Gator(h).on("mousedown",function(a){i.handleClick(i,a)}),this.getMeFront(),this.focusInputField(),this.opencallback!=null&&this.opencallback(this.id),this.draggable&&Gator(h).on("mousedown",".drag",function(a){i.drag(a,i)}),$WC.$Win.current=b,this.get()},focusInputField:function(){var a=this.getelem();if(!a)return;var b=a.querySelectorAll("input[type=text]");if(b.length)b[0].focus();else{var c=a.querySelectorAll("textarea");c.length&&c[0].focus()}},handleClick:function(a,b){var c=b.target.id,d={winnav:function(){a.sigleton&&$WC.$Win.destroy(a.id,!0)},winclose:function(){$WC.$Win.destroy(a.id)}},e=d[c];typeof e=="function"&&e()},drag:function(a,b){function f(a){a.preventDefault();var b=c.style;b.left=a.clientX-d+"px",b.top=a.clientY-e+"px"}function g(a){Gator(c).off("mousemove"),Gator(c).off("mouseup"),a.preventDefault}if(a.which!=1&&a.target.tagName==="INPUT")return;var c=b.getelem();if(!c)return;var d=a.clientX-c.offsetLeft,e=a.clientY-c.offsetTop;Gator(c).on("mousemove",f),Gator(c).on("mouseup",g)},close:function(a){var b=this.getelem();if(!b)return;this.closebeforecallback!=null&&this.closebeforecallback(this.id),b.remove(),this.closecallback!=null&&!a&&this.closecallback(this.id)},getelem:function(){return document.getElementById(this.id)},get:function(){return $WC.Config.get("PUREJS")===!0?this.getelem():window.jQuery?jQuery("#"+this.id):$("#"+this.id)},getMeFront:function(){var a=this.getelem();if(!a)return;var b=a.querySelectorAll("#winnav");b.length&&b.remove();if(this.nav&&$WC.$Win.persists()){var c=a.querySelectorAll("#winhead")[0];c.insertAdjacentHTML("afterbegin",'<span id="winnav" title="'+$WC.I18N("common.back")+'" class="zchat-zcheadicn mrgR10 fl_left"></span>')}$WC.Util.removeClass(a,"zcbg_mask"),this.bg&&$WC.Util.addClass(a,"zcbg_mask"),this.handleCloseOutside(),a.parentNode.appendChild(a)},handleCloseOutside:function(){var a=this.getelem(),b=this;this.closeoutside&&(a.insertAdjacentHTML("afterbegin",'<div class="zcbg_mask"></div>'),Gator(a).on("click",".zcbg_mask",function(){$WC.$Win.destroy(b.id)}))},getTemplate:function(){return['<div id="{WININDEX}" type="popup" class="modalwindow {WINCLASS} " {WINADDITIONALATTR}><div>','<div id="winhead" class="mheader {DRAGGABLE}">{WINHEADER}{WINCLOSE}</div>{WINHTML}</div>',"</div>"].join("")}},$WC.$Win=function(){var a={},b=function(b,c){a[b]=c},c={"window-created":[],"window-destroyed":[]};return{isExist:function(b){return a.hasOwnProperty(b)},persists:function(){var a=document.getElementById("zcwindows");if(a)return a.children.length>1},get:function(b){return this.isExist(b)?a[b].get():null},destroy:function(b,c){if(this.isExist(b)){a[b].close(c),delete a[b];var d=document.getElementById("zcwindows")&&document.getElementById("zcwindows").lastChild;this.current=!$WC.Util.isEmpty(d)&&!$WC.Util.isEmptyObject(d)?d.getAttribute("id"):null}this.triggerEvent("window-destroyed")},handleOutsideClose:function(){var b=this.current;b&&this.isExist(b)&&a[b].closeoutside&&$WC.$Win.destroy(b)},getFront:function(b){a[b].getMeFront()},closeAll:function(){var a=document.getElementById("zcwindows");if(a){var b=a.children,c=b.length;if(!b)return;while(b[0]){var d=b[0].id;this.isExist(d)&&this.destroy(d)}}},handleEscape:function(){var a=document.getElementById("zcwindows");if(a&&a.lastChild){var b=a.lastChild.id;if(this.isExist(b))return this.destroy(b),!0}return!1},create:function(c){var d=c.id;b(d,new $WC.WindowObject(c));var e=a[d].create(c);return this.triggerEvent("window-created"),e},triggerEvent:function(a){if(c.hasOwnProperty(a)){var b=c[a],d=function(a){setTimeout(function(){a()},0)};for(var e=0;e<b.length;e++)typeof b[e]=="function"&&d(b[e])}},on:function(a,b){c.hasOwnProperty(a)&&c[a].push(b)},off:function(a){c.hasOwnProperty(a)&&(c[a]=[])}}}(),$WC.$Dlg={},$WC.$Dlg=function(){function k(){j===!1&&(f={draggable:!0,bg:!0,"class":"zcdalogbx",openfn:function(){},bodyhtml:"",headerhtml:"",version:1,buttons:[]},g={buttons:[{text:$WC.I18N("common.ok"),colour:b}]},h={buttons:[{text:$WC.I18N("common.ok"),colour:c}]},j=!0)}var a={},b=1,c=2,d=3,e=1,f,g,h,i=[1,2,3],j=!1,l=function(b){a[b.id]={},a[b.id].buttons=b.buttons},m=function(a){return i.includes(a.version)?a.version:1},n=function(a){function d(a,d){switch(a){case 1:return d===c?"buttn_neg":"buttn_pos";case 2:return"zcdlgbtn "+(d===c?"zcdlgbtn-red":d===b?"zcdlgbtn-green":"");case 3:return"zcl-btn-large mL20 "+(d?d:"zcl-btn--primary")}}var f="",g=a.imagehtml?'<div class="zcdlg_lft"><div class="zcpp_dlgltin">'+a.imagehtml+"</div></div>":"",h=m(a),i=a.buttons.length,j=!1;for(var k=0;k<i;k++)j||(e=k+1,j=!0),f+='<button button="'+(k+1)+'" class="'+d(h,a.buttons[k].colour)+'">'+a.buttons[k].text+"</button>";return o(h).replace(/{IMAGE}/g,g).replace(/{MESSAGE}/g,$WC.Matcher.replace("escapeReplacementString",a.bodyhtml)).replace(/{BUTTON}/g,f)},o=function(a){switch(a){case 1:return['<div class="mcontent"><div class="dialogmn">{IMAGE}<div class="zcdlg_rht"><div class="zcdlgmsg">{MESSAGE}</div></div></div><div class="wctxtcent">{BUTTON}</div></div>'].join("");case 2:return['<div class="mcontent"><div class="mcontent_txt_con">{MESSAGE}</div><div class="mcontent_btn_con">{BUTTON}</div></div>'].join("");case 3:return['<div class="mcontent"><div class="mcontent_txt_con">{MESSAGE}</div><div class="mcontent_btn_con textR">{BUTTON}</div></div>'].join("")}},p=function(b){l(b);var c=$WC.$Win.create({id:b.id,header:b.headerhtml,closehtml:'<span id="winclose" title="'+$WC.I18N("common.cancel")+'" class="zchat-close cclose"></span>',html:n(b),"class":b.class,draggable:b.draggable,bg:b.bg,openfn:b.openfn,closefn:function(c){delete a[c],typeof b.closefn=="function"&&b.closefn()}});return typeof jQuery!="undefined"&&c instanceof jQuery&&(c=c[0]),r(c,b.id),c},q=function(a){return a.class+=typeof a.imagehtml=="undefined"?" zcdgimgnone":"",a},r=function(b,c){Gator(b).on("click","[button]",function(b){if($WC.$Dlg.isExist(c)){b.stopPropagation();var d=parseInt(this.getAttribute("button")),e=a[c].buttons[d-1].action;if(typeof e=="function")var f=e.call($WC.$Win.get(c));f||$WC.$Win.destroy(c)}})};return{GREEN_BUTTON:1,RED_BUTTON:2,GREY_BUTTON:3,create:function(a){k(),e=1;if(!$WC.$Dlg.isExist(a.id)){a=$WC.Util.extend(!0,{},f,a),a=q(a);var b=p(a),c=b.querySelectorAll('[button="'+e+'"]');return c&&c[0]&&c[0].focus(),b}},alert:function(a){k(),a=$WC.Util.extend(!0,{},g,a),this.create(a)},confirm:function(a){k(),a=$WC.Util.extend(!0,{},h,a),this.create(a)},isExist:function(b){return a.hasOwnProperty(b)},destroy:function(a){$WC.$Win.destroy(a)},frameHeaderHTML:function(a){var b="",c=a&&a.ispositive?"mheader_ttl clr-green":"mheader_ttl",d=a&&a.ispositive?"mheader_p clr-green":"mheader_p";return a&&a.imagehtml&&(b+=a.imagehtml),a&&a.header&&(b+='<div class="'+c+'">'+a.header+"</div>"),a&&a.subheader&&(b+='<div class="'+d+'">'+a.subheader+"</div>"),b},frameBodyInfoHTML:function(a){var b=a&&a.info?a.info.length:0,c=a&&a.infoheader?a.infoheader:$WC.I18N("dialogue.info.header"),d=b>0?'<div class="mcontent_ttl">'+c+"</div>":"";if(a&&$WC.Util.isEmpty(a.infoheader)&&b==1)d='<div class="zcdlg_rht">'+a.info[0]+"</div>";else if(b>0)for(var e=0;e<b;e++)d+='<div class="mcontent_p msi-rgtarw">'+a.info[e]+"</div>";return d},getButtonObj:function(a,b,c){return{text:$WC.I18N(a),colour:b,action:c}}}}(),$WC.Widgets=function(){function c(){b===!1&&(a={alert:{"class":"zchat-alrt",title:$WC.I18N("info.warning")},info:{"class":"zchat-hisseld",title:$WC.I18N("info.success")},confirm:{"class":"zchat-question",title:$WC.I18N("info.confirm")}},b=!0)}var a={},b=!1,d=function(a){var b={};return a.input&&a.input.type==="user_webhook_token"?b.text=$WC.I18N("common.authenticate"):typeof a.btntxt!="undefined"&&(b.text=a.btntxt),typeof a.btncallback!="undefined"&&(b.action=a.btncallback),b.colour=$WC.$Dlg.GREEN_BUTTON,b};return{construct:function(b){c();if(this.isValid(b)){var e='<div class="zcartcnt"><div><div class="{DLGLASS} wcdIB f40 mrgL10"></div><div class="wcdIB zcfarlt"><div class="zcartnm">{HEADER}</div><div class="clr0">{MSG}</div></div></div>{INPUT}</div>',f=a[b.type];b.type==="confirm"&&b.input?b.input.type==="user_webhook_token"?e=e.replace(/{INPUT}/g,"").replace(/{DLGLASS}/g,"zcf-integ").replace(/{HEADER}/g,$WC.I18N("webhooktoken.title.extn",[b.component_name])).replace(/{MSG}/g,$WC.I18N("webhooktoken.desc.extn",[b.component_name])):e=e.replace(/{INPUT}/g,'<textarea id="buttonconfirminput" placeholder="'+$WC.$CUtil.processXSS(b.input)+'" maxlength="300" class="zcartinp"></textarea>'):e=e.replace(/{INPUT}/g,""),e=e.replace(/{DLGLASS}/g,f.class).replace(/{HEADER}/g,typeof b.title!="undefined"?$WC.$CUtil.processXSS(b.title):f.title).replace(/{MSG}/g,$WC.CMsgUtil.convertLinks(b.description));if(b.type==="alert"||b.type==="info"||b.type==="confirm"){$WC.$Dlg.alert({id:"widget"+b.type,bodyhtml:e,buttons:[d(b)],closefn:typeof b.closeCallback=="function"?b.closeCallback:""});if(b.type==="confirm"){var g=document.getElementById("buttonconfirminput");g==null&&(g=document.getElementById("widget"+b.type).querySelector("button")),g!=null&&g.focus()}}}},isValid:function(a){c();var b=!1,d=["alert","confirm","prompt","info","poll","photo"];return typeof a.type!="undefined"&&(b=d.indexOf(a.type)!=-1),b}}}();var $WC=$WC||{};$WC.CustomMsg={msgobj:{},storeMsgObj:function(a){if(a["brief.msg"]||a["btnindexvsdetails.msg"])$WC.CustomMsg.msgobj[a.chid]=$WC.CustomMsg.msgobj[a.chid]||{},$WC.CustomMsg.msgobj[a.chid][a.time]=a},removeMsgObj:function(a){delete $WC.CustomMsg.msgobj[a]},getMsgObj:function(a,b,c){var d=a.closest("[chid]")||a;return $WC.CustomMsg.msgobj[b||d.getAttribute("chid")||a.closest("[data-chid]").getAttribute("data-chid")][c||d.getAttribute("time")||a.closest("[data-msgtime]").getAttribute("data-msgtime")]},getTheme:function(a){var b=a["brief.msg"];return b?b.themeid:""}},$WC.CustomMsgUI={button:{text:{theme1:1,theme2:3,theme3:1,theme4:2,theme5:1,theme6:0,theme7:3,theme8:1,theme9:10,theme10:2}},getCustomMessageContent:function(a){var b=a["brief.msg"];return b?($WC.CustomMsg.storeMsgObj(a),['<div class="zcmsg_bx zcmsg_bx'+$WC.CustomMsg.getTheme(a)+'" chid="'+a.chid+'"  time="'+a.time+'" data-sendername="'+$WC.Util.safeHTML(a.dname)+'" customcardmsg>',this.getThemeTemplateObj(a).getlayout(this.getThemeParamObj(a),a),"</div>"].join("")):""},getThemeParamObj:function(a){var b=a["brief.msg"];return{img:this.getThemeImageURL(a),desc:$WC.CMsgUtil.getDisplayContent(a),desctitle:a.msg?$WC.CMsgUtil.processMsg(a.msg.trim(),a):"",title:b.title?$WC.CMsgUtil.processMsg(b.title,a):"",titletooltip:b.title?a.raw?$WC.$CUtil.processXSS(b.title):b.title:"",icon:b.icon,button:$WC.CustomMsgUI.getButtonHTML(a),chid:a.chid,time:a.time}},getThemeImageURL:function(a){var b=$WC.CustomMsg.getTheme(a),c=a["brief.msg"];return["1","2","4","7"].indexOf(b)>-1?c.thumbnail||c.img:c.img||c.thumbnail},getCustomMsgOverlayHTML:function(a){var b='<div class="zc_cstm_ovrly">';return $WC.CMsgUtil.isCustomMessage(a)&&(b+=$WC.CustomMsgTemplate.getOverlayCustomMsgHTML(a)),$WC.CMsgUtil.isCustomFormattedMsg(a)&&(b+=$WC.CMsgUtil.getFormattedMsgContent(a)),b+"</div>"},getThemeTemplateObj:function(a){return $WC.CustomMsgTemplate["theme_"+$WC.CustomMsg.getTheme(a)]},getButtonHTML:function(a,b,c){var d=a["brief.msg"],e=b?!0:!1;b=b||d.buttons;if(!b||!b.length)return"";var f="",g=b.length,h=$WC.CustomMsg.getTheme(a);btncount=e?5:$WC.CustomMsgUI.button.text["theme"+$WC.CustomMsg.getTheme(a)];for(var i=0;i<g;i++){var j=b[i],k=c?"primaryindex = PRIMARY_INDEX":"";if(i>=btncount){f+=this.constructBtnDropDown(b,a,k,btncount);break}f+=$WC.CustomMsgTemplate.getbutton(j,a,i)}return'<div class="zcntnbx"  '+k+">"+f+"</div>"},constructBtnDropDown:function(a,b,c,d){var e=a.length,f='<div class="zcmorebtn" custom_btn_click><em custom_btn_click></em><ul>';for(var g=d;g<e;g++)f+="<li "+c+">"+$WC.CustomMsgTemplate.getbutton(a[g],b,g)+"</li>";return f+"</ul></div>"},handleMoreMessage:function(a){var b=a.target.getAttribute("custom_message"),c=document.getElementById("cardmainmessage");$WC.Util.addClass(a.target,"zc_dN"),b==="show_more"?(c.style.height=parseInt(c.getAttribute("scrollHeight"))+30+"px",$WC.Util.removeClass(document.querySelectorAll('[custom_message="show_less"]')[0],"zc_dN")):(c.style.height=parseInt(c.getAttribute("clientHeight"))+"px",$WC.Util.removeClass(document.querySelectorAll('[custom_message="show_more"]')[0],"zc_dN"))},handleCustomBoxClick:function(a,b,c){var d=$WC.CustomMsg.getMsgObj(a);if(b.target.getAttribute("purpose")==="custom_image_preview"){this.showOriginalImage(d["brief.msg"]);return}b.target.tagName.toLowerCase()!=="a"&&$WC.$Win.create({id:"custommsg","class":"cmsgdlg",header:$WC.CMsgUtil.getBriefMsgTitle(d),html:$WC.CustomMsgUI.getCustomMsgOverlayHTML(d),additionalattrs:' chid="'+d.chid+'" time="'+d.time+'"',closefn:c})},handleOverlayImage:function(a){var b=$WC.CustomMsg.getMsgObj(a),c=b?b["brief.msg"]:{img:a.getAttribute("src")};this.showOriginalImage(c)},showOriginalImage:function(a){$WC.$Win.create({id:"custommsgimgprev","class":"cmsgdlg cmsgprev",html:$WC.CustomMsgTemplate.getImagePreviewHTML(a)})}},$WC.CustomMsgTemplate={theme_0:{getlayout:function(a,b){var c="";return $WC.CMsgUtil.isCustomFormattedMsg(b)&&(c=$WC.CMsgUtil.getFormattedMsgContent(b)),['<div class="zcthm0ctr">',a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+a.title+"</div>":"",a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",'<div class="btncnt">','<div class="zcdesc">'+a.desc+"</div>","</div>",a.button,"</div>","<div>"+c+"</div>"].join("")}},theme_1:{getlayout:function(a){return[a.desc?'<div class="zcdesc"><div>'+a.desc+"</div></div>":"",'<div class="btncnt">',a.img?'<div class="zcimg"><img src="'+a.img+'" purpose="custom_image_preview" ></div>':"",a.title?'<div class="zctitle">'+(a.icon?'<img src="'+a.icon+'">':"")+'<div title="'+a.titletooltip+'">'+a.title+"</div></div>":"",a.button,"</div>"].join("")}},theme_2:{getlayout:function(a){return[a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",'<div class="btncnt">',a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc"><div>'+a.desc+"</div></div>",a.button,"</div>"].join("")}},theme_3:{getlayout:function(a){return['<div class="btncnt">',a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc"><div>'+a.desc+"</div></div>",a.button,"</div>"].join("")}},theme_4:{getlayout:function(a){return['<div class="btncnt">',a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc"><div>'+a.desc+"</div></div>","</div>",a.button].join("")}},theme_5:{getlayout:function(a){return[a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",a.button,'<div class="btncnt">',"<div>",a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc"><div>'+a.desc+"</div></div>","</div>","</div>"].join("")}},theme_6:{getlayout:function(a){var b=a.title||"",c=a.img?"":"zcnobg";return['<div class="btncnt '+c+'" >',a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",b?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+b+"</div>":"","</div>",'<div class="zcbtmbx">','<div class="zcdesc"><div class="ellips">'+a.desc+"</div></div>",a.button,"</div>"].join("")}},theme_7:{getlayout:function(a){return[a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",'<div class="btncnt">',a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc"><div>'+a.desc+"</div></div>","</div>",a.button].join("")}},theme_8:{getlayout:function(a){var b=a.desc;return b=b.replace(/(?:\r\n|\r|\n)/g,"<br />"),[a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"","<div>",'<div class="btncnt">',a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc"><div>'+b+"</div></div>","</div>",a.button,"</div>"].join("")}},theme_9:{getlayout:function(a){var b=document.createElement("div");b.innerHTML=a.button;var c=b.querySelectorAll("[btnindex]"),d;return c.length&&(d=c[c.length-1],b.querySelectorAll("[btnindex]:last-child")[0].remove()),['<div class="btncnt">',a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"",a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc"><div >'+a.desc+"</div>","</div>","</div>",b.innerHTML,'<div class="zcntrslut">'+(c.length?d.outerHTML:"")+"</div>"].join("")}},theme_10:{getlayout:function(a,b){var c="";return $WC.CMsgUtil.isCustomFormattedMsg(b)&&(c=$WC.CMsgUtil.getFormattedMsgContent(b)),['<div class="btncnt">',a.title?'<div class="zctitle" title="'+a.titletooltip+'">'+(a.icon?'<img src="'+a.icon+'">':"")+a.title+"</div>":"",'<div class="zcdesc">',a.img?'<img src="'+a.img+'" purpose="custom_image_preview" >':"","<p>"+a.desc+"</p>","</div>","</div>","<div>"+c+"</div>","<div>",a.button,"</div>"].join("")}},formatButton:function(a){return a.label?a:(a.text&&(a.label=a.text,delete a.text),a.click&&(a.action={},a.click["action.type"]&&(a.action.type=a.click["action.type"]),a.click["action.data"]&&(a.action.data=a.click["action.data"]),a.click["action.confirm"]&&(a.action.confirm=a.click["action.confirm"]),delete a.click),a)},getbutton:function(a,b,c){var d=b["btnindexvsdetails.msg"]?b["btnindexvsdetails.msg"][a]:a;d=this.formatButton(d);if(!d.action||!d.label)return"";var e=$WC.$CUtil.processXSS(d.label),f=d.hint?$WC.$CUtil.processXSS(d.hint):e,g=d.type==="+"?"zcok":d.type==="-"?"zccancel":"";return['<a class="zcbtn '+g+'" title="'+f+'" chid="'+b.chid+'" time="'+b.time+'" custombuttonclick_onmsg index="'+c+'" btnindex="'+d.index+'" >','<span data-cmsgbtn="true" class="cmsg-btn">'+e+"</span>","</a>"].join("")},getImagePreviewHTML:function(a){var b=a.img||a.thumbnail;return['<div class="cmsgimg">','<img src="'+b+'" />',"</div>"].join("")},getOverlayCustomMsgHTML:function(a){var b=a["brief.msg"],c=b.thumbnail||b.img,d=b.buttons,e=d&&d.length?"zccustmsg":"";return['<div class="msgbox zccard-bx '+e+'">','<div class="zccard">',c?'<img src="'+c+'" purpose="custom_image_preview" chid="'+a.chid+'" time="'+a.time+'"/>':"",'<div id="cardmainmessage" class="zccarddesc">'+$WC.CMsgUtil.getDisplayContent(a)+"</div>","</div>",$WC.CustomMsgUI.getButtonHTML(a,d),"</div>"].join("")},getBotSuggestionsContent:function(a){var b='<div botsuggestions class="zcbotsugg">';for(var c=0;c<a.length;c++){var d=a[c],e=$WC.$CUtil.processXSS(d.text);b+='<div suggestionsclick_onmsg text="'+e+'" title="'+e+'">'+(d.icon?'<img src="'+d.icon+'">':"")+'<span class="font14 txtcent bold">'+e+"</span>"+"</div>"}return b+"</div>"}};var ChatTour={};ChatTour.helpTipHtml='<div id="wms_chattour_icon" class="{{ICON}}"></div><h4 class="wms_chattour_title">{{TITLE}}</h4><p>{{CONTENT}}</p><span data-operation="tournext">{{NAVIGATOR}}</span><div data-operation="close" class="{{CLOSE}}"></div>',ChatTour.checkAndScheduleNotifier=function(a){if(WmsSettings.isTourEnabled()&&WmsSettings.isOnboardSeen()===!1&&WebMessanger.isChatPaused()===!1){var b=1728e6,c=(new Date).getTime()-a;clearTimeout(ChatTour.notifytimer);var d=b-c;d<0&&(d=0),ChatTour.notifytimer=setTimeout(function(){if(WmsSettings.isOnboardSeen()===!1&&WmsMainUI.getUnreadChatsCount()===0){if(WebMessanger.isCliqUser()===!0)return;ChatTour.insertTourNotifier(document.querySelector('#wms_menubar > [data-menuname="chat"]'))}},d)}},ChatTour.isTourNotificationShown=function(){return this.tournotifier?!0:!1},ChatTour.insertTourNotifier=function(a){if(a){var b=$WC.Util.createElement("span",null,"wms_chattour_initial");ChatTour.tournotifier=a.appendChild(b)}},ChatTour.removeTourNotifier=function(){ChatTour.tournotifier&&($WC.Util.removeElement(ChatTour.tournotifier),ChatTour.tournotifier=null)},ChatTour.init=function(a,b){ChatTour.list=a,ChatTour.removeTourNotifier(),ChatTour.tipnum=0;var c=document.getElementById("wms_tourcontainer");if(c===null){var d='<div id="wms_tourcontainer"><div id="wms_touroverlay" class="wms_touroverlay"></div><div id="wms_skiptour" data-operation="tourskip" class="wms_tourskip">'+$WC.I18N("tour.skip")+"</div>"+"</div>";b.insertAdjacentHTML("beforeend",d);var e='<div id="wms_chattour" class="wms_chattour" style="z-index:'+$WC.Config.get("zindex")+'">'+'<div id="wms_tourpointer" class="wms_tour_pointer wms_tour_pntdown"></div>'+'<div id="wms_chattour_content"></div>'+"</div>";document.body.insertAdjacentHTML("beforeend",e),ChatTour.bindEvents(),ChatTour.showHelpTip()}},ChatTour.bindEvents=function(){var a=document.getElementById("wms_tourcontainer"),b=document.getElementById("wms_chattour");Gator(b).on("click","[data-operation]",function(){var a=this.getAttribute("data-operation");a==="tournext"?ChatTour.tipnum===ChatTour.list.length-1?ChatTour.exit(!0,!0):ChatTour.nextHelpTip():a==="tourprev"?ChatTour.prevHelpTip():a==="close"?ChatTour.exit(!0):a==="visitcliq"&&(window.open(_WMSCHATURL),ChatTour.exit(!0,!0))}),Gator(a).on("click","[data-operation]",function(){var a=this.getAttribute("data-operation");a==="tourskip"&&ChatTour.exit(!0)})},ChatTour.handleKeyMovement=function(a){if(document.getElementById("wms_tourcontainer")!==null){var b=window.event?a.keyCode:a.which;return b===$WC.WmsConstants.KEYCODES.LEFT?ChatTour.prevHelpTip():b===$WC.WmsConstants.KEYCODES.ENTER||b===$WC.WmsConstants.KEYCODES.RIGHT?ChatTour.tipnum!==ChatTour.list.length-1&&ChatTour.nextHelpTip():b===$WC.WmsConstants.KEYCODES.ESCAPE&&ChatTour.exit(!0),!0}},ChatTour.prevHelpTip=function(){ChatTour.tipnum>0&&(ChatTour.hidePreviousHighlight(),ChatTour.tipnum--,ChatTour.showHelpTip())},ChatTour.nextHelpTip=function(){ChatTour.hidePreviousHighlight(),ChatTour.tipnum<ChatTour.list.length-1&&(ChatTour.tipnum++,ChatTour.tipnum<ChatTour.list.length&&ChatTour.showHelpTip())},ChatTour.exit=function(a,b){typeof ChatTour.tipnum=="number"&&ChatTour.list&&ChatTour.tipnum<ChatTour.list.length&&ChatTour.hidePreviousHighlight();if(a){var c=b?"0:"+ChatTour.list.length:ChatTour.tipnum+1+":"+ChatTour.list.length;WmsSettings.updateTourSettings(WmsSettings.constants.ONBOARD,c)}ChatTour.removeTourNotifier();var d=document.getElementById("wms_tourcontainer");$WC.Util.removeElement(d);var e=document.getElementById("wms_chattour");$WC.Util.removeElement(e)},ChatTour.showHelpTip=function(){var a=document.getElementById("wms_chattour_content"),b=$WC.I18N("Next"),c=ChatTour.helpTipHtml,d=ChatTour.list[ChatTour.tipnum];if(ChatTour.tipnum!==0||!d.sethtml)c+='<span data-operation="tourprev" style="float:left">'+$WC.I18N("tour.back")+"</span>";ChatTour.tipnum===ChatTour.list.length-1&&(b=$WC.I18N("Finish")),c=$WC.template.replace(c,{ICON:d.icon||"",TITLE:$WC.I18N(d.title||""),CONTENT:$WC.I18N(d.content||""),NAVIGATOR:$WC.I18N(d.navigator)||b,CLOSE:d.sethtml?"":"wms_chattour_close"});var e=document.querySelector("["+d.elemid+"]");a.innerHTML=c;if(d.sethtml){if(d.replacetext)for(var f in d.replacetext){var g={};g[f]=$WC.I18N(d.replacetext[f]),d.sethtml=$WC.template.replace(d.sethtml,g)}document.getElementById("wms_chattour_icon").insertAdjacentHTML("afterend",d.sethtml)}d.elemid&&$WC.Util.addClass(e,"wms_chattour_elemhighlight"),ChatTour.positionHelpTip(e,d.align,d.position)},ChatTour.positionHelpTip=function(a,b,c){var d=document.getElementById("wms_chattour"),e=document.getElementById("wms_tourpointer"),f=10,g=20,h=0,i=0,j=0;c!=="fixed"&&(d.style.width="",d.style.transform="");if(b==="center")$WC.Util.addClass(d,"wms_chattour_hvalign"),d.style.width="320px",h=window.innerWidth/2-d.offsetWidth/2+g,i=window.innerHeight/2-d.offsetHeight/2,e.style.display="none";else{var k=a.getBoundingClientRect();h=k.left+f,i=window.innerHeight-k.height-d.offsetHeight-g,j=k.width/2-e.offsetWidth/2-f,c==="fixed"&&(h=d.offsetLeft||f,j+=k.left),e.style.display="block",e.style.transform="translateX("+j+"px)"}d.style.transform="translate("+h+"px,"+i+"px)",ChatTour.list[ChatTour.tipnum+1]&&ChatTour.list[ChatTour.tipnum+1].align===ChatTour.list[ChatTour.tipnum].align&&$WC.Util.removeClass(d,"wms_chattour_hvalign")},ChatTour.hidePreviousHighlight=function(){var a=ChatTour.list[ChatTour.tipnum]&&ChatTour.list[ChatTour.tipnum].elemid;if(a){var b=document.querySelector("["+a+"]"),c=document.getElementById("wms_chattour");a&&$WC.Util.removeClass(b,"wms_chattour_elemhighlight"),c&&$WC.Util.removeClass(c,"wms_tourfadeIn")}},WmsUsersList.prototype.showList=function(a){var b=this.input.value,c=a&&a.callbackargs&&a.callbackargs.silentload,d=this.getList();d&&d.length?($WC.Util.removeElement(this.listcommon.container.querySelector("[data-emptylist]")),this.listcommon.showUI(d,!0,null,c),(d.length<10||$WC.Matcher.check("emailid",b,!0))&&WmsOrgContacts.isCachedRequest(b)===!1&&WmsHybridSearch.getNextResultSet({searchtext:b,inpresultset:$WC.WmsConstants.HYBRIDSEARCH.USERLIST,topicname:"userslistview",silentload:!0})):a&&a.stat==$WC.WmsConstants.REQSTATUS.NORESULTS&&this.listcommon.showUI('<span data-emptylist class="wms_searchresult wms-hvalign">'+$WC.I18N("search.noresult")+"</span>",null,!0),this.container.style.display="block"},WmsUsersList.prototype.handleKeyMovement=function(a){var b=a.keyCode,c=this.listcommon.selectedelem;b===$WC.WmsConstants.KEYCODES.ENTER?this.insertSuggestion(c):b===$WC.WmsConstants.KEYCODES.ESCAPE?this.container.style.display==="block"&&(this.container.style.display="none"):this.showList()},WmsUsersList.prototype.handleClick=function(a){this.insertSuggestion(a)},WmsUsersList.prototype.getList=function(){var a=this.input.value,b=[],c=this.target.querySelectorAll("[data-userid]");c.length&&$WC.Util.convertToArray(c).forEach(function(a){b.push(a.getAttribute("data-userid"))}),b=this.exclude_users?b.concat(this.exclude_users):b,b={USERID:b};var d=$WC.HybridSearch.filter("DNAME",a,WmsContacts.getContactsListWithoutBots(),10,b,"EMAILID");return d.length<10&&(d=d.concat($WC.HybridSearch.filter("DNAME",a,WmsOrgContacts.getOrgContactsList(),10,b,"EMAILID"))),d},WmsUsersList.prototype.insertSuggestion=function(a){var b=this.target.querySelectorAll("[data-userid]");if(this.userlimit&&b.length===this.userlimit){WMSUI.showErrorMsg($WC.I18N("reminders.members.limit"));return}var c=a.getAttribute("data-userid"),d=WmsContacts.getUserPhoto(c);this.target.insertAdjacentHTML("beforeend",'<div data-userid="'+c+'" class="wms_remmemwrapper"><img class="wms-filefrwrdcontactimg" src="'+d+'"><span data-operation="deletemembers" class="wms_remmemberclose"></span></div>'),this.input.value="",this.showList()};var lfromstatic=!0;

function WmsContactImpl(){}function Collaboration(){}function WmsChatUIImpl(){}function ZohoFeedImpl(){}function CustomChat(){}function ZTI(){}function WMSTP(){}function WmsUIImpl(){}function PubSubImpl(){}function Presence(){}function ChatletImpl(){}WmsContactImpl.handlePresence=function(a,b,c,d,e){},WmsContactImpl.handleAddressBook=function(){},WmsContactImpl.handleInvitations=function(a){},WmsContactImpl.handleInvite=function(a,b,c){},WmsContactImpl.notifyInvite=function(a,b,c){},WmsContactImpl.handleAccept=function(a,b,c){},WmsContactImpl.notifyAccept=function(a,b,c){},WmsContactImpl.handleReject=function(a,b,c){},WmsContactImpl.notifyRemove=function(a,b,c){},WmsContactImpl.handleDelete=function(a,b,c){},WmsContactImpl.handleContactUpdated=function(){},WmsContactImpl.handleStatusMessage=function(a,b){},WmsContactImpl.handeAllStatusMessages=function(){},WmsContactImpl.handleHideContactsUI=function(){},WmsContactImpl.handleShowContactsUI=function(){},WmsContactImpl.handleGetContacts=function(){},WmsContactImpl.handleMPReject=function(a,b,c){},WmsContactImpl.handleMPAccept=function(a,b,c){},WmsContactImpl.handleMPDelete=function(a,b,c){},WmsContactImpl.handleMPAdd=function(a,b,c){},WmsContactImpl.handleMPInvite=function(a,b,c){},WmsContactImpl.handleLogin=function(a,b,c,d){},WmsContactImpl.handleLogout=function(a,b,c,d,e){},WmsContactImpl.handleGetAccounts=function(a){},WmsContactImpl.handleBulkPresence=function(a,b){},Collaboration.handleUserList=function(a,b){},Collaboration.handleMessage=function(a,b,c,d,e){},Collaboration.handlePresence=function(a,b,c,d,e){},Collaboration.join=function(a){WebMessanger.joinCollab(a)},Collaboration.quit=function(a){WebMessanger.quit(a)},Collaboration.serverup=function(){},Collaboration.serverdown=function(){},Collaboration.handleZohoMessage=function(a,b,c,d,e,f,g,h,i,j,k,l){return!1},Collaboration.handleCustomMessage=function(a){},Collaboration.handleCrossProductMessage=function(a,b){},Collaboration.onConnect=function(){},Collaboration.openURL=function(a,b,c,d){return!0},Collaboration.handleCollabAdd=function(a,b,c,d,e){},Collaboration.handleCollabDelete=function(a,b,c,d,e){},Collaboration.handleUserAdd=function(a,b){},Collaboration.handleUserDeleted=function(a,b){},Collaboration.handleIsOnline=function(a){},Collaboration.handleLogout=function(a){},Collaboration.goOffline=function(){},Collaboration.wmsOffline=function(){},Collaboration.handleChatNotifyMessage=function(a,b,c){},Collaboration.getPageTitle=function(){return!1},Collaboration.handleWmsDisable=function(a){},Collaboration.handleComposeMail=function(a,b){return!1},Collaboration.handleServiceMessage=function(a){},Collaboration.handleLanguageChange=function(a){},Collaboration.handleAuthFailure=function(){},Collaboration.handleWebRTCMessage=function(a){},WmsChatUIImpl.handleUserIdle=function(a,b){},WmsChatUIImpl.handleUserEnteredText=function(a,b){},WmsChatUIImpl.handleUserTyping=function(a,b){},WmsChatUIImpl.handleNewChat=function(a){},WmsChatUIImpl.handleChatMessage=function(a){},WmsChatUIImpl.isActive=function(a){return!1},WmsChatUIImpl.handleTranscript=function(a,b){},ZohoFeedImpl.handleFeedHistory=function(a){},ZohoFeedImpl.handleFeedHistoryCount=function(a){},ZohoFeedImpl.handleUnreadFeeds=function(a){},ZohoFeedImpl.handleFeedsInRange=function(a){},ZohoFeedImpl.handleFeedDelete=function(a){},ZohoFeedImpl.handleFeedHistoryUI=function(){return!1},ZohoFeedImpl.handleUnreadFeedUI=function(){return!1},ZohoFeedImpl.handleLiveFeedsUI=function(a){return!1},CustomChat.handleUserList=function(a,b){},CustomChat.handleMessage=function(a){},CustomChat.handlePresence=function(a,b,c,d,e){},CustomChat.handleUserAdded=function(a,b,c){},CustomChat.handleUserDeleted=function(a,b,c){},CustomChat.handleTranscript=function(a,b){},CustomChat.join=function(a){WebMessanger.join(a)},CustomChat.transcript=function(a,b){},CustomChat.quit=function(a){WebMessanger.quit(a)},CustomChat.handleAttachmentMessage=function(a,b){},CustomChat.handleTitleUpdated=function(a,b){},CustomChat.isActive=function(a,b){return!1},CustomChat.handleCloseWin=function(a){},ZTI.handleFailure=function(a,b){},ZTI.handleCrossProductMessage=function(a){},WMSTP.isVideoEnabled=function(){return!1},WMSTP.isAudioEnabled=function(){return!1},WMSTP.isScreenShareEnabled=function(){return!1},WMSTP.handleNewVideo=function(a,b){},WMSTP.handleNewAudio=function(a,b){},WMSTP.handleAVMessage=function(a){},WmsUIImpl.handleFeedHistory=function(){},WmsUIImpl.handleUnreadFeeds=function(){},WmsUIImpl.handleDocumentIdle=function(){},WmsUIImpl.UIReady=function(){},WmsUIImpl.handleUIShown=function(){},WmsUIImpl.handleUIHidden=function(){},WmsUIImpl.handleChatWindowClose=function(a,b,c){},WmsUIImpl.preventChatWindowOpen=function(a,b){},WmsUIImpl.handleNewMessage=function(a,b,c,d){},WmsUIImpl.handleAnnouncement=function(a,b){return!1},WmsUIImpl.getHeaderHTML=function(a,b,c,d,e,f){},WmsUIImpl.getStatusHTML=function(a,b,c,d,e){},WmsUIImpl.getChatWindowContainer=function(a,b,c,d,e,f){},WmsUIImpl.getChatWindowOptions=function(a,b,c,d,e,f){},WmsUIImpl.getChatBarOptions=function(){},WmsUIImpl.customContactsConfig=function(){},WmsUIImpl.getTranscript=function(a,b,c){},WmsUIImpl.handleKeyMovement=function(a,b){},WmsUIImpl.handleKeyUp=function(a,b){},WmsUIImpl.handleKeyDown=function(a,b){},WmsUIImpl.openChatWindowDropUp=function(a,b,c){WMSUI.openChatWindowDropUp(a,b,c)},WmsUIImpl.closeChatWindowDropUp=function(a){WMSUI.closeChatWindowDropUp(a)},WmsUIImpl.onChatWindowDropUpClick=function(a,b){},WmsUIImpl.restoreChat=function(a){},WmsUIImpl.uploadFile=function(a,b,c){},WmsUIImpl.showDialog=function(a,b){WmsDialog.showModal(a,b)},WmsUIImpl.disableComposerOptions=function(a,b){WMSUI.disableComposerOptions(a,b)},WmsUIImpl.closeChatWindow=function(a){WMSUI.closeChatWindow(a)},WmsUIImpl.updateCountInContactsTab=function(a){WmsMainUI.updateChatInvitationCount(a)},WmsUIImpl.updateMessageInComposer=function(a,b){WMSUI.updateMessageInComposer(a,b)},WmsUIImpl.getUserPhoto=function(a,b){},WmsUIImpl.showFileUploadProgress=function(a,b){WindowHandler.showProgress(a,b)},WmsUIImpl.clearFileUploadProgress=function(a){WindowHandler.clearProgress(a)},WmsUIImpl.getMessageActions=function(a,b,c){},WmsUIImpl.destroyChatWindow=function(a){var b=WindowHandler.getWinObjById(a);b!==null&&(Factory.destroyDialog(b.winIndex,!0),b.removeWindowState())},WmsUIImpl.getChatWindowStatusText=function(a){},WmsUIImpl.disableActions=function(a){var b=WindowHandler.getWinObjById(a);b&&b.disableActions()},WmsUIImpl.updateChatWindowStatusText=function(a){var b=WindowHandler.getWinObjById(a);b&&b.updateUserStatus()},WmsUIImpl.updateChatTitle=function(a,b){WindowHandler.updateChatTitle(a,b)},WmsUIImpl.updateStatusInCustomContactMenu=function(a,b){WmsMainUI.updateStatusInCustomContactMenu(a,b)},WmsUIImpl.onComposerFocus=function(a){},PubSubImpl.onConnect=function(){},PubSubImpl.handleSubscribe=function(a){},PubSubImpl.handleUnSubscribe=function(a){},PubSubImpl.handleError=function(a,b,c){},PubSubImpl.handleUserList=function(a,b){},PubSubImpl.handleUserIn=function(a,b){},PubSubImpl.handleUserOut=function(a,b){},PubSubImpl.handleMessage=function(a,b){},Presence.handleUserStatus=function(a,b){},Presence.handleForceLogout=function(a){},Presence.handleMessage=function(a){},Presence.handleUserAdd=function(a){},Presence.handleUserDelete=function(a){},Presence.handleUserList=function(a,b){},Presence.handlePresence=function(a,b,c,d,e){},Presence.handleUserAdded=function(a,b){},Presence.handleUserDeleted=function(a,b){},ChatletImpl.handleURLInvocation=function(a,b){return!1},ChatletImpl.handleUserList=function(a,b,c){};
